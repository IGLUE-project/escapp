<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.2/jquery.scrollTo.min.js"></script>
<script>

    $.fn.upform = function() {
        var $this = $(this);
        var container = $this.find(".basicConfig");

        $(document).ready(function() {
            $(container).find(".erFormField:not(.disallow)").first().click();
        });

        $(container)
            .find(".erFormField:not(.disallow)")
            .not(".erFormField input, .erFormField select")
            .on("click", function() {
                rescroll(this);
            });

        $(container).find(".erFormField:not(.disallow) input, .erFormField:not(.disallow) select").keypress(function(e) {
            if (e.which == 13) {
                if ($(this).hasClass("required") && $(this).val() == "") {
                } else moveNext(this);
            }
        });

        $(container).find('.erFormField:not(.disallow) input[type="radio"]').change(function(e) {
            moveNext(this);
        });

        $(window).on("scroll", function() {
            $(container).find(".erFormField:not(.disallow)").each(function() {
                var etop = $(this).offset().top;
                var diff = etop - $(window).scrollTop();

                if (diff > 100 && diff < 300) {
                    reinitState(this);
                }
            });
        });

        function reinitState(e) {
            $(container).find(".erFormField:not(.disallow)").removeClass("active");

            $(container).find(".erFormField:not(.disallow) input, .erFormField:not(.disallow) select").each(function() {
                $(this).blur();
            });
            $(e).addClass("active");
            /*$(e).find('input').focus();*/
        }

        function rescroll(e) {
            $(window).scrollTo($(e), 200, {
                offset: { left: 100, top: -300 },
                queue: false
            });
        }

        function reinit(e) {
            reinitState(e);
            rescroll(e);
        }

        function moveNext(e) {
            $(e).parent().parent().next().click();
        }

        function movePrev(e) {
            $(e).parent().parent().prev().click();
        }
    };

    $(".main").upform();
    $.fn.upform = function() {
        var $this = $(this);
        var container = $this.find(".basicConfig");

        $(document).ready(function() {
            $(container).find(".erFormField:not(.disallow)").first().click()
        });


        $(container)
            .find(".erFormField:not(.disallow)")
            .not(".erFormField:not(.disallow) input, .erFormField:not(.disallow) select")
            .on("click", function() {
                rescroll(this);
            });

        $(container).find(".erFormField:not(.disallow) input").keypress(function(e) {
            if (e.which === 13) {
                if ($(this).hasClass("required") && $(this).val() == "") {
                } else moveNext(this);
            }
        });

        $(container).find('.erFormField:not(.disallow) input[type="radio"]').change(function(e) {
            moveNext(this);
        });

        $(window).on("scroll", function() {
            $(container).find(".erFormField:not(.disallow)").each(function() {
                var etop = $(this).offset().top;
                var diff = etop - $(window).scrollTop();

                if (diff > 90 && diff < 300) {
                    reinitState(this);
                }
            });
        });

        function reinitState(e) {
            $(container).find(".erFormField:not(.disallow)").removeClass("active");

            $(container).find(".erFormField:not(.disallow) input, .erFormField:not(.disallow) select").each(function() {
                $(this).blur();
            });
            $(e).find("input").focus();
        }

        function rescroll(e) {
            $(window).scrollTo($(e), 200, {
                offset: { left: 100, top: -300 },
                queue: false
            });
        }

        function reinit(e) {
            reinitState(e);
            rescroll(e);
        }

        function moveNext(e) {
            $(e).parent().parent().next().click();
        }

        function movePrev(e) {
            $(e).parent().parent().prev().click();
        }
    };

    $(".main").upform();

</script>
