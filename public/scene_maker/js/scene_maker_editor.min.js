var SceneMaker=SceneMaker||{};SceneMaker.VERSION="1.0.0",SceneMaker.getOptions=function(){try{if(window.parent.SCENE_MAKER_OPTIONS_PREVIEW)return window.parent.SCENE_MAKER_OPTIONS_PREVIEW;if(window.SCENE_MAKER_OPTIONS)return window.SCENE_MAKER_OPTIONS;if(window.parent.SCENE_MAKER_OPTIONS)return window.parent.SCENE_MAKER_OPTIONS}catch(e){}};/*! jQuery v1.7.2 jquery.com | jquery.org/license */(function(e,r){function _(a){return c.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function p(a){if(!Vn[a]){var u=ce.body,v=c("<"+a+">").appendTo(u),E=v.css("display");v.remove(),(E==="none"||E==="")&&(yn||(yn=ce.createElement("iframe"),yn.frameBorder=yn.width=yn.height=0),u.appendChild(yn),(!In||!yn.createElement)&&(In=(yn.contentWindow||yn.contentDocument).document,In.write((c.support.boxModel?"<!doctype html>":"")+"<html><body>"),In.close()),v=In.createElement(a),In.body.appendChild(v),E=c.css(v,"display"),u.removeChild(yn)),Vn[a]=E}return Vn[a]}function s(a,u){var v={};return c.each(jn.concat.apply([],jn.slice(0,u)),function(){v[this]=a}),v}function m(){mn=r}function f(){return setTimeout(m,0),mn=c.now()}function T(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}function k(){try{return new e.XMLHttpRequest}catch(a){}}function D(a,u){a.dataFilter&&(u=a.dataFilter(u,a.dataType));var v=a.dataTypes,E={},I,z,Y=v.length,Q,de=v[0],ae,_e,fe,ve,Ce;for(I=1;I<Y;I++){if(I===1)for(z in a.converters)typeof z=="string"&&(E[z.toLowerCase()]=a.converters[z]);if(ae=de,de=v[I],de==="*")de=ae;else if(ae!=="*"&&ae!==de){if(_e=ae+" "+de,fe=E[_e]||E["* "+de],!fe){Ce=r;for(ve in E)if(Q=ve.split(" "),(Q[0]===ae||Q[0]==="*")&&(Ce=E[Q[1]+" "+de],Ce)){ve=E[ve],ve===!0?fe=Ce:Ce===!0&&(fe=ve);break}}!fe&&!Ce&&c.error("No conversion from "+_e.replace(" "," to ")),fe!==!0&&(u=fe?fe(u):Ce(ve(u)))}}return u}function V(a,u,v){var E=a.contents,I=a.dataTypes,z=a.responseFields,Y,Q,de,ae;for(Q in z)Q in v&&(u[z[Q]]=v[Q]);for(;I[0]==="*";)I.shift(),Y===r&&(Y=a.mimeType||u.getResponseHeader("content-type"));if(Y){for(Q in E)if(E[Q]&&E[Q].test(Y)){I.unshift(Q);break}}if(I[0]in v)de=I[0];else{for(Q in v){if(!I[0]||a.converters[Q+" "+I[0]]){de=Q;break}ae||(ae=Q)}de=de||ae}if(de)return de!==I[0]&&I.unshift(de),v[de]}function O(a,u,v,E){if(c.isArray(u))c.each(u,function(z,Y){v||ui.test(a)?E(a,Y):O(a+"["+(typeof Y=="object"?z:"")+"]",Y,v,E)});else if(!v&&c.type(u)==="object")for(var I in u)O(a+"["+I+"]",u[I],v,E);else E(a,u)}function b(a,u){var v,E,I=c.ajaxSettings.flatOptions||{};for(v in u)u[v]!==r&&((I[v]?a:E||(E={}))[v]=u[v]);E&&c.extend(!0,a,E)}function R(a,u,v,E,I,z){I=I||u.dataTypes[0],z=z||{},z[I]=!0;for(var Y=a[I],Q=0,de=Y?Y.length:0,ae=a===ni,_e;Q<de&&(ae||!_e);Q++)_e=Y[Q](u,v,E),typeof _e=="string"&&(!ae||z[_e]?_e=r:(u.dataTypes.unshift(_e),_e=R(a,u,v,E,_e,z)));return(ae||!_e)&&!z["*"]&&(_e=R(a,u,v,E,"*",z)),_e}function S(a){return function(u,v){if(typeof u!="string"&&(v=u,u="*"),c.isFunction(v))for(var E=u.toLowerCase().split(gi),I=0,z=E.length,Y,Q,de;I<z;I++)Y=E[I],de=/^\+/.test(Y),de&&(Y=Y.substr(1)||"*"),Q=a[Y]=a[Y]||[],Q[de?"unshift":"push"](v)}}function h(a,u,v){var E=u==="width"?a.offsetWidth:a.offsetHeight,I=u==="width"?1:0,z=4;if(E>0){if(v!=="border")for(;I<z;I+=2)v||(E-=parseFloat(c.css(a,"padding"+En[I]))||0),v==="margin"?E+=parseFloat(c.css(a,v+En[I]))||0:E-=parseFloat(c.css(a,"border"+En[I]+"Width"))||0;return E+"px"}if(E=kn(a,u),(E<0||E==null)&&(E=a.style[u]),gn.test(E))return E;if(E=parseFloat(E)||0,v)for(;I<z;I+=2)E+=parseFloat(c.css(a,"padding"+En[I]))||0,v!=="padding"&&(E+=parseFloat(c.css(a,"border"+En[I]+"Width"))||0),v==="margin"&&(E+=parseFloat(c.css(a,v+En[I]))||0);return E+"px"}function w(a){var u=ce.createElement("div");return fn.appendChild(u),u.innerHTML=a.outerHTML,u.firstChild}function P(a){var u=(a.nodeName||"").toLowerCase();u==="input"?N(a):u!=="script"&&typeof a.getElementsByTagName!="undefined"&&c.grep(a.getElementsByTagName("input"),N)}function N(a){(a.type==="checkbox"||a.type==="radio")&&(a.defaultChecked=a.checked)}function X(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function te(a,u){var v;u.nodeType===1&&(u.clearAttributes&&u.clearAttributes(),u.mergeAttributes&&u.mergeAttributes(a),v=u.nodeName.toLowerCase(),v==="object"?u.outerHTML=a.outerHTML:v!=="input"||a.type!=="checkbox"&&a.type!=="radio"?v==="option"?u.selected=a.defaultSelected:v==="input"||v==="textarea"?u.defaultValue=a.defaultValue:v==="script"&&u.text!==a.text&&(u.text=a.text):(a.checked&&(u.defaultChecked=u.checked=a.checked),u.value!==a.value&&(u.value=a.value)),u.removeAttribute(c.expando),u.removeAttribute("_submit_attached"),u.removeAttribute("_change_attached"))}function ne(a,u){if(u.nodeType===1&&c.hasData(a)){var v,E,I,z=c._data(a),Y=c._data(u,z),Q=z.events;if(Q){delete Y.handle,Y.events={};for(v in Q)for(E=0,I=Q[v].length;E<I;E++)c.event.add(u,v,Q[v][E])}Y.data&&(Y.data=c.extend({},Y.data))}}function K(a,u){return c.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function M(a){var u=Ue.split("|"),v=a.createDocumentFragment();if(v.createElement)for(;u.length;)v.createElement(u.pop());return v}function J(a,u,v){if(u=u||0,c.isFunction(u))return c.grep(a,function(I,z){var Y=!!u.call(I,z,I);return Y===v});if(u.nodeType)return c.grep(a,function(I,z){return I===u===v});if(typeof u=="string"){var E=c.grep(a,function(I){return I.nodeType===1});if(vn.test(u))return c.filter(u,E,!v);u=c.filter(u,E)}return c.grep(a,function(I,z){return c.inArray(I,u)>=0===v})}function U(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function F(){return!0}function H(){return!1}function W(a,u,v){var E=u+"defer",I=u+"queue",z=u+"mark",Y=c._data(a,E);Y&&(v==="queue"||!c._data(a,I))&&(v==="mark"||!c._data(a,z))&&setTimeout(function(){!c._data(a,I)&&!c._data(a,z)&&(c.removeData(a,E,!0),Y.fire())},0)}function re(a){for(var u in a)if(!(u==="data"&&c.isEmptyObject(a[u]))&&u!=="toJSON")return!1;return!0}function y(a,u,v){if(v===r&&a.nodeType===1){var E="data-"+u.replace(je,"-$1").toLowerCase();if(v=a.getAttribute(E),typeof v=="string"){try{v=v==="true"?!0:v==="false"?!1:v==="null"?null:c.isNumeric(v)?+v:Re.test(v)?c.parseJSON(v):v}catch(I){}c.data(a,u,v)}else v=r}return v}function ke(a){var u=we[a]={},v,E;for(a=a.split(/\s+/),v=0,E=a.length;v<E;v++)u[a[v]]=!0;return u}var ce=e.document,Ge=e.navigator,lt=e.location,c=(function(){function a(){if(!u.isReady){try{ce.documentElement.doScroll("left")}catch(ie){setTimeout(a,1);return}u.ready()}}var u=function(ie,Ie){return new u.fn.init(ie,Ie,I)},v=e.jQuery,E=e.$,I,z=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,Y=/\S/,Q=/^\s+/,de=/\s+$/,ae=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,_e=/^[\],:{}\s]*$/,fe=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,ve=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Ce=/(?:^|:|,)(?:\s*\[)+/g,ot=/(webkit)[ \/]([\w.]+)/,et=/(opera)(?:.*version)?[ \/]([\w.]+)/,at=/(msie) ([\w.]+)/,dt=/(mozilla)(?:.*? rv:([\w.]+))?/,$t=/-([a-z]|[0-9])/ig,qt=/^-ms-/,wt=function(ie,Ie){return(Ie+"").toUpperCase()},q=Ge.userAgent,Z,ye,xe,Ne=Object.prototype.toString,Ae=Object.prototype.hasOwnProperty,ze=Array.prototype.push,Je=Array.prototype.slice,Ke=String.prototype.trim,gt=Array.prototype.indexOf,jt={};return u.fn=u.prototype={constructor:u,init:function(ie,Ie,Ze){var Be,it,Pt,Bt;if(!ie)return this;if(ie.nodeType)return this.context=this[0]=ie,this.length=1,this;if(ie==="body"&&!Ie&&ce.body)return this.context=ce,this[0]=ce.body,this.selector=ie,this.length=1,this;if(typeof ie=="string"){if(ie.charAt(0)!=="<"||ie.charAt(ie.length-1)!==">"||ie.length<3?Be=z.exec(ie):Be=[null,ie,null],Be&&(Be[1]||!Ie)){if(Be[1])return Ie=Ie instanceof u?Ie[0]:Ie,Bt=Ie?Ie.ownerDocument||Ie:ce,Pt=ae.exec(ie),Pt?u.isPlainObject(Ie)?(ie=[ce.createElement(Pt[1])],u.fn.attr.call(ie,Ie,!0)):ie=[Bt.createElement(Pt[1])]:(Pt=u.buildFragment([Be[1]],[Bt]),ie=(Pt.cacheable?u.clone(Pt.fragment):Pt.fragment).childNodes),u.merge(this,ie);if(it=ce.getElementById(Be[2]),it&&it.parentNode){if(it.id!==Be[2])return Ze.find(ie);this.length=1,this[0]=it}return this.context=ce,this.selector=ie,this}return!Ie||Ie.jquery?(Ie||Ze).find(ie):this.constructor(Ie).find(ie)}return u.isFunction(ie)?Ze.ready(ie):(ie.selector!==r&&(this.selector=ie.selector,this.context=ie.context),u.makeArray(ie,this))},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return Je.call(this,0)},get:function(ie){return ie==null?this.toArray():ie<0?this[this.length+ie]:this[ie]},pushStack:function(ie,Ie,Ze){var Be=this.constructor();return u.isArray(ie)?ze.apply(Be,ie):u.merge(Be,ie),Be.prevObject=this,Be.context=this.context,Ie==="find"?Be.selector=this.selector+(this.selector?" ":"")+Ze:Ie&&(Be.selector=this.selector+"."+Ie+"("+Ze+")"),Be},each:function(ie,Ie){return u.each(this,ie,Ie)},ready:function(ie){return u.bindReady(),ye.add(ie),this},eq:function(ie){return ie=+ie,ie===-1?this.slice(ie):this.slice(ie,ie+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(Je.apply(this,arguments),"slice",Je.call(arguments).join(","))},map:function(ie){return this.pushStack(u.map(this,function(Ie,Ze){return ie.call(Ie,Ze,Ie)}))},end:function(){return this.prevObject||this.constructor(null)},push:ze,sort:[].sort,splice:[].splice},u.fn.init.prototype=u.fn,u.extend=u.fn.extend=function(){var ie,Ie,Ze,Be,it,Pt,Bt=arguments[0]||{},rn=1,Sn=arguments.length,pn=!1;for(typeof Bt=="boolean"&&(pn=Bt,Bt=arguments[1]||{},rn=2),typeof Bt!="object"&&!u.isFunction(Bt)&&(Bt={}),Sn===rn&&(Bt=this,--rn);rn<Sn;rn++)if((ie=arguments[rn])!=null)for(Ie in ie)Ze=Bt[Ie],Be=ie[Ie],Bt!==Be&&(pn&&Be&&(u.isPlainObject(Be)||(it=u.isArray(Be)))?(it?(it=!1,Pt=Ze&&u.isArray(Ze)?Ze:[]):Pt=Ze&&u.isPlainObject(Ze)?Ze:{},Bt[Ie]=u.extend(pn,Pt,Be)):Be!==r&&(Bt[Ie]=Be));return Bt},u.extend({noConflict:function(ie){return e.$===u&&(e.$=E),ie&&e.jQuery===u&&(e.jQuery=v),u},isReady:!1,readyWait:1,holdReady:function(ie){ie?u.readyWait++:u.ready(!0)},ready:function(ie){if(ie===!0&&!--u.readyWait||ie!==!0&&!u.isReady){if(!ce.body)return setTimeout(u.ready,1);if(u.isReady=!0,ie!==!0&&--u.readyWait>0)return;ye.fireWith(ce,[u]),u.fn.trigger&&u(ce).trigger("ready").off("ready")}},bindReady:function(){if(!ye){if(ye=u.Callbacks("once memory"),ce.readyState==="complete")return setTimeout(u.ready,1);if(ce.addEventListener)ce.addEventListener("DOMContentLoaded",xe,!1),e.addEventListener("load",u.ready,!1);else if(ce.attachEvent){ce.attachEvent("onreadystatechange",xe),e.attachEvent("onload",u.ready);var ie=!1;try{ie=e.frameElement==null}catch(Ie){}ce.documentElement.doScroll&&ie&&a()}}},isFunction:function(ie){return u.type(ie)==="function"},isArray:Array.isArray||function(ie){return u.type(ie)==="array"},isWindow:function(ie){return ie!=null&&ie==ie.window},isNumeric:function(ie){return!isNaN(parseFloat(ie))&&isFinite(ie)},type:function(ie){return ie==null?String(ie):jt[Ne.call(ie)]||"object"},isPlainObject:function(ie){if(!ie||u.type(ie)!=="object"||ie.nodeType||u.isWindow(ie))return!1;try{if(ie.constructor&&!Ae.call(ie,"constructor")&&!Ae.call(ie.constructor.prototype,"isPrototypeOf"))return!1}catch(Ze){return!1}var Ie;for(Ie in ie);return Ie===r||Ae.call(ie,Ie)},isEmptyObject:function(ie){for(var Ie in ie)return!1;return!0},error:function(ie){throw new Error(ie)},parseJSON:function(ie){if(typeof ie!="string"||!ie)return null;if(ie=u.trim(ie),e.JSON&&e.JSON.parse)return e.JSON.parse(ie);if(_e.test(ie.replace(fe,"@").replace(ve,"]").replace(Ce,"")))return new Function("return "+ie)();u.error("Invalid JSON: "+ie)},parseXML:function(ie){if(typeof ie!="string"||!ie)return null;var Ie,Ze;try{e.DOMParser?(Ze=new DOMParser,Ie=Ze.parseFromString(ie,"text/xml")):(Ie=new ActiveXObject("Microsoft.XMLDOM"),Ie.async="false",Ie.loadXML(ie))}catch(Be){Ie=r}return(!Ie||!Ie.documentElement||Ie.getElementsByTagName("parsererror").length)&&u.error("Invalid XML: "+ie),Ie},noop:function(){},globalEval:function(ie){ie&&Y.test(ie)&&(e.execScript||function(Ie){e.eval.call(e,Ie)})(ie)},camelCase:function(ie){return ie.replace(qt,"ms-").replace($t,wt)},nodeName:function(ie,Ie){return ie.nodeName&&ie.nodeName.toUpperCase()===Ie.toUpperCase()},each:function(ie,Ie,Ze){var Be,it=0,Pt=ie.length,Bt=Pt===r||u.isFunction(ie);if(Ze)if(Bt){for(Be in ie)if(Ie.apply(ie[Be],Ze)===!1)break}else for(;it<Pt&&Ie.apply(ie[it++],Ze)!==!1;);else if(Bt){for(Be in ie)if(Ie.call(ie[Be],Be,ie[Be])===!1)break}else for(;it<Pt&&Ie.call(ie[it],it,ie[it++])!==!1;);return ie},trim:Ke?function(ie){return ie==null?"":Ke.call(ie)}:function(ie){return ie==null?"":(ie+"").replace(Q,"").replace(de,"")},makeArray:function(ie,Ie){var Ze=Ie||[];if(ie!=null){var Be=u.type(ie);ie.length==null||Be==="string"||Be==="function"||Be==="regexp"||u.isWindow(ie)?ze.call(Ze,ie):u.merge(Ze,ie)}return Ze},inArray:function(ie,Ie,Ze){var Be;if(Ie){if(gt)return gt.call(Ie,ie,Ze);for(Be=Ie.length,Ze=Ze?Ze<0?Math.max(0,Be+Ze):Ze:0;Ze<Be;Ze++)if(Ze in Ie&&Ie[Ze]===ie)return Ze}return-1},merge:function(ie,Ie){var Ze=ie.length,Be=0;if(typeof Ie.length=="number")for(var it=Ie.length;Be<it;Be++)ie[Ze++]=Ie[Be];else for(;Ie[Be]!==r;)ie[Ze++]=Ie[Be++];return ie.length=Ze,ie},grep:function(ie,Ie,Ze){var Be=[],it;Ze=!!Ze;for(var Pt=0,Bt=ie.length;Pt<Bt;Pt++)it=!!Ie(ie[Pt],Pt),Ze!==it&&Be.push(ie[Pt]);return Be},map:function(ie,Ie,Ze){var Be,it,Pt=[],Bt=0,rn=ie.length,Sn=ie instanceof u||rn!==r&&typeof rn=="number"&&(rn>0&&ie[0]&&ie[rn-1]||rn===0||u.isArray(ie));if(Sn)for(;Bt<rn;Bt++)Be=Ie(ie[Bt],Bt,Ze),Be!=null&&(Pt[Pt.length]=Be);else for(it in ie)Be=Ie(ie[it],it,Ze),Be!=null&&(Pt[Pt.length]=Be);return Pt.concat.apply([],Pt)},guid:1,proxy:function(ie,Ie){if(typeof Ie=="string"){var Ze=ie[Ie];Ie=ie,ie=Ze}if(!u.isFunction(ie))return r;var Be=Je.call(arguments,2),it=function(){return ie.apply(Ie,Be.concat(Je.call(arguments)))};return it.guid=ie.guid=ie.guid||it.guid||u.guid++,it},access:function(ie,Ie,Ze,Be,it,Pt,Bt){var rn,Sn=Ze==null,pn=0,_i=ie.length;if(Ze&&typeof Ze=="object"){for(pn in Ze)u.access(ie,Ie,pn,Ze[pn],1,Pt,Be);it=1}else if(Be!==r){if(rn=Bt===r&&u.isFunction(Be),Sn&&(rn?(rn=Ie,Ie=function(Vi,or,Ei){return rn.call(u(Vi),Ei)}):(Ie.call(ie,Be),Ie=null)),Ie)for(;pn<_i;pn++)Ie(ie[pn],Ze,rn?Be.call(ie[pn],pn,Ie(ie[pn],Ze)):Be,Bt);it=1}return it?ie:Sn?Ie.call(ie):_i?Ie(ie[0],Ze):Pt},now:function(){return new Date().getTime()},uaMatch:function(ie){ie=ie.toLowerCase();var Ie=ot.exec(ie)||et.exec(ie)||at.exec(ie)||ie.indexOf("compatible")<0&&dt.exec(ie)||[];return{browser:Ie[1]||"",version:Ie[2]||"0"}},sub:function(){function ie(Ze,Be){return new ie.fn.init(Ze,Be)}u.extend(!0,ie,this),ie.superclass=this,ie.fn=ie.prototype=this(),ie.fn.constructor=ie,ie.sub=this.sub,ie.fn.init=function(Ze,Be){return Be&&Be instanceof u&&!(Be instanceof ie)&&(Be=ie(Be)),u.fn.init.call(this,Ze,Be,Ie)},ie.fn.init.prototype=ie.fn;var Ie=ie(ce);return ie},browser:{}}),u.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(ie,Ie){jt["[object "+Ie+"]"]=Ie.toLowerCase()}),Z=u.uaMatch(q),Z.browser&&(u.browser[Z.browser]=!0,u.browser.version=Z.version),u.browser.webkit&&(u.browser.safari=!0),Y.test("\xA0")&&(Q=/^[\s\xA0]+/,de=/[\s\xA0]+$/),I=u(ce),ce.addEventListener?xe=function(){ce.removeEventListener("DOMContentLoaded",xe,!1),u.ready()}:ce.attachEvent&&(xe=function(){ce.readyState==="complete"&&(ce.detachEvent("onreadystatechange",xe),u.ready())}),u})(),we={};c.Callbacks=function(a){a=a?we[a]||ke(a):{};var u=[],v=[],E,I,z,Y,Q,de,ae=function(ve){var Ce,ot,et,at,dt;for(Ce=0,ot=ve.length;Ce<ot;Ce++)et=ve[Ce],at=c.type(et),at==="array"?ae(et):at==="function"&&(!a.unique||!fe.has(et))&&u.push(et)},_e=function(ve,Ce){for(Ce=Ce||[],E=!a.memory||[ve,Ce],I=!0,z=!0,de=Y||0,Y=0,Q=u.length;u&&de<Q;de++)if(u[de].apply(ve,Ce)===!1&&a.stopOnFalse){E=!0;break}z=!1,u&&(a.once?E===!0?fe.disable():u=[]:v&&v.length&&(E=v.shift(),fe.fireWith(E[0],E[1])))},fe={add:function(){if(u){var ve=u.length;ae(arguments),z?Q=u.length:E&&E!==!0&&(Y=ve,_e(E[0],E[1]))}return this},remove:function(){if(u)for(var ve=arguments,Ce=0,ot=ve.length;Ce<ot;Ce++)for(var et=0;et<u.length&&!(ve[Ce]===u[et]&&(z&&et<=Q&&(Q--,et<=de&&de--),u.splice(et--,1),a.unique));et++);return this},has:function(ve){if(u){for(var Ce=0,ot=u.length;Ce<ot;Ce++)if(ve===u[Ce])return!0}return!1},empty:function(){return u=[],this},disable:function(){return u=v=E=r,this},disabled:function(){return!u},lock:function(){return v=r,(!E||E===!0)&&fe.disable(),this},locked:function(){return!v},fireWith:function(ve,Ce){return v&&(z?a.once||v.push([ve,Ce]):(!a.once||!E)&&_e(ve,Ce)),this},fire:function(){return fe.fireWith(this,arguments),this},fired:function(){return!!I}};return fe};var De=[].slice;c.extend({Deferred:function(a){var u=c.Callbacks("once memory"),v=c.Callbacks("once memory"),E=c.Callbacks("memory"),I="pending",z={resolve:u,reject:v,notify:E},Y={done:u.add,fail:v.add,progress:E.add,state:function(){return I},isResolved:u.fired,isRejected:v.fired,then:function(ae,_e,fe){return Q.done(ae).fail(_e).progress(fe),this},always:function(){return Q.done.apply(Q,arguments).fail.apply(Q,arguments),this},pipe:function(ae,_e,fe){return c.Deferred(function(ve){c.each({done:[ae,"resolve"],fail:[_e,"reject"],progress:[fe,"notify"]},function(Ce,ot){var et=ot[0],at=ot[1],dt;c.isFunction(et)?Q[Ce](function(){dt=et.apply(this,arguments),dt&&c.isFunction(dt.promise)?dt.promise().then(ve.resolve,ve.reject,ve.notify):ve[at+"With"](this===Q?ve:this,[dt])}):Q[Ce](ve[at])})}).promise()},promise:function(ae){if(ae==null)ae=Y;else for(var _e in Y)ae[_e]=Y[_e];return ae}},Q=Y.promise({}),de;for(de in z)Q[de]=z[de].fire,Q[de+"With"]=z[de].fireWith;return Q.done(function(){I="resolved"},v.disable,E.lock).fail(function(){I="rejected"},u.disable,E.lock),a&&a.call(Q,Q),Q},when:function(a){function u(fe){return function(ve){Y[fe]=arguments.length>1?De.call(arguments,0):ve,ae.notifyWith(_e,Y)}}function v(fe){return function(ve){E[fe]=arguments.length>1?De.call(arguments,0):ve,--Q||ae.resolveWith(ae,E)}}var E=De.call(arguments,0),I=0,z=E.length,Y=Array(z),Q=z,de=z,ae=z<=1&&a&&c.isFunction(a.promise)?a:c.Deferred(),_e=ae.promise();if(z>1){for(;I<z;I++)E[I]&&E[I].promise&&c.isFunction(E[I].promise)?E[I].promise().then(v(I),ae.reject,u(I)):--Q;Q||ae.resolveWith(ae,E)}else ae!==a&&ae.resolveWith(ae,z?[a]:[]);return _e}}),c.support=(function(){var a,u,v,E,I,z,Y,Q,de,ae,_e,fe,ve=ce.createElement("div"),Ce=ce.documentElement;if(ve.setAttribute("className","t"),ve.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",u=ve.getElementsByTagName("*"),v=ve.getElementsByTagName("a")[0],!u||!u.length||!v)return{};E=ce.createElement("select"),I=E.appendChild(ce.createElement("option")),z=ve.getElementsByTagName("input")[0],a={leadingWhitespace:ve.firstChild.nodeType===3,tbody:!ve.getElementsByTagName("tbody").length,htmlSerialize:!!ve.getElementsByTagName("link").length,style:/top/.test(v.getAttribute("style")),hrefNormalized:v.getAttribute("href")==="/a",opacity:/^0.55/.test(v.style.opacity),cssFloat:!!v.style.cssFloat,checkOn:z.value==="on",optSelected:I.selected,getSetAttribute:ve.className!=="t",enctype:!!ce.createElement("form").enctype,html5Clone:ce.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0},c.boxModel=a.boxModel=ce.compatMode==="CSS1Compat",z.checked=!0,a.noCloneChecked=z.cloneNode(!0).checked,E.disabled=!0,a.optDisabled=!I.disabled;try{delete ve.test}catch(ot){a.deleteExpando=!1}if(!ve.addEventListener&&ve.attachEvent&&ve.fireEvent&&(ve.attachEvent("onclick",function(){a.noCloneEvent=!1}),ve.cloneNode(!0).fireEvent("onclick")),z=ce.createElement("input"),z.value="t",z.setAttribute("type","radio"),a.radioValue=z.value==="t",z.setAttribute("checked","checked"),z.setAttribute("name","t"),ve.appendChild(z),Y=ce.createDocumentFragment(),Y.appendChild(ve.lastChild),a.checkClone=Y.cloneNode(!0).cloneNode(!0).lastChild.checked,a.appendChecked=z.checked,Y.removeChild(z),Y.appendChild(ve),ve.attachEvent)for(_e in{submit:1,change:1,focusin:1})ae="on"+_e,fe=ae in ve,fe||(ve.setAttribute(ae,"return;"),fe=typeof ve[ae]=="function"),a[_e+"Bubbles"]=fe;return Y.removeChild(ve),Y=E=I=ve=z=null,c(function(){var ot,et,at,dt,$t,qt,wt,q,Z,ye,xe,Ne,Ae,ze=ce.getElementsByTagName("body")[0];!ze||(q=1,Ae="padding:0;margin:0;border:",xe="position:absolute;top:0;left:0;width:1px;height:1px;",Ne=Ae+"0;visibility:hidden;",Z="style='"+xe+Ae+"5px solid #000;",ye="<div "+Z+"display:block;'><div style='"+Ae+"0;display:block;overflow:hidden;'></div></div><table "+Z+"' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>",ot=ce.createElement("div"),ot.style.cssText=Ne+"width:0;height:0;position:static;top:0;margin-top:"+q+"px",ze.insertBefore(ot,ze.firstChild),ve=ce.createElement("div"),ot.appendChild(ve),ve.innerHTML="<table><tr><td style='"+Ae+"0;display:none'></td><td>t</td></tr></table>",Q=ve.getElementsByTagName("td"),fe=Q[0].offsetHeight===0,Q[0].style.display="",Q[1].style.display="none",a.reliableHiddenOffsets=fe&&Q[0].offsetHeight===0,e.getComputedStyle&&(ve.innerHTML="",wt=ce.createElement("div"),wt.style.width="0",wt.style.marginRight="0",ve.style.width="2px",ve.appendChild(wt),a.reliableMarginRight=(parseInt((e.getComputedStyle(wt,null)||{marginRight:0}).marginRight,10)||0)===0),typeof ve.style.zoom!="undefined"&&(ve.innerHTML="",ve.style.width=ve.style.padding="1px",ve.style.border=0,ve.style.overflow="hidden",ve.style.display="inline",ve.style.zoom=1,a.inlineBlockNeedsLayout=ve.offsetWidth===3,ve.style.display="block",ve.style.overflow="visible",ve.innerHTML="<div style='width:5px;'></div>",a.shrinkWrapBlocks=ve.offsetWidth!==3),ve.style.cssText=xe+Ne,ve.innerHTML=ye,et=ve.firstChild,at=et.firstChild,$t=et.nextSibling.firstChild.firstChild,qt={doesNotAddBorder:at.offsetTop!==5,doesAddBorderForTableAndCells:$t.offsetTop===5},at.style.position="fixed",at.style.top="20px",qt.fixedPosition=at.offsetTop===20||at.offsetTop===15,at.style.position=at.style.top="",et.style.overflow="hidden",et.style.position="relative",qt.subtractsBorderForOverflowNotVisible=at.offsetTop===-5,qt.doesNotIncludeMarginInBodyOffset=ze.offsetTop!==q,e.getComputedStyle&&(ve.style.marginTop="1%",a.pixelMargin=(e.getComputedStyle(ve,null)||{marginTop:0}).marginTop!=="1%"),typeof ot.style.zoom!="undefined"&&(ot.style.zoom=1),ze.removeChild(ot),wt=ve=ot=null,c.extend(a,qt))}),a})();var Re=/^(?:\{.*\}|\[.*\])$/,je=/([A-Z])/g;c.extend({cache:{},uuid:0,expando:"jQuery"+(c.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?c.cache[a[c.expando]]:a[c.expando],!!a&&!re(a)},data:function(a,u,v,E){if(c.acceptData(a)){var I,z,Y,Q=c.expando,de=typeof u=="string",ae=a.nodeType,_e=ae?c.cache:a,fe=ae?a[Q]:a[Q]&&Q,ve=u==="events";return(!fe||!_e[fe]||!ve&&!E&&!_e[fe].data)&&de&&v===r?void 0:(fe||(ae?a[Q]=fe=++c.uuid:fe=Q),_e[fe]||(_e[fe]={},ae||(_e[fe].toJSON=c.noop)),(typeof u=="object"||typeof u=="function")&&(E?_e[fe]=c.extend(_e[fe],u):_e[fe].data=c.extend(_e[fe].data,u)),I=z=_e[fe],E||(z.data||(z.data={}),z=z.data),v!==r&&(z[c.camelCase(u)]=v),ve&&!z[u]?I.events:(de?(Y=z[u],Y==null&&(Y=z[c.camelCase(u)])):Y=z,Y))}},removeData:function(a,u,v){if(c.acceptData(a)){var E,I,z,Y=c.expando,Q=a.nodeType,de=Q?c.cache:a,ae=Q?a[Y]:Y;if(!de[ae])return;if(u&&(E=v?de[ae]:de[ae].data,E)){for(c.isArray(u)||(u in E?u=[u]:(u=c.camelCase(u),u in E?u=[u]:u=u.split(" "))),I=0,z=u.length;I<z;I++)delete E[u[I]];if(!(v?re:c.isEmptyObject)(E))return}if(!v&&(delete de[ae].data,!re(de[ae])))return;c.support.deleteExpando||!de.setInterval?delete de[ae]:de[ae]=null,Q&&(c.support.deleteExpando?delete a[Y]:a.removeAttribute?a.removeAttribute(Y):a[Y]=null)}},_data:function(a,u,v){return c.data(a,u,v,!0)},acceptData:function(a){if(a.nodeName){var u=c.noData[a.nodeName.toLowerCase()];if(u)return u!==!0&&a.getAttribute("classid")===u}return!0}}),c.fn.extend({data:function(a,u){var v,E,I,z,Y,Q=this[0],de=0,ae=null;if(a===r){if(this.length&&(ae=c.data(Q),Q.nodeType===1&&!c._data(Q,"parsedAttrs"))){for(I=Q.attributes,Y=I.length;de<Y;de++)z=I[de].name,z.indexOf("data-")===0&&(z=c.camelCase(z.substring(5)),y(Q,z,ae[z]));c._data(Q,"parsedAttrs",!0)}return ae}return typeof a=="object"?this.each(function(){c.data(this,a)}):(v=a.split(".",2),v[1]=v[1]?"."+v[1]:"",E=v[1]+"!",c.access(this,function(_e){if(_e===r)return ae=this.triggerHandler("getData"+E,[v[0]]),ae===r&&Q&&(ae=c.data(Q,a),ae=y(Q,a,ae)),ae===r&&v[1]?this.data(v[0]):ae;v[1]=_e,this.each(function(){var fe=c(this);fe.triggerHandler("setData"+E,v),c.data(this,a,_e),fe.triggerHandler("changeData"+E,v)})},null,u,arguments.length>1,null,!1))},removeData:function(a){return this.each(function(){c.removeData(this,a)})}}),c.extend({_mark:function(a,u){a&&(u=(u||"fx")+"mark",c._data(a,u,(c._data(a,u)||0)+1))},_unmark:function(a,u,v){if(a!==!0&&(v=u,u=a,a=!1),u){v=v||"fx";var E=v+"mark",I=a?0:(c._data(u,E)||1)-1;I?c._data(u,E,I):(c.removeData(u,E,!0),W(u,v,"mark"))}},queue:function(a,u,v){var E;if(a)return u=(u||"fx")+"queue",E=c._data(a,u),v&&(!E||c.isArray(v)?E=c._data(a,u,c.makeArray(v)):E.push(v)),E||[]},dequeue:function(a,u){u=u||"fx";var v=c.queue(a,u),E=v.shift(),I={};E==="inprogress"&&(E=v.shift()),E&&(u==="fx"&&v.unshift("inprogress"),c._data(a,u+".run",I),E.call(a,function(){c.dequeue(a,u)},I)),v.length||(c.removeData(a,u+"queue "+u+".run",!0),W(a,u,"queue"))}}),c.fn.extend({queue:function(a,u){var v=2;return typeof a!="string"&&(u=a,a="fx",v--),arguments.length<v?c.queue(this[0],a):u===r?this:this.each(function(){var E=c.queue(this,a,u);a==="fx"&&E[0]!=="inprogress"&&c.dequeue(this,a)})},dequeue:function(a){return this.each(function(){c.dequeue(this,a)})},delay:function(a,u){return a=c.fx&&c.fx.speeds[a]||a,u=u||"fx",this.queue(u,function(v,E){var I=setTimeout(v,a);E.stop=function(){clearTimeout(I)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,u){function v(){--Y||E.resolveWith(I,[I])}typeof a!="string"&&(u=a,a=r),a=a||"fx";for(var E=c.Deferred(),I=this,z=I.length,Y=1,Q=a+"defer",de=a+"queue",ae=a+"mark",_e;z--;)(_e=c.data(I[z],Q,r,!0)||(c.data(I[z],de,r,!0)||c.data(I[z],ae,r,!0))&&c.data(I[z],Q,c.Callbacks("once memory"),!0))&&(Y++,_e.add(v));return v(),E.promise(u)}});var Pe=/[\n\t\r]/g,qe=/\s+/,ft=/\r/g,Ot=/^(?:button|input)$/i,Kt=/^(?:button|input|object|select|textarea)$/i,Zt=/^a(?:rea)?$/i,zt=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,me=c.support.getSetAttribute,oe,Fe,$e;c.fn.extend({attr:function(a,u){return c.access(this,c.attr,a,u,arguments.length>1)},removeAttr:function(a){return this.each(function(){c.removeAttr(this,a)})},prop:function(a,u){return c.access(this,c.prop,a,u,arguments.length>1)},removeProp:function(a){return a=c.propFix[a]||a,this.each(function(){try{this[a]=r,delete this[a]}catch(u){}})},addClass:function(a){var u,v,E,I,z,Y,Q;if(c.isFunction(a))return this.each(function(de){c(this).addClass(a.call(this,de,this.className))});if(a&&typeof a=="string"){for(u=a.split(qe),v=0,E=this.length;v<E;v++)if(I=this[v],I.nodeType===1)if(!I.className&&u.length===1)I.className=a;else{for(z=" "+I.className+" ",Y=0,Q=u.length;Y<Q;Y++)~z.indexOf(" "+u[Y]+" ")||(z+=u[Y]+" ");I.className=c.trim(z)}}return this},removeClass:function(a){var u,v,E,I,z,Y,Q;if(c.isFunction(a))return this.each(function(de){c(this).removeClass(a.call(this,de,this.className))});if(a&&typeof a=="string"||a===r){for(u=(a||"").split(qe),v=0,E=this.length;v<E;v++)if(I=this[v],I.nodeType===1&&I.className)if(a){for(z=(" "+I.className+" ").replace(Pe," "),Y=0,Q=u.length;Y<Q;Y++)z=z.replace(" "+u[Y]+" "," ");I.className=c.trim(z)}else I.className=""}return this},toggleClass:function(a,u){var v=typeof a,E=typeof u=="boolean";return c.isFunction(a)?this.each(function(I){c(this).toggleClass(a.call(this,I,this.className,u),u)}):this.each(function(){if(v==="string")for(var I,z=0,Y=c(this),Q=u,de=a.split(qe);I=de[z++];)Q=E?Q:!Y.hasClass(I),Y[Q?"addClass":"removeClass"](I);else(v==="undefined"||v==="boolean")&&(this.className&&c._data(this,"__className__",this.className),this.className=this.className||a===!1?"":c._data(this,"__className__")||"")})},hasClass:function(a){for(var u=" "+a+" ",v=0,E=this.length;v<E;v++)if(this[v].nodeType===1&&(" "+this[v].className+" ").replace(Pe," ").indexOf(u)>-1)return!0;return!1},val:function(a){var u,v,E,I=this[0];{if(arguments.length)return E=c.isFunction(a),this.each(function(z){var Y=c(this),Q;this.nodeType===1&&(E?Q=a.call(this,z,Y.val()):Q=a,Q==null?Q="":typeof Q=="number"?Q+="":c.isArray(Q)&&(Q=c.map(Q,function(de){return de==null?"":de+""})),u=c.valHooks[this.type]||c.valHooks[this.nodeName.toLowerCase()],(!u||!("set"in u)||u.set(this,Q,"value")===r)&&(this.value=Q))});if(I)return u=c.valHooks[I.type]||c.valHooks[I.nodeName.toLowerCase()],u&&"get"in u&&(v=u.get(I,"value"))!==r?v:(v=I.value,typeof v=="string"?v.replace(ft,""):v==null?"":v)}}}),c.extend({valHooks:{option:{get:function(a){var u=a.attributes.value;return!u||u.specified?a.value:a.text}},select:{get:function(a){var u,v,E,I,z=a.selectedIndex,Y=[],Q=a.options,de=a.type==="select-one";if(z<0)return null;for(v=de?z:0,E=de?z+1:Q.length;v<E;v++)if(I=Q[v],I.selected&&(c.support.optDisabled?!I.disabled:I.getAttribute("disabled")===null)&&(!I.parentNode.disabled||!c.nodeName(I.parentNode,"optgroup"))){if(u=c(I).val(),de)return u;Y.push(u)}return de&&!Y.length&&Q.length?c(Q[z]).val():Y},set:function(a,u){var v=c.makeArray(u);return c(a).find("option").each(function(){this.selected=c.inArray(c(this).val(),v)>=0}),v.length||(a.selectedIndex=-1),v}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,u,v,E){var I,z,Y,Q=a.nodeType;if(a&&Q!==3&&Q!==8&&Q!==2){if(E&&u in c.attrFn)return c(a)[u](v);if(typeof a.getAttribute=="undefined")return c.prop(a,u,v);if(Y=Q!==1||!c.isXMLDoc(a),Y&&(u=u.toLowerCase(),z=c.attrHooks[u]||(zt.test(u)?Fe:oe)),v!==r){if(v===null){c.removeAttr(a,u);return}return z&&"set"in z&&Y&&(I=z.set(a,v,u))!==r?I:(a.setAttribute(u,""+v),v)}return z&&"get"in z&&Y&&(I=z.get(a,u))!==null?I:(I=a.getAttribute(u),I===null?r:I)}},removeAttr:function(a,u){var v,E,I,z,Y,Q=0;if(u&&a.nodeType===1)for(E=u.toLowerCase().split(qe),z=E.length;Q<z;Q++)I=E[Q],I&&(v=c.propFix[I]||I,Y=zt.test(I),Y||c.attr(a,I,""),a.removeAttribute(me?I:v),Y&&v in a&&(a[v]=!1))},attrHooks:{type:{set:function(a,u){if(Ot.test(a.nodeName)&&a.parentNode)c.error("type property can't be changed");else if(!c.support.radioValue&&u==="radio"&&c.nodeName(a,"input")){var v=a.value;return a.setAttribute("type",u),v&&(a.value=v),u}}},value:{get:function(a,u){return oe&&c.nodeName(a,"button")?oe.get(a,u):u in a?a.value:null},set:function(a,u,v){if(oe&&c.nodeName(a,"button"))return oe.set(a,u,v);a.value=u}}},propFix:{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,u,v){var E,I,z,Y=a.nodeType;if(a&&Y!==3&&Y!==8&&Y!==2)return z=Y!==1||!c.isXMLDoc(a),z&&(u=c.propFix[u]||u,I=c.propHooks[u]),v!==r?I&&"set"in I&&(E=I.set(a,v,u))!==r?E:a[u]=v:I&&"get"in I&&(E=I.get(a,u))!==null?E:a[u]},propHooks:{tabIndex:{get:function(a){var u=a.getAttributeNode("tabindex");return u&&u.specified?parseInt(u.value,10):Kt.test(a.nodeName)||Zt.test(a.nodeName)&&a.href?0:r}}}}),c.attrHooks.tabindex=c.propHooks.tabIndex,Fe={get:function(a,u){var v,E=c.prop(a,u);return E===!0||typeof E!="boolean"&&(v=a.getAttributeNode(u))&&v.nodeValue!==!1?u.toLowerCase():r},set:function(a,u,v){var E;return u===!1?c.removeAttr(a,v):(E=c.propFix[v]||v,E in a&&(a[E]=!0),a.setAttribute(v,v.toLowerCase())),v}},me||($e={name:!0,id:!0,coords:!0},oe=c.valHooks.button={get:function(a,u){var v;return v=a.getAttributeNode(u),v&&($e[u]?v.nodeValue!=="":v.specified)?v.nodeValue:r},set:function(a,u,v){var E=a.getAttributeNode(v);return E||(E=ce.createAttribute(v),a.setAttributeNode(E)),E.nodeValue=u+""}},c.attrHooks.tabindex.set=oe.set,c.each(["width","height"],function(a,u){c.attrHooks[u]=c.extend(c.attrHooks[u],{set:function(v,E){if(E==="")return v.setAttribute(u,"auto"),E}})}),c.attrHooks.contenteditable={get:oe.get,set:function(a,u,v){u===""&&(u="false"),oe.set(a,u,v)}}),c.support.hrefNormalized||c.each(["href","src","width","height"],function(a,u){c.attrHooks[u]=c.extend(c.attrHooks[u],{get:function(v){var E=v.getAttribute(u,2);return E===null?r:E}})}),c.support.style||(c.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||r},set:function(a,u){return a.style.cssText=""+u}}),c.support.optSelected||(c.propHooks.selected=c.extend(c.propHooks.selected,{get:function(a){var u=a.parentNode;return u&&(u.selectedIndex,u.parentNode&&u.parentNode.selectedIndex),null}})),c.support.enctype||(c.propFix.enctype="encoding"),c.support.checkOn||c.each(["radio","checkbox"],function(){c.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),c.each(["radio","checkbox"],function(){c.valHooks[this]=c.extend(c.valHooks[this],{set:function(a,u){if(c.isArray(u))return a.checked=c.inArray(c(a).val(),u)>=0}})});var ut=/^(?:textarea|input|select)$/i,mt=/^([^\.]*)?(?:\.(.+))?$/,kt=/(?:^|\s)hover(\.\S+)?\b/,Ft=/^key/,Mt=/^(?:mouse|contextmenu)|click/,Lt=/^(?:focusinfocus|focusoutblur)$/,Nt=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,rt=function(a){var u=Nt.exec(a);return u&&(u[1]=(u[1]||"").toLowerCase(),u[3]=u[3]&&new RegExp("(?:^|\\s)"+u[3]+"(?:\\s|$)")),u},vt=function(a,u){var v=a.attributes||{};return(!u[1]||a.nodeName.toLowerCase()===u[1])&&(!u[2]||(v.id||{}).value===u[2])&&(!u[3]||u[3].test((v.class||{}).value))},tn=function(a){return c.event.special.hover?a:a.replace(kt,"mouseenter$1 mouseleave$1")};c.event={add:function(a,u,v,E,I){var z,Y,Q,de,ae,_e,fe,ve,Ce,ot,et,at;if(!(a.nodeType===3||a.nodeType===8||!u||!v||!(z=c._data(a)))){for(v.handler&&(Ce=v,v=Ce.handler,I=Ce.selector),v.guid||(v.guid=c.guid++),Q=z.events,Q||(z.events=Q={}),Y=z.handle,Y||(z.handle=Y=function(dt){return typeof c!="undefined"&&(!dt||c.event.triggered!==dt.type)?c.event.dispatch.apply(Y.elem,arguments):r},Y.elem=a),u=c.trim(tn(u)).split(" "),de=0;de<u.length;de++)ae=mt.exec(u[de])||[],_e=ae[1],fe=(ae[2]||"").split(".").sort(),at=c.event.special[_e]||{},_e=(I?at.delegateType:at.bindType)||_e,at=c.event.special[_e]||{},ve=c.extend({type:_e,origType:ae[1],data:E,handler:v,guid:v.guid,selector:I,quick:I&&rt(I),namespace:fe.join(".")},Ce),et=Q[_e],et||(et=Q[_e]=[],et.delegateCount=0,(!at.setup||at.setup.call(a,E,fe,Y)===!1)&&(a.addEventListener?a.addEventListener(_e,Y,!1):a.attachEvent&&a.attachEvent("on"+_e,Y))),at.add&&(at.add.call(a,ve),ve.handler.guid||(ve.handler.guid=v.guid)),I?et.splice(et.delegateCount++,0,ve):et.push(ve),c.event.global[_e]=!0;a=null}},global:{},remove:function(a,u,v,E,I){var z=c.hasData(a)&&c._data(a),Y,Q,de,ae,_e,fe,ve,Ce,ot,et,at,dt;if(z&&(Ce=z.events)){for(u=c.trim(tn(u||"")).split(" "),Y=0;Y<u.length;Y++){if(Q=mt.exec(u[Y])||[],de=ae=Q[1],_e=Q[2],!de){for(de in Ce)c.event.remove(a,de+u[Y],v,E,!0);continue}for(ot=c.event.special[de]||{},de=(E?ot.delegateType:ot.bindType)||de,at=Ce[de]||[],fe=at.length,_e=_e?new RegExp("(^|\\.)"+_e.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null,ve=0;ve<at.length;ve++)dt=at[ve],(I||ae===dt.origType)&&(!v||v.guid===dt.guid)&&(!_e||_e.test(dt.namespace))&&(!E||E===dt.selector||E==="**"&&dt.selector)&&(at.splice(ve--,1),dt.selector&&at.delegateCount--,ot.remove&&ot.remove.call(a,dt));at.length===0&&fe!==at.length&&((!ot.teardown||ot.teardown.call(a,_e)===!1)&&c.removeEvent(a,de,z.handle),delete Ce[de])}c.isEmptyObject(Ce)&&(et=z.handle,et&&(et.elem=null),c.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(a,u,v,E){if(!v||v.nodeType!==3&&v.nodeType!==8){var I=a.type||a,z=[],Y,Q,de,ae,_e,fe,ve,Ce,ot,et;if(Lt.test(I+c.event.triggered)||(I.indexOf("!")>=0&&(I=I.slice(0,-1),Q=!0),I.indexOf(".")>=0&&(z=I.split("."),I=z.shift(),z.sort()),(!v||c.event.customEvent[I])&&!c.event.global[I]))return;if(a=typeof a=="object"?a[c.expando]?a:new c.Event(I,a):new c.Event(I),a.type=I,a.isTrigger=!0,a.exclusive=Q,a.namespace=z.join("."),a.namespace_re=a.namespace?new RegExp("(^|\\.)"+z.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,fe=I.indexOf(":")<0?"on"+I:"",!v){Y=c.cache;for(de in Y)Y[de].events&&Y[de].events[I]&&c.event.trigger(a,u,Y[de].handle.elem,!0);return}if(a.result=r,a.target||(a.target=v),u=u!=null?c.makeArray(u):[],u.unshift(a),ve=c.event.special[I]||{},ve.trigger&&ve.trigger.apply(v,u)===!1)return;if(ot=[[v,ve.bindType||I]],!E&&!ve.noBubble&&!c.isWindow(v)){for(et=ve.delegateType||I,ae=Lt.test(et+I)?v:v.parentNode,_e=null;ae;ae=ae.parentNode)ot.push([ae,et]),_e=ae;_e&&_e===v.ownerDocument&&ot.push([_e.defaultView||_e.parentWindow||e,et])}for(de=0;de<ot.length&&!a.isPropagationStopped();de++)ae=ot[de][0],a.type=ot[de][1],Ce=(c._data(ae,"events")||{})[a.type]&&c._data(ae,"handle"),Ce&&Ce.apply(ae,u),Ce=fe&&ae[fe],Ce&&c.acceptData(ae)&&Ce.apply(ae,u)===!1&&a.preventDefault();return a.type=I,!E&&!a.isDefaultPrevented()&&(!ve._default||ve._default.apply(v.ownerDocument,u)===!1)&&(I!=="click"||!c.nodeName(v,"a"))&&c.acceptData(v)&&fe&&v[I]&&(I!=="focus"&&I!=="blur"||a.target.offsetWidth!==0)&&!c.isWindow(v)&&(_e=v[fe],_e&&(v[fe]=null),c.event.triggered=I,v[I](),c.event.triggered=r,_e&&(v[fe]=_e)),a.result}},dispatch:function(a){a=c.event.fix(a||e.event);var u=(c._data(this,"events")||{})[a.type]||[],v=u.delegateCount,E=[].slice.call(arguments,0),I=!a.exclusive&&!a.namespace,z=c.event.special[a.type]||{},Y=[],Q,de,ae,_e,fe,ve,Ce,ot,et,at,dt;if(E[0]=a,a.delegateTarget=this,!z.preDispatch||z.preDispatch.call(this,a)!==!1){if(v&&(!a.button||a.type!=="click")){for(_e=c(this),_e.context=this.ownerDocument||this,ae=a.target;ae!=this;ae=ae.parentNode||this)if(ae.disabled!==!0){for(ve={},ot=[],_e[0]=ae,Q=0;Q<v;Q++)et=u[Q],at=et.selector,ve[at]===r&&(ve[at]=et.quick?vt(ae,et.quick):_e.is(at)),ve[at]&&ot.push(et);ot.length&&Y.push({elem:ae,matches:ot})}}for(u.length>v&&Y.push({elem:this,matches:u.slice(v)}),Q=0;Q<Y.length&&!a.isPropagationStopped();Q++)for(Ce=Y[Q],a.currentTarget=Ce.elem,de=0;de<Ce.matches.length&&!a.isImmediatePropagationStopped();de++)et=Ce.matches[de],(I||!a.namespace&&!et.namespace||a.namespace_re&&a.namespace_re.test(et.namespace))&&(a.data=et.data,a.handleObj=et,fe=((c.event.special[et.origType]||{}).handle||et.handler).apply(Ce.elem,E),fe!==r&&(a.result=fe,fe===!1&&(a.preventDefault(),a.stopPropagation())));return z.postDispatch&&z.postDispatch.call(this,a),a.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,u){return a.which==null&&(a.which=u.charCode!=null?u.charCode:u.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,u){var v,E,I,z=u.button,Y=u.fromElement;return a.pageX==null&&u.clientX!=null&&(v=a.target.ownerDocument||ce,E=v.documentElement,I=v.body,a.pageX=u.clientX+(E&&E.scrollLeft||I&&I.scrollLeft||0)-(E&&E.clientLeft||I&&I.clientLeft||0),a.pageY=u.clientY+(E&&E.scrollTop||I&&I.scrollTop||0)-(E&&E.clientTop||I&&I.clientTop||0)),!a.relatedTarget&&Y&&(a.relatedTarget=Y===a.target?u.toElement:Y),!a.which&&z!==r&&(a.which=z&1?1:z&2?3:z&4?2:0),a}},fix:function(a){if(a[c.expando])return a;var u,v,E=a,I=c.event.fixHooks[a.type]||{},z=I.props?this.props.concat(I.props):this.props;for(a=c.Event(E),u=z.length;u;)v=z[--u],a[v]=E[v];return a.target||(a.target=E.srcElement||ce),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===r&&(a.metaKey=a.ctrlKey),I.filter?I.filter(a,E):a},special:{ready:{setup:c.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,u,v){c.isWindow(this)&&(this.onbeforeunload=v)},teardown:function(a,u){this.onbeforeunload===u&&(this.onbeforeunload=null)}}},simulate:function(a,u,v,E){var I=c.extend(new c.Event,v,{type:a,isSimulated:!0,originalEvent:{}});E?c.event.trigger(I,null,u):c.event.dispatch.call(u,I),I.isDefaultPrevented()&&v.preventDefault()}},c.event.handle=c.event.dispatch,c.removeEvent=ce.removeEventListener?function(a,u,v){a.removeEventListener&&a.removeEventListener(u,v,!1)}:function(a,u,v){a.detachEvent&&a.detachEvent("on"+u,v)},c.Event=function(a,u){if(!(this instanceof c.Event))return new c.Event(a,u);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?F:H):this.type=a,u&&c.extend(this,u),this.timeStamp=a&&a.timeStamp||c.now(),this[c.expando]=!0},c.Event.prototype={preventDefault:function(){this.isDefaultPrevented=F;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=F;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=F,this.stopPropagation()},isDefaultPrevented:H,isPropagationStopped:H,isImmediatePropagationStopped:H},c.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,u){c.event.special[a]={delegateType:u,bindType:u,handle:function(v){var E=this,I=v.relatedTarget,z=v.handleObj,Y=z.selector,Q;return(!I||I!==E&&!c.contains(E,I))&&(v.type=z.origType,Q=z.handler.apply(this,arguments),v.type=u),Q}}}),c.support.submitBubbles||(c.event.special.submit={setup:function(){if(c.nodeName(this,"form"))return!1;c.event.add(this,"click._submit keypress._submit",function(a){var u=a.target,v=c.nodeName(u,"input")||c.nodeName(u,"button")?u.form:r;v&&!v._submit_attached&&(c.event.add(v,"submit._submit",function(E){E._submit_bubble=!0}),v._submit_attached=!0)})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&c.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(c.nodeName(this,"form"))return!1;c.event.remove(this,"._submit")}}),c.support.changeBubbles||(c.event.special.change={setup:function(){if(ut.test(this.nodeName))return(this.type==="checkbox"||this.type==="radio")&&(c.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),c.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,c.event.simulate("change",this,a,!0))})),!1;c.event.add(this,"beforeactivate._change",function(a){var u=a.target;ut.test(u.nodeName)&&!u._change_attached&&(c.event.add(u,"change._change",function(v){this.parentNode&&!v.isSimulated&&!v.isTrigger&&c.event.simulate("change",this.parentNode,v,!0)}),u._change_attached=!0)})},handle:function(a){var u=a.target;if(this!==u||a.isSimulated||a.isTrigger||u.type!=="radio"&&u.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){return c.event.remove(this,"._change"),ut.test(this.nodeName)}}),c.support.focusinBubbles||c.each({focus:"focusin",blur:"focusout"},function(a,u){var v=0,E=function(I){c.event.simulate(u,I.target,c.event.fix(I),!0)};c.event.special[u]={setup:function(){v++===0&&ce.addEventListener(a,E,!0)},teardown:function(){--v===0&&ce.removeEventListener(a,E,!0)}}}),c.fn.extend({on:function(a,u,v,E,I){var z,Y;if(typeof a=="object"){typeof u!="string"&&(v=v||u,u=r);for(Y in a)this.on(Y,u,v,a[Y],I);return this}if(v==null&&E==null?(E=u,v=u=r):E==null&&(typeof u=="string"?(E=v,v=r):(E=v,v=u,u=r)),E===!1)E=H;else if(!E)return this;return I===1&&(z=E,E=function(Q){return c().off(Q),z.apply(this,arguments)},E.guid=z.guid||(z.guid=c.guid++)),this.each(function(){c.event.add(this,a,E,v,u)})},one:function(a,u,v,E){return this.on(a,u,v,E,1)},off:function(a,u,v){if(a&&a.preventDefault&&a.handleObj){var E=a.handleObj;return c(a.delegateTarget).off(E.namespace?E.origType+"."+E.namespace:E.origType,E.selector,E.handler),this}if(typeof a=="object"){for(var I in a)this.off(I,u,a[I]);return this}return(u===!1||typeof u=="function")&&(v=u,u=r),v===!1&&(v=H),this.each(function(){c.event.remove(this,a,v,u)})},bind:function(a,u,v){return this.on(a,null,u,v)},unbind:function(a,u){return this.off(a,null,u)},live:function(a,u,v){return c(this.context).on(a,this.selector,u,v),this},die:function(a,u){return c(this.context).off(a,this.selector||"**",u),this},delegate:function(a,u,v,E){return this.on(u,a,v,E)},undelegate:function(a,u,v){return arguments.length==1?this.off(a,"**"):this.off(u,a,v)},trigger:function(a,u){return this.each(function(){c.event.trigger(a,u,this)})},triggerHandler:function(a,u){if(this[0])return c.event.trigger(a,u,this[0],!0)},toggle:function(a){var u=arguments,v=a.guid||c.guid++,E=0,I=function(z){var Y=(c._data(this,"lastToggle"+a.guid)||0)%E;return c._data(this,"lastToggle"+a.guid,Y+1),z.preventDefault(),u[Y].apply(this,arguments)||!1};for(I.guid=v;E<u.length;)u[E++].guid=v;return this.click(I)},hover:function(a,u){return this.mouseenter(a).mouseleave(u||a)}}),c.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,u){c.fn[u]=function(v,E){return E==null&&(E=v,v=null),arguments.length>0?this.on(u,null,v,E):this.trigger(u)},c.attrFn&&(c.attrFn[u]=!0),Ft.test(u)&&(c.event.fixHooks[u]=c.event.keyHooks),Mt.test(u)&&(c.event.fixHooks[u]=c.event.mouseHooks)}),(function(){function a(q,Z,ye,xe,Ne,Ae){for(var ze=0,Je=xe.length;ze<Je;ze++){var Ke=xe[ze];if(Ke){var gt=!1;for(Ke=Ke[q];Ke;){if(Ke[E]===ye){gt=xe[Ke.sizset];break}if(Ke.nodeType===1){if(Ae||(Ke[E]=ye,Ke.sizset=ze),typeof Z!="string"){if(Ke===Z){gt=!0;break}}else if(fe.filter(Z,[Ke]).length>0){gt=Ke;break}}Ke=Ke[q]}xe[ze]=gt}}}function u(q,Z,ye,xe,Ne,Ae){for(var ze=0,Je=xe.length;ze<Je;ze++){var Ke=xe[ze];if(Ke){var gt=!1;for(Ke=Ke[q];Ke;){if(Ke[E]===ye){gt=xe[Ke.sizset];break}if(Ke.nodeType===1&&!Ae&&(Ke[E]=ye,Ke.sizset=ze),Ke.nodeName.toLowerCase()===Z){gt=Ke;break}Ke=Ke[q]}xe[ze]=gt}}}var v=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,E="sizcache"+(Math.random()+"").replace(".",""),I=0,z=Object.prototype.toString,Y=!1,Q=!0,de=/\\/g,ae=/\r\n/g,_e=/\W/;[0,0].sort(function(){return Q=!1,0});var fe=function(q,Z,ye,xe){ye=ye||[],Z=Z||ce;var Ne=Z;if(Z.nodeType!==1&&Z.nodeType!==9)return[];if(!q||typeof q!="string")return ye;var Ae,ze,Je,Ke,gt,jt,ie,Ie,Ze=!0,Be=fe.isXML(Z),it=[],Pt=q;do if(v.exec(""),Ae=v.exec(Pt),Ae&&(Pt=Ae[3],it.push(Ae[1]),Ae[2])){Ke=Ae[3];break}while(Ae);if(it.length>1&&ot.exec(q))if(it.length===2&&Ce.relative[it[0]])ze=wt(it[0]+it[1],Z,xe);else for(ze=Ce.relative[it[0]]?[Z]:fe(it.shift(),Z);it.length;)q=it.shift(),Ce.relative[q]&&(q+=it.shift()),ze=wt(q,ze,xe);else if(!xe&&it.length>1&&Z.nodeType===9&&!Be&&Ce.match.ID.test(it[0])&&!Ce.match.ID.test(it[it.length-1])&&(gt=fe.find(it.shift(),Z,Be),Z=gt.expr?fe.filter(gt.expr,gt.set)[0]:gt.set[0]),Z)for(gt=xe?{expr:it.pop(),set:dt(xe)}:fe.find(it.pop(),it.length===1&&(it[0]==="~"||it[0]==="+")&&Z.parentNode?Z.parentNode:Z,Be),ze=gt.expr?fe.filter(gt.expr,gt.set):gt.set,it.length>0?Je=dt(ze):Ze=!1;it.length;)jt=it.pop(),ie=jt,Ce.relative[jt]?ie=it.pop():jt="",ie==null&&(ie=Z),Ce.relative[jt](Je,ie,Be);else Je=it=[];if(Je||(Je=ze),Je||fe.error(jt||q),z.call(Je)==="[object Array]")if(!Ze)ye.push.apply(ye,Je);else if(Z&&Z.nodeType===1)for(Ie=0;Je[Ie]!=null;Ie++)Je[Ie]&&(Je[Ie]===!0||Je[Ie].nodeType===1&&fe.contains(Z,Je[Ie]))&&ye.push(ze[Ie]);else for(Ie=0;Je[Ie]!=null;Ie++)Je[Ie]&&Je[Ie].nodeType===1&&ye.push(ze[Ie]);else dt(Je,ye);return Ke&&(fe(Ke,Ne,ye,xe),fe.uniqueSort(ye)),ye};fe.uniqueSort=function(q){if($t&&(Y=Q,q.sort($t),Y))for(var Z=1;Z<q.length;Z++)q[Z]===q[Z-1]&&q.splice(Z--,1);return q},fe.matches=function(q,Z){return fe(q,null,null,Z)},fe.matchesSelector=function(q,Z){return fe(Z,null,null,[q]).length>0},fe.find=function(q,Z,ye){var xe,Ne,Ae,ze,Je,Ke;if(!q)return[];for(Ne=0,Ae=Ce.order.length;Ne<Ae;Ne++)if(Je=Ce.order[Ne],(ze=Ce.leftMatch[Je].exec(q))&&(Ke=ze[1],ze.splice(1,1),Ke.substr(Ke.length-1)!=="\\"&&(ze[1]=(ze[1]||"").replace(de,""),xe=Ce.find[Je](ze,Z,ye),xe!=null))){q=q.replace(Ce.match[Je],"");break}return xe||(xe=typeof Z.getElementsByTagName!="undefined"?Z.getElementsByTagName("*"):[]),{set:xe,expr:q}},fe.filter=function(q,Z,ye,xe){for(var Ne,Ae,ze,Je,Ke,gt,jt,ie,Ie,Ze=q,Be=[],it=Z,Pt=Z&&Z[0]&&fe.isXML(Z[0]);q&&Z.length;){for(ze in Ce.filter)if((Ne=Ce.leftMatch[ze].exec(q))!=null&&Ne[2]){if(gt=Ce.filter[ze],jt=Ne[1],Ae=!1,Ne.splice(1,1),jt.substr(jt.length-1)==="\\")continue;if(it===Be&&(Be=[]),Ce.preFilter[ze]){if(Ne=Ce.preFilter[ze](Ne,it,ye,Be,xe,Pt),!Ne)Ae=Je=!0;else if(Ne===!0)continue}if(Ne)for(ie=0;(Ke=it[ie])!=null;ie++)Ke&&(Je=gt(Ke,Ne,ie,it),Ie=xe^Je,ye&&Je!=null?Ie?Ae=!0:it[ie]=!1:Ie&&(Be.push(Ke),Ae=!0));if(Je!==r){if(ye||(it=Be),q=q.replace(Ce.match[ze],""),!Ae)return[];break}}if(q===Ze)if(Ae==null)fe.error(q);else break;Ze=q}return it},fe.error=function(q){throw new Error("Syntax error, unrecognized expression: "+q)};var ve=fe.getText=function(q){var Z,ye,xe=q.nodeType,Ne="";if(xe){if(xe===1||xe===9||xe===11){if(typeof q.textContent=="string")return q.textContent;if(typeof q.innerText=="string")return q.innerText.replace(ae,"");for(q=q.firstChild;q;q=q.nextSibling)Ne+=ve(q)}else if(xe===3||xe===4)return q.nodeValue}else for(Z=0;ye=q[Z];Z++)ye.nodeType!==8&&(Ne+=ve(ye));return Ne},Ce=fe.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{class:"className",for:"htmlFor"},attrHandle:{href:function(q){return q.getAttribute("href")},type:function(q){return q.getAttribute("type")}},relative:{"+":function(q,Z){var ye=typeof Z=="string",xe=ye&&!_e.test(Z),Ne=ye&&!xe;xe&&(Z=Z.toLowerCase());for(var Ae=0,ze=q.length,Je;Ae<ze;Ae++)if(Je=q[Ae]){for(;(Je=Je.previousSibling)&&Je.nodeType!==1;);q[Ae]=Ne||Je&&Je.nodeName.toLowerCase()===Z?Je||!1:Je===Z}Ne&&fe.filter(Z,q,!0)},">":function(q,Z){var ye,xe=typeof Z=="string",Ne=0,Ae=q.length;if(xe&&!_e.test(Z)){for(Z=Z.toLowerCase();Ne<Ae;Ne++)if(ye=q[Ne],ye){var ze=ye.parentNode;q[Ne]=ze.nodeName.toLowerCase()===Z?ze:!1}}else{for(;Ne<Ae;Ne++)ye=q[Ne],ye&&(q[Ne]=xe?ye.parentNode:ye.parentNode===Z);xe&&fe.filter(Z,q,!0)}},"":function(q,Z,ye){var xe,Ne=I++,Ae=a;typeof Z=="string"&&!_e.test(Z)&&(Z=Z.toLowerCase(),xe=Z,Ae=u),Ae("parentNode",Z,Ne,q,xe,ye)},"~":function(q,Z,ye){var xe,Ne=I++,Ae=a;typeof Z=="string"&&!_e.test(Z)&&(Z=Z.toLowerCase(),xe=Z,Ae=u),Ae("previousSibling",Z,Ne,q,xe,ye)}},find:{ID:function(q,Z,ye){if(typeof Z.getElementById!="undefined"&&!ye){var xe=Z.getElementById(q[1]);return xe&&xe.parentNode?[xe]:[]}},NAME:function(q,Z){if(typeof Z.getElementsByName!="undefined"){for(var ye=[],xe=Z.getElementsByName(q[1]),Ne=0,Ae=xe.length;Ne<Ae;Ne++)xe[Ne].getAttribute("name")===q[1]&&ye.push(xe[Ne]);return ye.length===0?null:ye}},TAG:function(q,Z){if(typeof Z.getElementsByTagName!="undefined")return Z.getElementsByTagName(q[1])}},preFilter:{CLASS:function(q,Z,ye,xe,Ne,Ae){if(q=" "+q[1].replace(de,"")+" ",Ae)return q;for(var ze=0,Je;(Je=Z[ze])!=null;ze++)Je&&(Ne^(Je.className&&(" "+Je.className+" ").replace(/[\t\n\r]/g," ").indexOf(q)>=0)?ye||xe.push(Je):ye&&(Z[ze]=!1));return!1},ID:function(q){return q[1].replace(de,"")},TAG:function(q,Z){return q[1].replace(de,"").toLowerCase()},CHILD:function(q){if(q[1]==="nth"){q[2]||fe.error(q[0]),q[2]=q[2].replace(/^\+|\s*/g,"");var Z=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(q[2]==="even"&&"2n"||q[2]==="odd"&&"2n+1"||!/\D/.test(q[2])&&"0n+"+q[2]||q[2]);q[2]=Z[1]+(Z[2]||1)-0,q[3]=Z[3]-0}else q[2]&&fe.error(q[0]);return q[0]=I++,q},ATTR:function(q,Z,ye,xe,Ne,Ae){var ze=q[1]=q[1].replace(de,"");return!Ae&&Ce.attrMap[ze]&&(q[1]=Ce.attrMap[ze]),q[4]=(q[4]||q[5]||"").replace(de,""),q[2]==="~="&&(q[4]=" "+q[4]+" "),q},PSEUDO:function(q,Z,ye,xe,Ne){if(q[1]==="not")if((v.exec(q[3])||"").length>1||/^\w/.test(q[3]))q[3]=fe(q[3],null,null,Z);else{var Ae=fe.filter(q[3],Z,ye,!0^Ne);return ye||xe.push.apply(xe,Ae),!1}else if(Ce.match.POS.test(q[0])||Ce.match.CHILD.test(q[0]))return!0;return q},POS:function(q){return q.unshift(!0),q}},filters:{enabled:function(q){return q.disabled===!1&&q.type!=="hidden"},disabled:function(q){return q.disabled===!0},checked:function(q){return q.checked===!0},selected:function(q){return q.parentNode&&q.parentNode.selectedIndex,q.selected===!0},parent:function(q){return!!q.firstChild},empty:function(q){return!q.firstChild},has:function(q,Z,ye){return!!fe(ye[3],q).length},header:function(q){return/h\d/i.test(q.nodeName)},text:function(q){var Z=q.getAttribute("type"),ye=q.type;return q.nodeName.toLowerCase()==="input"&&ye==="text"&&(Z===ye||Z===null)},radio:function(q){return q.nodeName.toLowerCase()==="input"&&q.type==="radio"},checkbox:function(q){return q.nodeName.toLowerCase()==="input"&&q.type==="checkbox"},file:function(q){return q.nodeName.toLowerCase()==="input"&&q.type==="file"},password:function(q){return q.nodeName.toLowerCase()==="input"&&q.type==="password"},submit:function(q){var Z=q.nodeName.toLowerCase();return(Z==="input"||Z==="button")&&q.type==="submit"},image:function(q){return q.nodeName.toLowerCase()==="input"&&q.type==="image"},reset:function(q){var Z=q.nodeName.toLowerCase();return(Z==="input"||Z==="button")&&q.type==="reset"},button:function(q){var Z=q.nodeName.toLowerCase();return Z==="input"&&q.type==="button"||Z==="button"},input:function(q){return/input|select|textarea|button/i.test(q.nodeName)},focus:function(q){return q===q.ownerDocument.activeElement}},setFilters:{first:function(q,Z){return Z===0},last:function(q,Z,ye,xe){return Z===xe.length-1},even:function(q,Z){return Z%2===0},odd:function(q,Z){return Z%2===1},lt:function(q,Z,ye){return Z<ye[3]-0},gt:function(q,Z,ye){return Z>ye[3]-0},nth:function(q,Z,ye){return ye[3]-0===Z},eq:function(q,Z,ye){return ye[3]-0===Z}},filter:{PSEUDO:function(q,Z,ye,xe){var Ne=Z[1],Ae=Ce.filters[Ne];if(Ae)return Ae(q,ye,Z,xe);if(Ne==="contains")return(q.textContent||q.innerText||ve([q])||"").indexOf(Z[3])>=0;if(Ne==="not"){for(var ze=Z[3],Je=0,Ke=ze.length;Je<Ke;Je++)if(ze[Je]===q)return!1;return!0}fe.error(Ne)},CHILD:function(q,Z){var ye,xe,Ne,Ae,ze,Je,Ke,gt=Z[1],jt=q;switch(gt){case"only":case"first":for(;jt=jt.previousSibling;)if(jt.nodeType===1)return!1;if(gt==="first")return!0;jt=q;case"last":for(;jt=jt.nextSibling;)if(jt.nodeType===1)return!1;return!0;case"nth":if(ye=Z[2],xe=Z[3],ye===1&&xe===0)return!0;if(Ne=Z[0],Ae=q.parentNode,Ae&&(Ae[E]!==Ne||!q.nodeIndex)){for(Je=0,jt=Ae.firstChild;jt;jt=jt.nextSibling)jt.nodeType===1&&(jt.nodeIndex=++Je);Ae[E]=Ne}return Ke=q.nodeIndex-xe,ye===0?Ke===0:Ke%ye===0&&Ke/ye>=0}},ID:function(q,Z){return q.nodeType===1&&q.getAttribute("id")===Z},TAG:function(q,Z){return Z==="*"&&q.nodeType===1||!!q.nodeName&&q.nodeName.toLowerCase()===Z},CLASS:function(q,Z){return(" "+(q.className||q.getAttribute("class"))+" ").indexOf(Z)>-1},ATTR:function(q,Z){var ye=Z[1],xe=fe.attr?fe.attr(q,ye):Ce.attrHandle[ye]?Ce.attrHandle[ye](q):q[ye]!=null?q[ye]:q.getAttribute(ye),Ne=xe+"",Ae=Z[2],ze=Z[4];return xe==null?Ae==="!=":!Ae&&fe.attr?xe!=null:Ae==="="?Ne===ze:Ae==="*="?Ne.indexOf(ze)>=0:Ae==="~="?(" "+Ne+" ").indexOf(ze)>=0:ze?Ae==="!="?Ne!==ze:Ae==="^="?Ne.indexOf(ze)===0:Ae==="$="?Ne.substr(Ne.length-ze.length)===ze:Ae==="|="?Ne===ze||Ne.substr(0,ze.length+1)===ze+"-":!1:Ne&&xe!==!1},POS:function(q,Z,ye,xe){var Ne=Z[2],Ae=Ce.setFilters[Ne];if(Ae)return Ae(q,ye,Z,xe)}}},ot=Ce.match.POS,et=function(q,Z){return"\\"+(Z-0+1)};for(var at in Ce.match)Ce.match[at]=new RegExp(Ce.match[at].source+/(?![^\[]*\])(?![^\(]*\))/.source),Ce.leftMatch[at]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Ce.match[at].source.replace(/\\(\d+)/g,et));Ce.match.globalPOS=ot;var dt=function(q,Z){return q=Array.prototype.slice.call(q,0),Z?(Z.push.apply(Z,q),Z):q};try{Array.prototype.slice.call(ce.documentElement.childNodes,0)[0].nodeType}catch(q){dt=function(Z,ye){var xe=0,Ne=ye||[];if(z.call(Z)==="[object Array]")Array.prototype.push.apply(Ne,Z);else if(typeof Z.length=="number")for(var Ae=Z.length;xe<Ae;xe++)Ne.push(Z[xe]);else for(;Z[xe];xe++)Ne.push(Z[xe]);return Ne}}var $t,qt;ce.documentElement.compareDocumentPosition?$t=function(q,Z){return q===Z?(Y=!0,0):!q.compareDocumentPosition||!Z.compareDocumentPosition?q.compareDocumentPosition?-1:1:q.compareDocumentPosition(Z)&4?-1:1}:($t=function(q,Z){if(q===Z)return Y=!0,0;if(q.sourceIndex&&Z.sourceIndex)return q.sourceIndex-Z.sourceIndex;var ye,xe,Ne=[],Ae=[],ze=q.parentNode,Je=Z.parentNode,Ke=ze;if(ze===Je)return qt(q,Z);if(!ze)return-1;if(!Je)return 1;for(;Ke;)Ne.unshift(Ke),Ke=Ke.parentNode;for(Ke=Je;Ke;)Ae.unshift(Ke),Ke=Ke.parentNode;ye=Ne.length,xe=Ae.length;for(var gt=0;gt<ye&&gt<xe;gt++)if(Ne[gt]!==Ae[gt])return qt(Ne[gt],Ae[gt]);return gt===ye?qt(q,Ae[gt],-1):qt(Ne[gt],Z,1)},qt=function(q,Z,ye){if(q===Z)return ye;for(var xe=q.nextSibling;xe;){if(xe===Z)return-1;xe=xe.nextSibling}return 1}),(function(){var q=ce.createElement("div"),Z="script"+new Date().getTime(),ye=ce.documentElement;q.innerHTML="<a name='"+Z+"'/>",ye.insertBefore(q,ye.firstChild),ce.getElementById(Z)&&(Ce.find.ID=function(xe,Ne,Ae){if(typeof Ne.getElementById!="undefined"&&!Ae){var ze=Ne.getElementById(xe[1]);return ze?ze.id===xe[1]||typeof ze.getAttributeNode!="undefined"&&ze.getAttributeNode("id").nodeValue===xe[1]?[ze]:r:[]}},Ce.filter.ID=function(xe,Ne){var Ae=typeof xe.getAttributeNode!="undefined"&&xe.getAttributeNode("id");return xe.nodeType===1&&Ae&&Ae.nodeValue===Ne}),ye.removeChild(q),ye=q=null})(),(function(){var q=ce.createElement("div");q.appendChild(ce.createComment("")),q.getElementsByTagName("*").length>0&&(Ce.find.TAG=function(Z,ye){var xe=ye.getElementsByTagName(Z[1]);if(Z[1]==="*"){for(var Ne=[],Ae=0;xe[Ae];Ae++)xe[Ae].nodeType===1&&Ne.push(xe[Ae]);xe=Ne}return xe}),q.innerHTML="<a href='#'></a>",q.firstChild&&typeof q.firstChild.getAttribute!="undefined"&&q.firstChild.getAttribute("href")!=="#"&&(Ce.attrHandle.href=function(Z){return Z.getAttribute("href",2)}),q=null})(),ce.querySelectorAll&&(function(){var q=fe,Z=ce.createElement("div"),ye="__sizzle__";if(Z.innerHTML="<p class='TEST'></p>",!Z.querySelectorAll||Z.querySelectorAll(".TEST").length!==0){fe=function(Ne,Ae,ze,Je){if(Ae=Ae||ce,!Je&&!fe.isXML(Ae)){var Ke=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(Ne);if(Ke&&(Ae.nodeType===1||Ae.nodeType===9)){if(Ke[1])return dt(Ae.getElementsByTagName(Ne),ze);if(Ke[2]&&Ce.find.CLASS&&Ae.getElementsByClassName)return dt(Ae.getElementsByClassName(Ke[2]),ze)}if(Ae.nodeType===9){if(Ne==="body"&&Ae.body)return dt([Ae.body],ze);if(Ke&&Ke[3]){var gt=Ae.getElementById(Ke[3]);if(!gt||!gt.parentNode)return dt([],ze);if(gt.id===Ke[3])return dt([gt],ze)}try{return dt(Ae.querySelectorAll(Ne),ze)}catch(it){}}else if(Ae.nodeType===1&&Ae.nodeName.toLowerCase()!=="object"){var jt=Ae,ie=Ae.getAttribute("id"),Ie=ie||ye,Ze=Ae.parentNode,Be=/^\s*[+~]/.test(Ne);ie?Ie=Ie.replace(/'/g,"\\$&"):Ae.setAttribute("id",Ie),Be&&Ze&&(Ae=Ae.parentNode);try{if(!Be||Ze)return dt(Ae.querySelectorAll("[id='"+Ie+"'] "+Ne),ze)}catch(it){}finally{ie||jt.removeAttribute("id")}}}return q(Ne,Ae,ze,Je)};for(var xe in q)fe[xe]=q[xe];Z=null}})(),(function(){var q=ce.documentElement,Z=q.matchesSelector||q.mozMatchesSelector||q.webkitMatchesSelector||q.msMatchesSelector;if(Z){var ye=!Z.call(ce.createElement("div"),"div"),xe=!1;try{Z.call(ce.documentElement,"[test!='']:sizzle")}catch(Ne){xe=!0}fe.matchesSelector=function(Ne,Ae){if(Ae=Ae.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']"),!fe.isXML(Ne))try{if(xe||!Ce.match.PSEUDO.test(Ae)&&!/!=/.test(Ae)){var ze=Z.call(Ne,Ae);if(ze||!ye||Ne.document&&Ne.document.nodeType!==11)return ze}}catch(Je){}return fe(Ae,null,null,[Ne]).length>0}}})(),(function(){var q=ce.createElement("div");if(q.innerHTML="<div class='test e'></div><div class='test'></div>",q.getElementsByClassName&&q.getElementsByClassName("e").length!==0){if(q.lastChild.className="e",q.getElementsByClassName("e").length===1)return;Ce.order.splice(1,0,"CLASS"),Ce.find.CLASS=function(Z,ye,xe){if(typeof ye.getElementsByClassName!="undefined"&&!xe)return ye.getElementsByClassName(Z[1])},q=null}})(),ce.documentElement.contains?fe.contains=function(q,Z){return q!==Z&&(q.contains?q.contains(Z):!0)}:ce.documentElement.compareDocumentPosition?fe.contains=function(q,Z){return!!(q.compareDocumentPosition(Z)&16)}:fe.contains=function(){return!1},fe.isXML=function(q){var Z=(q?q.ownerDocument||q:0).documentElement;return Z?Z.nodeName!=="HTML":!1};var wt=function(q,Z,ye){for(var xe,Ne=[],Ae="",ze=Z.nodeType?[Z]:Z;xe=Ce.match.PSEUDO.exec(q);)Ae+=xe[0],q=q.replace(Ce.match.PSEUDO,"");q=Ce.relative[q]?q+"*":q;for(var Je=0,Ke=ze.length;Je<Ke;Je++)fe(q,ze[Je],Ne,ye);return fe.filter(Ae,Ne)};fe.attr=c.attr,fe.selectors.attrMap={},c.find=fe,c.expr=fe.selectors,c.expr[":"]=c.expr.filters,c.unique=fe.uniqueSort,c.text=fe.getText,c.isXMLDoc=fe.isXML,c.contains=fe.contains})();var Yt=/Until$/,Jt=/^(?:parents|prevUntil|prevAll)/,Qt=/,/,vn=/^.[^:#\[\.,]*$/,le=Array.prototype.slice,se=c.expr.match.globalPOS,Le={children:!0,contents:!0,next:!0,prev:!0};c.fn.extend({find:function(a){var u=this,v,E;if(typeof a!="string")return c(a).filter(function(){for(v=0,E=u.length;v<E;v++)if(c.contains(u[v],this))return!0});var I=this.pushStack("","find",a),z,Y,Q;for(v=0,E=this.length;v<E;v++)if(z=I.length,c.find(a,this[v],I),v>0){for(Y=z;Y<I.length;Y++)for(Q=0;Q<z;Q++)if(I[Q]===I[Y]){I.splice(Y--,1);break}}return I},has:function(a){var u=c(a);return this.filter(function(){for(var v=0,E=u.length;v<E;v++)if(c.contains(this,u[v]))return!0})},not:function(a){return this.pushStack(J(this,a,!1),"not",a)},filter:function(a){return this.pushStack(J(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?se.test(a)?c(a,this.context).index(this[0])>=0:c.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,u){var v=[],E,I,z=this[0];if(c.isArray(a)){for(var Y=1;z&&z.ownerDocument&&z!==u;){for(E=0;E<a.length;E++)c(z).is(a[E])&&v.push({selector:a[E],elem:z,level:Y});z=z.parentNode,Y++}return v}var Q=se.test(a)||typeof a!="string"?c(a,u||this.context):0;for(E=0,I=this.length;E<I;E++)for(z=this[E];z;){if(Q?Q.index(z)>-1:c.find.matchesSelector(z,a)){v.push(z);break}if(z=z.parentNode,!z||!z.ownerDocument||z===u||z.nodeType===11)break}return v=v.length>1?c.unique(v):v,this.pushStack(v,"closest",a)},index:function(a){return a?typeof a=="string"?c.inArray(this[0],c(a)):c.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,u){var v=typeof a=="string"?c(a,u):c.makeArray(a&&a.nodeType?[a]:a),E=c.merge(this.get(),v);return this.pushStack(U(v[0])||U(E[0])?E:c.unique(E))},andSelf:function(){return this.add(this.prevObject)}}),c.each({parent:function(a){var u=a.parentNode;return u&&u.nodeType!==11?u:null},parents:function(a){return c.dir(a,"parentNode")},parentsUntil:function(a,u,v){return c.dir(a,"parentNode",v)},next:function(a){return c.nth(a,2,"nextSibling")},prev:function(a){return c.nth(a,2,"previousSibling")},nextAll:function(a){return c.dir(a,"nextSibling")},prevAll:function(a){return c.dir(a,"previousSibling")},nextUntil:function(a,u,v){return c.dir(a,"nextSibling",v)},prevUntil:function(a,u,v){return c.dir(a,"previousSibling",v)},siblings:function(a){return c.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return c.sibling(a.firstChild)},contents:function(a){return c.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:c.makeArray(a.childNodes)}},function(a,u){c.fn[a]=function(v,E){var I=c.map(this,u,v);return Yt.test(a)||(E=v),E&&typeof E=="string"&&(I=c.filter(E,I)),I=this.length>1&&!Le[a]?c.unique(I):I,(this.length>1||Qt.test(E))&&Jt.test(a)&&(I=I.reverse()),this.pushStack(I,a,le.call(arguments).join(","))}}),c.extend({filter:function(a,u,v){return v&&(a=":not("+a+")"),u.length===1?c.find.matchesSelector(u[0],a)?[u[0]]:[]:c.find.matches(a,u)},dir:function(a,u,v){for(var E=[],I=a[u];I&&I.nodeType!==9&&(v===r||I.nodeType!==1||!c(I).is(v));)I.nodeType===1&&E.push(I),I=I[u];return E},nth:function(a,u,v,E){u=u||1;for(var I=0;a&&!(a.nodeType===1&&++I===u);a=a[v]);return a},sibling:function(a,u){for(var v=[];a;a=a.nextSibling)a.nodeType===1&&a!==u&&v.push(a);return v}});var Ue="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",yt=/ jQuery\d+="(?:\d+|null)"/g,pt=/^\s+/,Ht=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,_t=/<([\w:]+)/,At=/<tbody/i,It=/<|&#?\w+;/,Wt=/<(?:script|style)/i,Xt=/<(?:script|object|embed|option|style)/i,Vt=new RegExp("<(?:"+Ue+")[\\s/>]","i"),un=/checked\s*(?:[^=]|=\s*.checked.)/i,dn=/\/(java|ecma)script/i,hn=/^\s*<!(?:\[CDATA\[|\-\-)/,on={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},fn=M(ce);on.optgroup=on.option,on.tbody=on.tfoot=on.colgroup=on.caption=on.thead,on.th=on.td,c.support.htmlSerialize||(on._default=[1,"div<div>","</div>"]),c.fn.extend({text:function(a){return c.access(this,function(u){return u===r?c.text(this):this.empty().append((this[0]&&this[0].ownerDocument||ce).createTextNode(u))},null,a,arguments.length)},wrapAll:function(a){if(c.isFunction(a))return this.each(function(v){c(this).wrapAll(a.call(this,v))});if(this[0]){var u=c(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&u.insertBefore(this[0]),u.map(function(){for(var v=this;v.firstChild&&v.firstChild.nodeType===1;)v=v.firstChild;return v}).append(this)}return this},wrapInner:function(a){return c.isFunction(a)?this.each(function(u){c(this).wrapInner(a.call(this,u))}):this.each(function(){var u=c(this),v=u.contents();v.length?v.wrapAll(a):u.append(a)})},wrap:function(a){var u=c.isFunction(a);return this.each(function(v){c(this).wrapAll(u?a.call(this,v):a)})},unwrap:function(){return this.parent().each(function(){c.nodeName(this,"body")||c(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(u){this.parentNode.insertBefore(u,this)});if(arguments.length){var a=c.clean(arguments);return a.push.apply(a,this.toArray()),this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(u){this.parentNode.insertBefore(u,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);return a.push.apply(a,c.clean(arguments)),a}},remove:function(a,u){for(var v=0,E;(E=this[v])!=null;v++)(!a||c.filter(a,[E]).length)&&(!u&&E.nodeType===1&&(c.cleanData(E.getElementsByTagName("*")),c.cleanData([E])),E.parentNode&&E.parentNode.removeChild(E));return this},empty:function(){for(var a=0,u;(u=this[a])!=null;a++)for(u.nodeType===1&&c.cleanData(u.getElementsByTagName("*"));u.firstChild;)u.removeChild(u.firstChild);return this},clone:function(a,u){return a=a==null?!1:a,u=u==null?a:u,this.map(function(){return c.clone(this,a,u)})},html:function(a){return c.access(this,function(u){var v=this[0]||{},E=0,I=this.length;if(u===r)return v.nodeType===1?v.innerHTML.replace(yt,""):null;if(typeof u=="string"&&!Wt.test(u)&&(c.support.leadingWhitespace||!pt.test(u))&&!on[(_t.exec(u)||["",""])[1].toLowerCase()]){u=u.replace(Ht,"<$1></$2>");try{for(;E<I;E++)v=this[E]||{},v.nodeType===1&&(c.cleanData(v.getElementsByTagName("*")),v.innerHTML=u);v=0}catch(z){}}v&&this.empty().append(u)},null,a,arguments.length)},replaceWith:function(a){return this[0]&&this[0].parentNode?c.isFunction(a)?this.each(function(u){var v=c(this),E=v.html();v.replaceWith(a.call(this,u,E))}):(typeof a!="string"&&(a=c(a).detach()),this.each(function(){var u=this.nextSibling,v=this.parentNode;c(this).remove(),u?c(u).before(a):c(v).append(a)})):this.length?this.pushStack(c(c.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,u,v){var E,I,z,Y,Q=a[0],de=[];if(!c.support.checkClone&&arguments.length===3&&typeof Q=="string"&&un.test(Q))return this.each(function(){c(this).domManip(a,u,v,!0)});if(c.isFunction(Q))return this.each(function(ve){var Ce=c(this);a[0]=Q.call(this,ve,u?Ce.html():r),Ce.domManip(a,u,v)});if(this[0]){if(Y=Q&&Q.parentNode,c.support.parentNode&&Y&&Y.nodeType===11&&Y.childNodes.length===this.length?E={fragment:Y}:E=c.buildFragment(a,this,de),z=E.fragment,z.childNodes.length===1?I=z=z.firstChild:I=z.firstChild,I){u=u&&c.nodeName(I,"tr");for(var ae=0,_e=this.length,fe=_e-1;ae<_e;ae++)v.call(u?K(this[ae],I):this[ae],E.cacheable||_e>1&&ae<fe?c.clone(z,!0,!0):z)}de.length&&c.each(de,function(ve,Ce){Ce.src?c.ajax({type:"GET",global:!1,url:Ce.src,async:!1,dataType:"script"}):c.globalEval((Ce.text||Ce.textContent||Ce.innerHTML||"").replace(hn,"/*$0*/")),Ce.parentNode&&Ce.parentNode.removeChild(Ce)})}return this}}),c.buildFragment=function(a,u,v){var E,I,z,Y,Q=a[0];return u&&u[0]&&(Y=u[0].ownerDocument||u[0]),Y.createDocumentFragment||(Y=ce),a.length===1&&typeof Q=="string"&&Q.length<512&&Y===ce&&Q.charAt(0)==="<"&&!Xt.test(Q)&&(c.support.checkClone||!un.test(Q))&&(c.support.html5Clone||!Vt.test(Q))&&(I=!0,z=c.fragments[Q],z&&z!==1&&(E=z)),E||(E=Y.createDocumentFragment(),c.clean(a,Y,E,v)),I&&(c.fragments[Q]=z?E:1),{fragment:E,cacheable:I}},c.fragments={},c.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,u){c.fn[a]=function(v){var E=[],I=c(v),z=this.length===1&&this[0].parentNode;if(z&&z.nodeType===11&&z.childNodes.length===1&&I.length===1)return I[u](this[0]),this;for(var Y=0,Q=I.length;Y<Q;Y++){var de=(Y>0?this.clone(!0):this).get();c(I[Y])[u](de),E=E.concat(de)}return this.pushStack(E,a,I.selector)}}),c.extend({clone:function(a,u,v){var E,I,z,Y=c.support.html5Clone||c.isXMLDoc(a)||!Vt.test("<"+a.nodeName+">")?a.cloneNode(!0):w(a);if((!c.support.noCloneEvent||!c.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!c.isXMLDoc(a))for(te(a,Y),E=X(a),I=X(Y),z=0;E[z];++z)I[z]&&te(E[z],I[z]);if(u&&(ne(a,Y),v))for(E=X(a),I=X(Y),z=0;E[z];++z)ne(E[z],I[z]);return E=I=null,Y},clean:function(a,u,v,E){var I,z,Y,Q=[];u=u||ce,typeof u.createElement=="undefined"&&(u=u.ownerDocument||u[0]&&u[0].ownerDocument||ce);for(var de=0,ae;(ae=a[de])!=null;de++)if(typeof ae=="number"&&(ae+=""),!!ae){if(typeof ae=="string")if(!It.test(ae))ae=u.createTextNode(ae);else{ae=ae.replace(Ht,"<$1></$2>");var _e=(_t.exec(ae)||["",""])[1].toLowerCase(),fe=on[_e]||on._default,ve=fe[0],Ce=u.createElement("div"),ot=fn.childNodes,et;for(u===ce?fn.appendChild(Ce):M(u).appendChild(Ce),Ce.innerHTML=fe[1]+ae+fe[2];ve--;)Ce=Ce.lastChild;if(!c.support.tbody){var at=At.test(ae),dt=_e==="table"&&!at?Ce.firstChild&&Ce.firstChild.childNodes:fe[1]==="<table>"&&!at?Ce.childNodes:[];for(Y=dt.length-1;Y>=0;--Y)c.nodeName(dt[Y],"tbody")&&!dt[Y].childNodes.length&&dt[Y].parentNode.removeChild(dt[Y])}!c.support.leadingWhitespace&&pt.test(ae)&&Ce.insertBefore(u.createTextNode(pt.exec(ae)[0]),Ce.firstChild),ae=Ce.childNodes,Ce&&(Ce.parentNode.removeChild(Ce),ot.length>0&&(et=ot[ot.length-1],et&&et.parentNode&&et.parentNode.removeChild(et)))}var $t;if(!c.support.appendChecked)if(ae[0]&&typeof($t=ae.length)=="number")for(Y=0;Y<$t;Y++)P(ae[Y]);else P(ae);ae.nodeType?Q.push(ae):Q=c.merge(Q,ae)}if(v)for(I=function(wt){return!wt.type||dn.test(wt.type)},de=0;Q[de];de++)if(z=Q[de],E&&c.nodeName(z,"script")&&(!z.type||dn.test(z.type)))E.push(z.parentNode?z.parentNode.removeChild(z):z);else{if(z.nodeType===1){var qt=c.grep(z.getElementsByTagName("script"),I);Q.splice.apply(Q,[de+1,0].concat(qt))}v.appendChild(z)}return Q},cleanData:function(a){for(var u,v,E=c.cache,I=c.event.special,z=c.support.deleteExpando,Y=0,Q;(Q=a[Y])!=null;Y++)if(!(Q.nodeName&&c.noData[Q.nodeName.toLowerCase()])&&(v=Q[c.expando],v)){if(u=E[v],u&&u.events){for(var de in u.events)I[de]?c.event.remove(Q,de):c.removeEvent(Q,de,u.handle);u.handle&&(u.handle.elem=null)}z?delete Q[c.expando]:Q.removeAttribute&&Q.removeAttribute(c.expando),delete E[v]}}});var Nn=/alpha\([^)]*\)/i,Yn=/opacity=([^)]*)/,Pi=/([A-Z]|^ms)/g,Ln=/^[\-+]?(?:\d*\.)?\d+$/i,gn=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,ci=/^([\-+])=([\-+.\de]+)/,Di=/^margin/,Oi={position:"absolute",visibility:"hidden",display:"block"},En=["Top","Right","Bottom","Left"],kn,Fn,$n;c.fn.css=function(a,u){return c.access(this,function(v,E,I){return I!==r?c.style(v,E,I):c.css(v,E)},a,u,arguments.length>1)},c.extend({cssHooks:{opacity:{get:function(a,u){if(u){var v=kn(a,"opacity");return v===""?"1":v}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:c.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,u,v,E){if(a&&a.nodeType!==3&&a.nodeType!==8&&a.style){var I,z,Y=c.camelCase(u),Q=a.style,de=c.cssHooks[Y];if(u=c.cssProps[Y]||Y,v===r)return de&&"get"in de&&(I=de.get(a,!1,E))!==r?I:Q[u];if(z=typeof v,z==="string"&&(I=ci.exec(v))&&(v=+(I[1]+1)*+I[2]+parseFloat(c.css(a,u)),z="number"),v==null||z==="number"&&isNaN(v))return;if(z==="number"&&!c.cssNumber[Y]&&(v+="px"),!de||!("set"in de)||(v=de.set(a,v))!==r)try{Q[u]=v}catch(ae){}}},css:function(a,u,v){var E,I;if(u=c.camelCase(u),I=c.cssHooks[u],u=c.cssProps[u]||u,u==="cssFloat"&&(u="float"),I&&"get"in I&&(E=I.get(a,!0,v))!==r)return E;if(kn)return kn(a,u)},swap:function(a,u,v){var E={},I,z;for(z in u)E[z]=a.style[z],a.style[z]=u[z];I=v.call(a);for(z in u)a.style[z]=E[z];return I}}),c.curCSS=c.css,ce.defaultView&&ce.defaultView.getComputedStyle&&(Fn=function(a,u){var v,E,I,z,Y=a.style;return u=u.replace(Pi,"-$1").toLowerCase(),(E=a.ownerDocument.defaultView)&&(I=E.getComputedStyle(a,null))&&(v=I.getPropertyValue(u),v===""&&!c.contains(a.ownerDocument.documentElement,a)&&(v=c.style(a,u))),!c.support.pixelMargin&&I&&Di.test(u)&&gn.test(v)&&(z=Y.width,Y.width=v,v=I.width,Y.width=z),v}),ce.documentElement.currentStyle&&($n=function(a,u){var v,E,I,z=a.currentStyle&&a.currentStyle[u],Y=a.style;return z==null&&Y&&(I=Y[u])&&(z=I),gn.test(z)&&(v=Y.left,E=a.runtimeStyle&&a.runtimeStyle.left,E&&(a.runtimeStyle.left=a.currentStyle.left),Y.left=u==="fontSize"?"1em":z,z=Y.pixelLeft+"px",Y.left=v,E&&(a.runtimeStyle.left=E)),z===""?"auto":z}),kn=Fn||$n,c.each(["height","width"],function(a,u){c.cssHooks[u]={get:function(v,E,I){if(E)return v.offsetWidth!==0?h(v,u,I):c.swap(v,Oi,function(){return h(v,u,I)})},set:function(v,E){return Ln.test(E)?E+"px":E}}}),c.support.opacity||(c.cssHooks.opacity={get:function(a,u){return Yn.test((u&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":u?"1":""},set:function(a,u){var v=a.style,E=a.currentStyle,I=c.isNumeric(u)?"alpha(opacity="+u*100+")":"",z=E&&E.filter||v.filter||"";v.zoom=1,!(u>=1&&c.trim(z.replace(Nn,""))===""&&(v.removeAttribute("filter"),E&&!E.filter))&&(v.filter=Nn.test(z)?z.replace(Nn,I):z+" "+I)}}),c(function(){c.support.reliableMarginRight||(c.cssHooks.marginRight={get:function(a,u){return c.swap(a,{display:"inline-block"},function(){return u?kn(a,"margin-right"):a.style.marginRight})}})}),c.expr&&c.expr.filters&&(c.expr.filters.hidden=function(a){var u=a.offsetWidth,v=a.offsetHeight;return u===0&&v===0||!c.support.reliableHiddenOffsets&&(a.style&&a.style.display||c.css(a,"display"))==="none"},c.expr.filters.visible=function(a){return!c.expr.filters.hidden(a)}),c.each({margin:"",padding:"",border:"Width"},function(a,u){c.cssHooks[a+u]={expand:function(v){var E,I=typeof v=="string"?v.split(" "):[v],z={};for(E=0;E<4;E++)z[a+En[E]+u]=I[E]||I[E-2]||I[0];return z}}});var Ni=/%20/g,ui=/\[\]$/,Xn=/\r?\n/g,di=/#.*$/,Hn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,Rn=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,fi=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,pi=/^(?:GET|HEAD)$/,hi=/^\/\//,ei=/\?/,Li=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,qn=/^(?:select|textarea)/i,gi=/\s+/,Fi=/([?&])_=[^&]*/,mi=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,ti=c.fn.load,ni={},vi={},xn,Cn,yi="*/*";try{xn=lt.href}catch(a){xn=ce.createElement("a"),xn.href="",xn=xn.href}Cn=mi.exec(xn.toLowerCase())||[],c.fn.extend({load:function(a,u,v){if(typeof a!="string"&&ti)return ti.apply(this,arguments);if(!this.length)return this;var E=a.indexOf(" ");if(E>=0){var I=a.slice(E,a.length);a=a.slice(0,E)}var z="GET";u&&(c.isFunction(u)?(v=u,u=r):typeof u=="object"&&(u=c.param(u,c.ajaxSettings.traditional),z="POST"));var Y=this;return c.ajax({url:a,type:z,dataType:"html",data:u,complete:function(Q,de,ae){ae=Q.responseText,Q.isResolved()&&(Q.done(function(_e){ae=_e}),Y.html(I?c("<div>").append(ae.replace(Li,"")).find(I):ae)),v&&Y.each(v,[ae,de,Q])}}),this},serialize:function(){return c.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?c.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||qn.test(this.nodeName)||Rn.test(this.type))}).map(function(a,u){var v=c(this).val();return v==null?null:c.isArray(v)?c.map(v,function(E,I){return{name:u.name,value:E.replace(Xn,`\r
`)}}):{name:u.name,value:v.replace(Xn,`\r
`)}}).get()}}),c.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,u){c.fn[u]=function(v){return this.on(u,v)}}),c.each(["get","post"],function(a,u){c[u]=function(v,E,I,z){return c.isFunction(E)&&(z=z||I,I=E,E=r),c.ajax({type:u,url:v,data:E,success:I,dataType:z})}}),c.extend({getScript:function(a,u){return c.get(a,r,u,"script")},getJSON:function(a,u,v){return c.get(a,u,v,"json")},ajaxSetup:function(a,u){return u?b(a,c.ajaxSettings):(u=a,a=c.ajaxSettings),b(a,u),a},ajaxSettings:{url:xn,isLocal:fi.test(Cn[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":yi},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":c.parseJSON,"text xml":c.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:S(ni),ajaxTransport:S(vi),ajax:function(a,u){function v(ye,xe,Ne,Ae){if(dt!==2){dt=2,et&&clearTimeout(et),ot=r,ve=Ae||"",wt.readyState=ye>0?4:0;var ze,Je,Ke,gt=xe,jt=Ne?V(E,wt,Ne):r,ie,Ie;if(ye>=200&&ye<300||ye===304)if(E.ifModified&&((ie=wt.getResponseHeader("Last-Modified"))&&(c.lastModified[ae]=ie),(Ie=wt.getResponseHeader("Etag"))&&(c.etag[ae]=Ie)),ye===304)gt="notmodified",ze=!0;else try{Je=D(E,jt),gt="success",ze=!0}catch(Ze){gt="parsererror",Ke=Ze}else Ke=gt,(!gt||ye)&&(gt="error",ye<0&&(ye=0));wt.status=ye,wt.statusText=""+(xe||gt),ze?Y.resolveWith(I,[Je,gt,wt]):Y.rejectWith(I,[wt,gt,Ke]),wt.statusCode(de),de=r,$t&&z.trigger("ajax"+(ze?"Success":"Error"),[wt,E,ze?Je:Ke]),Q.fireWith(I,[wt,gt]),$t&&(z.trigger("ajaxComplete",[wt,E]),--c.active||c.event.trigger("ajaxStop"))}}typeof a=="object"&&(u=a,a=r),u=u||{};var E=c.ajaxSetup({},u),I=E.context||E,z=I!==E&&(I.nodeType||I instanceof c)?c(I):c.event,Y=c.Deferred(),Q=c.Callbacks("once memory"),de=E.statusCode||{},ae,_e={},fe={},ve,Ce,ot,et,at,dt=0,$t,qt,wt={readyState:0,setRequestHeader:function(ye,xe){if(!dt){var Ne=ye.toLowerCase();ye=fe[Ne]=fe[Ne]||ye,_e[ye]=xe}return this},getAllResponseHeaders:function(){return dt===2?ve:null},getResponseHeader:function(ye){var xe;if(dt===2){if(!Ce)for(Ce={};xe=Hn.exec(ve);)Ce[xe[1].toLowerCase()]=xe[2];xe=Ce[ye.toLowerCase()]}return xe===r?null:xe},overrideMimeType:function(ye){return dt||(E.mimeType=ye),this},abort:function(ye){return ye=ye||"abort",ot&&ot.abort(ye),v(0,ye),this}};if(Y.promise(wt),wt.success=wt.done,wt.error=wt.fail,wt.complete=Q.add,wt.statusCode=function(ye){if(ye){var xe;if(dt<2)for(xe in ye)de[xe]=[de[xe],ye[xe]];else xe=ye[wt.status],wt.then(xe,xe)}return this},E.url=((a||E.url)+"").replace(di,"").replace(hi,Cn[1]+"//"),E.dataTypes=c.trim(E.dataType||"*").toLowerCase().split(gi),E.crossDomain==null&&(at=mi.exec(E.url.toLowerCase()),E.crossDomain=!(!at||at[1]==Cn[1]&&at[2]==Cn[2]&&(at[3]||(at[1]==="http:"?80:443))==(Cn[3]||(Cn[1]==="http:"?80:443)))),E.data&&E.processData&&typeof E.data!="string"&&(E.data=c.param(E.data,E.traditional)),R(ni,E,u,wt),dt===2)return!1;if($t=E.global,E.type=E.type.toUpperCase(),E.hasContent=!pi.test(E.type),$t&&c.active++===0&&c.event.trigger("ajaxStart"),!E.hasContent&&(E.data&&(E.url+=(ei.test(E.url)?"&":"?")+E.data,delete E.data),ae=E.url,E.cache===!1)){var q=c.now(),Z=E.url.replace(Fi,"$1_="+q);E.url=Z+(Z===E.url?(ei.test(E.url)?"&":"?")+"_="+q:"")}(E.data&&E.hasContent&&E.contentType!==!1||u.contentType)&&wt.setRequestHeader("Content-Type",E.contentType),E.ifModified&&(ae=ae||E.url,c.lastModified[ae]&&wt.setRequestHeader("If-Modified-Since",c.lastModified[ae]),c.etag[ae]&&wt.setRequestHeader("If-None-Match",c.etag[ae])),wt.setRequestHeader("Accept",E.dataTypes[0]&&E.accepts[E.dataTypes[0]]?E.accepts[E.dataTypes[0]]+(E.dataTypes[0]!=="*"?", "+yi+"; q=0.01":""):E.accepts["*"]);for(qt in E.headers)wt.setRequestHeader(qt,E.headers[qt]);if(E.beforeSend&&(E.beforeSend.call(I,wt,E)===!1||dt===2))return wt.abort(),!1;for(qt in{success:1,error:1,complete:1})wt[qt](E[qt]);if(ot=R(vi,E,u,wt),!ot)v(-1,"No Transport");else{wt.readyState=1,$t&&z.trigger("ajaxSend",[wt,E]),E.async&&E.timeout>0&&(et=setTimeout(function(){wt.abort("timeout")},E.timeout));try{dt=1,ot.send(_e,v)}catch(ye){if(dt<2)v(-1,ye);else throw ye}}return wt},param:function(a,u){var v=[],E=function(z,Y){Y=c.isFunction(Y)?Y():Y,v[v.length]=encodeURIComponent(z)+"="+encodeURIComponent(Y)};if(u===r&&(u=c.ajaxSettings.traditional),c.isArray(a)||a.jquery&&!c.isPlainObject(a))c.each(a,function(){E(this.name,this.value)});else for(var I in a)O(I,a[I],u,E);return v.join("&").replace(Ni,"+")}}),c.extend({active:0,lastModified:{},etag:{}});var bi=c.now(),Mn=/(\=)\?(&|$)|\?\?/i;c.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return c.expando+"_"+bi++}}),c.ajaxPrefilter("json jsonp",function(a,u,v){var E=typeof a.data=="string"&&/^application\/x\-www\-form\-urlencoded/.test(a.contentType);if(a.dataTypes[0]==="jsonp"||a.jsonp!==!1&&(Mn.test(a.url)||E&&Mn.test(a.data))){var I,z=a.jsonpCallback=c.isFunction(a.jsonpCallback)?a.jsonpCallback():a.jsonpCallback,Y=e[z],Q=a.url,de=a.data,ae="$1"+z+"$2";return a.jsonp!==!1&&(Q=Q.replace(Mn,ae),a.url===Q&&(E&&(de=de.replace(Mn,ae)),a.data===de&&(Q+=(/\?/.test(Q)?"&":"?")+a.jsonp+"="+z))),a.url=Q,a.data=de,e[z]=function(_e){I=[_e]},v.always(function(){e[z]=Y,I&&c.isFunction(Y)&&e[z](I[0])}),a.converters["script json"]=function(){return I||c.error(z+" was not called"),I[0]},a.dataTypes[0]="json","script"}}),c.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return c.globalEval(a),a}}}),c.ajaxPrefilter("script",function(a){a.cache===r&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),c.ajaxTransport("script",function(a){if(a.crossDomain){var u,v=ce.head||ce.getElementsByTagName("head")[0]||ce.documentElement;return{send:function(E,I){u=ce.createElement("script"),u.async="async",a.scriptCharset&&(u.charset=a.scriptCharset),u.src=a.url,u.onload=u.onreadystatechange=function(z,Y){(Y||!u.readyState||/loaded|complete/.test(u.readyState))&&(u.onload=u.onreadystatechange=null,v&&u.parentNode&&v.removeChild(u),u=r,Y||I(200,"success"))},v.insertBefore(u,v.firstChild)},abort:function(){u&&u.onload(0,1)}}}});var Qn=e.ActiveXObject?function(){for(var a in An)An[a](0,1)}:!1,an=0,An;c.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&k()||T()}:k,(function(a){c.extend(c.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})})(c.ajaxSettings.xhr()),c.support.ajax&&c.ajaxTransport(function(a){if(!a.crossDomain||c.support.cors){var u;return{send:function(v,E){var I=a.xhr(),z,Y;if(a.username?I.open(a.type,a.url,a.async,a.username,a.password):I.open(a.type,a.url,a.async),a.xhrFields)for(Y in a.xhrFields)I[Y]=a.xhrFields[Y];a.mimeType&&I.overrideMimeType&&I.overrideMimeType(a.mimeType),!a.crossDomain&&!v["X-Requested-With"]&&(v["X-Requested-With"]="XMLHttpRequest");try{for(Y in v)I.setRequestHeader(Y,v[Y])}catch(Q){}I.send(a.hasContent&&a.data||null),u=function(Q,de){var ae,_e,fe,ve,Ce;try{if(u&&(de||I.readyState===4))if(u=r,z&&(I.onreadystatechange=c.noop,Qn&&delete An[z]),de)I.readyState!==4&&I.abort();else{ae=I.status,fe=I.getAllResponseHeaders(),ve={},Ce=I.responseXML,Ce&&Ce.documentElement&&(ve.xml=Ce);try{ve.text=I.responseText}catch(ot){}try{_e=I.statusText}catch(ot){_e=""}!ae&&a.isLocal&&!a.crossDomain?ae=ve.text?200:404:ae===1223&&(ae=204)}}catch(ot){de||E(-1,ot)}ve&&E(ae,_e,ve,fe)},!a.async||I.readyState===4?u():(z=++an,Qn&&(An||(An={},c(e).unload(Qn)),An[z]=u),I.onreadystatechange=u)},abort:function(){u&&u(0,1)}}}});var Vn={},yn,In,wi=/^(?:toggle|show|hide)$/,Hi=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,zn,jn=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],mn;c.fn.extend({show:function(a,u,v){var E,I;if(a||a===0)return this.animate(s("show",3),a,u,v);for(var z=0,Y=this.length;z<Y;z++)E=this[z],E.style&&(I=E.style.display,!c._data(E,"olddisplay")&&I==="none"&&(I=E.style.display=""),(I===""&&c.css(E,"display")==="none"||!c.contains(E.ownerDocument.documentElement,E))&&c._data(E,"olddisplay",p(E.nodeName)));for(z=0;z<Y;z++)E=this[z],E.style&&(I=E.style.display,(I===""||I==="none")&&(E.style.display=c._data(E,"olddisplay")||""));return this},hide:function(a,u,v){if(a||a===0)return this.animate(s("hide",3),a,u,v);for(var E,I,z=0,Y=this.length;z<Y;z++)E=this[z],E.style&&(I=c.css(E,"display"),I!=="none"&&!c._data(E,"olddisplay")&&c._data(E,"olddisplay",I));for(z=0;z<Y;z++)this[z].style&&(this[z].style.display="none");return this},_toggle:c.fn.toggle,toggle:function(a,u,v){var E=typeof a=="boolean";return c.isFunction(a)&&c.isFunction(u)?this._toggle.apply(this,arguments):a==null||E?this.each(function(){var I=E?a:c(this).is(":hidden");c(this)[I?"show":"hide"]()}):this.animate(s("toggle",3),a,u,v),this},fadeTo:function(a,u,v,E){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:u},a,v,E)},animate:function(a,u,v,E){function I(){z.queue===!1&&c._mark(this);var Y=c.extend({},z),Q=this.nodeType===1,de=Q&&c(this).is(":hidden"),ae,_e,fe,ve,Ce,ot,et,at,dt,$t,qt;Y.animatedProperties={};for(fe in a)if(ae=c.camelCase(fe),fe!==ae&&(a[ae]=a[fe],delete a[fe]),(Ce=c.cssHooks[ae])&&"expand"in Ce){ot=Ce.expand(a[ae]),delete a[ae];for(fe in ot)fe in a||(a[fe]=ot[fe])}for(ae in a){if(_e=a[ae],c.isArray(_e)?(Y.animatedProperties[ae]=_e[1],_e=a[ae]=_e[0]):Y.animatedProperties[ae]=Y.specialEasing&&Y.specialEasing[ae]||Y.easing||"swing",_e==="hide"&&de||_e==="show"&&!de)return Y.complete.call(this);Q&&(ae==="height"||ae==="width")&&(Y.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],c.css(this,"display")==="inline"&&c.css(this,"float")==="none"&&(!c.support.inlineBlockNeedsLayout||p(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}Y.overflow!=null&&(this.style.overflow="hidden");for(fe in a)ve=new c.fx(this,Y,fe),_e=a[fe],wi.test(_e)?(qt=c._data(this,"toggle"+fe)||(_e==="toggle"?de?"show":"hide":0),qt?(c._data(this,"toggle"+fe,qt==="show"?"hide":"show"),ve[qt]()):ve[_e]()):(et=Hi.exec(_e),at=ve.cur(),et?(dt=parseFloat(et[2]),$t=et[3]||(c.cssNumber[fe]?"":"px"),$t!=="px"&&(c.style(this,fe,(dt||1)+$t),at=(dt||1)/ve.cur()*at,c.style(this,fe,at+$t)),et[1]&&(dt=(et[1]==="-="?-1:1)*dt+at),ve.custom(at,dt,$t)):ve.custom(at,_e,""));return!0}var z=c.speed(u,v,E);return c.isEmptyObject(a)?this.each(z.complete,[!1]):(a=c.extend({},a),z.queue===!1?this.each(I):this.queue(z.queue,I))},stop:function(a,u,v){return typeof a!="string"&&(v=u,u=a,a=r),u&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){function E(de,ae,_e){var fe=ae[_e];c.removeData(de,_e,!0),fe.stop(v)}var I,z=!1,Y=c.timers,Q=c._data(this);if(v||c._unmark(!0,this),a==null)for(I in Q)Q[I]&&Q[I].stop&&I.indexOf(".run")===I.length-4&&E(this,Q,I);else Q[I=a+".run"]&&Q[I].stop&&E(this,Q,I);for(I=Y.length;I--;)Y[I].elem===this&&(a==null||Y[I].queue===a)&&(v?Y[I](!0):Y[I].saveState(),z=!0,Y.splice(I,1));(!v||!z)&&c.dequeue(this,a)})}}),c.each({slideDown:s("show",1),slideUp:s("hide",1),slideToggle:s("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,u){c.fn[a]=function(v,E,I){return this.animate(u,v,E,I)}}),c.extend({speed:function(a,u,v){var E=a&&typeof a=="object"?c.extend({},a):{complete:v||!v&&u||c.isFunction(a)&&a,duration:a,easing:v&&u||u&&!c.isFunction(u)&&u};return E.duration=c.fx.off?0:typeof E.duration=="number"?E.duration:E.duration in c.fx.speeds?c.fx.speeds[E.duration]:c.fx.speeds._default,(E.queue==null||E.queue===!0)&&(E.queue="fx"),E.old=E.complete,E.complete=function(I){c.isFunction(E.old)&&E.old.call(this),E.queue?c.dequeue(this,E.queue):I!==!1&&c._unmark(this)},E},easing:{linear:function(a){return a},swing:function(a){return-Math.cos(a*Math.PI)/2+.5}},timers:[],fx:function(a,u,v){this.options=u,this.elem=a,this.prop=v,u.orig=u.orig||{}}}),c.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(c.fx.step[this.prop]||c.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,u=c.css(this.elem,this.prop);return isNaN(a=parseFloat(u))?!u||u==="auto"?0:u:a},custom:function(a,u,v){function E(Y){return I.step(Y)}var I=this,z=c.fx;this.startTime=mn||f(),this.end=u,this.now=this.start=a,this.pos=this.state=0,this.unit=v||this.unit||(c.cssNumber[this.prop]?"":"px"),E.queue=this.options.queue,E.elem=this.elem,E.saveState=function(){c._data(I.elem,"fxshow"+I.prop)===r&&(I.options.hide?c._data(I.elem,"fxshow"+I.prop,I.start):I.options.show&&c._data(I.elem,"fxshow"+I.prop,I.end))},E()&&c.timers.push(E)&&!zn&&(zn=setInterval(z.tick,z.interval))},show:function(){var a=c._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||c.style(this.elem,this.prop),this.options.show=!0,a!==r?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),c(this.elem).show()},hide:function(){this.options.orig[this.prop]=c._data(this.elem,"fxshow"+this.prop)||c.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var u,v,E,I=mn||f(),z=!0,Y=this.elem,Q=this.options;if(a||I>=Q.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),Q.animatedProperties[this.prop]=!0;for(u in Q.animatedProperties)Q.animatedProperties[u]!==!0&&(z=!1);if(z){if(Q.overflow!=null&&!c.support.shrinkWrapBlocks&&c.each(["","X","Y"],function(de,ae){Y.style["overflow"+ae]=Q.overflow[de]}),Q.hide&&c(Y).hide(),Q.hide||Q.show)for(u in Q.animatedProperties)c.style(Y,u,Q.orig[u]),c.removeData(Y,"fxshow"+u,!0),c.removeData(Y,"toggle"+u,!0);E=Q.complete,E&&(Q.complete=!1,E.call(Y))}return!1}return Q.duration==1/0?this.now=I:(v=I-this.startTime,this.state=v/Q.duration,this.pos=c.easing[Q.animatedProperties[this.prop]](this.state,v,0,1,Q.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}},c.extend(c.fx,{tick:function(){for(var a,u=c.timers,v=0;v<u.length;v++)a=u[v],!a()&&u[v]===a&&u.splice(v--,1);u.length||c.fx.stop()},interval:13,stop:function(){clearInterval(zn),zn=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){c.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),c.each(jn.concat.apply([],jn),function(a,u){u.indexOf("margin")&&(c.fx.step[u]=function(v){c.style(v.elem,u,Math.max(0,v.now)+v.unit)})}),c.expr&&c.expr.filters&&(c.expr.filters.animated=function(a){return c.grep(c.timers,function(u){return a===u.elem}).length});var Un,Ri=/^t(?:able|d|h)$/i,Tn=/^(?:body|html)$/i;"getBoundingClientRect"in ce.documentElement?Un=function(a,u,v,E){try{E=a.getBoundingClientRect()}catch(ve){}if(!E||!c.contains(v,a))return E?{top:E.top,left:E.left}:{top:0,left:0};var I=u.body,z=_(u),Y=v.clientTop||I.clientTop||0,Q=v.clientLeft||I.clientLeft||0,de=z.pageYOffset||c.support.boxModel&&v.scrollTop||I.scrollTop,ae=z.pageXOffset||c.support.boxModel&&v.scrollLeft||I.scrollLeft,_e=E.top+de-Y,fe=E.left+ae-Q;return{top:_e,left:fe}}:Un=function(a,u,v){for(var E,I=a.offsetParent,z=a,Y=u.body,Q=u.defaultView,de=Q?Q.getComputedStyle(a,null):a.currentStyle,ae=a.offsetTop,_e=a.offsetLeft;(a=a.parentNode)&&a!==Y&&a!==v&&!(c.support.fixedPosition&&de.position==="fixed");)E=Q?Q.getComputedStyle(a,null):a.currentStyle,ae-=a.scrollTop,_e-=a.scrollLeft,a===I&&(ae+=a.offsetTop,_e+=a.offsetLeft,c.support.doesNotAddBorder&&(!c.support.doesAddBorderForTableAndCells||!Ri.test(a.nodeName))&&(ae+=parseFloat(E.borderTopWidth)||0,_e+=parseFloat(E.borderLeftWidth)||0),z=I,I=a.offsetParent),c.support.subtractsBorderForOverflowNotVisible&&E.overflow!=="visible"&&(ae+=parseFloat(E.borderTopWidth)||0,_e+=parseFloat(E.borderLeftWidth)||0),de=E;return(de.position==="relative"||de.position==="static")&&(ae+=Y.offsetTop,_e+=Y.offsetLeft),c.support.fixedPosition&&de.position==="fixed"&&(ae+=Math.max(v.scrollTop,Y.scrollTop),_e+=Math.max(v.scrollLeft,Y.scrollLeft)),{top:ae,left:_e}},c.fn.offset=function(a){if(arguments.length)return a===r?this:this.each(function(E){c.offset.setOffset(this,a,E)});var u=this[0],v=u&&u.ownerDocument;return v?u===v.body?c.offset.bodyOffset(u):Un(u,v,v.documentElement):null},c.offset={bodyOffset:function(a){var u=a.offsetTop,v=a.offsetLeft;return c.support.doesNotIncludeMarginInBodyOffset&&(u+=parseFloat(c.css(a,"marginTop"))||0,v+=parseFloat(c.css(a,"marginLeft"))||0),{top:u,left:v}},setOffset:function(a,u,v){var E=c.css(a,"position");E==="static"&&(a.style.position="relative");var I=c(a),z=I.offset(),Y=c.css(a,"top"),Q=c.css(a,"left"),de=(E==="absolute"||E==="fixed")&&c.inArray("auto",[Y,Q])>-1,ae={},_e={},fe,ve;de?(_e=I.position(),fe=_e.top,ve=_e.left):(fe=parseFloat(Y)||0,ve=parseFloat(Q)||0),c.isFunction(u)&&(u=u.call(a,v,z)),u.top!=null&&(ae.top=u.top-z.top+fe),u.left!=null&&(ae.left=u.left-z.left+ve),"using"in u?u.using.call(a,ae):I.css(ae)}},c.fn.extend({position:function(){if(!this[0])return null;var a=this[0],u=this.offsetParent(),v=this.offset(),E=Tn.test(u[0].nodeName)?{top:0,left:0}:u.offset();return v.top-=parseFloat(c.css(a,"marginTop"))||0,v.left-=parseFloat(c.css(a,"marginLeft"))||0,E.top+=parseFloat(c.css(u[0],"borderTopWidth"))||0,E.left+=parseFloat(c.css(u[0],"borderLeftWidth"))||0,{top:v.top-E.top,left:v.left-E.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||ce.body;a&&!Tn.test(a.nodeName)&&c.css(a,"position")==="static";)a=a.offsetParent;return a})}}),c.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,u){var v=/Y/.test(u);c.fn[a]=function(E){return c.access(this,function(I,z,Y){var Q=_(I);if(Y===r)return Q?u in Q?Q[u]:c.support.boxModel&&Q.document.documentElement[z]||Q.document.body[z]:I[z];Q?Q.scrollTo(v?c(Q).scrollLeft():Y,v?Y:c(Q).scrollTop()):I[z]=Y},a,E,arguments.length,null)}}),c.each({Height:"height",Width:"width"},function(a,u){var v="client"+a,E="scroll"+a,I="offset"+a;c.fn["inner"+a]=function(){var z=this[0];return z?z.style?parseFloat(c.css(z,u,"padding")):this[u]():null},c.fn["outer"+a]=function(z){var Y=this[0];return Y?Y.style?parseFloat(c.css(Y,u,z?"margin":"border")):this[u]():null},c.fn[u]=function(z){return c.access(this,function(Y,Q,de){var ae,_e,fe,ve;if(c.isWindow(Y))return ae=Y.document,_e=ae.documentElement[v],c.support.boxModel&&_e||ae.body&&ae.body[v]||_e;if(Y.nodeType===9)return ae=Y.documentElement,ae[v]>=ae[E]?ae[v]:Math.max(Y.body[E],ae[E],Y.body[I],ae[I]);if(de===r)return fe=c.css(Y,Q),ve=parseFloat(fe),c.isNumeric(ve)?ve:fe;c(Y).css(Q,de)},u,z,arguments.length,null)}}),e.jQuery=e.$=c,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return c})})(window);/*! jQuery UI - v1.9.2 - 2012-12-10
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.position.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.sortable.js, jquery.ui.autocomplete.js, jquery.ui.menu.js, jquery.ui.slider.js
* Copyright (c) 2012 jQuery Foundation and other contributors Licensed MIT */(function(e,r){function _(f,T){var k,D,V,O=f.nodeName.toLowerCase();return O==="area"?(k=f.parentNode,D=k.name,!f.href||!D||k.nodeName.toLowerCase()!=="map"?!1:(V=e("img[usemap=#"+D+"]")[0],!!V&&p(V))):(/input|select|textarea|button|object/.test(O)?!f.disabled:O==="a"&&f.href||T)&&p(f)}function p(f){return e.expr.filters.visible(f)&&!e(f).parents().andSelf().filter(function(){return e.css(this,"visibility")==="hidden"}).length}var s=0,m=/^ui-id-\d+$/;e.ui=e.ui||{},!e.ui.version&&(e.extend(e.ui,{version:"1.9.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(f,T){return typeof f=="number"?this.each(function(){var k=this;setTimeout(function(){e(k).focus(),T&&T.call(k)},f)}):this._focus.apply(this,arguments)},scrollParent:function(){var f;return e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?f=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):f=this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!f.length?e(document):f},zIndex:function(f){if(f!==r)return this.css("zIndex",f);if(this.length)for(var T=e(this[0]),k,D;T.length&&T[0]!==document;){if(k=T.css("position"),(k==="absolute"||k==="relative"||k==="fixed")&&(D=parseInt(T.css("zIndex"),10),!isNaN(D)&&D!==0))return D;T=T.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++s)})},removeUniqueId:function(){return this.each(function(){m.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(f){return function(T){return!!e.data(T,f)}}):function(f,T,k){return!!e.data(f,k[3])},focusable:function(f){return _(f,!isNaN(e.attr(f,"tabindex")))},tabbable:function(f){var T=e.attr(f,"tabindex"),k=isNaN(T);return(k||T>=0)&&_(f,!k)}}),e(function(){var f=document.body,T=f.appendChild(T=document.createElement("div"));T.offsetHeight,e.extend(T.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),e.support.minHeight=T.offsetHeight===100,e.support.selectstart="onselectstart"in T,f.removeChild(T).style.display="none"}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(f,T){function k(b,R,S,h){return e.each(D,function(){R-=parseFloat(e.css(b,"padding"+this))||0,S&&(R-=parseFloat(e.css(b,"border"+this+"Width"))||0),h&&(R-=parseFloat(e.css(b,"margin"+this))||0)}),R}var D=T==="Width"?["Left","Right"]:["Top","Bottom"],V=T.toLowerCase(),O={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+T]=function(b){return b===r?O["inner"+T].call(this):this.each(function(){e(this).css(V,k(this,b)+"px")})},e.fn["outer"+T]=function(b,R){return typeof b!="number"?O["outer"+T].call(this,b):this.each(function(){e(this).css(V,k(this,b,!0,R)+"px")})}}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=(function(f){return function(T){return arguments.length?f.call(this,e.camelCase(T)):f.call(this)}})(e.fn.removeData)),(function(){var f=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];e.ui.ie=!!f.length,e.ui.ie6=parseFloat(f[1],10)===6})(),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(f){f.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(f,T,k){var D,V=e.ui[f].prototype;for(D in k)V.plugins[D]=V.plugins[D]||[],V.plugins[D].push([T,k[D]])},call:function(f,T,k){var D,V=f.plugins[T];if(!(!V||!f.element[0].parentNode||f.element[0].parentNode.nodeType===11))for(D=0;D<V.length;D++)f.options[V[D][0]]&&V[D][1].apply(f.element,k)}},contains:e.contains,hasScroll:function(f,T){if(e(f).css("overflow")==="hidden")return!1;var k=T&&T==="left"?"scrollLeft":"scrollTop",D=!1;return f[k]>0?!0:(f[k]=1,D=f[k]>0,f[k]=0,D)},isOverAxis:function(f,T,k){return f>T&&f<T+k},isOver:function(f,T,k,D,V,O){return e.ui.isOverAxis(f,k,V)&&e.ui.isOverAxis(T,D,O)}}))})(jQuery),(function(e,r){var _=0,p=Array.prototype.slice,s=e.cleanData;e.cleanData=function(m){for(var f=0,T;(T=m[f])!=null;f++)try{e(T).triggerHandler("remove")}catch(k){}s(m)},e.widget=function(m,f,T){var k,D,V,O,b=m.split(".")[0];m=m.split(".")[1],k=b+"-"+m,T||(T=f,f=e.Widget),e.expr[":"][k.toLowerCase()]=function(R){return!!e.data(R,k)},e[b]=e[b]||{},D=e[b][m],V=e[b][m]=function(R,S){if(!this._createWidget)return new V(R,S);arguments.length&&this._createWidget(R,S)},e.extend(V,D,{version:T.version,_proto:e.extend({},T),_childConstructors:[]}),O=new f,O.options=e.widget.extend({},O.options),e.each(T,function(R,S){e.isFunction(S)&&(T[R]=(function(){var h=function(){return f.prototype[R].apply(this,arguments)},w=function(P){return f.prototype[R].apply(this,P)};return function(){var P=this._super,N=this._superApply,X;return this._super=h,this._superApply=w,X=S.apply(this,arguments),this._super=P,this._superApply=N,X}})())}),V.prototype=e.widget.extend(O,{widgetEventPrefix:D?O.widgetEventPrefix:m},T,{constructor:V,namespace:b,widgetName:m,widgetBaseClass:k,widgetFullName:k}),D?(e.each(D._childConstructors,function(R,S){var h=S.prototype;e.widget(h.namespace+"."+h.widgetName,V,S._proto)}),delete D._childConstructors):f._childConstructors.push(V),e.widget.bridge(m,V)},e.widget.extend=function(m){for(var f=p.call(arguments,1),T=0,k=f.length,D,V;T<k;T++)for(D in f[T])V=f[T][D],f[T].hasOwnProperty(D)&&V!==r&&(e.isPlainObject(V)?m[D]=e.isPlainObject(m[D])?e.widget.extend({},m[D],V):e.widget.extend({},V):m[D]=V);return m},e.widget.bridge=function(m,f){var T=f.prototype.widgetFullName||m;e.fn[m]=function(k){var D=typeof k=="string",V=p.call(arguments,1),O=this;return k=!D&&V.length?e.widget.extend.apply(null,[k].concat(V)):k,D?this.each(function(){var b,R=e.data(this,T);if(!R)return e.error("cannot call methods on "+m+" prior to initialization; attempted to call method '"+k+"'");if(!e.isFunction(R[k])||k.charAt(0)==="_")return e.error("no such method '"+k+"' for "+m+" widget instance");if(b=R[k].apply(R,V),b!==R&&b!==r)return O=b&&b.jquery?O.pushStack(b.get()):b,!1}):this.each(function(){var b=e.data(this,T);b?b.option(k||{})._init():e.data(this,T,new f(k,this))}),O}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(m,f){f=e(f||this.defaultElement||this)[0],this.element=e(f),this.uuid=_++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),m),this.bindings=e(),this.hoverable=e(),this.focusable=e(),f!==this&&(e.data(f,this.widgetName,this),e.data(f,this.widgetFullName,this),this._on(!0,this.element,{remove:function(T){T.target===f&&this.destroy()}}),this.document=e(f.style?f.ownerDocument:f.document||f),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(m,f){var T=m,k,D,V;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof m=="string")if(T={},k=m.split("."),m=k.shift(),k.length){for(D=T[m]=e.widget.extend({},this.options[m]),V=0;V<k.length-1;V++)D[k[V]]=D[k[V]]||{},D=D[k[V]];if(m=k.pop(),f===r)return D[m]===r?null:D[m];D[m]=f}else{if(f===r)return this.options[m]===r?null:this.options[m];T[m]=f}return this._setOptions(T),this},_setOptions:function(m){var f;for(f in m)this._setOption(f,m[f]);return this},_setOption:function(m,f){return this.options[m]=f,m==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!f).attr("aria-disabled",f),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(m,f,T){var k,D=this;typeof m!="boolean"&&(T=f,f=m,m=!1),T?(f=k=e(f),this.bindings=this.bindings.add(f)):(T=f,f=this.element,k=this.widget()),e.each(T,function(V,O){function b(){if(!(!m&&(D.options.disabled===!0||e(this).hasClass("ui-state-disabled"))))return(typeof O=="string"?D[O]:O).apply(D,arguments)}typeof O!="string"&&(b.guid=O.guid=O.guid||b.guid||e.guid++);var R=V.match(/^(\w+)\s*(.*)$/),S=R[1]+D.eventNamespace,h=R[2];h?k.delegate(h,S,b):f.bind(S,b)})},_off:function(m,f){f=(f||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,m.unbind(f).undelegate(f)},_delay:function(m,f){function T(){return(typeof m=="string"?k[m]:m).apply(k,arguments)}var k=this;return setTimeout(T,f||0)},_hoverable:function(m){this.hoverable=this.hoverable.add(m),this._on(m,{mouseenter:function(f){e(f.currentTarget).addClass("ui-state-hover")},mouseleave:function(f){e(f.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(m){this.focusable=this.focusable.add(m),this._on(m,{focusin:function(f){e(f.currentTarget).addClass("ui-state-focus")},focusout:function(f){e(f.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(m,f,T){var k,D,V=this.options[m];if(T=T||{},f=e.Event(f),f.type=(m===this.widgetEventPrefix?m:this.widgetEventPrefix+m).toLowerCase(),f.target=this.element[0],D=f.originalEvent,D)for(k in D)k in f||(f[k]=D[k]);return this.element.trigger(f,T),!(e.isFunction(V)&&V.apply(this.element[0],[f].concat(T))===!1||f.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(m,f){e.Widget.prototype["_"+m]=function(T,k,D){typeof k=="string"&&(k={effect:k});var V,O=k?k===!0||typeof k=="number"?f:k.effect||f:m;k=k||{},typeof k=="number"&&(k={duration:k}),V=!e.isEmptyObject(k),k.complete=D,k.delay&&T.delay(k.delay),V&&e.effects&&(e.effects.effect[O]||e.uiBackCompat!==!1&&e.effects[O])?T[m](k):O!==m&&T[O]?T[O](k.duration,k.easing,D):T.queue(function(b){e(this)[m](),D&&D.call(T[0]),b()})}}),e.uiBackCompat!==!1&&(e.Widget.prototype._getCreateOptions=function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]})})(jQuery),(function(e,r){var _=!1;e(document).mouseup(function(p){_=!1}),e.widget("ui.mouse",{version:"1.9.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var p=this;this.element.bind("mousedown."+this.widgetName,function(s){return p._mouseDown(s)}).bind("click."+this.widgetName,function(s){if(e.data(s.target,p.widgetName+".preventClickEvent")===!0)return e.removeData(s.target,p.widgetName+".preventClickEvent"),s.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(p){if(!_){this._mouseStarted&&this._mouseUp(p),this._mouseDownEvent=p;var s=this,m=p.which===1,f=typeof this.options.cancel=="string"&&p.target.nodeName?e(p.target).closest(this.options.cancel).length:!1;return!m||f||!this._mouseCapture(p)?!0:(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){s.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(p)&&this._mouseDelayMet(p)&&(this._mouseStarted=this._mouseStart(p)!==!1,!this._mouseStarted)?(p.preventDefault(),!0):(e.data(p.target,this.widgetName+".preventClickEvent")===!0&&e.removeData(p.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(T){return s._mouseMove(T)},this._mouseUpDelegate=function(T){return s._mouseUp(T)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),p.preventDefault(),_=!0,!0))}},_mouseMove:function(p){return!e.ui.ie||document.documentMode>=9||p.button?this._mouseStarted?(this._mouseDrag(p),p.preventDefault()):(this._mouseDistanceMet(p)&&this._mouseDelayMet(p)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,p)!==!1,this._mouseStarted?this._mouseDrag(p):this._mouseUp(p)),!this._mouseStarted):this._mouseUp(p)},_mouseUp:function(p){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,p.target===this._mouseDownEvent.target&&e.data(p.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(p)),!1},_mouseDistanceMet:function(p){return Math.max(Math.abs(this._mouseDownEvent.pageX-p.pageX),Math.abs(this._mouseDownEvent.pageY-p.pageY))>=this.options.distance},_mouseDelayMet:function(p){return this.mouseDelayMet},_mouseStart:function(p){},_mouseDrag:function(p){},_mouseStop:function(p){},_mouseCapture:function(p){return!0}})})(jQuery),(function(e,r){function _(S,h,w){return[parseInt(S[0],10)*(b.test(S[0])?h/100:1),parseInt(S[1],10)*(b.test(S[1])?w/100:1)]}function p(S,h){return parseInt(e.css(S,h),10)||0}e.ui=e.ui||{};var s,m=Math.max,f=Math.abs,T=Math.round,k=/left|center|right/,D=/top|center|bottom/,V=/[\+\-]\d+%?/,O=/^\w+/,b=/%$/,R=e.fn.position;e.position={scrollbarWidth:function(){if(s!==r)return s;var S,h,w=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),P=w.children()[0];return e("body").append(w),S=P.offsetWidth,w.css("overflow","scroll"),h=P.offsetWidth,S===h&&(h=w[0].clientWidth),w.remove(),s=S-h},getScrollInfo:function(S){var h=S.isWindow?"":S.element.css("overflow-x"),w=S.isWindow?"":S.element.css("overflow-y"),P=h==="scroll"||h==="auto"&&S.width<S.element[0].scrollWidth,N=w==="scroll"||w==="auto"&&S.height<S.element[0].scrollHeight;return{width:P?e.position.scrollbarWidth():0,height:N?e.position.scrollbarWidth():0}},getWithinInfo:function(S){var h=e(S||window),w=e.isWindow(h[0]);return{element:h,isWindow:w,offset:h.offset()||{left:0,top:0},scrollLeft:h.scrollLeft(),scrollTop:h.scrollTop(),width:w?h.width():h.outerWidth(),height:w?h.height():h.outerHeight()}}},e.fn.position=function(S){if(!S||!S.of)return R.apply(this,arguments);S=e.extend({},S);var h,w,P,N,X,te=e(S.of),ne=e.position.getWithinInfo(S.within),K=e.position.getScrollInfo(ne),M=te[0],J=(S.collision||"flip").split(" "),U={};return M.nodeType===9?(w=te.width(),P=te.height(),N={top:0,left:0}):e.isWindow(M)?(w=te.width(),P=te.height(),N={top:te.scrollTop(),left:te.scrollLeft()}):M.preventDefault?(S.at="left top",w=P=0,N={top:M.pageY,left:M.pageX}):(w=te.outerWidth(),P=te.outerHeight(),N=te.offset()),X=e.extend({},N),e.each(["my","at"],function(){var F=(S[this]||"").split(" "),H,W;F.length===1&&(F=k.test(F[0])?F.concat(["center"]):D.test(F[0])?["center"].concat(F):["center","center"]),F[0]=k.test(F[0])?F[0]:"center",F[1]=D.test(F[1])?F[1]:"center",H=V.exec(F[0]),W=V.exec(F[1]),U[this]=[H?H[0]:0,W?W[0]:0],S[this]=[O.exec(F[0])[0],O.exec(F[1])[0]]}),J.length===1&&(J[1]=J[0]),S.at[0]==="right"?X.left+=w:S.at[0]==="center"&&(X.left+=w/2),S.at[1]==="bottom"?X.top+=P:S.at[1]==="center"&&(X.top+=P/2),h=_(U.at,w,P),X.left+=h[0],X.top+=h[1],this.each(function(){var F,H,W=e(this),re=W.outerWidth(),y=W.outerHeight(),ke=p(this,"marginLeft"),ce=p(this,"marginTop"),Ge=re+ke+p(this,"marginRight")+K.width,lt=y+ce+p(this,"marginBottom")+K.height,c=e.extend({},X),we=_(U.my,W.outerWidth(),W.outerHeight());S.my[0]==="right"?c.left-=re:S.my[0]==="center"&&(c.left-=re/2),S.my[1]==="bottom"?c.top-=y:S.my[1]==="center"&&(c.top-=y/2),c.left+=we[0],c.top+=we[1],e.support.offsetFractions||(c.left=T(c.left),c.top=T(c.top)),F={marginLeft:ke,marginTop:ce},e.each(["left","top"],function(De,Re){e.ui.position[J[De]]&&e.ui.position[J[De]][Re](c,{targetWidth:w,targetHeight:P,elemWidth:re,elemHeight:y,collisionPosition:F,collisionWidth:Ge,collisionHeight:lt,offset:[h[0]+we[0],h[1]+we[1]],my:S.my,at:S.at,within:ne,elem:W})}),e.fn.bgiframe&&W.bgiframe(),S.using&&(H=function(De){var Re=N.left-c.left,je=Re+w-re,Pe=N.top-c.top,qe=Pe+P-y,ft={target:{element:te,left:N.left,top:N.top,width:w,height:P},element:{element:W,left:c.left,top:c.top,width:re,height:y},horizontal:je<0?"left":Re>0?"right":"center",vertical:qe<0?"top":Pe>0?"bottom":"middle"};w<re&&f(Re+je)<w&&(ft.horizontal="center"),P<y&&f(Pe+qe)<P&&(ft.vertical="middle"),m(f(Re),f(je))>m(f(Pe),f(qe))?ft.important="horizontal":ft.important="vertical",S.using.call(this,De,ft)}),W.offset(e.extend(c,{using:H}))})},e.ui.position={fit:{left:function(S,h){var w=h.within,P=w.isWindow?w.scrollLeft:w.offset.left,N=w.width,X=S.left-h.collisionPosition.marginLeft,te=P-X,ne=X+h.collisionWidth-N-P,K;h.collisionWidth>N?te>0&&ne<=0?(K=S.left+te+h.collisionWidth-N-P,S.left+=te-K):ne>0&&te<=0?S.left=P:te>ne?S.left=P+N-h.collisionWidth:S.left=P:te>0?S.left+=te:ne>0?S.left-=ne:S.left=m(S.left-X,S.left)},top:function(S,h){var w=h.within,P=w.isWindow?w.scrollTop:w.offset.top,N=h.within.height,X=S.top-h.collisionPosition.marginTop,te=P-X,ne=X+h.collisionHeight-N-P,K;h.collisionHeight>N?te>0&&ne<=0?(K=S.top+te+h.collisionHeight-N-P,S.top+=te-K):ne>0&&te<=0?S.top=P:te>ne?S.top=P+N-h.collisionHeight:S.top=P:te>0?S.top+=te:ne>0?S.top-=ne:S.top=m(S.top-X,S.top)}},flip:{left:function(S,h){var w=h.within,P=w.offset.left+w.scrollLeft,N=w.width,X=w.isWindow?w.scrollLeft:w.offset.left,te=S.left-h.collisionPosition.marginLeft,ne=te-X,K=te+h.collisionWidth-N-X,M=h.my[0]==="left"?-h.elemWidth:h.my[0]==="right"?h.elemWidth:0,J=h.at[0]==="left"?h.targetWidth:h.at[0]==="right"?-h.targetWidth:0,U=-2*h.offset[0],F,H;ne<0?(F=S.left+M+J+U+h.collisionWidth-N-P,(F<0||F<f(ne))&&(S.left+=M+J+U)):K>0&&(H=S.left-h.collisionPosition.marginLeft+M+J+U-X,(H>0||f(H)<K)&&(S.left+=M+J+U))},top:function(S,h){var w=h.within,P=w.offset.top+w.scrollTop,N=w.height,X=w.isWindow?w.scrollTop:w.offset.top,te=S.top-h.collisionPosition.marginTop,ne=te-X,K=te+h.collisionHeight-N-X,M=h.my[1]==="top",J=M?-h.elemHeight:h.my[1]==="bottom"?h.elemHeight:0,U=h.at[1]==="top"?h.targetHeight:h.at[1]==="bottom"?-h.targetHeight:0,F=-2*h.offset[1],H,W;ne<0?(W=S.top+J+U+F+h.collisionHeight-N-P,S.top+J+U+F>ne&&(W<0||W<f(ne))&&(S.top+=J+U+F)):K>0&&(H=S.top-h.collisionPosition.marginTop+J+U+F-X,S.top+J+U+F>K&&(H>0||f(H)<K)&&(S.top+=J+U+F))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},(function(){var S,h,w,P,N,X=document.getElementsByTagName("body")[0],te=document.createElement("div");S=document.createElement(X?"div":"body"),w={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},X&&e.extend(w,{position:"absolute",left:"-1000px",top:"-1000px"});for(N in w)S.style[N]=w[N];S.appendChild(te),h=X||document.documentElement,h.insertBefore(S,h.firstChild),te.style.cssText="position: absolute; left: 10.7432222px;",P=e(te).offset().left,e.support.offsetFractions=P>10&&P<11,S.innerHTML="",h.removeChild(S)})(),e.uiBackCompat!==!1&&(function(S){var h=S.fn.position;S.fn.position=function(w){if(!w||!w.offset)return h.call(this,w);var P=w.offset.split(" "),N=w.at.split(" ");return P.length===1&&(P[1]=P[0]),/^\d/.test(P[0])&&(P[0]="+"+P[0]),/^\d/.test(P[1])&&(P[1]="+"+P[1]),N.length===1&&(/left|center|right/.test(N[0])?N[1]="center":(N[1]=N[0],N[0]="center")),h.call(this,S.extend(w,{at:N[0]+P[0]+" "+N[1]+P[1],offset:r}))}})(jQuery)})(jQuery),(function(e,r){e.widget("ui.draggable",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(_){var p=this.options;return this.helper||p.disabled||e(_.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(_),this.handle?(e(p.iframeFix===!0?"iframe":p.iframeFix).each(function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(_){var p=this.options;return this.helper=this._createHelper(_),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:_.pageX-this.offset.left,top:_.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(_),this.originalPageX=_.pageX,this.originalPageY=_.pageY,p.cursorAt&&this._adjustOffsetFromHelper(p.cursorAt),p.containment&&this._setContainment(),this._trigger("start",_)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!p.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,_),this._mouseDrag(_,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,_),!0)},_mouseDrag:function(_,p){if(this.position=this._generatePosition(_),this.positionAbs=this._convertPositionTo("absolute"),!p){var s=this._uiHash();if(this._trigger("drag",_,s)===!1)return this._mouseUp({}),!1;this.position=s.position}return(!this.options.axis||this.options.axis!="y")&&(this.helper[0].style.left=this.position.left+"px"),(!this.options.axis||this.options.axis!="x")&&(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,_),!1},_mouseStop:function(_){var p=!1;e.ui.ddmanager&&!this.options.dropBehaviour&&(p=e.ui.ddmanager.drop(this,_)),this.dropped&&(p=this.dropped,this.dropped=!1);for(var s=this.element[0],m=!1;s&&(s=s.parentNode);)s==document&&(m=!0);if(!m&&this.options.helper==="original")return!1;if(this.options.revert=="invalid"&&!p||this.options.revert=="valid"&&p||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,p)){var f=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){f._trigger("stop",_)!==!1&&f._clear()})}else this._trigger("stop",_)!==!1&&this._clear();return!1},_mouseUp:function(_){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,_),e.ui.mouse.prototype._mouseUp.call(this,_)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(_){var p=!this.options.handle||!e(this.options.handle,this.element).length;return e(this.options.handle,this.element).find("*").andSelf().each(function(){this==_.target&&(p=!0)}),p},_createHelper:function(_){var p=this.options,s=e.isFunction(p.helper)?e(p.helper.apply(this.element[0],[_])):p.helper=="clone"?this.element.clone().removeAttr("id"):this.element;return s.parents("body").length||s.appendTo(p.appendTo=="parent"?this.element[0].parentNode:p.appendTo),s[0]!=this.element[0]&&!/(fixed|absolute)/.test(s.css("position"))&&s.css("position","absolute"),s},_adjustOffsetFromHelper:function(_){typeof _=="string"&&(_=_.split(" ")),e.isArray(_)&&(_={left:+_[0],top:+_[1]||0}),"left"in _&&(this.offset.click.left=_.left+this.margins.left),"right"in _&&(this.offset.click.left=this.helperProportions.width-_.right+this.margins.left),"top"in _&&(this.offset.click.top=_.top+this.margins.top),"bottom"in _&&(this.offset.click.top=this.helperProportions.height-_.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var _=this.offsetParent.offset();return this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(_.left+=this.scrollParent.scrollLeft(),_.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.ui.ie)&&(_={top:0,left:0}),{top:_.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:_.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var _=this.element.position();return{top:_.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:_.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var _=this.options;if(_.containment=="parent"&&(_.containment=this.helper[0].parentNode),(_.containment=="document"||_.containment=="window")&&(this.containment=[_.containment=="document"?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,_.containment=="document"?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(_.containment=="document"?0:e(window).scrollLeft())+e(_.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(_.containment=="document"?0:e(window).scrollTop())+(e(_.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),!/^(document|window|parent)$/.test(_.containment)&&_.containment.constructor!=Array){var p=e(_.containment),s=p[0];if(!s)return;var m=p.offset(),f=e(s).css("overflow")!="hidden";this.containment=[(parseInt(e(s).css("borderLeftWidth"),10)||0)+(parseInt(e(s).css("paddingLeft"),10)||0),(parseInt(e(s).css("borderTopWidth"),10)||0)+(parseInt(e(s).css("paddingTop"),10)||0),(f?Math.max(s.scrollWidth,s.offsetWidth):s.offsetWidth)-(parseInt(e(s).css("borderLeftWidth"),10)||0)-(parseInt(e(s).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(f?Math.max(s.scrollHeight,s.offsetHeight):s.offsetHeight)-(parseInt(e(s).css("borderTopWidth"),10)||0)-(parseInt(e(s).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=p}else _.containment.constructor==Array&&(this.containment=_.containment)},_convertPositionTo:function(_,p){p||(p=this.position);var s=_=="absolute"?1:-1,m=this.options,f=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,T=/(html|body)/i.test(f[0].tagName);return{top:p.top+this.offset.relative.top*s+this.offset.parent.top*s-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():T?0:f.scrollTop())*s,left:p.left+this.offset.relative.left*s+this.offset.parent.left*s-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():T?0:f.scrollLeft())*s}},_generatePosition:function(_){var p=this.options,s=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,m=/(html|body)/i.test(s[0].tagName),f=_.pageX,T=_.pageY;if(this.originalPosition){var k;if(this.containment){if(this.relative_container){var D=this.relative_container.offset();k=[this.containment[0]+D.left,this.containment[1]+D.top,this.containment[2]+D.left,this.containment[3]+D.top]}else k=this.containment;_.pageX-this.offset.click.left<k[0]&&(f=k[0]+this.offset.click.left),_.pageY-this.offset.click.top<k[1]&&(T=k[1]+this.offset.click.top),_.pageX-this.offset.click.left>k[2]&&(f=k[2]+this.offset.click.left),_.pageY-this.offset.click.top>k[3]&&(T=k[3]+this.offset.click.top)}if(p.grid){var V=p.grid[1]?this.originalPageY+Math.round((T-this.originalPageY)/p.grid[1])*p.grid[1]:this.originalPageY;T=k&&(V-this.offset.click.top<k[1]||V-this.offset.click.top>k[3])?V-this.offset.click.top<k[1]?V+p.grid[1]:V-p.grid[1]:V;var O=p.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/p.grid[0])*p.grid[0]:this.originalPageX;f=k&&(O-this.offset.click.left<k[0]||O-this.offset.click.left>k[2])?O-this.offset.click.left<k[0]?O+p.grid[0]:O-p.grid[0]:O}}return{top:T-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():m?0:s.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():m?0:s.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(_,p,s){return s=s||this._uiHash(),e.ui.plugin.call(this,_,[p,s]),_=="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,_,p,s)},plugins:{},_uiHash:function(_){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(_,p){var s=e(this).data("draggable"),m=s.options,f=e.extend({},p,{item:s.element});s.sortables=[],e(m.connectToSortable).each(function(){var T=e.data(this,"sortable");T&&!T.options.disabled&&(s.sortables.push({instance:T,shouldRevert:T.options.revert}),T.refreshPositions(),T._trigger("activate",_,f))})},stop:function(_,p){var s=e(this).data("draggable"),m=e.extend({},p,{item:s.element});e.each(s.sortables,function(){this.instance.isOver?(this.instance.isOver=0,s.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(_),this.instance.options.helper=this.instance.options._helper,s.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",_,m))})},drag:function(_,p){var s=e(this).data("draggable"),m=this,f=function(T){var k=this.offset.click.top,D=this.offset.click.left,V=this.positionAbs.top,O=this.positionAbs.left,b=T.height,R=T.width,S=T.top,h=T.left;return e.ui.isOver(V+k,O+D,S,h,b,R)};e.each(s.sortables,function(T){var k=!1,D=this;this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(k=!0,e.each(s.sortables,function(){return this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this!=D&&this.instance._intersectsWith(this.instance.containerCache)&&e.ui.contains(D.instance.element[0],this.instance.element[0])&&(k=!1),k})),k?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(m).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return p.helper[0]},_.target=this.instance.currentItem[0],this.instance._mouseCapture(_,!0),this.instance._mouseStart(_,!0,!0),this.instance.offset.click.top=s.offset.click.top,this.instance.offset.click.left=s.offset.click.left,this.instance.offset.parent.left-=s.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=s.offset.parent.top-this.instance.offset.parent.top,s._trigger("toSortable",_),s.dropped=this.instance.element,s.currentItem=s.element,this.instance.fromOutside=s),this.instance.currentItem&&this.instance._mouseDrag(_)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",_,this.instance._uiHash(this.instance)),this.instance._mouseStop(_,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),s._trigger("fromSortable",_),s.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(_,p){var s=e("body"),m=e(this).data("draggable").options;s.css("cursor")&&(m._cursor=s.css("cursor")),s.css("cursor",m.cursor)},stop:function(_,p){var s=e(this).data("draggable").options;s._cursor&&e("body").css("cursor",s._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(_,p){var s=e(p.helper),m=e(this).data("draggable").options;s.css("opacity")&&(m._opacity=s.css("opacity")),s.css("opacity",m.opacity)},stop:function(_,p){var s=e(this).data("draggable").options;s._opacity&&e(p.helper).css("opacity",s._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(_,p){var s=e(this).data("draggable");s.scrollParent[0]!=document&&s.scrollParent[0].tagName!="HTML"&&(s.overflowOffset=s.scrollParent.offset())},drag:function(_,p){var s=e(this).data("draggable"),m=s.options,f=!1;s.scrollParent[0]!=document&&s.scrollParent[0].tagName!="HTML"?((!m.axis||m.axis!="x")&&(s.overflowOffset.top+s.scrollParent[0].offsetHeight-_.pageY<m.scrollSensitivity?s.scrollParent[0].scrollTop=f=s.scrollParent[0].scrollTop+m.scrollSpeed:_.pageY-s.overflowOffset.top<m.scrollSensitivity&&(s.scrollParent[0].scrollTop=f=s.scrollParent[0].scrollTop-m.scrollSpeed)),(!m.axis||m.axis!="y")&&(s.overflowOffset.left+s.scrollParent[0].offsetWidth-_.pageX<m.scrollSensitivity?s.scrollParent[0].scrollLeft=f=s.scrollParent[0].scrollLeft+m.scrollSpeed:_.pageX-s.overflowOffset.left<m.scrollSensitivity&&(s.scrollParent[0].scrollLeft=f=s.scrollParent[0].scrollLeft-m.scrollSpeed))):((!m.axis||m.axis!="x")&&(_.pageY-e(document).scrollTop()<m.scrollSensitivity?f=e(document).scrollTop(e(document).scrollTop()-m.scrollSpeed):e(window).height()-(_.pageY-e(document).scrollTop())<m.scrollSensitivity&&(f=e(document).scrollTop(e(document).scrollTop()+m.scrollSpeed))),(!m.axis||m.axis!="y")&&(_.pageX-e(document).scrollLeft()<m.scrollSensitivity?f=e(document).scrollLeft(e(document).scrollLeft()-m.scrollSpeed):e(window).width()-(_.pageX-e(document).scrollLeft())<m.scrollSensitivity&&(f=e(document).scrollLeft(e(document).scrollLeft()+m.scrollSpeed)))),f!==!1&&e.ui.ddmanager&&!m.dropBehaviour&&e.ui.ddmanager.prepareOffsets(s,_)}}),e.ui.plugin.add("draggable","snap",{start:function(_,p){var s=e(this).data("draggable"),m=s.options;s.snapElements=[],e(m.snap.constructor!=String?m.snap.items||":data(draggable)":m.snap).each(function(){var f=e(this),T=f.offset();this!=s.element[0]&&s.snapElements.push({item:this,width:f.outerWidth(),height:f.outerHeight(),top:T.top,left:T.left})})},drag:function(_,p){for(var s=e(this).data("draggable"),m=s.options,f=m.snapTolerance,T=p.offset.left,k=T+s.helperProportions.width,D=p.offset.top,V=D+s.helperProportions.height,O=s.snapElements.length-1;O>=0;O--){var b=s.snapElements[O].left,R=b+s.snapElements[O].width,S=s.snapElements[O].top,h=S+s.snapElements[O].height;if(!(b-f<T&&T<R+f&&S-f<D&&D<h+f||b-f<T&&T<R+f&&S-f<V&&V<h+f||b-f<k&&k<R+f&&S-f<D&&D<h+f||b-f<k&&k<R+f&&S-f<V&&V<h+f)){s.snapElements[O].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,_,e.extend(s._uiHash(),{snapItem:s.snapElements[O].item})),s.snapElements[O].snapping=!1;continue}if(m.snapMode!="inner"){var w=Math.abs(S-V)<=f,P=Math.abs(h-D)<=f,N=Math.abs(b-k)<=f,X=Math.abs(R-T)<=f;w&&(p.position.top=s._convertPositionTo("relative",{top:S-s.helperProportions.height,left:0}).top-s.margins.top),P&&(p.position.top=s._convertPositionTo("relative",{top:h,left:0}).top-s.margins.top),N&&(p.position.left=s._convertPositionTo("relative",{top:0,left:b-s.helperProportions.width}).left-s.margins.left),X&&(p.position.left=s._convertPositionTo("relative",{top:0,left:R}).left-s.margins.left)}var te=w||P||N||X;if(m.snapMode!="outer"){var w=Math.abs(S-D)<=f,P=Math.abs(h-V)<=f,N=Math.abs(b-T)<=f,X=Math.abs(R-k)<=f;w&&(p.position.top=s._convertPositionTo("relative",{top:S,left:0}).top-s.margins.top),P&&(p.position.top=s._convertPositionTo("relative",{top:h-s.helperProportions.height,left:0}).top-s.margins.top),N&&(p.position.left=s._convertPositionTo("relative",{top:0,left:b}).left-s.margins.left),X&&(p.position.left=s._convertPositionTo("relative",{top:0,left:R-s.helperProportions.width}).left-s.margins.left)}!s.snapElements[O].snapping&&(w||P||N||X||te)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,_,e.extend(s._uiHash(),{snapItem:s.snapElements[O].item})),s.snapElements[O].snapping=w||P||N||X||te}}}),e.ui.plugin.add("draggable","stack",{start:function(_,p){var s=e(this).data("draggable").options,m=e.makeArray(e(s.stack)).sort(function(T,k){return(parseInt(e(T).css("zIndex"),10)||0)-(parseInt(e(k).css("zIndex"),10)||0)});if(m.length){var f=parseInt(m[0].style.zIndex)||0;e(m).each(function(T){this.style.zIndex=f+T}),this[0].style.zIndex=f+m.length}}}),e.ui.plugin.add("draggable","zIndex",{start:function(_,p){var s=e(p.helper),m=e(this).data("draggable").options;s.css("zIndex")&&(m._zIndex=s.css("zIndex")),s.css("zIndex",m.zIndex)},stop:function(_,p){var s=e(this).data("draggable").options;s._zIndex&&e(p.helper).css("zIndex",s._zIndex)}})})(jQuery),(function(e,r){e.widget("ui.droppable",{version:"1.9.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var _=this.options,p=_.accept;this.isover=0,this.isout=1,this.accept=e.isFunction(p)?p:function(s){return s.is(p)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[_.scope]=e.ui.ddmanager.droppables[_.scope]||[],e.ui.ddmanager.droppables[_.scope].push(this),_.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var _=e.ui.ddmanager.droppables[this.options.scope],p=0;p<_.length;p++)_[p]==this&&_.splice(p,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(_,p){_=="accept"&&(this.accept=e.isFunction(p)?p:function(s){return s.is(p)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(_){var p=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),p&&this._trigger("activate",_,this.ui(p))},_deactivate:function(_){var p=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),p&&this._trigger("deactivate",_,this.ui(p))},_over:function(_){var p=e.ui.ddmanager.current;!p||(p.currentItem||p.element)[0]==this.element[0]||this.accept.call(this.element[0],p.currentItem||p.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",_,this.ui(p)))},_out:function(_){var p=e.ui.ddmanager.current;!p||(p.currentItem||p.element)[0]==this.element[0]||this.accept.call(this.element[0],p.currentItem||p.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",_,this.ui(p)))},_drop:function(_,p){var s=p||e.ui.ddmanager.current;if(!s||(s.currentItem||s.element)[0]==this.element[0])return!1;var m=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var f=e.data(this,"droppable");if(f.options.greedy&&!f.options.disabled&&f.options.scope==s.options.scope&&f.accept.call(f.element[0],s.currentItem||s.element)&&e.ui.intersect(s,e.extend(f,{offset:f.element.offset()}),f.options.tolerance))return m=!0,!1}),m?!1:this.accept.call(this.element[0],s.currentItem||s.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",_,this.ui(s)),this.element):!1},ui:function(_){return{draggable:_.currentItem||_.element,helper:_.helper,position:_.position,offset:_.positionAbs}}}),e.ui.intersect=function(_,p,s){if(!p.offset)return!1;var m=(_.positionAbs||_.position.absolute).left,f=m+_.helperProportions.width,T=(_.positionAbs||_.position.absolute).top,k=T+_.helperProportions.height,D=p.offset.left,V=D+p.proportions.width,O=p.offset.top,b=O+p.proportions.height;switch(s){case"fit":return D<=m&&f<=V&&O<=T&&k<=b;case"intersect":return D<m+_.helperProportions.width/2&&f-_.helperProportions.width/2<V&&O<T+_.helperProportions.height/2&&k-_.helperProportions.height/2<b;case"pointer":var R=(_.positionAbs||_.position.absolute).left+(_.clickOffset||_.offset.click).left,S=(_.positionAbs||_.position.absolute).top+(_.clickOffset||_.offset.click).top,h=e.ui.isOver(S,R,O,D,p.proportions.height,p.proportions.width);return h;case"touch":return(T>=O&&T<=b||k>=O&&k<=b||T<O&&k>b)&&(m>=D&&m<=V||f>=D&&f<=V||m<D&&f>V);default:return!1}},e.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(_,p){var s=e.ui.ddmanager.droppables[_.options.scope]||[],m=p?p.type:null,f=(_.currentItem||_.element).find(":data(droppable)").andSelf();e:for(var T=0;T<s.length;T++)if(!(s[T].options.disabled||_&&!s[T].accept.call(s[T].element[0],_.currentItem||_.element))){for(var k=0;k<f.length;k++)if(f[k]==s[T].element[0]){s[T].proportions.height=0;continue e}s[T].visible=s[T].element.css("display")!="none",s[T].visible&&(m=="mousedown"&&s[T]._activate.call(s[T],p),s[T].offset=s[T].element.offset(),s[T].proportions={width:s[T].element[0].offsetWidth,height:s[T].element[0].offsetHeight})}},drop:function(_,p){var s=!1;return e.each(e.ui.ddmanager.droppables[_.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(_,this,this.options.tolerance)&&(s=this._drop.call(this,p)||s),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],_.currentItem||_.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,p)))}),s},dragStart:function(_,p){_.element.parentsUntil("body").bind("scroll.droppable",function(){_.options.refreshPositions||e.ui.ddmanager.prepareOffsets(_,p)})},drag:function(_,p){_.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(_,p),e.each(e.ui.ddmanager.droppables[_.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var s=e.ui.intersect(_,this,this.options.tolerance),m=!s&&this.isover==1?"isout":s&&this.isover==0?"isover":null;if(m){var f;if(this.options.greedy){var T=this.options.scope,k=this.element.parents(":data(droppable)").filter(function(){return e.data(this,"droppable").options.scope===T});k.length&&(f=e.data(k[0],"droppable"),f.greedyChild=m=="isover"?1:0)}f&&m=="isover"&&(f.isover=0,f.isout=1,f._out.call(f,p)),this[m]=1,this[m=="isout"?"isover":"isout"]=0,this[m=="isover"?"_over":"_out"].call(this,p),f&&m=="isout"&&(f.isout=0,f.isover=1,f._over.call(f,p))}}})},dragStop:function(_,p){_.element.parentsUntil("body").unbind("scroll.droppable"),_.options.refreshPositions||e.ui.ddmanager.prepareOffsets(_,p)}}})(jQuery),(function(e,r){e.widget("ui.sortable",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var _=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?_.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var _=this.items.length-1;_>=0;_--)this.items[_].item.removeData(this.widgetName+"-item");return this},_setOption:function(_,p){_==="disabled"?(this.options[_]=p,this.widget().toggleClass("ui-sortable-disabled",!!p)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(_,p){var s=this;if(this.reverting||this.options.disabled||this.options.type=="static")return!1;this._refreshItems(_);var m=null,f=e(_.target).parents().each(function(){if(e.data(this,s.widgetName+"-item")==s)return m=e(this),!1});if(e.data(_.target,s.widgetName+"-item")==s&&(m=e(_.target)),!m)return!1;if(this.options.handle&&!p){var T=!1;if(e(this.options.handle,m).find("*").andSelf().each(function(){this==_.target&&(T=!0)}),!T)return!1}return this.currentItem=m,this._removeCurrentsFromItems(),!0},_mouseStart:function(_,p,s){var m=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(_),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:_.pageX-this.offset.left,top:_.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(_),this.originalPageX=_.pageX,this.originalPageY=_.pageY,m.cursorAt&&this._adjustOffsetFromHelper(m.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),m.containment&&this._setContainment(),m.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",m.cursor)),m.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",m.opacity)),m.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",m.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",_,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(var f=this.containers.length-1;f>=0;f--)this.containers[f]._trigger("activate",_,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!m.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,_),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(_),!0},_mouseDrag:function(_){if(this.position=this._generatePosition(_),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll){var p=this.options,s=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-_.pageY<p.scrollSensitivity?this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop+p.scrollSpeed:_.pageY-this.overflowOffset.top<p.scrollSensitivity&&(this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop-p.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-_.pageX<p.scrollSensitivity?this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft+p.scrollSpeed:_.pageX-this.overflowOffset.left<p.scrollSensitivity&&(this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft-p.scrollSpeed)):(_.pageY-e(document).scrollTop()<p.scrollSensitivity?s=e(document).scrollTop(e(document).scrollTop()-p.scrollSpeed):e(window).height()-(_.pageY-e(document).scrollTop())<p.scrollSensitivity&&(s=e(document).scrollTop(e(document).scrollTop()+p.scrollSpeed)),_.pageX-e(document).scrollLeft()<p.scrollSensitivity?s=e(document).scrollLeft(e(document).scrollLeft()-p.scrollSpeed):e(window).width()-(_.pageX-e(document).scrollLeft())<p.scrollSensitivity&&(s=e(document).scrollLeft(e(document).scrollLeft()+p.scrollSpeed))),s!==!1&&e.ui.ddmanager&&!p.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,_)}this.positionAbs=this._convertPositionTo("absolute"),(!this.options.axis||this.options.axis!="y")&&(this.helper[0].style.left=this.position.left+"px"),(!this.options.axis||this.options.axis!="x")&&(this.helper[0].style.top=this.position.top+"px");for(var m=this.items.length-1;m>=0;m--){var f=this.items[m],T=f.item[0],k=this._intersectsWithPointer(f);if(k&&f.instance===this.currentContainer&&T!=this.currentItem[0]&&this.placeholder[k==1?"next":"prev"]()[0]!=T&&!e.contains(this.placeholder[0],T)&&(this.options.type!="semi-dynamic"||!e.contains(this.element[0],T))){if(this.direction=k==1?"down":"up",this.options.tolerance!="pointer"&&!this._intersectsWithSides(f))break;this._rearrange(_,f),this._trigger("change",_,this._uiHash());break}}return this._contactContainers(_),e.ui.ddmanager&&e.ui.ddmanager.drag(this,_),this._trigger("sort",_,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(_,p){if(_){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,_),this.options.revert){var s=this,m=this.placeholder.offset();this.reverting=!0,e(this.helper).animate({left:m.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:m.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){s._clear(_)})}else this._clear(_,p);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var _=this.containers.length-1;_>=0;_--)this.containers[_]._trigger("deactivate",null,this._uiHash(this)),this.containers[_].containerCache.over&&(this.containers[_]._trigger("out",null,this._uiHash(this)),this.containers[_].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(_){var p=this._getItemsAsjQuery(_&&_.connected),s=[];return _=_||{},e(p).each(function(){var m=(e(_.item||this).attr(_.attribute||"id")||"").match(_.expression||/(.+)[-=_](.+)/);m&&s.push((_.key||m[1]+"[]")+"="+(_.key&&_.expression?m[1]:m[2]))}),!s.length&&_.key&&s.push(_.key+"="),s.join("&")},toArray:function(_){var p=this._getItemsAsjQuery(_&&_.connected),s=[];return _=_||{},p.each(function(){s.push(e(_.item||this).attr(_.attribute||"id")||"")}),s},_intersectsWith:function(_){var p=this.positionAbs.left,s=p+this.helperProportions.width,m=this.positionAbs.top,f=m+this.helperProportions.height,T=_.left,k=T+_.width,D=_.top,V=D+_.height,O=this.offset.click.top,b=this.offset.click.left,R=m+O>D&&m+O<V&&p+b>T&&p+b<k;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>_[this.floating?"width":"height"]?R:T<p+this.helperProportions.width/2&&s-this.helperProportions.width/2<k&&D<m+this.helperProportions.height/2&&f-this.helperProportions.height/2<V},_intersectsWithPointer:function(_){var p=this.options.axis==="x"||e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,_.top,_.height),s=this.options.axis==="y"||e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,_.left,_.width),m=p&&s,f=this._getDragVerticalDirection(),T=this._getDragHorizontalDirection();return m?this.floating?T&&T=="right"||f=="down"?2:1:f&&(f=="down"?2:1):!1},_intersectsWithSides:function(_){var p=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,_.top+_.height/2,_.height),s=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,_.left+_.width/2,_.width),m=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?f=="right"&&s||f=="left"&&!s:m&&(m=="down"&&p||m=="up"&&!p)},_getDragVerticalDirection:function(){var _=this.positionAbs.top-this.lastPositionAbs.top;return _!=0&&(_>0?"down":"up")},_getDragHorizontalDirection:function(){var _=this.positionAbs.left-this.lastPositionAbs.left;return _!=0&&(_>0?"right":"left")},refresh:function(_){return this._refreshItems(_),this.refreshPositions(),this},_connectWith:function(){var _=this.options;return _.connectWith.constructor==String?[_.connectWith]:_.connectWith},_getItemsAsjQuery:function(_){var p=[],s=[],m=this._connectWith();if(m&&_)for(var f=m.length-1;f>=0;f--)for(var T=e(m[f]),k=T.length-1;k>=0;k--){var D=e.data(T[k],this.widgetName);D&&D!=this&&!D.options.disabled&&s.push([e.isFunction(D.options.items)?D.options.items.call(D.element):e(D.options.items,D.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),D])}s.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var f=s.length-1;f>=0;f--)s[f][0].each(function(){p.push(this)});return e(p)},_removeCurrentsFromItems:function(){var _=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(p){for(var s=0;s<_.length;s++)if(_[s]==p.item[0])return!1;return!0})},_refreshItems:function(_){this.items=[],this.containers=[this];var p=this.items,s=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],_,{item:this.currentItem}):e(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(var f=m.length-1;f>=0;f--)for(var T=e(m[f]),k=T.length-1;k>=0;k--){var D=e.data(T[k],this.widgetName);D&&D!=this&&!D.options.disabled&&(s.push([e.isFunction(D.options.items)?D.options.items.call(D.element[0],_,{item:this.currentItem}):e(D.options.items,D.element),D]),this.containers.push(D))}for(var f=s.length-1;f>=0;f--)for(var V=s[f][1],O=s[f][0],k=0,b=O.length;k<b;k++){var R=e(O[k]);R.data(this.widgetName+"-item",V),p.push({item:R,instance:V,width:0,height:0,left:0,top:0})}},refreshPositions:function(_){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var p=this.items.length-1;p>=0;p--){var s=this.items[p];if(!(s.instance!=this.currentContainer&&this.currentContainer&&s.item[0]!=this.currentItem[0])){var m=this.options.toleranceElement?e(this.options.toleranceElement,s.item):s.item;_||(s.width=m.outerWidth(),s.height=m.outerHeight());var f=m.offset();s.left=f.left,s.top=f.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var p=this.containers.length-1;p>=0;p--){var f=this.containers[p].element.offset();this.containers[p].containerCache.left=f.left,this.containers[p].containerCache.top=f.top,this.containers[p].containerCache.width=this.containers[p].element.outerWidth(),this.containers[p].containerCache.height=this.containers[p].element.outerHeight()}return this},_createPlaceholder:function(_){_=_||this;var p=_.options;if(!p.placeholder||p.placeholder.constructor==String){var s=p.placeholder;p.placeholder={element:function(){var m=e(document.createElement(_.currentItem[0].nodeName)).addClass(s||_.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return s||(m.style.visibility="hidden"),m},update:function(m,f){s&&!p.forcePlaceholderSize||(f.height()||f.height(_.currentItem.innerHeight()-parseInt(_.currentItem.css("paddingTop")||0,10)-parseInt(_.currentItem.css("paddingBottom")||0,10)),f.width()||f.width(_.currentItem.innerWidth()-parseInt(_.currentItem.css("paddingLeft")||0,10)-parseInt(_.currentItem.css("paddingRight")||0,10)))}}}_.placeholder=e(p.placeholder.element.call(_.element,_.currentItem)),_.currentItem.after(_.placeholder),p.placeholder.update(_,_.placeholder)},_contactContainers:function(_){for(var p=null,s=null,m=this.containers.length-1;m>=0;m--)if(!e.contains(this.currentItem[0],this.containers[m].element[0]))if(this._intersectsWith(this.containers[m].containerCache)){if(p&&e.contains(this.containers[m].element[0],p.element[0]))continue;p=this.containers[m],s=m}else this.containers[m].containerCache.over&&(this.containers[m]._trigger("out",_,this._uiHash(this)),this.containers[m].containerCache.over=0);if(p)if(this.containers.length===1)this.containers[s]._trigger("over",_,this._uiHash(this)),this.containers[s].containerCache.over=1;else{for(var f=1e4,T=null,k=this.containers[s].floating?"left":"top",D=this.containers[s].floating?"width":"height",V=this.positionAbs[k]+this.offset.click[k],O=this.items.length-1;O>=0;O--)if(e.contains(this.containers[s].element[0],this.items[O].item[0])&&this.items[O].item[0]!=this.currentItem[0]){var b=this.items[O].item.offset()[k],R=!1;Math.abs(b-V)>Math.abs(b+this.items[O][D]-V)&&(R=!0,b+=this.items[O][D]),Math.abs(b-V)<f&&(f=Math.abs(b-V),T=this.items[O],this.direction=R?"up":"down")}if(!T&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[s],T?this._rearrange(_,T,null,!0):this._rearrange(_,null,this.containers[s].element,!0),this._trigger("change",_,this._uiHash()),this.containers[s]._trigger("change",_,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[s]._trigger("over",_,this._uiHash(this)),this.containers[s].containerCache.over=1}},_createHelper:function(_){var p=this.options,s=e.isFunction(p.helper)?e(p.helper.apply(this.element[0],[_,this.currentItem])):p.helper=="clone"?this.currentItem.clone():this.currentItem;return s.parents("body").length||e(p.appendTo!="parent"?p.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(s[0].style.width==""||p.forceHelperSize)&&s.width(this.currentItem.width()),(s[0].style.height==""||p.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(_){typeof _=="string"&&(_=_.split(" ")),e.isArray(_)&&(_={left:+_[0],top:+_[1]||0}),"left"in _&&(this.offset.click.left=_.left+this.margins.left),"right"in _&&(this.offset.click.left=this.helperProportions.width-_.right+this.margins.left),"top"in _&&(this.offset.click.top=_.top+this.margins.top),"bottom"in _&&(this.offset.click.top=this.helperProportions.height-_.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var _=this.offsetParent.offset();return this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(_.left+=this.scrollParent.scrollLeft(),_.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.ui.ie)&&(_={top:0,left:0}),{top:_.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:_.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var _=this.currentItem.position();return{top:_.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:_.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var _=this.options;if(_.containment=="parent"&&(_.containment=this.helper[0].parentNode),(_.containment=="document"||_.containment=="window")&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e(_.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(e(_.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),!/^(document|window|parent)$/.test(_.containment)){var p=e(_.containment)[0],s=e(_.containment).offset(),m=e(p).css("overflow")!="hidden";this.containment=[s.left+(parseInt(e(p).css("borderLeftWidth"),10)||0)+(parseInt(e(p).css("paddingLeft"),10)||0)-this.margins.left,s.top+(parseInt(e(p).css("borderTopWidth"),10)||0)+(parseInt(e(p).css("paddingTop"),10)||0)-this.margins.top,s.left+(m?Math.max(p.scrollWidth,p.offsetWidth):p.offsetWidth)-(parseInt(e(p).css("borderLeftWidth"),10)||0)-(parseInt(e(p).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,s.top+(m?Math.max(p.scrollHeight,p.offsetHeight):p.offsetHeight)-(parseInt(e(p).css("borderTopWidth"),10)||0)-(parseInt(e(p).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(_,p){p||(p=this.position);var s=_=="absolute"?1:-1,m=this.options,f=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,T=/(html|body)/i.test(f[0].tagName);return{top:p.top+this.offset.relative.top*s+this.offset.parent.top*s-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():T?0:f.scrollTop())*s,left:p.left+this.offset.relative.left*s+this.offset.parent.left*s-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():T?0:f.scrollLeft())*s}},_generatePosition:function(_){var p=this.options,s=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,m=/(html|body)/i.test(s[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var f=_.pageX,T=_.pageY;if(this.originalPosition&&(this.containment&&(_.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),_.pageY-this.offset.click.top<this.containment[1]&&(T=this.containment[1]+this.offset.click.top),_.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),_.pageY-this.offset.click.top>this.containment[3]&&(T=this.containment[3]+this.offset.click.top)),p.grid)){var k=this.originalPageY+Math.round((T-this.originalPageY)/p.grid[1])*p.grid[1];T=this.containment&&(k-this.offset.click.top<this.containment[1]||k-this.offset.click.top>this.containment[3])?k-this.offset.click.top<this.containment[1]?k+p.grid[1]:k-p.grid[1]:k;var D=this.originalPageX+Math.round((f-this.originalPageX)/p.grid[0])*p.grid[0];f=this.containment&&(D-this.offset.click.left<this.containment[0]||D-this.offset.click.left>this.containment[2])?D-this.offset.click.left<this.containment[0]?D+p.grid[0]:D-p.grid[0]:D}return{top:T-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():m?0:s.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():m?0:s.scrollLeft())}},_rearrange:function(_,p,s,m){s?s[0].appendChild(this.placeholder[0]):p.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?p.item[0]:p.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var f=this.counter;this._delay(function(){f==this.counter&&this.refreshPositions(!m)})},_clear:function(_,p){this.reverting=!1;var s=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]==this.currentItem[0]){for(var m in this._storedCSS)(this._storedCSS[m]=="auto"||this._storedCSS[m]=="static")&&(this._storedCSS[m]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!p&&s.push(function(f){this._trigger("receive",f,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!p&&s.push(function(f){this._trigger("update",f,this._uiHash())}),this!==this.currentContainer&&(p||(s.push(function(f){this._trigger("remove",f,this._uiHash())}),s.push(function(f){return function(T){f._trigger("receive",T,this._uiHash(this))}}.call(this,this.currentContainer)),s.push(function(f){return function(T){f._trigger("update",T,this._uiHash(this))}}.call(this,this.currentContainer))));for(var m=this.containers.length-1;m>=0;m--)p||s.push(function(T){return function(k){T._trigger("deactivate",k,this._uiHash(this))}}.call(this,this.containers[m])),this.containers[m].containerCache.over&&(s.push(function(T){return function(k){T._trigger("out",k,this._uiHash(this))}}.call(this,this.containers[m])),this.containers[m].containerCache.over=0);if(this._storedCursor&&e("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!p){this._trigger("beforeStop",_,this._uiHash());for(var m=0;m<s.length;m++)s[m].call(this,_);this._trigger("stop",_,this._uiHash())}return this.fromOutside=!1,!1}if(p||this._trigger("beforeStop",_,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null,!p){for(var m=0;m<s.length;m++)s[m].call(this,_);this._trigger("stop",_,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(_){var p=_||this;return{helper:p.helper,placeholder:p.placeholder||e([]),position:p.position,originalPosition:p.originalPosition,offset:p.positionAbs,item:p.currentItem,sender:_?_.element:null}}})})(jQuery),(function(e,r){var _=0;e.widget("ui.autocomplete",{version:"1.9.2",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var p,s,m;this.isMultiLine=this._isMultiLine(),this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(f){if(this.element.prop("readOnly")){p=!0,m=!0,s=!0;return}p=!1,m=!1,s=!1;var T=e.ui.keyCode;switch(f.keyCode){case T.PAGE_UP:p=!0,this._move("previousPage",f);break;case T.PAGE_DOWN:p=!0,this._move("nextPage",f);break;case T.UP:p=!0,this._keyEvent("previous",f);break;case T.DOWN:p=!0,this._keyEvent("next",f);break;case T.ENTER:case T.NUMPAD_ENTER:this.menu.active&&(p=!0,f.preventDefault(),this.menu.select(f));break;case T.TAB:this.menu.active&&this.menu.select(f);break;case T.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(f),f.preventDefault());break;default:s=!0,this._searchTimeout(f)}},keypress:function(f){if(p){p=!1,f.preventDefault();return}if(!s){var T=e.ui.keyCode;switch(f.keyCode){case T.PAGE_UP:this._move("previousPage",f);break;case T.PAGE_DOWN:this._move("nextPage",f);break;case T.UP:this._keyEvent("previous",f);break;case T.DOWN:this._keyEvent("next",f)}}},input:function(f){if(m){m=!1,f.preventDefault();return}this._searchTimeout(f)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(f){if(this.cancelBlur){delete this.cancelBlur;return}clearTimeout(this.searching),this.close(f),this._change(f)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo||"body")[0]).menu({input:e(),role:null}).zIndex(this.element.zIndex()+1).hide().data("menu"),this._on(this.menu.element,{mousedown:function(f){f.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var T=this.menu.element[0];e(f.target).closest(".ui-menu-item").length||this._delay(function(){var k=this;this.document.one("mousedown",function(D){D.target!==k.element[0]&&D.target!==T&&!e.contains(T,D.target)&&k.close()})})},menufocus:function(f,T){if(this.isNewMenu&&(this.isNewMenu=!1,f.originalEvent&&/^mouse/.test(f.originalEvent.type))){this.menu.blur(),this.document.one("mousemove",function(){e(f.target).trigger(f.originalEvent)});return}var k=T.item.data("ui-autocomplete-item")||T.item.data("item.autocomplete");this._trigger("focus",f,{item:k})!==!1?f.originalEvent&&/^key/.test(f.originalEvent.type)&&this._value(k.value):this.liveRegion.text(k.value)},menuselect:function(f,T){var k=T.item.data("ui-autocomplete-item")||T.item.data("item.autocomplete"),D=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=D,this._delay(function(){this.previous=D,this.selectedItem=k})),this._trigger("select",f,{item:k})!==!1&&this._value(k.value),this.term=this._value(),this.close(f),this.selectedItem=k}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element),e.fn.bgiframe&&this.menu.element.bgiframe(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(p,s){this._super(p,s),p==="source"&&this._initSource(),p==="appendTo"&&this.menu.element.appendTo(this.document.find(s||"body")[0]),p==="disabled"&&s&&this.xhr&&this.xhr.abort()},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var p,s,m=this;e.isArray(this.options.source)?(p=this.options.source,this.source=function(f,T){T(e.ui.autocomplete.filter(p,f.term))}):typeof this.options.source=="string"?(s=this.options.source,this.source=function(f,T){m.xhr&&m.xhr.abort(),m.xhr=e.ajax({url:s,data:f,dataType:"json",success:function(k){T(k)},error:function(){T([])}})}):this.source=this.options.source},_searchTimeout:function(p){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,p))},this.options.delay)},search:function(p,s){if(p=p!=null?p:this._value(),this.term=this._value(),p.length<this.options.minLength)return this.close(s);if(this._trigger("search",s)!==!1)return this._search(p)},_search:function(p){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:p},this._response())},_response:function(){var p=this,s=++_;return function(m){s===_&&p.__response(m),p.pending--,p.pending||p.element.removeClass("ui-autocomplete-loading")}},__response:function(p){p&&(p=this._normalize(p)),this._trigger("response",null,{content:p}),!this.options.disabled&&p&&p.length&&!this.cancelSearch?(this._suggest(p),this._trigger("open")):this._close()},close:function(p){this.cancelSearch=!0,this._close(p)},_close:function(p){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",p))},_change:function(p){this.previous!==this._value()&&this._trigger("change",p,{item:this.selectedItem})},_normalize:function(p){return p.length&&p[0].label&&p[0].value?p:e.map(p,function(s){return typeof s=="string"?{label:s,value:s}:e.extend({label:s.label||s.value,value:s.value||s.label},s)})},_suggest:function(p){var s=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(s,p),this.menu.refresh(),s.show(),this._resizeMenu(),s.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var p=this.menu.element;p.outerWidth(Math.max(p.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(p,s){var m=this;e.each(s,function(f,T){m._renderItemData(p,T)})},_renderItemData:function(p,s){return this._renderItem(p,s).data("ui-autocomplete-item",s)},_renderItem:function(p,s){return e("<li>").append(e("<a>").text(s.label)).appendTo(p)},_move:function(p,s){if(!this.menu.element.is(":visible")){this.search(null,s);return}if(this.menu.isFirstItem()&&/^previous/.test(p)||this.menu.isLastItem()&&/^next/.test(p)){this._value(this.term),this.menu.blur();return}this.menu[p](s)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(p,s){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(p,s),s.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(p){return p.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(p,s){var m=new RegExp(e.ui.autocomplete.escapeRegex(s),"i");return e.grep(p,function(f){return m.test(f.label||f.value||f)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(p){return p+(p>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(p){var s;this._superApply(arguments),!(this.options.disabled||this.cancelSearch)&&(p&&p.length?s=this.options.messages.results(p.length):s=this.options.messages.noResults,this.liveRegion.text(s))}})})(jQuery),(function(e,r){var _=!1;e.widget("ui.menu",{version:"1.9.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(p){this.options.disabled&&p.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(p){p.preventDefault()},"click .ui-state-disabled > a":function(p){p.preventDefault()},"click .ui-menu-item:has(a)":function(p){var s=e(p.target).closest(".ui-menu-item");!_&&s.not(".ui-state-disabled").length&&(_=!0,this.select(p),s.has(".ui-menu").length?this.expand(p):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&this.active.parents(".ui-menu").length===1&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(p){var s=e(p.currentTarget);s.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(p,s)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(p,s){var m=this.active||this.element.children(".ui-menu-item").eq(0);s||this.focus(p,m)},blur:function(p){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(p)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(p){e(p.target).closest(".ui-menu").length||this.collapseAll(p),_=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var p=e(this);p.data("ui-menu-submenu-carat")&&p.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(p){function s(O){return O.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var m,f,T,k,D,V=!0;switch(p.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(p);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(p);break;case e.ui.keyCode.HOME:this._move("first","first",p);break;case e.ui.keyCode.END:this._move("last","last",p);break;case e.ui.keyCode.UP:this.previous(p);break;case e.ui.keyCode.DOWN:this.next(p);break;case e.ui.keyCode.LEFT:this.collapse(p);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(p);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(p);break;case e.ui.keyCode.ESCAPE:this.collapse(p);break;default:V=!1,f=this.previousFilter||"",T=String.fromCharCode(p.keyCode),k=!1,clearTimeout(this.filterTimer),T===f?k=!0:T=f+T,D=new RegExp("^"+s(T),"i"),m=this.activeMenu.children(".ui-menu-item").filter(function(){return D.test(e(this).children("a").text())}),m=k&&m.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):m,m.length||(T=String.fromCharCode(p.keyCode),D=new RegExp("^"+s(T),"i"),m=this.activeMenu.children(".ui-menu-item").filter(function(){return D.test(e(this).children("a").text())})),m.length?(this.focus(p,m),m.length>1?(this.previousFilter=T,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}V&&p.preventDefault()},_activate:function(p){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(p):this.select(p))},refresh:function(){var p,s=this.options.icons.submenu,m=this.element.find(this.options.menus);m.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var f=e(this),T=f.prev("a"),k=e("<span>").addClass("ui-menu-icon ui-icon "+s).data("ui-menu-submenu-carat",!0);T.attr("aria-haspopup","true").prepend(k),f.attr("aria-labelledby",T.attr("id"))}),p=m.add(this.element),p.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),p.children(":not(.ui-menu-item)").each(function(){var f=e(this);/[^\-\s]/.test(f.text())||f.addClass("ui-widget-content ui-menu-divider")}),p.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(p,s){var m,f;this.blur(p,p&&p.type==="focus"),this._scrollIntoView(s),this.active=s.first(),f=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",f.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),p&&p.type==="keydown"?this._close():this.timer=this._delay(function(){this._close()},this.delay),m=s.children(".ui-menu"),m.length&&/^mouse/.test(p.type)&&this._startOpening(m),this.activeMenu=s.parent(),this._trigger("focus",p,{item:s})},_scrollIntoView:function(p){var s,m,f,T,k,D;this._hasScroll()&&(s=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,m=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,f=p.offset().top-this.activeMenu.offset().top-s-m,T=this.activeMenu.scrollTop(),k=this.activeMenu.height(),D=p.height(),f<0?this.activeMenu.scrollTop(T+f):f+D>k&&this.activeMenu.scrollTop(T+f-k+D))},blur:function(p,s){s||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",p,{item:this.active}))},_startOpening:function(p){clearTimeout(this.timer),p.attr("aria-hidden")==="true"&&(this.timer=this._delay(function(){this._close(),this._open(p)},this.delay))},_open:function(p){var s=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(p.parents(".ui-menu")).hide().attr("aria-hidden","true"),p.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(s)},collapseAll:function(p,s){clearTimeout(this.timer),this.timer=this._delay(function(){var m=s?this.element:e(p&&p.target).closest(this.element.find(".ui-menu"));m.length||(m=this.element),this._close(m),this.blur(p),this.activeMenu=m},this.delay)},_close:function(p){p||(p=this.active?this.active.parent():this.element),p.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(p){var s=this.active&&this.active.parent().closest(".ui-menu-item",this.element);s&&s.length&&(this._close(),this.focus(p,s))},expand:function(p){var s=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();s&&s.length&&(this._open(s.parent()),this._delay(function(){this.focus(p,s)}))},next:function(p){this._move("next","first",p)},previous:function(p){this._move("prev","last",p)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(p,s,m){var f;this.active&&(p==="first"||p==="last"?f=this.active[p==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):f=this.active[p+"All"](".ui-menu-item").eq(0)),(!f||!f.length||!this.active)&&(f=this.activeMenu.children(".ui-menu-item")[s]()),this.focus(m,f)},nextPage:function(p){var s,m,f;if(!this.active){this.next(p);return}this.isLastItem()||(this._hasScroll()?(m=this.active.offset().top,f=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return s=e(this),s.offset().top-m-f<0}),this.focus(p,s)):this.focus(p,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))},previousPage:function(p){var s,m,f;if(!this.active){this.next(p);return}this.isFirstItem()||(this._hasScroll()?(m=this.active.offset().top,f=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return s=e(this),s.offset().top-m+f>0}),this.focus(p,s)):this.focus(p,this.activeMenu.children(".ui-menu-item").first()))},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(p){this.active=this.active||e(p.target).closest(".ui-menu-item");var s={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(p,!0),this._trigger("select",p,s)}})})(jQuery),(function(e,r){var _=5;e.widget("ui.slider",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var p,s,m=this.options,f=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),T="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",k=[];for(this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(m.disabled?" ui-slider-disabled ui-disabled":"")),this.range=e([]),m.range&&(m.range===!0&&(m.values||(m.values=[this._valueMin(),this._valueMin()]),m.values.length&&m.values.length!==2&&(m.values=[m.values[0],m.values[0]])),this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(m.range==="min"||m.range==="max"?" ui-slider-range-"+m.range:""))),s=m.values&&m.values.length||1,p=f.length;p<s;p++)k.push(T);this.handles=f.add(e(k.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(D){D.preventDefault()}).mouseenter(function(){m.disabled||e(this).addClass("ui-state-hover")}).mouseleave(function(){e(this).removeClass("ui-state-hover")}).focus(function(){m.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")}),this.handles.each(function(D){e(this).data("ui-slider-handle-index",D)}),this._on(this.handles,{keydown:function(D){var V,O,b,R,S=e(D.target).data("ui-slider-handle-index");switch(D.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(D.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(D.target).addClass("ui-state-active"),V=this._start(D,S),V===!1))return}switch(R=this.options.step,this.options.values&&this.options.values.length?O=b=this.values(S):O=b=this.value(),D.keyCode){case e.ui.keyCode.HOME:b=this._valueMin();break;case e.ui.keyCode.END:b=this._valueMax();break;case e.ui.keyCode.PAGE_UP:b=this._trimAlignValue(O+(this._valueMax()-this._valueMin())/_);break;case e.ui.keyCode.PAGE_DOWN:b=this._trimAlignValue(O-(this._valueMax()-this._valueMin())/_);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(O===this._valueMax())return;b=this._trimAlignValue(O+R);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(O===this._valueMin())return;b=this._trimAlignValue(O-R)}this._slide(D,S,b)},keyup:function(D){var V=e(D.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(D,V),this._change(D,V),e(D.target).removeClass("ui-state-active"))}}),this._refreshValue(),this._animateOff=!1},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(p){var s,m,f,T,k,D,V,O,b=this,R=this.options;return R.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),s={x:p.pageX,y:p.pageY},m=this._normValueFromMouse(s),f=this._valueMax()-this._valueMin()+1,this.handles.each(function(S){var h=Math.abs(m-b.values(S));f>h&&(f=h,T=e(this),k=S)}),R.range===!0&&this.values(1)===R.min&&(k+=1,T=e(this.handles[k])),D=this._start(p,k),D===!1?!1:(this._mouseSliding=!0,this._handleIndex=k,T.addClass("ui-state-active").focus(),V=T.offset(),O=!e(p.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=O?{left:0,top:0}:{left:p.pageX-V.left-T.width()/2,top:p.pageY-V.top-T.height()/2-(parseInt(T.css("borderTopWidth"),10)||0)-(parseInt(T.css("borderBottomWidth"),10)||0)+(parseInt(T.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(p,k,m),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(p){var s={x:p.pageX,y:p.pageY},m=this._normValueFromMouse(s);return this._slide(p,this._handleIndex,m),!1},_mouseStop:function(p){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(p,this._handleIndex),this._change(p,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(p){var s,m,f,T,k;return this.orientation==="horizontal"?(s=this.elementSize.width,m=p.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(s=this.elementSize.height,m=p.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),f=m/s,f>1&&(f=1),f<0&&(f=0),this.orientation==="vertical"&&(f=1-f),T=this._valueMax()-this._valueMin(),k=this._valueMin()+f*T,this._trimAlignValue(k)},_start:function(p,s){var m={handle:this.handles[s],value:this.value()};return this.options.values&&this.options.values.length&&(m.value=this.values(s),m.values=this.values()),this._trigger("start",p,m)},_slide:function(p,s,m){var f,T,k;this.options.values&&this.options.values.length?(f=this.values(s?0:1),this.options.values.length===2&&this.options.range===!0&&(s===0&&m>f||s===1&&m<f)&&(m=f),m!==this.values(s)&&(T=this.values(),T[s]=m,k=this._trigger("slide",p,{handle:this.handles[s],value:m,values:T}),f=this.values(s?0:1),k!==!1&&this.values(s,m,!0))):m!==this.value()&&(k=this._trigger("slide",p,{handle:this.handles[s],value:m}),k!==!1&&this.value(m))},_stop:function(p,s){var m={handle:this.handles[s],value:this.value()};this.options.values&&this.options.values.length&&(m.value=this.values(s),m.values=this.values()),this._trigger("stop",p,m)},_change:function(p,s){if(!this._keySliding&&!this._mouseSliding){var m={handle:this.handles[s],value:this.value()};this.options.values&&this.options.values.length&&(m.value=this.values(s),m.values=this.values()),this._trigger("change",p,m)}},value:function(p){if(arguments.length){this.options.value=this._trimAlignValue(p),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(p,s){var m,f,T;if(arguments.length>1){this.options.values[p]=this._trimAlignValue(s),this._refreshValue(),this._change(null,p);return}if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(p):this.value();for(m=this.options.values,f=arguments[0],T=0;T<m.length;T+=1)m[T]=this._trimAlignValue(f[T]),this._change(null,T);this._refreshValue()},_setOption:function(p,s){var m,f=0;switch(e.isArray(this.options.values)&&(f=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),p){case"disabled":s?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),m=0;m<f;m+=1)this._change(null,m);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var p=this.options.value;return p=this._trimAlignValue(p),p},_values:function(p){var s,m,f;if(arguments.length)return s=this.options.values[p],s=this._trimAlignValue(s),s;for(m=this.options.values.slice(),f=0;f<m.length;f+=1)m[f]=this._trimAlignValue(m[f]);return m},_trimAlignValue:function(p){if(p<=this._valueMin())return this._valueMin();if(p>=this._valueMax())return this._valueMax();var s=this.options.step>0?this.options.step:1,m=(p-this._valueMin())%s,f=p-m;return Math.abs(m)*2>=s&&(f+=m>0?s:-s),parseFloat(f.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var p,s,m,f,T,k=this.options.range,D=this.options,V=this,O=this._animateOff?!1:D.animate,b={};this.options.values&&this.options.values.length?this.handles.each(function(R){s=(V.values(R)-V._valueMin())/(V._valueMax()-V._valueMin())*100,b[V.orientation==="horizontal"?"left":"bottom"]=s+"%",e(this).stop(1,1)[O?"animate":"css"](b,D.animate),V.options.range===!0&&(V.orientation==="horizontal"?(R===0&&V.range.stop(1,1)[O?"animate":"css"]({left:s+"%"},D.animate),R===1&&V.range[O?"animate":"css"]({width:s-p+"%"},{queue:!1,duration:D.animate})):(R===0&&V.range.stop(1,1)[O?"animate":"css"]({bottom:s+"%"},D.animate),R===1&&V.range[O?"animate":"css"]({height:s-p+"%"},{queue:!1,duration:D.animate}))),p=s}):(m=this.value(),f=this._valueMin(),T=this._valueMax(),s=T!==f?(m-f)/(T-f)*100:0,b[this.orientation==="horizontal"?"left":"bottom"]=s+"%",this.handle.stop(1,1)[O?"animate":"css"](b,D.animate),k==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[O?"animate":"css"]({width:s+"%"},D.animate),k==="max"&&this.orientation==="horizontal"&&this.range[O?"animate":"css"]({width:100-s+"%"},{queue:!1,duration:D.animate}),k==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[O?"animate":"css"]({height:s+"%"},D.animate),k==="max"&&this.orientation==="vertical"&&this.range[O?"animate":"css"]({height:100-s+"%"},{queue:!1,duration:D.animate}))}})})(jQuery),eval((function(e,r,_,p,s,m){if(s=function(f){return(f<r?"":s(parseInt(f/r)))+((f=f%r)>35?String.fromCharCode(f+29):f.toString(36))},!"".replace(/^/,String)){for(;_--;)m[s(_)]=p[_]||s(_);p=[function(f){return m[f]}],s=function(){return"\\w+"},_=1}for(;_--;)p[_]&&(e=e.replace(new RegExp("\\b"+s(_)+"\\b","g"),p[_]));return e})(`(D($){8($.1s.1v){H}$.1s.6i=$.1s.1v=D(u,w){8(1l.S==0){18(J,'6j 55 6k 1j "'+1l.4o+'".');H 1l}8(1l.S>1){H 1l.1W(D(){$(1l).1v(u,w)})}F y=1l,$12=1l[0],56=L;8(y.1q('57')){56=y.1P('3o','4p');y.T('3o',['4q',J])}F z={};z.59=D(o,a,b){o=3S($12,o);o.E=6l($12,o.E);o.1K=6m($12,o.1K);o.N=6n($12,o.N);o.14=5a($12,o.14);o.16=5a($12,o.16);o.1b=6o($12,o.1b);o.1r=6p($12,o.1r);o.1Q=6q($12,o.1Q);8(a){31=$.1L(J,{},$.1s.1v.5b,o)}7=$.1L(J,{},$.1s.1v.5b,o);7.d=6r(7);A.2l=(7.2l=='5c'||7.2l=='1m')?'16':'14';F c=y.13(),2m=5d($1n,7,'P');8(3p(7.25)){7.25='7Q'+G.3T}7.3U=5e(7,2m);7.E=6s(7.E,7,c,b);7[7.d['P']]=6t(7[7.d['P']],7,c);7[7.d['1e']]=6u(7[7.d['1e']],7,c);8(7.2H){8(!3V(7[7.d['P']])){7[7.d['P']]='2I%'}}8(3V(7[7.d['P']])){A.6v=J;A.4r=7[7.d['P']];7[7.d['P']]=4s(2m,A.4r);8(!7.E.M){7.E.U.1d=J}}8(7.2H){7.1R=L;7.1i=[0,0,0,0];7.1B=L;7.E.U.1d=L}O{8(!7.E.M){7=6w(7,2m)}8(!7[7.d['P']]){8(!7.E.U.1d&&Y(7.E[7.d['P']])&&7.E.1t=='*'){7[7.d['P']]=7.E.M*7.E[7.d['P']];7.1B=L}O{7[7.d['P']]='1d'}}8(1z(7.1B)){7.1B=(Y(7[7.d['P']]))?'5f':L}8(7.E.U.1d){7.E.M=32(c,7,0)}}8(7.E.1t!='*'&&!7.E.U.1d){7.E.U.4t=7.E.M;7.E.M=3W(c,7,0)}7.E.M=2x(7.E.M,7,7.E.U.2c,$12);7.E.U.20=7.E.M;8(7.2H){8(!7.E.U.34){7.E.U.34=7.E.M}8(!7.E.U.1X){7.E.U.1X=7.E.M}7=5g(7,c,2m)}O{7.1i=6x(7.1i);8(7.1B=='3q'){7.1B='1m'}O 8(7.1B=='5h'){7.1B='35'}1F(7.1B){R'5f':R'1m':R'35':8(7[7.d['P']]!='1d'){7=5i(7,c);7.1R=J}17;2J:7.1B=L;7.1R=(7.1i[0]==0&&7.1i[1]==0&&7.1i[2]==0&&7.1i[3]==0)?L:J;17}}8(!Y(7.1K.1M)){7.1K.1M=6y}8(1z(7.1K.E)){7.1K.E=(7.2H||7.E.U.1d||7.E.1t!='*')?'M':7.E.M}7.N=$.1L(J,{},7.1K,7.N);7.14=$.1L(J,{},7.1K,7.14);7.16=$.1L(J,{},7.1K,7.16);7.1b=$.1L(J,{},7.1K,7.1b);7.N=6z($12,7.N);7.14=5j($12,7.14);7.16=5j($12,7.16);7.1b=6A($12,7.1b);7.1r=6B($12,7.1r);7.1Q=6C($12,7.1Q);8(7.2n){7.2n=5k(7.2n)}8(7.N.5l){7.N.4u=7.N.5l;3X('N.5l','N.4u')}8(7.N.5m){7.N.4v=7.N.5m;3X('N.5m','N.4v')}8(7.N.5n){7.N.4w=7.N.5n;3X('N.5n','N.4w')}8(7.N.5o){7.N.2K=7.N.5o;3X('N.5o','N.2K')}};z.6D=D(){y.1q('57',J);F a=y.13(),3Y=6E(y,['6F','6G','3r','3q','35','5h','1m','3Z','P','1e','6H','1S','5p','6I']),5q='7R';1F(3Y.3r){R'6J':R'7S':5q=3Y.3r;17}8(G.3s=='36'){41($1n)}O{$1n.Z(3Y)}$1n.Z({'7T':'3t','3r':5q});41(y);y.1q('6K',3Y.3Z);y.Z({'6F':'1m','6G':'42','3r':'6J','3q':0,'35':'N','5h':'N','1m':0,'6H':0,'1S':0,'5p':0,'6I':0});4x(a,7);41(a);8(7.2H){5r(7,a)}};z.6L=D(){z.5s();y.11(I('6M',G),D(e,a){e.1g();8(!A.2d){8(7.N.W){7.N.W.3a(2y('4y',G))}}A.2d=J;8(7.N.1G){7.N.1G=L;y.T(I('3b',G),a)}H J});y.11(I('5t',G),D(e){e.1g();8(A.26){43(V)}H J});y.11(I('3b',G),D(e,a,b){e.1g();1u=3u(1u);8(a&&A.26){V.2d=J;F c=2o()-V.2L;V.1M-=c;8(V.4z){V.4z.1M-=c}8(V.4A){V.4A.1M-=c}43(V,L)}8(!A.27&&!A.26){8(b){1u.3v+=2o()-1u.2L}}8(!A.27){8(7.N.W){7.N.W.3a(2y('6N',G))}}A.27=J;8(7.N.4v){F d=7.N.2K-1u.3v,3c=2I-1H.2z(d*2I/7.N.2K);7.N.4v.1h($12,3c,d)}H J});y.11(I('1G',G),D(e,b,c,d){e.1g();1u=3u(1u);F v=[b,c,d],t=['2M','28','3d'],a=3e(v,t);b=a[0];c=a[1];d=a[2];8(b!='14'&&b!='16'){b=A.2l}8(!Y(c)){c=0}8(!1k(d)){d=L}8(d){A.2d=L;7.N.1G=J}8(!7.N.1G){e.2e();H 18(G,'3w 4y: 2p 3f.')}8(A.27){8(7.N.W){7.N.W.2N(2y('4y',G));7.N.W.2N(2y('6N',G))}}A.27=L;1u.2L=2o();F f=7.N.2K+c;44=f-1u.3v;3c=2I-1H.2z(44*2I/f);8(7.N.1f){1u.1f=7U(D(){F a=2o()-1u.2L+1u.3v,3c=1H.2z(a*2I/f);7.N.1f.4B.1h(7.N.1f.2q[0],3c)},7.N.1f.5u)}1u.N=7V(D(){8(7.N.1f){7.N.1f.4B.1h(7.N.1f.2q[0],2I)}8(7.N.4w){7.N.4w.1h($12,3c,44)}8(A.26){y.T(I('1G',G),b)}O{y.T(I(b,G),7.N)}},44);8(7.N.4u){7.N.4u.1h($12,3c,44)}H J});y.11(I('3g',G),D(e){e.1g();8(V.2d){V.2d=L;A.27=L;A.26=J;V.2L=2o();3x(V,G)}O{y.T(I('1G',G))}H J});y.11(I('14',G)+' '+I('16',G),D(e,b,f,g,h){e.1g();8(A.2d||y.2f(':3t')){e.2e();H 18(G,'3w 4y 7W 3t: 2p 3f.')}F i=(Y(7.E.4C))?7.E.4C:7.E.M+1;8(i>K.Q){e.2e();H 18(G,'2p 6O E ('+K.Q+' Q, '+i+' 6P): 2p 3f.')}F v=[b,f,g,h],t=['2A','28/2M','D','3d'],a=3e(v,t);b=a[0];f=a[1];g=a[2];h=a[3];F k=e.5v.19(G.3y.45.S);8(!1T(b)){b={}}8(1o(g)){b.3h=g}8(1k(h)){b.2O=h}b=$.1L(J,{},7[k],b);8(b.5w&&!b.5w.1h($12,k)){e.2e();H 18(G,'7X "5w" 7Y L.')}8(!Y(f)){8(7.E.1t!='*'){f='M'}O{F m=[f,b.E,7[k].E];1j(F a=0,l=m.S;a<l;a++){8(Y(m[a])||m[a]=='6Q'||m[a]=='M'){f=m[a];17}}}1F(f){R'6Q':e.2e();H y.1P(I(k+'7Z',G),[b,g]);17;R'M':8(!7.E.U.1d&&7.E.1t=='*'){f=7.E.M}17}}8(V.2d){y.T(I('3g',G));y.T(I('2O',G),[k,[b,f,g]]);e.2e();H 18(G,'3w 80 3f.')}8(b.1M>0){8(A.26){8(b.2O){8(b.2O=='2P'){2g=[]}8(b.2O!='X'||2g.S==0){y.T(I('2O',G),[k,[b,f,g]])}}e.2e();H 18(G,'3w 81 3f.')}}1u.3v=0;y.T(I('6R'+k,G),[b,f]);8(7.2n){F s=7.2n,c=[b,f];1j(F j=0,l=s.S;j<l;j++){F d=k;8(!s[j][2]){d=(d=='14')?'16':'14'}8(!s[j][1]){c[0]=s[j][0].1P('3o',['6S',d])}c[1]=f+s[j][3];s[j][0].T('3o',['6R'+d,c])}}H J});y.11(I('82',G),D(e,b,c){e.1g();F d=y.13();8(!7.1U){8(K.X==0){8(7.3z){y.T(I('16',G),K.Q-1)}H e.2e()}}1Y(d,7);8(!Y(c)){8(7.E.U.1d){c=4D(d,7,K.Q-1)}O 8(7.E.1t!='*'){F f=(Y(b.E))?b.E:5x(y,7);c=6T(d,7,K.Q-1,f)}O{c=7.E.M}c=4E(c,7,b.E,$12)}8(!7.1U){8(K.Q-c<K.X){c=K.Q-K.X}}7.E.U.20=7.E.M;8(7.E.U.1d){F g=2x(32(d,7,K.Q-c),7,7.E.U.2c,$12);8(7.E.M+c<=g&&c<K.Q){c++;g=2x(32(d,7,K.Q-c),7,7.E.U.2c,$12)}7.E.M=g}O 8(7.E.1t!='*'){F g=3W(d,7,K.Q-c);7.E.M=2x(g,7,7.E.U.2c,$12)}1Y(d,7,J);8(c==0){e.2e();H 18(G,'0 E 46 1K: 2p 3f.')}18(G,'6U '+c+' E 5y.');K.X+=c;2h(K.X>=K.Q){K.X-=K.Q}8(!7.1U){8(K.X==0&&b.4F){b.4F.1h($12,'14')}8(!7.3z){3A(7,K.X,G)}}y.13().19(K.Q-c,K.Q).83(y);8(K.Q<7.E.M+c){y.13().19(0,(7.E.M+c)-K.Q).4G(J).47(y)}F d=y.13(),3i=6V(d,7,c),2i=6W(d,7),1Z=d.1N(c-1),21=3i.2P(),2r=2i.2P();1Y(d,7);F h=0,2B=0;8(7.1B){F p=4H(2i,7);h=p[0];2B=p[1]}F i=(h<0)?7.1i[7.d[3]]:0;F j=L,2Q=$();8(7.E.M<c){2Q=d.19(7.E.U.20,c);8(b.1V=='6X'){F k=7.E[7.d['P']];j=2Q;1Z=2r;5z(j);7.E[7.d['P']]='1d'}}F l=L,3B=2R(d.19(0,c),7,'P'),2j=4I(4J(2i,7,J),7,!7.1R),3C=0,29={},4K={},2s={},2S={},4L={},2T={},5A={},2U=5B(b,7,c,3B);1F(b.1V){R'1I':R'1I-1w':3C=2R(d.19(0,7.E.M),7,'P');17}8(j){7.E[7.d['P']]=k}1Y(d,7,J);8(2B>=0){1Y(21,7,7.1i[7.d[1]])}8(h>=0){1Y(1Z,7,7.1i[7.d[3]])}8(7.1B){7.1i[7.d[1]]=2B;7.1i[7.d[3]]=h}2T[7.d['1m']]=-(3B-i);5A[7.d['1m']]=-(3C-i);4K[7.d['1m']]=2j[7.d['P']];F m=D(){},1O=D(){},1C=D(){},3D=D(){},2C=D(){},5C=D(){},1D=D(){},3E=D(){},1x=D(){},1y=D(){},1J=D(){};1F(b.1V){R'3j':R'1I':R'1I-1w':R'22':R'22-1w':l=y.4G(J).47($1n);17}1F(b.1V){R'3j':R'22':R'22-1w':l.13().19(0,c).2t();l.13().19(7.E.U.20).2t();17;R'1I':R'1I-1w':l.13().19(7.E.M).2t();l.Z(5A);17}y.Z(2T);V=48(2U,b.2u,G);29[7.d['1m']]=(7.1R)?7.1i[7.d[3]]:0;8(7[7.d['P']]=='1d'||7[7.d['1e']]=='1d'){m=D(){$1n.Z(2j)};1O=D(){V.1a.1c([$1n,2j])}}8(7.1R){8(2r.4M(1Z).S){2s[7.d['1S']]=1Z.1q('2a');8(h<0){1Z.Z(2s)}O{1D=D(){1Z.Z(2s)};3E=D(){V.1a.1c([1Z,2s])}}}1F(b.1V){R'1I':R'1I-1w':l.13().1N(c-1).Z(2s);17}8(2r.4M(21).S){2S[7.d['1S']]=21.1q('2a');1C=D(){21.Z(2S)};3D=D(){V.1a.1c([21,2S])}}8(2B>=0){4L[7.d['1S']]=2r.1q('2a')+7.1i[7.d[1]];2C=D(){2r.Z(4L)};5C=D(){V.1a.1c([2r,4L])}}}1J=D(){y.Z(29)};F n=7.E.M+c-K.Q;1y=D(){8(n>0){y.13().19(K.Q).2t();3i=$(y.13().19(K.Q-(7.E.M-n)).3F().6Y(y.13().19(0,n).3F()))}5D(j);8(7.1R){F a=y.13().1N(7.E.M+c-1);a.Z(7.d['1S'],a.1q('2a'))}};F o=5E(3i,2Q,2i,c,'14',2U,2j);1x=D(){5F(y,l,b);A.26=L;2b.3h=4a($12,b,'3h',o,2b);2g=5G(y,2g,G);8(!A.27){y.T(I('1G',G))}};A.26=J;1u=3u(1u);2b.3G=4a($12,b,'3G',o,2b);1F(b.1V){R'42':y.Z(29);m();1C();2C();1D();1J();1y();1x();17;R'1w':V.1a.1c([y,{'1E':0},D(){m();1C();2C();1D();1J();1y();V=48(2U,b.2u,G);V.1a.1c([y,{'1E':1},1x]);3x(V,G)}]);17;R'3j':y.Z({'1E':0});V.1a.1c([l,{'1E':0}]);V.1a.1c([y,{'1E':1},1x]);1O();1C();2C();1D();1J();1y();17;R'1I':V.1a.1c([l,29,D(){1C();2C();1D();1J();1y();1x()}]);1O();17;R'1I-1w':V.1a.1c([y,{'1E':0}]);V.1a.1c([l,29,D(){y.Z({'1E':1});1C();2C();1D();1J();1y();1x()}]);1O();17;R'22':V.1a.1c([l,4K,1x]);1O();1C();2C();1D();1J();1y();17;R'22-1w':y.Z({'1E':0});V.1a.1c([y,{'1E':1}]);V.1a.1c([l,4K,1x]);1O();1C();2C();1D();1J();1y();17;2J:V.1a.1c([y,29,D(){1y();1x()}]);1O();3D();5C();3E();17}3x(V,G);5H(7.25,y,G);y.T(I('3H',G),[L,2j]);H J});y.11(I('84',G),D(e,c,d){e.1g();F f=y.13();8(!7.1U){8(K.X==7.E.M){8(7.3z){y.T(I('14',G),K.Q-1)}H e.2e()}}1Y(f,7);8(!Y(d)){8(7.E.1t!='*'){F g=(Y(c.E))?c.E:5x(y,7);d=6Z(f,7,0,g)}O{d=7.E.M}d=4E(d,7,c.E,$12)}F h=(K.X==0)?K.Q:K.X;8(!7.1U){8(7.E.U.1d){F i=32(f,7,d),g=4D(f,7,h-1)}O{F i=7.E.M,g=7.E.M}8(d+i>h){d=h-g}}7.E.U.20=7.E.M;8(7.E.U.1d){F i=2x(5I(f,7,d,h),7,7.E.U.2c,$12);2h(7.E.M-d>=i&&d<K.Q){d++;i=2x(5I(f,7,d,h),7,7.E.U.2c,$12)}7.E.M=i}O 8(7.E.1t!='*'){F i=3W(f,7,d);7.E.M=2x(i,7,7.E.U.2c,$12)}1Y(f,7,J);8(d==0){e.2e();H 18(G,'0 E 46 1K: 2p 3f.')}18(G,'6U '+d+' E 70.');K.X-=d;2h(K.X<0){K.X+=K.Q}8(!7.1U){8(K.X==7.E.M&&c.4F){c.4F.1h($12,'16')}8(!7.3z){3A(7,K.X,G)}}8(K.Q<7.E.M+d){y.13().19(0,(7.E.M+d)-K.Q).4G(J).47(y)}F f=y.13(),3i=71(f,7),2i=72(f,7,d),1Z=f.1N(d-1),21=3i.2P(),2r=2i.2P();1Y(f,7);F j=0,2B=0;8(7.1B){F p=4H(2i,7);j=p[0];2B=p[1]}F k=L,2Q=$();8(7.E.U.20<d){2Q=f.19(7.E.U.20,d);8(c.1V=='6X'){F l=7.E[7.d['P']];k=2Q;1Z=21;5z(k);7.E[7.d['P']]='1d'}}F m=L,3B=2R(f.19(0,d),7,'P'),2j=4I(4J(2i,7,J),7,!7.1R),3C=0,29={},4N={},2s={},2S={},2T={},2U=5B(c,7,d,3B);1F(c.1V){R'22':R'22-1w':3C=2R(f.19(0,7.E.U.20),7,'P');17}8(k){7.E[7.d['P']]=l}8(7.1B){8(7.1i[7.d[1]]<0){7.1i[7.d[1]]=0}}1Y(f,7,J);1Y(21,7,7.1i[7.d[1]]);8(7.1B){7.1i[7.d[1]]=2B;7.1i[7.d[3]]=j}2T[7.d['1m']]=(7.1R)?7.1i[7.d[3]]:0;F n=D(){},1O=D(){},1C=D(){},3D=D(){},1D=D(){},3E=D(){},1x=D(){},1y=D(){},1J=D(){};1F(c.1V){R'3j':R'1I':R'1I-1w':R'22':R'22-1w':m=y.4G(J).47($1n);m.13().19(7.E.U.20).2t();17}1F(c.1V){R'3j':R'1I':R'1I-1w':y.Z('3Z',1);m.Z('3Z',0);17}V=48(2U,c.2u,G);29[7.d['1m']]=-3B;4N[7.d['1m']]=-3C;8(j<0){29[7.d['1m']]+=j}8(7[7.d['P']]=='1d'||7[7.d['1e']]=='1d'){n=D(){$1n.Z(2j)};1O=D(){V.1a.1c([$1n,2j])}}8(7.1R){F o=2r.1q('2a');8(2B>=0){o+=7.1i[7.d[1]]}2r.Z(7.d['1S'],o);8(1Z.4M(21).S){2S[7.d['1S']]=21.1q('2a')}1C=D(){21.Z(2S)};3D=D(){V.1a.1c([21,2S])};F q=1Z.1q('2a');8(j>0){q+=7.1i[7.d[3]]}2s[7.d['1S']]=q;1D=D(){1Z.Z(2s)};3E=D(){V.1a.1c([1Z,2s])}}1J=D(){y.Z(2T)};F r=7.E.M+d-K.Q;1y=D(){8(r>0){y.13().19(K.Q).2t()}F a=y.13().19(0,d).47(y).2P();8(r>0){2i=3I(f,7)}5D(k);8(7.1R){8(K.Q<7.E.M+d){F b=y.13().1N(7.E.M-1);b.Z(7.d['1S'],b.1q('2a')+7.1i[7.d[1]])}a.Z(7.d['1S'],a.1q('2a'))}};F s=5E(3i,2Q,2i,d,'16',2U,2j);1x=D(){y.Z('3Z',y.1q('6K'));5F(y,m,c);A.26=L;2b.3h=4a($12,c,'3h',s,2b);2g=5G(y,2g,G);8(!A.27){y.T(I('1G',G))}};A.26=J;1u=3u(1u);2b.3G=4a($12,c,'3G',s,2b);1F(c.1V){R'42':y.Z(29);n();1C();1D();1J();1y();1x();17;R'1w':V.1a.1c([y,{'1E':0},D(){n();1C();1D();1J();1y();V=48(2U,c.2u,G);V.1a.1c([y,{'1E':1},1x]);3x(V,G)}]);17;R'3j':y.Z({'1E':0});V.1a.1c([m,{'1E':0}]);V.1a.1c([y,{'1E':1},1x]);1O();1C();1D();1J();1y();17;R'1I':y.Z(7.d['1m'],$1n[7.d['P']]());V.1a.1c([y,2T,1x]);1O();1C();1D();1y();17;R'1I-1w':y.Z(7.d['1m'],$1n[7.d['P']]());V.1a.1c([m,{'1E':0}]);V.1a.1c([y,2T,1x]);1O();1C();1D();1y();17;R'22':V.1a.1c([m,4N,1x]);1O();1C();1D();1J();1y();17;R'22-1w':y.Z({'1E':0});V.1a.1c([y,{'1E':1}]);V.1a.1c([m,4N,1x]);1O();1C();1D();1J();1y();17;2J:V.1a.1c([y,29,D(){1J();1y();1x()}]);1O();3D();3E();17}3x(V,G);5H(7.25,y,G);y.T(I('3H',G),[L,2j]);H J});y.11(I('3k',G),D(e,b,c,d,f,g,h){e.1g();F v=[b,c,d,f,g,h],t=['2M/28/2A','28','3d','2A','2M','D'],a=3e(v,t);f=a[3];g=a[4];h=a[5];b=3J(a[0],a[1],a[2],K,y);8(b==0){H L}8(!1T(f)){f=L}8(g!='14'&&g!='16'){8(7.1U){g=(b<=K.Q/2)?'16':'14'}O{g=(K.X==0||K.X>b)?'16':'14'}}8(g=='14'){b=K.Q-b}y.T(I(g,G),[f,b,h]);H J});y.11(I('85',G),D(e,a,b){e.1g();F c=y.1P(I('4b',G));H y.1P(I('5J',G),[c-1,a,'14',b])});y.11(I('86',G),D(e,a,b){e.1g();F c=y.1P(I('4b',G));H y.1P(I('5J',G),[c+1,a,'16',b])});y.11(I('5J',G),D(e,a,b,c,d){e.1g();8(!Y(a)){a=y.1P(I('4b',G))}F f=7.1b.E||7.E.M,1X=1H.2z(K.Q/f)-1;8(a<0){a=1X}8(a>1X){a=0}H y.1P(I('3k',G),[a*f,0,J,b,c,d])});y.11(I('73',G),D(e,s){e.1g();8(s){s=3J(s,0,J,K,y)}O{s=0}s+=K.X;8(s!=0){8(K.Q>0){2h(s>K.Q){s-=K.Q}}y.87(y.13().19(s,K.Q))}H J});y.11(I('2n',G),D(e,s){e.1g();8(s){s=5k(s)}O 8(7.2n){s=7.2n}O{H 18(G,'6j 88 46 2n.')}F n=y.1P(I('4p',G)),x=J;1j(F j=0,l=s.S;j<l;j++){8(!s[j][0].1P(I('3k',G),[n,s[j][3],J])){x=L}}H x});y.11(I('2O',G),D(e,a,b){e.1g();8(1o(a)){a.1h($12,2g)}O 8(2V(a)){2g=a}O 8(!1z(a)){2g.1c([a,b])}H 2g});y.11(I('89',G),D(e,b,c,d,f){e.1g();F v=[b,c,d,f],t=['2M/2A','2M/28/2A','3d','28'],a=3e(v,t);b=a[0];c=a[1];d=a[2];f=a[3];8(1T(b)&&!2v(b)){b=$(b)}O 8(1p(b)){b=$(b)}8(!2v(b)||b.S==0){H 18(G,'2p a 5K 2A.')}8(1z(c)){c='4c'}4x(b,7);41(b);F g=c,4d='4d';8(c=='4c'){8(d){8(K.X==0){c=K.Q-1;4d='74'}O{c=K.X;K.X+=b.S}8(c<0){c=0}}O{c=K.Q-1;4d='74'}}O{c=3J(c,f,d,K,y)}F h=y.13().1N(c);8(h.S){h[4d](b)}O{18(G,'8a 8b-3r 4M 6k! 8c 8d 46 75 4c.');y.76(b)}8(g!='4c'&&!d){8(c<K.X){K.X+=b.S}}K.Q=y.13().S;8(K.X>=K.Q){K.X-=K.Q}y.T(I('4O',G));y.T(I('5L',G));H J});y.11(I('77',G),D(e,c,d,f){e.1g();F v=[c,d,f],t=['2M/28/2A','3d','28'],a=3e(v,t);c=a[0];d=a[1];f=a[2];F g=L;8(c 2W $&&c.S>1){h=$();c.1W(D(i,a){F b=y.T(I('77',G),[$(1l),d,f]);8(b){h=h.8e(b)}});H h}8(1z(c)||c=='4c'){h=y.13().2P()}O{c=3J(c,f,d,K,y);F h=y.13().1N(c);8(h.S){8(c<K.X){K.X-=h.S}}}8(h&&h.S){h.8f();K.Q=y.13().S;y.T(I('4O',G))}H h});y.11(I('3G',G)+' '+I('3h',G),D(e,a){e.1g();F b=e.5v.19(G.3y.45.S);8(2V(a)){2b[b]=a}8(1o(a)){2b[b].1c(a)}H 2b[b]});y.11(I('4p',G),D(e,a){e.1g();8(K.X==0){F b=0}O{F b=K.Q-K.X}8(1o(a)){a.1h($12,b)}H b});y.11(I('4b',G),D(e,a){e.1g();F b=7.1b.E||7.E.M,1X=1H.2z(K.Q/b-1),2k;8(K.X==0){2k=0}O 8(K.X<K.Q%b){2k=0}O 8(K.X==b&&!7.1U){2k=1X}O{2k=1H.78((K.Q-K.X)/b)}8(2k<0){2k=0}8(2k>1X){2k=1X}8(1o(a)){a.1h($12,2k)}H 2k});y.11(I('8g',G),D(e,a){e.1g();F b=3I(y.13(),7);8(1o(a)){a.1h($12,b)}H b});y.11(I('19',G),D(e,f,l,b){e.1g();8(K.Q==0){H L}F v=[f,l,b],t=['28','28','D'],a=3e(v,t);f=(Y(a[0]))?a[0]:0;l=(Y(a[1]))?a[1]:K.Q;b=a[2];f+=K.X;l+=K.X;8(E.Q>0){2h(f>K.Q){f-=K.Q}2h(l>K.Q){l-=K.Q}2h(f<0){f+=K.Q}2h(l<0){l+=K.Q}}F c=y.13(),$i;8(l>f){$i=c.19(f,l)}O{$i=$(c.19(f,K.Q).3F().6Y(c.19(0,l).3F()))}8(1o(b)){b.1h($12,$i)}H $i});y.11(I('27',G)+' '+I('2d',G)+' '+I('26',G),D(e,a){e.1g();F b=e.5v.19(G.3y.45.S),5M=A[b];8(1o(a)){a.1h($12,5M)}H 5M});y.11(I('6S',G),D(e,a,b,c){e.1g();F d=L;8(1o(a)){a.1h($12,7)}O 8(1T(a)){31=$.1L(J,{},31,a);8(b!==L)d=J;O 7=$.1L(J,{},7,a)}O 8(!1z(a)){8(1o(b)){F f=4P('7.'+a);8(1z(f)){f=''}b.1h($12,f)}O 8(!1z(b)){8(2X c!=='3d')c=J;4P('31.'+a+' = b');8(c!==L)d=J;O 4P('7.'+a+' = b')}O{H 4P('7.'+a)}}8(d){1Y(y.13(),7);z.59(31);z.5N();F g=4Q(y,7);y.T(I('3H',G),[J,g])}H 7});y.11(I('5L',G),D(e,a,b){e.1g();8(1z(a)){a=$('8h')}O 8(1p(a)){a=$(a)}8(!2v(a)||a.S==0){H 18(G,'2p a 5K 2A.')}8(!1p(b)){b='a.6i'}a.8i(b).1W(D(){F h=1l.79||'';8(h.S>0&&y.13().7a($(h))!=-1){$(1l).23('5O').5O(D(e){e.2D();y.T(I('3k',G),h)})}});H J});y.11(I('3H',G),D(e,b,c){e.1g();8(!7.1b.1A){H}F d=7.1b.E||7.E.M,4R=1H.2z(K.Q/d);8(b){8(7.1b.3K){7.1b.1A.13().2t();7.1b.1A.1W(D(){1j(F a=0;a<4R;a++){F i=y.13().1N(3J(a*d,0,J,K,y));$(1l).76(7.1b.3K.1h(i[0],a+1))}})}7.1b.1A.1W(D(){$(1l).13().23(7.1b.3L).1W(D(a){$(1l).11(7.1b.3L,D(e){e.2D();y.T(I('3k',G),[a*d,-7.1b.4S,J,7.1b])})})})}F f=y.1P(I('4b',G))+7.1b.4S;8(f>=4R){f=0}8(f<0){f=4R-1}7.1b.1A.1W(D(){$(1l).13().2N(2y('7b',G)).1N(f).3a(2y('7b',G))});H J});y.11(I('4O',G),D(e){F a=7.E.M,2E=y.13(),2m=5d($1n,7,'P');K.Q=2E.S;8(A.4r){7.3U=2m;7[7.d['P']]=4s(2m,A.4r)}O{7.3U=5e(7,2m)}8(7.2H){7.E.P=7.E.3M.P;7.E.1e=7.E.3M.1e;7=5g(7,2E,2m);a=7.E.M;5r(7,2E)}O 8(7.E.U.1d){a=32(2E,7,0)}O 8(7.E.1t!='*'){a=3W(2E,7,0)}8(!7.1U&&K.X!=0&&a>K.X){8(7.E.U.1d){F b=4D(2E,7,K.X)-K.X}O 8(7.E.1t!='*'){F b=7c(2E,7,K.X)-K.X}O{F b=7.E.M-K.X}18(G,'8j 8k-1U: 8l '+b+' E 5y.');y.T(I('14',G),b)}7.E.M=2x(a,7,7.E.U.2c,$12);7.E.U.20=7.E.M;7=5i(7,2E);F c=4Q(y,7);y.T(I('3H',G),[J,c]);4T(7,K.Q,G);3A(7,K.X,G);H c});y.11(I('4q',G),D(e,a){e.1g();1u=3u(1u);y.1q('57',L);y.T(I('5t',G));8(a){y.T(I('73',G))}4U(y.13());4U(y);z.5s();z.5P();8(G.3s=='36'){4U($1n)}O{$1n.8m(y)}H J});y.11(I('18',G),D(e){18(G,'3w P: '+7.P);18(G,'3w 1e: '+7.1e);18(G,'7d 8n: '+7.E.P);18(G,'7d 8o: '+7.E.1e);18(G,'4e 4f E M: '+7.E.M);8(7.N.1G){18(G,'4e 4f E 5Q 8p: '+7.N.E)}8(7.14.W){18(G,'4e 4f E 5Q 5y: '+7.14.E)}8(7.16.W){18(G,'4e 4f E 5Q 70: '+7.16.E)}H G.18});y.11('3o',D(e,n,o){e.1g();H y.1P(I(n,G),o)})};z.5s=D(){y.23(I('',G));y.23(I('',G,L));y.23('3o')};z.5N=D(){z.5P();4T(7,K.Q,G);3A(7,K.X,G);8(7.N.2F){F b=3N(7.N.2F);$1n.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}8(7.N.W){7.N.W.11(I(7.N.3L,G,L),D(e){e.2D();F a=L,b=3O;8(A.27){a='1G'}O 8(7.N.4X){a='3b';b=3N(7.N.4X)}8(a){y.T(I(a,G),b)}})}8(7.14.W){7.14.W.11(I(7.14.3L,G,L),D(e){e.2D();y.T(I('14',G))});8(7.14.2F){F b=3N(7.14.2F);7.14.W.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}}8(7.16.W){7.16.W.11(I(7.16.3L,G,L),D(e){e.2D();y.T(I('16',G))});8(7.16.2F){F b=3N(7.16.2F);7.16.W.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}}8(7.1b.1A){8(7.1b.2F){F b=3N(7.1b.2F);7.1b.1A.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}}8(7.14.2Y||7.16.2Y){$(4g).11(I('7e',G,L,J,J),D(e){F k=e.7f;8(k==7.16.2Y){e.2D();y.T(I('16',G))}8(k==7.14.2Y){e.2D();y.T(I('14',G))}})}8(7.1b.4Y){$(4g).11(I('7e',G,L,J,J),D(e){F k=e.7f;8(k>=49&&k<58){k=(k-49)*7.E.M;8(k<=K.Q){e.2D();y.T(I('3k',G),[k,0,J,7.1b])}}})}8($.1s.1r){F c='8q'8r 3l;8((c&&7.1r.4h)||(!c&&7.1r.5R)){F d=$.1L(J,{},7.14,7.1r),7g=$.1L(J,{},7.16,7.1r),5S=D(){y.T(I('14',G),[d])},5T=D(){y.T(I('16',G),[7g])};1F(7.2l){R'5c':R'7h':7.1r.2G.8s=5T;7.1r.2G.8t=5S;17;2J:7.1r.2G.8u=5T;7.1r.2G.8v=5S}8(A.1r){y.1r('4q')}$1n.1r(7.1r.2G);$1n.Z('7i','8w');A.1r=J}}8($.1s.1Q){8(7.1Q){F f=$.1L(J,{},7.14,7.1Q),7j=$.1L(J,{},7.16,7.1Q);8(A.1Q){$1n.23(I('1Q',G,L))}$1n.11(I('1Q',G,L),D(e,a){e.2D();8(a>0){y.T(I('14',G),[f])}O{y.T(I('16',G),[7j])}});A.1Q=J}}8(7.N.1G){y.T(I('1G',G),7.N.5U)}8(A.6v){F g=D(e){y.T(I('5t',G));8(7.N.5V&&!A.27){y.T(I('1G',G))}1Y(y.13(),7);y.T(I('4O',G))};F h=$(3l),4i=3O;8($.5W&&G.5X=='5W'){4i=$.5W(8x,g)}O 8($.4Z&&G.5X=='4Z'){4i=$.4Z(8y,g)}O{F i=0,5Y=0;4i=D(){F a=h.P(),5Z=h.1e();8(a!=i||5Z!=5Y){g();i=a;5Y=5Z}}}h.11(I('8z',G,L,J,J),4i)}};z.5P=D(){F a=I('',G),3P=I('',G,L);61=I('',G,L,J,J);$(4g).23(61);$(3l).23(61);$1n.23(3P);8(7.N.W){7.N.W.23(3P)}8(7.14.W){7.14.W.23(3P)}8(7.16.W){7.16.W.23(3P)}8(7.1b.1A){7.1b.1A.23(3P);8(7.1b.3K){7.1b.1A.13().2t()}}8(A.1r){y.1r('4q');$1n.Z('7i','2J');A.1r=L}8(A.1Q){A.1Q=L}4T(7,'4j',G);3A(7,'2N',G)};8(1k(w)){w={'18':w}}F A={'2l':'16','27':J,'26':L,'2d':L,'1Q':L,'1r':L},K={'Q':y.13().S,'X':0},1u={'N':3O,'1f':3O,'2L':2o(),'3v':0},V={'2d':L,'1M':0,'2L':0,'2u':'','1a':[]},2b={'3G':[],'3h':[]},2g=[],G=$.1L(J,{},$.1s.1v.7k,w),7={},31=$.1L(J,{},u),$1n=(G.3s=='36')?y.36():y.8A('<'+G.3s.55+' 8B="'+G.3s.7l+'" />').36();G.4o=y.4o;G.3T=$.1s.1v.3T++;G.2Z=(G.2Z&&$.1s.2Z)?'2Z':'8C';z.59(31,J,56);z.6D();z.6L();z.5N();8(2V(7.E.3m)){F B=7.E.3m}O{F B=[];8(7.E.3m!=0){B.1c(7.E.3m)}}8(7.25){B.8D(4k(7m(7.25),10))}8(B.S>0){1j(F a=0,l=B.S;a<l;a++){F s=B[a];8(s==0){62}8(s===J){s=3l.8E.79;8(s.S<1){62}}O 8(s==='7n'){s=1H.4l(1H.7n()*K.Q)}8(y.1P(I('3k',G),[s,0,J,{1V:'42'}])){17}}}F C=4Q(y,7),7o=3I(y.13(),7);8(7.7p){7.7p.1h($12,{'P':C.P,'1e':C.1e,'E':7o})}y.T(I('3H',G),[J,C]);y.T(I('5L',G));8(G.18){y.T(I('18',G))}H y};$.1s.1v.3T=1;$.1s.1v.5b={'2n':L,'3z':J,'1U':J,'2H':L,'2l':'1m','E':{'3m':0},'1K':{'2u':'7q','1M':6y,'2F':L,'3L':'5O','2O':L}};$.1s.1v.7k={'18':L,'2Z':L,'5X':'4Z','3y':{'45':'','7r':'8F'},'3s':{'55':'8G','7l':'8H'},'63':{}};$.1s.1v.7s=D(a){H'<a 8I="#"><7t>'+a+'</7t></a>'};$.1s.1v.7u=D(a){$(1l).Z('P',a+'%')};$.1s.1v.25={3F:D(n){n+='=';F b=4g.25.3Q(';');1j(F a=0,l=b.S;a<l;a++){F c=b[a];2h(c.8J(0)==' '){c=c.19(1)}8(c.3R(n)==0){H c.19(n.S)}}H 0},64:D(n,v,d){F e="";8(d){F a=7v 7w();a.8K(a.2o()+(d*24*60*60*8L));e="; 8M="+a.8N()}4g.25=n+'='+v+e+'; 8O=/'},2t:D(n){$.1s.1v.25.64(n,"",-1)}};D 48(d,e,c){8(c.2Z=='2Z'){8(e=='7q'){e='8P'}}H{1a:[],1M:d,8Q:d,2u:e,2L:2o()}}D 3x(s,c){1j(F a=0,l=s.1a.S;a<l;a++){F b=s.1a[a];8(!b){62}b[0][c.2Z](b[1],s.1M,s.2u,b[2])}}D 43(s,c){8(!1k(c)){c=J}8(1T(s.4z)){43(s.4z,c)}1j(F a=0,l=s.1a.S;a<l;a++){F b=s.1a[a];b[0].6M(J);8(c){b[0].Z(b[1]);8(1o(b[2])){b[2]()}}}8(1T(s.4A)){43(s.4A,c)}}D 5F(a,b,o){8(b){b.2t()}1F(o.1V){R'1w':R'3j':R'1I-1w':R'22-1w':a.Z('1t','');a.Z('1E',1);17}}D 4a(d,o,b,a,c){8(o[b]){o[b].1h(d,a)}8(c[b].S){1j(F i=0,l=c[b].S;i<l;i++){c[b][i].1h(d,a)}}H[]}D 5G(a,q,c){8(q.S){a.T(I(q[0][0],c),q[0][1]);q.8R()}H q}D 5z(b){b.1W(D(){F a=$(1l);a.1q('7x',a.2f(':3t')).4j()})}D 5D(b){8(b){b.1W(D(){F a=$(1l);8(!a.1q('7x')){a.4m()}})}}D 3u(t){8(t.N){8S(t.N)}8(t.1f){8T(t.1f)}H t}D 5E(a,b,c,d,e,f,g){H{'P':g.P,'1e':g.1e,'E':{'20':a,'8U':b,'M':c},'1K':{'E':d,'2l':e,'1M':f}}}D 5B(a,o,b,c){F d=a.1M;8(a.1V=='42'){H 0}8(d=='N'){d=o.1K.1M/o.1K.E*b}O 8(d<10){d=c/d}8(d<1){H 0}8(a.1V=='1w'){d=d/2}H 1H.78(d)}D 4T(o,t,c){F a=(Y(o.E.4C))?o.E.4C:o.E.M+1;8(t=='4m'||t=='4j'){F f=t}O 8(a>t){18(c,'2p 6O E ('+t+' Q, '+a+' 6P): 8V 8W.');F f='4j'}O{F f='4m'}F s=(f=='4m')?'2N':'3a',h=2y('3t',c);8(o.N.W){o.N.W[f]()[s](h)}8(o.14.W){o.14.W[f]()[s](h)}8(o.16.W){o.16.W[f]()[s](h)}8(o.1b.1A){o.1b.1A[f]()[s](h)}}D 3A(o,f,c){8(o.1U||o.3z)H;F a=(f=='2N'||f=='3a')?f:L,51=2y('8X',c);8(o.N.W&&a){o.N.W[a](51)}8(o.14.W){F b=a||(f==0)?'3a':'2N';o.14.W[b](51)}8(o.16.W){F b=a||(f==o.E.M)?'3a':'2N';o.16.W[b](51)}}D 3S(a,b){8(1o(b)){b=b.1h(a)}O 8(1z(b)){b={}}H b}D 6l(a,b){b=3S(a,b);8(Y(b)){b={'M':b}}O 8(b=='1d'){b={'M':b,'P':b,'1e':b}}O 8(!1T(b)){b={}}H b}D 6m(a,b){b=3S(a,b);8(Y(b)){8(b<=50){b={'E':b}}O{b={'1M':b}}}O 8(1p(b)){b={'2u':b}}O 8(!1T(b)){b={}}H b}D 52(a,b){b=3S(a,b);8(1p(b)){F c=65(b);8(c==-1){b=$(b)}O{b=c}}H b}D 6n(a,b){b=52(a,b);8(2v(b)){b={'W':b}}O 8(1k(b)){b={'1G':b}}O 8(Y(b)){b={'2K':b}}8(b.1f){8(1p(b.1f)||2v(b.1f)){b.1f={'2q':b.1f}}}H b}D 6z(a,b){8(1o(b.W)){b.W=b.W.1h(a)}8(1p(b.W)){b.W=$(b.W)}8(!1k(b.1G)){b.1G=J}8(!Y(b.5U)){b.5U=0}8(1z(b.4X)){b.4X=J}8(!1k(b.5V)){b.5V=J}8(!Y(b.2K)){b.2K=(b.1M<10)?8Y:b.1M*5}8(b.1f){8(1o(b.1f.2q)){b.1f.2q=b.1f.2q.1h(a)}8(1p(b.1f.2q)){b.1f.2q=$(b.1f.2q)}8(b.1f.2q){8(!1o(b.1f.4B)){b.1f.4B=$.1s.1v.7u}8(!Y(b.1f.5u)){b.1f.5u=50}}O{b.1f=L}}H b}D 5a(a,b){b=52(a,b);8(2v(b)){b={'W':b}}O 8(Y(b)){b={'2Y':b}}H b}D 5j(a,b){8(1o(b.W)){b.W=b.W.1h(a)}8(1p(b.W)){b.W=$(b.W)}8(1p(b.2Y)){b.2Y=65(b.2Y)}H b}D 6o(a,b){b=52(a,b);8(2v(b)){b={'1A':b}}O 8(1k(b)){b={'4Y':b}}H b}D 6A(a,b){8(1o(b.1A)){b.1A=b.1A.1h(a)}8(1p(b.1A)){b.1A=$(b.1A)}8(!Y(b.E)){b.E=L}8(!1k(b.4Y)){b.4Y=L}8(!1o(b.3K)&&!53(b.3K)){b.3K=$.1s.1v.7s}8(!Y(b.4S)){b.4S=0}H b}D 6p(a,b){8(1o(b)){b=b.1h(a)}8(1z(b)){b={'4h':L}}8(3p(b)){b={'4h':b}}O 8(Y(b)){b={'E':b}}H b}D 6B(a,b){8(!1k(b.4h)){b.4h=J}8(!1k(b.5R)){b.5R=L}8(!1T(b.2G)){b.2G={}}8(!1k(b.2G.7y)){b.2G.7y=L}H b}D 6q(a,b){8(1o(b)){b=b.1h(a)}8(3p(b)){b={}}O 8(Y(b)){b={'E':b}}O 8(1z(b)){b=L}H b}D 6C(a,b){H b}D 3J(a,b,c,d,e){8(1p(a)){a=$(a,e)}8(1T(a)){a=$(a,e)}8(2v(a)){a=e.13().7a(a);8(!1k(c)){c=L}}O{8(!1k(c)){c=J}}8(!Y(a)){a=0}8(!Y(b)){b=0}8(c){a+=d.X}a+=b;8(d.Q>0){2h(a>=d.Q){a-=d.Q}2h(a<0){a+=d.Q}}H a}D 4D(i,o,s){F t=0,x=0;1j(F a=s;a>=0;a--){F j=i.1N(a);t+=(j.2f(':M'))?j[o.d['2w']](J):0;8(t>o.3U){H x}8(a==0){a=i.S}x++}}D 7c(i,o,s){H 66(i,o.E.1t,o.E.U.4t,s)}D 6T(i,o,s,m){H 66(i,o.E.1t,m,s)}D 66(i,f,m,s){F t=0,x=0;1j(F a=s,l=i.S;a>=0;a--){x++;8(x==l){H x}F j=i.1N(a);8(j.2f(f)){t++;8(t==m){H x}}8(a==0){a=l}}}D 5x(a,o){H o.E.U.4t||a.13().19(0,o.E.M).1t(o.E.1t).S}D 32(i,o,s){F t=0,x=0;1j(F a=s,l=i.S-1;a<=l;a++){F j=i.1N(a);t+=(j.2f(':M'))?j[o.d['2w']](J):0;8(t>o.3U){H x}x++;8(x==l+1){H x}8(a==l){a=-1}}}D 5I(i,o,s,l){F v=32(i,o,s);8(!o.1U){8(s+v>l){v=l-s}}H v}D 3W(i,o,s){H 68(i,o.E.1t,o.E.U.4t,s,o.1U)}D 6Z(i,o,s,m){H 68(i,o.E.1t,m+1,s,o.1U)-1}D 68(i,f,m,s,c){F t=0,x=0;1j(F a=s,l=i.S-1;a<=l;a++){x++;8(x>=l){H x}F j=i.1N(a);8(j.2f(f)){t++;8(t==m){H x}}8(a==l){a=-1}}}D 3I(i,o){H i.19(0,o.E.M)}D 6V(i,o,n){H i.19(n,o.E.U.20+n)}D 6W(i,o){H i.19(0,o.E.M)}D 71(i,o){H i.19(0,o.E.U.20)}D 72(i,o,n){H i.19(n,o.E.M+n)}D 4x(i,o,d){8(o.1R){8(!1p(d)){d='2a'}i.1W(D(){F j=$(1l),m=4k(j.Z(o.d['1S']),10);8(!Y(m)){m=0}j.1q(d,m)})}}D 1Y(i,o,m){8(o.1R){F x=(1k(m))?m:L;8(!Y(m)){m=0}4x(i,o,'7z');i.1W(D(){F j=$(1l);j.Z(o.d['1S'],((x)?j.1q('7z'):m+j.1q('2a')))})}}D 41(i){i.1W(D(){F j=$(1l);j.1q('7A',j.7B('7C')||'')})}D 4U(i){i.1W(D(){F j=$(1l);j.7B('7C',j.1q('7A')||'')})}D 5r(o,b){F c=o.E.M,7D=o.E[o.d['P']],69=o[o.d['1e']],7E=3V(69);b.1W(D(){F a=$(1l),6a=7D-7F(a,o,'8Z');a[o.d['P']](6a);8(7E){a[o.d['1e']](4s(6a,69))}})}D 4Q(a,o){F b=a.36(),$i=a.13(),$v=3I($i,o),54=4I(4J($v,o,J),o,L);b.Z(54);8(o.1R){F p=o.1i,r=p[o.d[1]];8(o.1B&&r<0){r=0}F c=$v.2P();c.Z(o.d['1S'],c.1q('2a')+r);a.Z(o.d['3q'],p[o.d[0]]);a.Z(o.d['1m'],p[o.d[3]])}a.Z(o.d['P'],54[o.d['P']]+(2R($i,o,'P')*2));a.Z(o.d['1e'],6b($i,o,'1e'));H 54}D 4J(i,o,a){H[2R(i,o,'P',a),6b(i,o,'1e',a)]}D 6b(i,o,a,b){8(!1k(b)){b=L}8(Y(o[o.d[a]])&&b){H o[o.d[a]]}8(Y(o.E[o.d[a]])){H o.E[o.d[a]]}a=(a.6c().3R('P')>-1)?'2w':'3n';H 4n(i,o,a)}D 4n(i,o,b){F s=0;1j(F a=0,l=i.S;a<l;a++){F j=i.1N(a);F m=(j.2f(':M'))?j[o.d[b]](J):0;8(s<m){s=m}}H s}D 2R(i,o,b,c){8(!1k(c)){c=L}8(Y(o[o.d[b]])&&c){H o[o.d[b]]}8(Y(o.E[o.d[b]])){H o.E[o.d[b]]*i.S}F d=(b.6c().3R('P')>-1)?'2w':'3n',s=0;1j(F a=0,l=i.S;a<l;a++){F j=i.1N(a);s+=(j.2f(':M'))?j[o.d[d]](J):0}H s}D 5d(a,o,d){F b=a.2f(':M');8(b){a.4j()}F s=a.36()[o.d[d]]();8(b){a.4m()}H s}D 5e(o,a){H(Y(o[o.d['P']]))?o[o.d['P']]:a}D 6d(i,o,b){F s=L,v=L;1j(F a=0,l=i.S;a<l;a++){F j=i.1N(a);F c=(j.2f(':M'))?j[o.d[b]](J):0;8(s===L){s=c}O 8(s!=c){v=J}8(s==0){v=J}}H v}D 7F(i,o,d){H i[o.d['90'+d]](J)-i[o.d[d.6c()]]()}D 4s(s,o){8(3V(o)){o=4k(o.19(0,-1),10);8(!Y(o)){H s}s*=o/2I}H s}D I(n,c,a,b,d){8(!1k(a)){a=J}8(!1k(b)){b=J}8(!1k(d)){d=L}8(a){n=c.3y.45+n}8(b){n=n+'.'+c.3y.7r}8(b&&d){n+=c.3T}H n}D 2y(n,c){H(1p(c.63[n]))?c.63[n]:n}D 4I(a,o,p){8(!1k(p)){p=J}F b=(o.1R&&p)?o.1i:[0,0,0,0];F c={};c[o.d['P']]=a[0]+b[1]+b[3];c[o.d['1e']]=a[1]+b[0]+b[2];H c}D 3e(c,d){F e=[];1j(F a=0,7G=c.S;a<7G;a++){1j(F b=0,7H=d.S;b<7H;b++){8(d[b].3R(2X c[a])>-1&&1z(e[b])){e[b]=c[a];17}}}H e}D 6x(p){8(1z(p)){H[0,0,0,0]}8(Y(p)){H[p,p,p,p]}8(1p(p)){p=p.3Q('91').7I('').3Q('92').7I('').3Q(' ')}8(!2V(p)){H[0,0,0,0]}1j(F i=0;i<4;i++){p[i]=4k(p[i],10)}1F(p.S){R 0:H[0,0,0,0];R 1:H[p[0],p[0],p[0],p[0]];R 2:H[p[0],p[1],p[0],p[1]];R 3:H[p[0],p[1],p[2],p[1]];2J:H[p[0],p[1],p[2],p[3]]}}D 4H(a,o){F x=(Y(o[o.d['P']]))?1H.2z(o[o.d['P']]-2R(a,o,'P')):0;1F(o.1B){R'1m':H[0,x];R'35':H[x,0];R'5f':2J:H[1H.2z(x/2),1H.4l(x/2)]}}D 6r(o){F a=[['P','7J','2w','1e','7K','3n','1m','3q','1S',0,1,2,3],['1e','7K','3n','P','7J','2w','3q','1m','5p',3,2,1,0]];F b=a[0].S,7L=(o.2l=='35'||o.2l=='1m')?0:1;F c={};1j(F d=0;d<b;d++){c[a[0][d]]=a[7L][d]}H c}D 4E(x,o,a,b){F v=x;8(1o(a)){v=a.1h(b,v)}O 8(1p(a)){F p=a.3Q('+'),m=a.3Q('-');8(m.S>p.S){F c=J,6e=m[0],30=m[1]}O{F c=L,6e=p[0],30=p[1]}1F(6e){R'93':v=(x%2==1)?x-1:x;17;R'94':v=(x%2==0)?x-1:x;17;2J:v=x;17}30=4k(30,10);8(Y(30)){8(c){30=-30}v+=30}}8(!Y(v)||v<1){v=1}H v}D 2x(x,o,a,b){H 6f(4E(x,o,a,b),o.E.U)}D 6f(v,i){8(Y(i.34)&&v<i.34){v=i.34}8(Y(i.1X)&&v>i.1X){v=i.1X}8(v<1){v=1}H v}D 5k(s){8(!2V(s)){s=[[s]]}8(!2V(s[0])){s=[s]}1j(F j=0,l=s.S;j<l;j++){8(1p(s[j][0])){s[j][0]=$(s[j][0])}8(!1k(s[j][1])){s[j][1]=J}8(!1k(s[j][2])){s[j][2]=J}8(!Y(s[j][3])){s[j][3]=0}}H s}D 65(k){8(k=='35'){H 39}8(k=='1m'){H 37}8(k=='5c'){H 38}8(k=='7h'){H 40}H-1}D 5H(n,a,c){8(n){F v=a.1P(I('4p',c));$.1s.1v.25.64(n,v)}}D 7m(n){F c=$.1s.1v.25.3F(n);H(c=='')?0:c}D 6E(a,b){F c={};1j(F p=0,l=b.S;p<l;p++){c[b[p]]=a.Z(b[p])}H c}D 6s(a,b,c,d){8(!1T(a.U)){a.U={}}8(!1T(a.3M)){a.3M={}}8(a.3m==0&&Y(d)){a.3m=d}8(1T(a.M)){a.U.34=a.M.34;a.U.1X=a.M.1X;a.M=L}O 8(1p(a.M)){8(a.M=='1d'){a.U.1d=J}O{a.U.2c=a.M}a.M=L}O 8(1o(a.M)){a.U.2c=a.M;a.M=L}8(!1p(a.1t)){a.1t=(c.1t(':3t').S>0)?':M':'*'}8(!a[b.d['P']]){8(b.2H){18(J,'7M a '+b.d['P']+' 1j 75 E!');a[b.d['P']]=4n(c,b,'2w')}O{a[b.d['P']]=(6d(c,b,'2w'))?'1d':c[b.d['2w']](J)}}8(!a[b.d['1e']]){a[b.d['1e']]=(6d(c,b,'3n'))?'1d':c[b.d['3n']](J)}a.3M.P=a.P;a.3M.1e=a.1e;H a}D 6w(a,b){8(a.E[a.d['P']]=='1d'){a.E.U.1d=J}8(!a.E.U.1d){8(Y(a[a.d['P']])){a.E.M=1H.4l(a[a.d['P']]/a.E[a.d['P']])}O{a.E.M=1H.4l(b/a.E[a.d['P']]);a[a.d['P']]=a.E.M*a.E[a.d['P']];8(!a.E.U.2c){a.1B=L}}8(a.E.M=='95'||a.E.M<1){18(J,'2p a 5K 28 4f M E: 7M 46 "1d".');a.E.U.1d=J}}H a}D 6t(a,b,c){8(a=='N'){a=4n(c,b,'2w')}H a}D 6u(a,b,c){8(a=='N'){a=4n(c,b,'3n')}8(!a){a=b.E[b.d['1e']]}H a}D 5i(o,a){F p=4H(3I(a,o),o);o.1i[o.d[1]]=p[1];o.1i[o.d[3]]=p[0];H o}D 5g(o,a,b){F c=6f(1H.2z(o[o.d['P']]/o.E[o.d['P']]),o.E.U);8(c>a.S){c=a.S}F d=1H.4l(o[o.d['P']]/c);o.E.M=c;o.E[o.d['P']]=d;o[o.d['P']]=c*d;H o}D 3N(p){8(1p(p)){F i=(p.3R('96')>-1)?J:L,r=(p.3R('3g')>-1)?J:L}O{F i=r=L}H[i,r]}D 97(a){H(Y(a))?a:3O}D 6g(a){H(a===3O)}D 1z(a){H(6g(a)||2X a=='7N'||a===''||a==='7N')}D 2V(a){H(a 2W 98)}D 2v(a){H(a 2W 7O)}D 1T(a){H((a 2W 99||2X a=='2A')&&!6g(a)&&!2v(a)&&!2V(a))}D Y(a){H((a 2W 4e||2X a=='28')&&!9a(a))}D 1p(a){H((a 2W 9b||2X a=='2M')&&!1z(a)&&!3p(a)&&!53(a))}D 1o(a){H(a 2W 9c||2X a=='D')}D 1k(a){H(a 2W 9d||2X a=='3d'||3p(a)||53(a))}D 3p(a){H(a===J||a==='J')}D 53(a){H(a===L||a==='L')}D 3V(x){H(1p(x)&&x.19(-1)=='%')}D 2o(){H 7v 7w().2o()}D 3X(o,n){18(J,o+' 2f 9e, 9f 1j 9g 9h 9i 9j. 9k '+n+' 9l.')}D 18(d,m){8(!1z(3l.6h)&&!1z(3l.6h.7P)){8(1T(d)){F s=' ('+d.4o+')';d=d.18}O{F s=''}8(!d){H L}8(1p(m)){m='1v'+s+': '+m}O{m=['1v'+s+':',m]}3l.6h.7P(m)}H L}$.1L($.2u,{'9m':D(t){F a=t*t;H t*(-a*t+4*a-6*t+4)},'9n':D(t){H t*(4*t*t-9*t+6)},'9o':D(t){F a=t*t;H t*(33*a*a-9p*a*t+9q*a-67*t+15)}})})(7O);`,62,585,"|||||||opts|if|||||||||||||||||||||||||||||||function|items|var|conf|return|cf_e|true|itms|false|visible|auto|else|width|total|case|length|trigger|visibleConf|scrl|button|first|is_number|css||bind|tt0|children|prev||next|break|debug|slice|anims|pagination|push|variable|height|progress|stopPropagation|call|padding|for|is_boolean|this|left|wrp|is_function|is_string|data|swipe|fn|filter|tmrs|carouFredSel|fade|_onafter|_moveitems|is_undefined|container|align|_s_paddingold|_s_paddingcur|opacity|switch|play|Math|cover|_position|scroll|extend|duration|eq|_a_wrapper|triggerHandler|mousewheel|usePadding|marginRight|is_object|circular|fx|each|max|sz_resetMargin|i_cur_l|old|i_old_l|uncover|unbind||cookie|isScrolling|isPaused|number|a_cfs|_cfs_origCssMargin|clbk|adjust|isStopped|stopImmediatePropagation|is|queu|while|i_new|w_siz|nr|direction|avail_primary|synchronise|getTime|Not|bar|i_new_l|a_cur|remove|easing|is_jquery|outerWidth|cf_getItemsAdjust|cf_c|ceil|object|pR|_s_paddingnew|preventDefault|a_itm|pauseOnHover|options|responsive|100|default|timeoutDuration|startTime|string|removeClass|queue|last|i_skp|ms_getTotalSize|a_old|a_lef|a_dur|is_array|instanceof|typeof|key|transition|adj|opts_orig|gn_getVisibleItemsNext||min|right|parent||||addClass|pause|perc|boolean|cf_sortParams|scrolling|resume|onAfter|i_old|crossfade|slideTo|window|start|outerHeight|_cfs_triggerEvent|is_true|top|position|wrapper|hidden|sc_clearTimers|timePassed|Carousel|sc_startScroll|events|infinite|nv_enableNavi|i_siz|i_siz_vis|_a_paddingold|_a_paddingcur|get|onBefore|updatePageStatus|gi_getCurrentItems|gn_getItemIndex|anchorBuilder|event|sizesConf|bt_pauseOnHoverConfig|null|ns2|split|indexOf|go_getObject|serialNumber|maxDimension|is_percentage|gn_getVisibleItemsNextFilter|deprecated|orgCSS|zIndex||sz_storeOrigCss|none|sc_stopScroll|dur2|prefix|to|appendTo|sc_setScroll||sc_fireCallbacks|currentPage|end|before|Number|of|document|onTouch|onResize|hide|parseInt|floor|show|ms_getTrueLargestSize|selector|currentPosition|destroy|primarySizePercentage|ms_getPercentage|org|onTimeoutStart|onTimeoutPause|onTimeoutEnd|sz_storeMargin|stopped|pre|post|updater|minimum|gn_getVisibleItemsPrev|cf_getAdjust|onEnd|clone|cf_getAlignPadding|cf_mapWrapperSizes|ms_getSizes|a_wsz|a_new|not|a_cfs_vis|updateSizes|eval|sz_setSizes|pgs|deviation|nv_showNavi|sz_restoreOrigCss|mouseenter|mouseleave|pauseOnEvent|keys|throttle||di|go_getNaviObject|is_false|sz|element|starting_position|_cfs_isCarousel||_cfs_init|go_getPrevNextObject|defaults|up|ms_getParentSize|ms_getMaxDimension|center|in_getResponsiveValues|bottom|in_getAlignPadding|go_complementPrevNextObject|cf_getSynchArr|onPauseStart|onPausePause|onPauseEnd|pauseDuration|marginBottom|newPosition|sz_setResponsiveSizes|_cfs_unbind_events|finish|interval|type|conditions|gn_getVisibleOrg|backward|sc_hideHiddenItems|a_lef_vis|sc_getDuration|_a_paddingnew|sc_showHiddenItems|sc_mapCallbackArguments|sc_afterScroll|sc_fireQueue|cf_setCookie|gn_getVisibleItemsNextTestCircular|slideToPage|valid|linkAnchors|value|_cfs_bind_buttons|click|_cfs_unbind_buttons|scrolled|onMouse|swP|swN|delay|pauseOnResize|debounce|onWindowResize|_windowHeight|nh||ns3|continue|classnames|set|cf_getKeyCode|gn_getItemsPrevFilter||gn_getItemsNextFilter|seco|nw|ms_getLargestSize|toLowerCase|ms_hasVariableSizes|sta|cf_getItemAdjustMinMax|is_null|console|caroufredsel|No|found|go_getItemsObject|go_getScrollObject|go_getAutoObject|go_getPaginationObject|go_getSwipeObject|go_getMousewheelObject|cf_getDimensions|in_complementItems|in_complementPrimarySize|in_complementSecondarySize|upDateOnWindowResize|in_complementVisibleItems|cf_getPadding|500|go_complementAutoObject|go_complementPaginationObject|go_complementSwipeObject|go_complementMousewheelObject|_cfs_build|in_mapCss|textAlign|float|marginTop|marginLeft|absolute|_cfs_origCssZindex|_cfs_bind_events|stop|paused|enough|needed|page|slide_|configuration|gn_getScrollItemsPrevFilter|Scrolling|gi_getOldItemsPrev|gi_getNewItemsPrev|directscroll|concat|gn_getScrollItemsNextFilter|forward|gi_getOldItemsNext|gi_getNewItemsNext|jumpToStart|after|the|append|removeItem|round|hash|index|selected|gn_getVisibleItemsPrevFilter|Item|keyup|keyCode|scN|down|cursor|mcN|configs|classname|cf_getCookie|random|itm|onCreate|swing|namespace|pageAnchorBuilder|span|progressbarUpdater|new|Date|_cfs_isHidden|triggerOnTouchEnd|_cfs_tempCssMargin|_cfs_origCss|attr|style|newS|secp|ms_getPaddingBorderMargin|l1|l2|join|innerWidth|innerHeight|dx|Set|undefined|jQuery|log|caroufredsel_cookie_|relative|fixed|overflow|setInterval|setTimeout|or|Callback|returned|Page|resumed|currently|slide_prev|prependTo|slide_next|prevPage|nextPage|prepend|carousel|insertItem|Correct|insert|Appending|item|add|detach|currentVisible|body|find|Preventing|non|sliding|replaceWith|widths|heights|automatically|ontouchstart|in|swipeUp|swipeDown|swipeLeft|swipeRight|move|200|300|resize|wrap|class|animate|unshift|location|cfs|div|caroufredsel_wrapper|href|charAt|setTime|1000|expires|toGMTString|path|ease|orgDuration|shift|clearTimeout|clearInterval|skipped|Hiding|navigation|disabled|2500|Width|outer|px|em|even|odd|Infinity|immediate|bt_mousesheelNumber|Array|Object|isNaN|String|Function|Boolean|DEPRECATED|support|it|will|be|removed|Use|instead|quadratic|cubic|elastic|106|126".split("|"),0,{})),(function(e){var r,_,p,s,m,f,T,k,D,V,O=0,b={},R=[],S=0,h={},w=[],P=null,N=new Image,X=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,te=/[^\.]\.(swf)\s*$/i,ne,K=1,M=0,J="",U,F,H=!1,W=e.extend(e("<div/>")[0],{prop:0}),re=e.browser.msie&&e.browser.version<7&&!window.XMLHttpRequest,y=function(){_.hide(),N.onerror=N.onload=null,P&&P.abort(),r.empty()},ke=function(){if(b.onError(R,O,b)===!1){_.hide(),H=!1;return}b.titleShow=!1,b.width="auto",b.height="auto",r.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),Ge()},ce=function(){var me=R[O],oe,Fe,$e,ut,mt,kt;if(y(),b=e.extend({},e.fn.fancybox.defaults,typeof e(me).data("fancybox")=="undefined"?b:e(me).data("fancybox")),kt=b.onStart(R,O,b),kt===!1){H=!1;return}else typeof kt=="object"&&(b=e.extend(b,kt));if($e=b.title||(me.nodeName?e(me).attr("title"):me.title)||"",me.nodeName&&!b.orig&&(b.orig=e(me).children("img:first").length?e(me).children("img:first"):e(me)),$e===""&&b.orig&&b.titleFromAlt&&($e=b.orig.attr("alt")),oe=b.href||(me.nodeName?e(me).attr("href"):me.href)||null,(/^(?:javascript)/i.test(oe)||oe=="#")&&(oe=null),b.type?(Fe=b.type,oe||(oe=b.content)):b.content?Fe="html":oe&&(oe.match(X)?Fe="image":oe.match(te)?Fe="swf":e(me).hasClass("iframe")?Fe="iframe":oe.indexOf("#")===0?Fe="inline":Fe="ajax"),!Fe){ke();return}switch(Fe=="inline"&&(me=oe.substr(oe.indexOf("#")),Fe=e(me).length>0?"inline":"ajax"),b.type=Fe,b.href=oe,b.title=$e,b.autoDimensions&&(b.type=="html"||b.type=="inline"||b.type=="ajax"?(b.width="auto",b.height="auto"):b.autoDimensions=!1),b.modal&&(b.overlayShow=!0,b.hideOnOverlayClick=!1,b.hideOnContentClick=!1,b.enableEscapeButton=!1,b.showCloseButton=!1),b.padding=parseInt(b.padding,10),b.margin=parseInt(b.margin,10),r.css("padding",b.padding+b.margin),e(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){e(this).replaceWith(f.children())}),Fe){case"html":r.html(b.content),Ge();break;case"inline":if(e(me).parent().is("#fancybox-content")===!0){H=!1;return}e('<div class="fancybox-inline-tmp" />').hide().insertBefore(e(me)).bind("fancybox-cleanup",function(){e(this).replaceWith(f.children())}).bind("fancybox-cancel",function(){e(this).replaceWith(r.children())}),e(me).appendTo(r),Ge();break;case"image":H=!1,e.fancybox.showActivity(),N=new Image,N.onerror=function(){ke()},N.onload=function(){H=!0,N.onerror=N.onload=null,lt()},N.src=oe;break;case"swf":b.scrolling="no",ut='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+b.width+'" height="'+b.height+'"><param name="movie" value="'+oe+'"></param>',mt="",e.each(b.swf,function(Ft,Mt){ut+='<param name="'+Ft+'" value="'+Mt+'"></param>',mt+=" "+Ft+'="'+Mt+'"'}),ut+='<embed src="'+oe+'" type="application/x-shockwave-flash" width="'+b.width+'" height="'+b.height+'"'+mt+"></embed></object>",r.html(ut),Ge();break;case"ajax":H=!1,e.fancybox.showActivity(),b.ajax.win=b.ajax.success,P=e.ajax(e.extend({},b.ajax,{url:oe,data:b.ajax.data||{},error:function(Ft,Mt,Lt){Ft.status>0&&ke()},success:function(Ft,Mt,Lt){var Nt=typeof Lt=="object"?Lt:P;if(Nt.status==200){if(typeof b.ajax.win=="function")if(kt=b.ajax.win(oe,Ft,Mt,Lt),kt===!1){_.hide();return}else(typeof kt=="string"||typeof kt=="object")&&(Ft=kt);r.html(Ft),Ge()}}}));break;case"iframe":c();break}},Ge=function(){var me=b.width,oe=b.height;me.toString().indexOf("%")>-1?me=parseInt((e(window).width()-b.margin*2)*parseFloat(me)/100,10)+"px":me=me=="auto"?"auto":me+"px",oe.toString().indexOf("%")>-1?oe=parseInt((e(window).height()-b.margin*2)*parseFloat(oe)/100,10)+"px":oe=oe=="auto"?"auto":oe+"px",r.wrapInner('<div style="width:'+me+";height:"+oe+";overflow: "+(b.scrolling=="auto"?"auto":b.scrolling=="yes"?"scroll":"hidden")+';position:relative;"></div>'),b.width=r.width(),b.height=r.height(),c()},lt=function(){b.width=N.width,b.height=N.height,e("<img />").attr({id:"fancybox-img",src:N.src,alt:b.title}).appendTo(r),c()},c=function(){e("#fancybox-outer").css("background","white");var me,oe;if(_.hide(),s.is(":visible")&&h.onCleanup(w,S,h)===!1){e.event.trigger("fancybox-cancel"),H=!1;return}if(H=!0,e(f.add(p)).unbind(),e(window).unbind("resize.fb scroll.fb"),e(document).unbind("keydown.fb"),s.is(":visible")&&h.titlePosition!=="outside"&&s.css("height",s.height()),w=R,S=O,h=b,h.overlayShow?(p.css({"background-color":h.overlayColor,opacity:h.overlayOpacity,cursor:h.hideOnOverlayClick?"pointer":"auto",height:e(document).height()}),p.is(":visible")||(re&&e("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"}),p.show())):p.hide(),F=Ot(),De(),s.is(":visible")){e(T.add(D).add(V)).hide(),me=s.position(),U={top:me.top,left:me.left,width:s.width(),height:s.height()},oe=U.width==F.width&&U.height==F.height,f.fadeTo(h.changeFade,.3,function(){var Fe=function(){f.html(r.contents()).fadeTo(h.changeFade,1,je)};e.event.trigger("fancybox-change"),f.empty().removeAttr("filter").css({"border-width":h.padding,width:F.width-h.padding*2,height:b.autoDimensions?"auto":F.height-M-h.padding*2}),oe?Fe():(W.prop=0,e(W).animate({prop:1},{duration:h.changeSpeed,easing:h.easingChange,step:qe,complete:Fe}))});return}if(s.removeAttr("style"),f.css("border-width",h.padding),h.transitionIn=="elastic"){U=Zt(),f.html(r.contents()),s.show(),h.opacity&&(F.opacity=0),W.prop=0,e(W).animate({prop:1},{duration:h.speedIn,easing:h.easingIn,step:qe,complete:je});return}h.titlePosition=="inside"&&M>0&&k.show(),f.css({width:F.width-h.padding*2,height:b.autoDimensions?"auto":F.height-M-h.padding*2}).html(r.contents()),s.css(F).fadeIn(h.transitionIn=="none"?0:h.speedIn,je)},we=function(me){return me&&me.length?h.titlePosition=="float"?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+me+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+h.titlePosition+'">'+me+"</div>":!1},De=function(){if(J=h.title||"",M=0,k.empty().removeAttr("style").removeClass(),h.titleShow===!1){k.hide();return}if(J=e.isFunction(h.titleFormat)?h.titleFormat(J,w,S,h):we(J),!J||J===""){k.hide();return}switch(k.addClass("fancybox-title-"+h.titlePosition).html(J).appendTo("body").show(),h.titlePosition){case"inside":k.css({width:F.width-h.padding*2,marginLeft:h.padding,marginRight:h.padding}),M=k.outerHeight(!0),k.appendTo(m),F.height+=M;break;case"over":k.css({marginLeft:h.padding,width:F.width-h.padding*2,bottom:h.padding}).appendTo(m);break;case"float":k.css("left",parseInt((k.width()-F.width-40)/2,10)*-1).appendTo(s);break;default:k.css({width:F.width-h.padding*2,paddingLeft:h.padding,paddingRight:h.padding}).appendTo(s);break}k.hide()},Re=function(){if((h.enableEscapeButton||h.enableKeyboardNav)&&e(document).bind("keydown.fb",function(me){me.keyCode==27&&h.enableEscapeButton?(me.preventDefault(),e.fancybox.close()):(me.keyCode==37||me.keyCode==39)&&h.enableKeyboardNav&&me.target.tagName!=="INPUT"&&me.target.tagName!=="TEXTAREA"&&me.target.tagName!=="SELECT"&&(me.preventDefault(),e.fancybox[me.keyCode==37?"prev":"next"]())}),!h.showNavArrows){D.hide(),V.hide();return}(h.cyclic&&w.length>1||S!==0)&&D.show(),(h.cyclic&&w.length>1||S!=w.length-1)&&V.show()},je=function(){e.support.opacity||(f.get(0).style.removeAttribute("filter"),s.get(0).style.removeAttribute("filter")),b.autoDimensions&&f.css("height","auto"),s.css("height","auto"),J&&J.length&&k.show(),h.showCloseButton&&T.show(),Re(),h.hideOnContentClick&&f.bind("click",e.fancybox.close),h.hideOnOverlayClick&&p.bind("click",e.fancybox.close),e(window).bind("resize.fb",e.fancybox.resize),h.centerOnScroll&&e(window).bind("scroll.fb",e.fancybox.center),h.type=="iframe"&&e('<iframe id="fancybox-frame" name="fancybox-frame'+new Date().getTime()+'" frameborder="0" hspace="0" '+(e.browser.msie?'allowtransparency="true""':"")+' scrolling="'+b.scrolling+'" src="'+h.href+'"></iframe>').appendTo(f),s.show(),H=!1,e.fancybox.center(),h.onComplete(w,S,h),Pe()},Pe=function(){var me,oe;w.length-1>S&&(me=w[S+1].href,typeof me!="undefined"&&me.match(X)&&(oe=new Image,oe.src=me)),S>0&&(me=w[S-1].href,typeof me!="undefined"&&me.match(X)&&(oe=new Image,oe.src=me))},qe=function(me){var oe={width:parseInt(U.width+(F.width-U.width)*me,10),height:parseInt(U.height+(F.height-U.height)*me,10),top:parseInt(U.top+(F.top-U.top)*me,10),left:parseInt(U.left+(F.left-U.left)*me,10)};typeof F.opacity!="undefined"&&(oe.opacity=me<.5?.5:me),s.css(oe),f.css({width:oe.width-h.padding*2,height:oe.height-M*me-h.padding*2})},ft=function(){return[e(window).width()-h.margin*2,e(window).height()-h.margin*2,e(document).scrollLeft()+h.margin,e(document).scrollTop()+h.margin]},Ot=function(){var me=ft(),oe={},Fe=h.autoScale,$e=h.padding*2,ut;return h.width.toString().indexOf("%")>-1?oe.width=parseInt(me[0]*parseFloat(h.width)/100,10):oe.width=h.width+$e,h.height.toString().indexOf("%")>-1?oe.height=parseInt(me[1]*parseFloat(h.height)/100,10):oe.height=h.height+$e,Fe&&(oe.width>me[0]||oe.height>me[1])&&(b.type=="image"||b.type=="swf"?(ut=h.width/h.height,oe.width>me[0]&&(oe.width=me[0],oe.height=parseInt((oe.width-$e)/ut+$e,10)),oe.height>me[1]&&(oe.height=me[1],oe.width=parseInt((oe.height-$e)*ut+$e,10))):(oe.width=Math.min(oe.width,me[0]),oe.height=Math.min(oe.height,me[1]))),oe.top=parseInt(Math.max(me[3]-20,me[3]+(me[1]-oe.height-40)*.5),10),oe.left=parseInt(Math.max(me[2]-20,me[2]+(me[0]-oe.width-40)*.5),10),oe},Kt=function(me){var oe=me.offset();return oe.top+=parseInt(me.css("paddingTop"),10)||0,oe.left+=parseInt(me.css("paddingLeft"),10)||0,oe.top+=parseInt(me.css("border-top-width"),10)||0,oe.left+=parseInt(me.css("border-left-width"),10)||0,oe.width=me.width(),oe.height=me.height(),oe},Zt=function(){var me=b.orig?e(b.orig):!1,oe={},Fe,$e;return me&&me.length?(Fe=Kt(me),oe={width:Fe.width+h.padding*2,height:Fe.height+h.padding*2,top:Fe.top-h.padding-20,left:Fe.left-h.padding-20}):($e=ft(),oe={width:h.padding*2,height:h.padding*2,top:parseInt($e[3]+$e[1]*.5,10),left:parseInt($e[2]+$e[0]*.5,10)}),oe},zt=function(){if(!_.is(":visible")){clearInterval(ne);return}e("div",_).css("top",K*-40+"px"),K=(K+1)%12};e.fn.fancybox=function(me){return e(this).length?(e(this).data("fancybox",e.extend({},me,e.metadata?e(this).metadata():{})).unbind("click.fb").bind("click.fb",function(oe){if(oe.preventDefault(),!H){H=!0,e(this).blur(),R=[],O=0;var Fe=e(this).attr("rel")||"";!Fe||Fe==""||Fe==="nofollow"?R.push(this):(R=e("a[rel="+Fe+"], area[rel="+Fe+"]"),O=R.index(this)),ce()}}),this):this},e.fancybox=function(me){var oe;if(!H){if(H=!0,oe=typeof arguments[1]!="undefined"?arguments[1]:{},R=[],O=parseInt(oe.index,10)||0,e.isArray(me)){for(var Fe=0,$e=me.length;Fe<$e;Fe++)typeof me[Fe]=="object"?e(me[Fe]).data("fancybox",e.extend({},oe,me[Fe])):me[Fe]=e({}).data("fancybox",e.extend({content:me[Fe]},oe));R=jQuery.merge(R,me)}else typeof me=="object"?e(me).data("fancybox",e.extend({},oe,me)):me=e({}).data("fancybox",e.extend({content:me},oe)),R.push(me);(O>R.length||O<0)&&(O=0),ce()}},e.fancybox.showActivity=function(){clearInterval(ne),_.show(),ne=setInterval(zt,66)},e.fancybox.hideActivity=function(){_.hide()},e.fancybox.next=function(){return e.fancybox.pos(S+1)},e.fancybox.prev=function(){return e.fancybox.pos(S-1)},e.fancybox.pos=function(me){H||(me=parseInt(me),R=w,me>-1&&me<w.length?(O=me,ce()):h.cyclic&&w.length>1&&(O=me>=w.length?0:w.length-1,ce()))},e.fancybox.cancel=function(){H||(H=!0,e.event.trigger("fancybox-cancel"),y(),b.onCancel(R,O,b),H=!1)},e.fancybox.close=function(){if(H||s.is(":hidden"))return;if(H=!0,h&&(typeof h.onCleanup!="function"||h.onCleanup(w,S,h)===!1)){H=!1;return}y(),e(T.add(D).add(V)).hide(),e(f.add(p)).unbind(),e(window).unbind("resize.fb scroll.fb"),e(document).unbind("keydown.fb"),f.find("iframe").attr("src",re&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank"),h.titlePosition!=="inside"&&k.empty(),s.stop();function me(){p.fadeOut("fast"),k.empty().hide(),s.hide(),e.event.trigger("fancybox-cleanup"),f.empty(),h.onClosed(w,S,h),w=b=[],S=O=0,h=b={},H=!1}if(h.transitionOut=="elastic"){U=Zt();var oe=s.position();F={top:oe.top,left:oe.left,width:s.width(),height:s.height()},h.opacity&&(F.opacity=1),k.empty().hide(),W.prop=1,e(W).animate({prop:0},{duration:h.speedOut,easing:h.easingOut,step:qe,complete:me})}else s.fadeOut(h.transitionOut=="none"?0:h.speedOut,me)},e.fancybox.resize=function(){p.is(":visible")&&p.css("height",e(document).height()),e.fancybox.center(!0)},e.fancybox.center=function(){if(!(h&&h.center===!1)){var me,oe;H||(oe=arguments[0]===!0?1:0,me=ft(),!(!oe&&(s.width()>me[0]||s.height()>me[1]))&&s.stop().animate({top:parseInt(Math.max(me[3]-20,me[3]+(me[1]-f.height()-40)*.5-h.padding)),left:parseInt(Math.max(me[2]-20,me[2]+(me[0]-f.width()-40)*.5-h.padding))},typeof arguments[0]=="number"?arguments[0]:200))}},e.fancybox.init=function(){e("#fancybox-wrap").length||(e("body").append(r=e('<div id="fancybox-tmp"></div>'),_=e('<div id="fancybox-loading"><div></div></div>'),p=e('<div id="fancybox-overlay"></div>'),s=e('<div id="fancybox-wrap"></div>')),m=e('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(s),m.append(f=e('<div id="fancybox-content"></div>'),T=e('<a id="fancybox-close"></a>'),k=e('<div id="fancybox-title"></div>'),D=e('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),V=e('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>')),T.click(e.fancybox.close),_.click(e.fancybox.cancel),D.click(function(me){me.preventDefault(),e.fancybox.prev()}),V.click(function(me){me.preventDefault(),e.fancybox.next()}),e.fn.mousewheel&&s.bind("mousewheel.fb",function(me,oe){H?me.preventDefault():(e(me.target).get(0).clientHeight==0||e(me.target).get(0).scrollHeight===e(me.target).get(0).clientHeight)&&(me.preventDefault(),e.fancybox[oe>0?"prev":"next"]())}),e.support.opacity||s.addClass("fancybox-ie"),re&&(_.addClass("fancybox-ie6"),s.addClass("fancybox-ie6"),e('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(m)))},e.fn.fancybox.defaults={padding:10,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,center:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}},e(document).ready(function(){e.fancybox.init()})})(jQuery),(function(e){function r(s){var m=s||window.event,f=[].slice.call(arguments,1),T=0,k=!0,D=0,V=0;return s=e.event.fix(m),s.type="mousewheel",m.wheelDelta&&(T=m.wheelDelta/120),m.detail&&(T=-m.detail/3),V=T,m.axis!==void 0&&m.axis===m.HORIZONTAL_AXIS&&(V=0,D=-1*T),m.wheelDeltaY!==void 0&&(V=m.wheelDeltaY/120),m.wheelDeltaX!==void 0&&(D=-1*m.wheelDeltaX/120),f.unshift(s,T,D,V),(e.event.dispatch||e.event.handle).apply(this,f)}var _=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var p=_.length;p;)e.event.fixHooks[_[--p]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var s=_.length;s;)this.addEventListener(_[--s],r,!1);else this.onmousewheel=r},teardown:function(){if(this.removeEventListener)for(var s=_.length;s;)this.removeEventListener(_[--s],r,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(s){return s?this.bind("mousewheel",s):this.trigger("mousewheel")},unmousewheel:function(s){return this.unbind("mousewheel",s)}})})(jQuery),(function(e){var r={init:function(f){var m={set_width:!1,set_height:!1,horizontalScroll:!1,scrollInertia:950,mouseWheel:!0,mouseWheelPixels:"auto",autoDraggerLength:!0,autoHideScrollbar:!1,snapAmount:null,snapOffset:0,scrollButtons:{enable:!1,scrollType:"continuous",scrollSpeed:"auto",scrollAmount:40},advanced:{updateOnBrowserResize:!0,updateOnContentResize:!1,autoExpandHorizontalScroll:!1,autoScrollOnFocus:!0,normalizeMouseWheelDelta:!1},contentTouchScroll:!0,callbacks:{onScrollStart:function(){},onScroll:function(){},onTotalScroll:function(){},onTotalScrollBack:function(){},onTotalScrollOffset:0,onTotalScrollBackOffset:0,whileScrolling:function(){}},theme:"light"},f=e.extend(!0,m,f);return this.each(function(){var T=e(this);if(f.set_width&&T.css("width",f.set_width),f.set_height&&T.css("height",f.set_height),!e(document).data("mCustomScrollbar-index"))e(document).data("mCustomScrollbar-index","1");else{var k=parseInt(e(document).data("mCustomScrollbar-index"));e(document).data("mCustomScrollbar-index",k+1)}T.wrapInner("<div class='mCustomScrollBox mCS-"+f.theme+"' id='mCSB_"+e(document).data("mCustomScrollbar-index")+"' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_"+e(document).data("mCustomScrollbar-index"));var D=T.children(".mCustomScrollBox");if(f.horizontalScroll){D.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />");var V=D.children(".mCSB_h_wrapper");V.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({width:V.children().outerWidth(),position:"relative"}).unwrap()}else D.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />");var O=D.children(".mCSB_container");e.support.touch&&O.addClass("mCS_touch"),O.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");var b=D.children(".mCSB_scrollTools"),R=b.children(".mCSB_draggerContainer"),S=R.children(".mCSB_dragger");if(f.horizontalScroll?S.data("minDraggerWidth",S.width()):S.data("minDraggerHeight",S.height()),f.scrollButtons.enable&&(f.horizontalScroll?b.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>"):b.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>")),D.bind("scroll",function(){T.is(".mCS_disabled")||D.scrollTop(0).scrollLeft(0)}),T.data({mCS_Init:!0,mCustomScrollbarIndex:e(document).data("mCustomScrollbar-index"),horizontalScroll:f.horizontalScroll,scrollInertia:f.scrollInertia,scrollEasing:"mcsEaseOut",mouseWheel:f.mouseWheel,mouseWheelPixels:f.mouseWheelPixels,autoDraggerLength:f.autoDraggerLength,autoHideScrollbar:f.autoHideScrollbar,snapAmount:f.snapAmount,snapOffset:f.snapOffset,scrollButtons_enable:f.scrollButtons.enable,scrollButtons_scrollType:f.scrollButtons.scrollType,scrollButtons_scrollSpeed:f.scrollButtons.scrollSpeed,scrollButtons_scrollAmount:f.scrollButtons.scrollAmount,autoExpandHorizontalScroll:f.advanced.autoExpandHorizontalScroll,autoScrollOnFocus:f.advanced.autoScrollOnFocus,normalizeMouseWheelDelta:f.advanced.normalizeMouseWheelDelta,contentTouchScroll:f.contentTouchScroll,onScrollStart_Callback:f.callbacks.onScrollStart,onScroll_Callback:f.callbacks.onScroll,onTotalScroll_Callback:f.callbacks.onTotalScroll,onTotalScrollBack_Callback:f.callbacks.onTotalScrollBack,onTotalScroll_Offset:f.callbacks.onTotalScrollOffset,onTotalScrollBack_Offset:f.callbacks.onTotalScrollBackOffset,whileScrolling_Callback:f.callbacks.whileScrolling,bindEvent_scrollbar_drag:!1,bindEvent_content_touch:!1,bindEvent_scrollbar_click:!1,bindEvent_mousewheel:!1,bindEvent_buttonsContinuous_y:!1,bindEvent_buttonsContinuous_x:!1,bindEvent_buttonsPixels_y:!1,bindEvent_buttonsPixels_x:!1,bindEvent_focusin:!1,bindEvent_autoHideScrollbar:!1,mCSB_buttonScrollRight:!1,mCSB_buttonScrollLeft:!1,mCSB_buttonScrollDown:!1,mCSB_buttonScrollUp:!1}),f.horizontalScroll)T.css("max-width")!=="none"&&(f.advanced.updateOnContentResize||(f.advanced.updateOnContentResize=!0));else if(T.css("max-height")!=="none"){var h=!1,w=parseInt(T.css("max-height"));T.css("max-height").indexOf("%")>=0&&(h=w,w=T.parent().height()*h/100),T.css("overflow","hidden"),D.css("max-height",w)}if(T.mCustomScrollbar("update"),f.advanced.updateOnBrowserResize){var P,N=e(window).width(),X=e(window).height();e(window).bind("resize."+T.data("mCustomScrollbarIndex"),function(){P&&clearTimeout(P),P=setTimeout(function(){if(!T.is(".mCS_disabled")&&!T.is(".mCS_destroyed")){var K=e(window).width(),M=e(window).height();(N!==K||X!==M)&&(T.css("max-height")!=="none"&&h&&D.css("max-height",T.parent().height()*h/100),T.mCustomScrollbar("update"),N=K,X=M)}},150)})}if(f.advanced.updateOnContentResize){var te;if(f.horizontalScroll)var ne=O.outerWidth();else var ne=O.outerHeight();te=setInterval(function(){if(f.horizontalScroll){f.advanced.autoExpandHorizontalScroll&&O.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:O.outerWidth(),position:"relative"}).unwrap();var K=O.outerWidth()}else var K=O.outerHeight();K!=ne&&(T.mCustomScrollbar("update"),ne=K)},300)}})},update:function(){var s=e(this),m=s.children(".mCustomScrollBox"),f=m.children(".mCSB_container");f.removeClass("mCS_no_scrollbar"),s.removeClass("mCS_disabled mCS_destroyed"),m.scrollTop(0).scrollLeft(0);var T=m.children(".mCSB_scrollTools"),k=T.children(".mCSB_draggerContainer"),D=k.children(".mCSB_dragger");if(s.data("horizontalScroll")){var V=T.children(".mCSB_buttonLeft"),O=T.children(".mCSB_buttonRight"),b=m.width();s.data("autoExpandHorizontalScroll")&&f.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:f.outerWidth(),position:"relative"}).unwrap();var R=f.outerWidth()}else var S=T.children(".mCSB_buttonUp"),h=T.children(".mCSB_buttonDown"),w=m.height(),P=f.outerHeight();if(P>w&&!s.data("horizontalScroll")){T.css("display","block");var N=k.height();if(s.data("autoDraggerLength")){var X=Math.round(w/P*N),te=D.data("minDraggerHeight");if(X<=te)D.css({height:te});else if(X>=N-10){var ne=N-10;D.css({height:ne})}else D.css({height:X});D.children(".mCSB_dragger_bar").css({"line-height":D.height()+"px"})}var K=D.height(),M=(P-w)/(N-K);s.data("scrollAmount",M).mCustomScrollbar("scrolling",m,f,k,D,S,h,V,O);var J=Math.abs(f.position().top);s.mCustomScrollbar("scrollTo",J,{scrollInertia:0,trigger:"internal"})}else if(R>b&&s.data("horizontalScroll")){T.css("display","block");var U=k.width();if(s.data("autoDraggerLength")){var F=Math.round(b/R*U),H=D.data("minDraggerWidth");if(F<=H)D.css({width:H});else if(F>=U-10){var W=U-10;D.css({width:W})}else D.css({width:F})}var re=D.width(),M=(R-b)/(U-re);s.data("scrollAmount",M).mCustomScrollbar("scrolling",m,f,k,D,S,h,V,O);var J=Math.abs(f.position().left);s.mCustomScrollbar("scrollTo",J,{scrollInertia:0,trigger:"internal"})}else m.unbind("mousewheel focusin"),s.data("horizontalScroll")?D.add(f).css("left",0):D.add(f).css("top",0),T.css("display","none"),f.addClass("mCS_no_scrollbar"),s.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1})},scrolling:function(s,m,f,T,k,D,V,O){var b=e(this);if(!b.data("bindEvent_scrollbar_drag")){var R,S;e.support.msPointer?(T.bind("MSPointerDown",function(H){H.preventDefault(),b.data({on_drag:!0}),T.addClass("mCSB_dragger_onDrag");var W=e(this),re=W.offset(),y=H.originalEvent.pageX-re.left,ke=H.originalEvent.pageY-re.top;y<W.width()&&y>0&&ke<W.height()&&ke>0&&(R=ke,S=y)}),e(document).bind("MSPointerMove."+b.data("mCustomScrollbarIndex"),function(H){if(H.preventDefault(),b.data("on_drag")){var W=T,re=W.offset(),y=H.originalEvent.pageX-re.left,ke=H.originalEvent.pageY-re.top;h(R,S,ke,y)}}).bind("MSPointerUp."+b.data("mCustomScrollbarIndex"),function(H){b.data({on_drag:!1}),T.removeClass("mCSB_dragger_onDrag")})):(T.bind("mousedown touchstart",function(H){H.preventDefault(),H.stopImmediatePropagation();var W=e(this),re=W.offset(),y,ke;if(H.type==="touchstart"){var ce=H.originalEvent.touches[0]||H.originalEvent.changedTouches[0];y=ce.pageX-re.left,ke=ce.pageY-re.top}else b.data({on_drag:!0}),T.addClass("mCSB_dragger_onDrag"),y=H.pageX-re.left,ke=H.pageY-re.top;y<W.width()&&y>0&&ke<W.height()&&ke>0&&(R=ke,S=y)}).bind("touchmove",function(H){H.preventDefault(),H.stopImmediatePropagation();var W=H.originalEvent.touches[0]||H.originalEvent.changedTouches[0],re=e(this),y=re.offset(),ke=W.pageX-y.left,ce=W.pageY-y.top;h(R,S,ce,ke)}),e(document).bind("mousemove."+b.data("mCustomScrollbarIndex"),function(H){if(b.data("on_drag")){var W=T,re=W.offset(),y=H.pageX-re.left,ke=H.pageY-re.top;h(R,S,ke,y)}}).bind("mouseup."+b.data("mCustomScrollbarIndex"),function(H){b.data({on_drag:!1}),T.removeClass("mCSB_dragger_onDrag")})),b.data({bindEvent_scrollbar_drag:!0})}function h(H,W,re,y){b.data("horizontalScroll")?b.mCustomScrollbar("scrollTo",T.position().left-W+y,{moveDragger:!0,trigger:"internal"}):b.mCustomScrollbar("scrollTo",T.position().top-H+re,{moveDragger:!0,trigger:"internal"})}if(e.support.touch&&b.data("contentTouchScroll")&&!b.data("bindEvent_content_touch")){var w,P,N,X,te,ne,K;m.bind("touchstart",function(H){H.stopImmediatePropagation(),w=H.originalEvent.touches[0]||H.originalEvent.changedTouches[0],P=e(this),N=P.offset(),te=w.pageX-N.left,X=w.pageY-N.top,ne=X,K=te}),m.bind("touchmove",function(H){H.preventDefault(),H.stopImmediatePropagation(),w=H.originalEvent.touches[0]||H.originalEvent.changedTouches[0],P=e(this).parent(),N=P.offset(),te=w.pageX-N.left,X=w.pageY-N.top,b.data("horizontalScroll")?b.mCustomScrollbar("scrollTo",K-te,{trigger:"internal"}):b.mCustomScrollbar("scrollTo",ne-X,{trigger:"internal"})})}if(b.data("bindEvent_scrollbar_click")||(f.bind("click",function(H){var W=(H.pageY-f.offset().top)*b.data("scrollAmount"),re=e(H.target);b.data("horizontalScroll")&&(W=(H.pageX-f.offset().left)*b.data("scrollAmount")),(re.hasClass("mCSB_draggerContainer")||re.hasClass("mCSB_draggerRail"))&&b.mCustomScrollbar("scrollTo",W,{trigger:"internal",scrollEasing:"draggerRailEase"})}),b.data({bindEvent_scrollbar_click:!0})),b.data("mouseWheel")&&(b.data("bindEvent_mousewheel")||(s.bind("mousewheel",function(H,W){var re,y=b.data("mouseWheelPixels"),ke=Math.abs(m.position().top),ce=T.position().top,Ge=f.height()-T.height();b.data("normalizeMouseWheelDelta")&&(W<0?W=-1:W=1),y==="auto"&&(y=100+Math.round(b.data("scrollAmount")/2)),b.data("horizontalScroll")&&(ce=T.position().left,Ge=f.width()-T.width(),ke=Math.abs(m.position().left)),(W>0&&ce!==0||W<0&&ce!==Ge)&&(H.preventDefault(),H.stopImmediatePropagation()),re=ke-W*y,b.mCustomScrollbar("scrollTo",re,{trigger:"internal"})}),b.data({bindEvent_mousewheel:!0}))),b.data("scrollButtons_enable"))if(b.data("scrollButtons_scrollType")==="pixels"){let H=function(W){T.data("preventAction")||(T.data("preventAction",!0),b.mCustomScrollbar("scrollTo",W,{trigger:"internal"}))};b.data("horizontalScroll")?(O.add(V).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend",M,J),b.data({bindEvent_buttonsContinuous_x:!1}),b.data("bindEvent_buttonsPixels_x")||(O.bind("click",function(W){W.preventDefault(),H(Math.abs(m.position().left)+b.data("scrollButtons_scrollAmount"))}),V.bind("click",function(W){W.preventDefault(),H(Math.abs(m.position().left)-b.data("scrollButtons_scrollAmount"))}),b.data({bindEvent_buttonsPixels_x:!0}))):(D.add(k).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend",M,J),b.data({bindEvent_buttonsContinuous_y:!1}),b.data("bindEvent_buttonsPixels_y")||(D.bind("click",function(W){W.preventDefault(),H(Math.abs(m.position().top)+b.data("scrollButtons_scrollAmount"))}),k.bind("click",function(W){W.preventDefault(),H(Math.abs(m.position().top)-b.data("scrollButtons_scrollAmount"))}),b.data({bindEvent_buttonsPixels_y:!0})))}else{let H=function(){var W=b.data("scrollButtons_scrollSpeed");return b.data("scrollButtons_scrollSpeed")==="auto"&&(W=Math.round((b.data("scrollInertia")+100)/40)),W};if(b.data("horizontalScroll")){if(O.add(V).unbind("click"),b.data({bindEvent_buttonsPixels_x:!1}),!b.data("bindEvent_buttonsContinuous_x")){O.bind("mousedown touchstart MSPointerDown",function(W){W.preventDefault();var re=H();b.data({mCSB_buttonScrollRight:setInterval(function(){b.mCustomScrollbar("scrollTo",Math.abs(m.position().left)+re,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var M=function(W){W.preventDefault(),clearInterval(b.data("mCSB_buttonScrollRight"))};O.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",M),V.bind("mousedown touchstart MSPointerDown",function(W){W.preventDefault();var re=H();b.data({mCSB_buttonScrollLeft:setInterval(function(){b.mCustomScrollbar("scrollTo",Math.abs(m.position().left)-re,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var J=function(W){W.preventDefault(),clearInterval(b.data("mCSB_buttonScrollLeft"))};V.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",J),b.data({bindEvent_buttonsContinuous_x:!0})}}else if(D.add(k).unbind("click"),b.data({bindEvent_buttonsPixels_y:!1}),!b.data("bindEvent_buttonsContinuous_y")){D.bind("mousedown touchstart MSPointerDown",function(W){W.preventDefault();var re=H();b.data({mCSB_buttonScrollDown:setInterval(function(){b.mCustomScrollbar("scrollTo",Math.abs(m.position().top)+re,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var U=function(W){W.preventDefault(),clearInterval(b.data("mCSB_buttonScrollDown"))};D.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",U),k.bind("mousedown touchstart MSPointerDown",function(W){W.preventDefault();var re=H();b.data({mCSB_buttonScrollUp:setInterval(function(){b.mCustomScrollbar("scrollTo",Math.abs(m.position().top)-re,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var F=function(W){W.preventDefault(),clearInterval(b.data("mCSB_buttonScrollUp"))};k.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",F),b.data({bindEvent_buttonsContinuous_y:!0})}}b.data("autoScrollOnFocus")&&(b.data("bindEvent_focusin")||(s.bind("focusin",function(){s.scrollTop(0).scrollLeft(0);var H=e(document.activeElement);if(H.is("input,textarea,select,button,a[tabindex],area,object")){var W=m.position().top,re=H.position().top,y=s.height()-H.outerHeight();b.data("horizontalScroll")&&(W=m.position().left,re=H.position().left,y=s.width()-H.outerWidth()),(W+re<0||W+re>y)&&b.mCustomScrollbar("scrollTo",re,{trigger:"internal"})}}),b.data({bindEvent_focusin:!0}))),b.data("autoHideScrollbar")&&(b.data("bindEvent_autoHideScrollbar")||(s.bind("mouseenter",function(H){s.addClass("mCS-mouse-over"),_.showScrollbar.call(s.children(".mCSB_scrollTools"))}).bind("mouseleave touchend",function(H){s.removeClass("mCS-mouse-over"),H.type==="mouseleave"&&_.hideScrollbar.call(s.children(".mCSB_scrollTools"))}),b.data({bindEvent_autoHideScrollbar:!0})))},scrollTo:function(s,k){var f=e(this),T={moveDragger:!1,trigger:"external",callbacks:!0,scrollInertia:f.data("scrollInertia"),scrollEasing:f.data("scrollEasing")},k=e.extend(T,k),D,V=f.children(".mCustomScrollBox"),O=V.children(".mCSB_container"),b=V.children(".mCSB_scrollTools"),R=b.children(".mCSB_draggerContainer"),S=R.children(".mCSB_dragger"),h=draggerSpeed=k.scrollInertia,w,P,N,X;if(!O.hasClass("mCS_no_scrollbar")&&(f.data({mCS_trigger:k.trigger}),f.data("mCS_Init")&&(k.callbacks=!1),s||s===0)){if(typeof s=="number")k.moveDragger?(D=s,f.data("horizontalScroll")?s=S.position().left*f.data("scrollAmount"):s=S.position().top*f.data("scrollAmount"),draggerSpeed=0):D=s/f.data("scrollAmount");else if(typeof s=="string"){var te;s==="top"?te=0:s==="bottom"&&!f.data("horizontalScroll")?te=O.outerHeight()-V.height():s==="left"?te=0:s==="right"&&f.data("horizontalScroll")?te=O.outerWidth()-V.width():s==="first"?te=f.find(".mCSB_container").find(":first"):s==="last"?te=f.find(".mCSB_container").find(":last"):te=f.find(s),te.length===1?(f.data("horizontalScroll")?s=te.position().left:s=te.position().top,D=s/f.data("scrollAmount")):D=s=te}if(f.data("horizontalScroll")){f.data("onTotalScrollBack_Offset")&&(P=-f.data("onTotalScrollBack_Offset")),f.data("onTotalScroll_Offset")&&(X=V.width()-O.outerWidth()+f.data("onTotalScroll_Offset")),D<0?(D=s=0,clearInterval(f.data("mCSB_buttonScrollLeft")),P||(w=!0)):D>=R.width()-S.width()?(D=R.width()-S.width(),s=V.width()-O.outerWidth(),clearInterval(f.data("mCSB_buttonScrollRight")),X||(N=!0)):s=-s;var ne=f.data("snapAmount");ne&&(s=Math.round(s/ne)*ne-f.data("snapOffset")),_.mTweenAxis.call(this,S[0],"left",Math.round(D),draggerSpeed,k.scrollEasing),_.mTweenAxis.call(this,O[0],"left",Math.round(s),h,k.scrollEasing,{onStart:function(){k.callbacks&&!f.data("mCS_tweenRunning")&&K("onScrollStart"),f.data("autoHideScrollbar")&&_.showScrollbar.call(b)},onUpdate:function(){k.callbacks&&K("whileScrolling")},onComplete:function(){k.callbacks&&(K("onScroll"),(w||P&&O.position().left>=P)&&K("onTotalScrollBack"),(N||X&&O.position().left<=X)&&K("onTotalScroll")),S.data("preventAction",!1),f.data("mCS_tweenRunning",!1),f.data("autoHideScrollbar")&&(V.hasClass("mCS-mouse-over")||_.hideScrollbar.call(b))}})}else{f.data("onTotalScrollBack_Offset")&&(P=-f.data("onTotalScrollBack_Offset")),f.data("onTotalScroll_Offset")&&(X=V.height()-O.outerHeight()+f.data("onTotalScroll_Offset")),D<0?(D=s=0,clearInterval(f.data("mCSB_buttonScrollUp")),P||(w=!0)):D>=R.height()-S.height()?(D=R.height()-S.height(),s=V.height()-O.outerHeight(),clearInterval(f.data("mCSB_buttonScrollDown")),X||(N=!0)):s=-s;var ne=f.data("snapAmount");ne&&(s=Math.round(s/ne)*ne-f.data("snapOffset")),_.mTweenAxis.call(this,S[0],"top",Math.round(D),draggerSpeed,k.scrollEasing),_.mTweenAxis.call(this,O[0],"top",Math.round(s),h,k.scrollEasing,{onStart:function(){k.callbacks&&!f.data("mCS_tweenRunning")&&K("onScrollStart"),f.data("autoHideScrollbar")&&_.showScrollbar.call(b)},onUpdate:function(){k.callbacks&&K("whileScrolling")},onComplete:function(){k.callbacks&&(K("onScroll"),(w||P&&O.position().top>=P)&&K("onTotalScrollBack"),(N||X&&O.position().top<=X)&&K("onTotalScroll")),S.data("preventAction",!1),f.data("mCS_tweenRunning",!1),f.data("autoHideScrollbar")&&(V.hasClass("mCS-mouse-over")||_.hideScrollbar.call(b))}})}f.data("mCS_Init")&&f.data({mCS_Init:!1})}function K(M){switch(this.mcs={top:O.position().top,left:O.position().left,draggerTop:S.position().top,draggerLeft:S.position().left,topPct:Math.round(100*Math.abs(O.position().top)/Math.abs(O.outerHeight()-V.height())),leftPct:Math.round(100*Math.abs(O.position().left)/Math.abs(O.outerWidth()-V.width()))},M){case"onScrollStart":f.data("mCS_tweenRunning",!0).data("onScrollStart_Callback").call(f,this.mcs);break;case"whileScrolling":f.data("whileScrolling_Callback").call(f,this.mcs);break;case"onScroll":f.data("onScroll_Callback").call(f,this.mcs);break;case"onTotalScrollBack":f.data("onTotalScrollBack_Callback").call(f,this.mcs);break;case"onTotalScroll":f.data("onTotalScroll_Callback").call(f,this.mcs);break}}},stop:function(){var s=e(this),m=s.children().children(".mCSB_container"),f=s.children().children().children().children(".mCSB_dragger");_.mTweenAxisStop.call(this,m[0]),_.mTweenAxisStop.call(this,f[0])},disable:function(s){var m=e(this),f=m.children(".mCustomScrollBox"),T=f.children(".mCSB_container"),k=f.children(".mCSB_scrollTools"),D=k.children().children(".mCSB_dragger");f.unbind("mousewheel focusin mouseenter mouseleave touchend"),T.unbind("touchstart touchmove"),s&&(m.data("horizontalScroll")?D.add(T).css("left",0):D.add(T).css("top",0)),k.css("display","none"),T.addClass("mCS_no_scrollbar"),m.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1,bindEvent_content_touch:!1,bindEvent_autoHideScrollbar:!1}).addClass("mCS_disabled")},destroy:function(){var s=e(this);s.removeClass("mCustomScrollbar _mCS_"+s.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove(),e(document).unbind("mousemove."+s.data("mCustomScrollbarIndex")+" mouseup."+s.data("mCustomScrollbarIndex")+" MSPointerMove."+s.data("mCustomScrollbarIndex")+" MSPointerUp."+s.data("mCustomScrollbarIndex")),e(window).unbind("resize."+s.data("mCustomScrollbarIndex"))}},_={showScrollbar:function(){this.stop().animate({opacity:1},"fast")},hideScrollbar:function(){this.stop().animate({opacity:0},"fast")},mTweenAxis:function(s,m,f,T,k,V){var V=V||{},O=V.onStart||function(){},b=V.onUpdate||function(){},R=V.onComplete||function(){},S=te(),h,w=0,P=s.offsetTop,N=s.style;m==="left"&&(P=s.offsetLeft);var X=f-P;J(),M();function te(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():new Date().getTime()}function ne(){w||O.call(),w=te()-S,K(),w>=s._time&&(s._time=w>s._time?w+h-(w-s._time):w+h-1,s._time<w+1&&(s._time=w+1)),s._time<T?s._id=_request(ne):R.call()}function K(){T>0?(s.currVal=U(s._time,P,X,T,k),N[m]=Math.round(s.currVal)+"px"):N[m]=f+"px",b.call()}function M(){h=1e3/60,s._time=w+h,_request=window.requestAnimationFrame?window.requestAnimationFrame:function(F){return K(),setTimeout(F,.01)},s._id=_request(ne)}function J(){s._id!=null&&(window.requestAnimationFrame?window.cancelAnimationFrame(s._id):clearTimeout(s._id),s._id=null)}function U(F,H,W,re,y){switch(y){case"linear":return W*F/re+H;case"easeOutQuad":return F/=re,-W*F*(F-2)+H;break;case"easeInOutQuad":if(F/=re/2,F<1)return W/2*F*F+H;return F--,-W/2*(F*(F-2)-1)+H;break;case"easeOutCubic":return F/=re,F--,W*(F*F*F+1)+H;break;case"easeOutQuart":return F/=re,F--,-W*(F*F*F*F-1)+H;break;case"easeOutQuint":return F/=re,F--,W*(F*F*F*F*F+1)+H;break;case"easeOutCirc":return F/=re,F--,W*Math.sqrt(1-F*F)+H;break;case"easeOutSine":return W*Math.sin(F/re*(Math.PI/2))+H;case"easeOutExpo":return W*(-Math.pow(2,-10*F/re)+1)+H;case"mcsEaseOut":var ke=(F/=re)*F,ce=ke*F;return H+W*(.499999999999997*ce*ke+-2.5*ke*ke+5.5*ce+-6.5*ke+4*F);case"draggerRailEase":if(F/=re/2,F<1)return W/2*F*F*F+H;return F-=2,W/2*(F*F*F+2)+H;break}}},mTweenAxisStop:function(s){s._id!=null&&(window.requestAnimationFrame?window.cancelAnimationFrame(s._id):clearTimeout(s._id),s._id=null)},rafPolyfill:function(){for(var s=["ms","moz","webkit","o"],m=s.length;--m>-1&&!window.requestAnimationFrame;)window.requestAnimationFrame=window[s[m]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[s[m]+"CancelAnimationFrame"]||window[s[m]+"CancelRequestAnimationFrame"]}};_.rafPolyfill.call(),e.support.touch="ontouchstart"in window,e.support.msPointer=window.navigator.msPointerEnabled;var p=document.location.protocol=="https:"?"https:":"http:";e.event.special.mousewheel||document.write('<script src="'+p+'//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js"><\/script>'),e.fn.mCustomScrollbar=function(s){if(r[s])return r[s].apply(this,Array.prototype.slice.call(arguments,1));if(typeof s=="object"||!s)return r.init.apply(this,arguments);e.error("Method "+s+" does not exist")}})(jQuery);/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 20112014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */(function(e){if(e.support.touch="ontouchend"in document,!e.support.touch)return;var r=e.ui.mouse.prototype,_=r._mouseInit,p=r._mouseDestroy,s;function m(f,T){if(!(f.originalEvent.touches.length>1)){f.preventDefault();var k=f.originalEvent.changedTouches[0],D=document.createEvent("MouseEvents");D.initMouseEvent(T,!0,!0,window,1,k.screenX,k.screenY,k.clientX,k.clientY,!1,!1,!1,!1,0,null),console.log("dispatch simulated event: "+T),f.target.dispatchEvent(D)}}r._touchStart=function(f){console.log("mouseProto._touchStart");var T=this;s||!T._mouseCapture(f.originalEvent.changedTouches[0])||(s=!0,T._touchMoved=!1,m(f,"mouseover"),m(f,"mousemove"),m(f,"mousedown"))},r._touchMove=function(f){console.log("mouseProto._touchMove"),s&&(this._touchMoved=!0,m(f,"mousemove"))},r._touchEnd=function(f){s&&(m(f,"mouseup"),m(f,"mouseout"),this._touchMoved||m(f,"click"),s=!1)},r._mouseInit=function(){var f=this;f.element.bind({touchstart:e.proxy(f,"_touchStart"),touchmove:e.proxy(f,"_touchMove"),touchend:e.proxy(f,"_touchEnd")}),_.call(f)},r._mouseDestroy=function(){var f=this;f.element.unbind({touchstart:e.proxy(f,"_touchStart"),touchmove:e.proxy(f,"_touchMove"),touchend:e.proxy(f,"_touchEnd")}),p.call(f)}})(jQuery),(function(e,r){typeof exports=="object"&&typeof module<"u"?r(exports):typeof define=="function"&&define.amd?define(["exports"],r):(e=typeof globalThis<"u"?globalThis:e||self,r(e.Annotorious={}))})(void 0,function(e){"use strict";var r=Object.defineProperty,_=(t,n,o)=>n in t?r(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o,p=(t,n,o)=>_(t,typeof n!="symbol"?n+"":n,o);function s(){}function m(t,n){for(const o in n)t[o]=n[o];return t}function f(t){return t()}function T(){return Object.create(null)}function k(t){t.forEach(f)}function D(t){return typeof t=="function"}function V(t,n){return t!=t?n==n:t!==n||t&&typeof t=="object"||typeof t=="function"}function O(t){return Object.keys(t).length===0}function b(t,...n){if(t==null){for(const l of n)l(void 0);return s}const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function R(t,n,o){t.$$.on_destroy.push(b(n,o))}function S(t,n,o,l){if(t){const d=h(t,n,o,l);return t[0](d)}}function h(t,n,o,l){return t[1]&&l?m(o.ctx.slice(),t[1](l(n))):o.ctx}function w(t,n,o,l){if(t[2]&&l){const d=t[2](l(o));if(n.dirty===void 0)return d;if(typeof d=="object"){const g=[],x=Math.max(n.dirty.length,d.length);for(let C=0;C<x;C+=1)g[C]=n.dirty[C]|d[C];return g}return n.dirty|d}return n.dirty}function P(t,n,o,l,d,g){if(d){const x=h(n,o,l,g);t.p(x,d)}}function N(t){if(t.ctx.length>32){const n=[],o=t.ctx.length/32;for(let l=0;l<o;l++)n[l]=-1;return n}return-1}function X(t){const n={};for(const o in t)o[0]!=="$"&&(n[o]=t[o]);return n}function te(t){return t!=null?t:""}function ne(t,n){t.appendChild(n)}function K(t,n,o){t.insertBefore(n,o||null)}function M(t){t.parentNode&&t.parentNode.removeChild(t)}function J(t,n){for(let o=0;o<t.length;o+=1)t[o]&&t[o].d(n)}function U(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function F(t){return document.createTextNode(t)}function H(){return F(" ")}function W(){return F("")}function re(t,n,o,l){return t.addEventListener(n,o,l),()=>t.removeEventListener(n,o,l)}function y(t,n,o){o==null?t.removeAttribute(n):t.getAttribute(n)!==o&&t.setAttribute(n,o)}function ke(t){return Array.from(t.childNodes)}function ce(t,n,o){t.classList.toggle(n,!!o)}function Ge(t,n,{bubbles:o=!1,cancelable:l=!1}={}){return new CustomEvent(t,{detail:n,bubbles:o,cancelable:l})}let lt;function c(t){lt=t}function we(){if(!lt)throw new Error("Function called outside component initialization");return lt}function De(t){we().$$.on_mount.push(t)}function Re(){const t=we();return(n,o,{cancelable:l=!1}={})=>{const d=t.$$.callbacks[n];if(d){const g=Ge(n,o,{cancelable:l});return d.slice().forEach(x=>{x.call(t,g)}),!g.defaultPrevented}return!0}}function je(t,n){const o=t.$$.callbacks[n.type];o&&o.slice().forEach(l=>l.call(this,n))}const Pe=[],qe=[];let ft=[];const Ot=[],Kt=Promise.resolve();let Zt=!1;function zt(){Zt||(Zt=!0,Kt.then(ut))}function me(){return zt(),Kt}function oe(t){ft.push(t)}const Fe=new Set;let $e=0;function ut(){if($e!==0)return;const t=lt;do{try{for(;$e<Pe.length;){const n=Pe[$e];$e++,c(n),mt(n.$$)}}catch(n){throw Pe.length=0,$e=0,n}for(c(null),Pe.length=0,$e=0;qe.length;)qe.pop()();for(let n=0;n<ft.length;n+=1){const o=ft[n];Fe.has(o)||(Fe.add(o),o())}ft.length=0}while(Pe.length);for(;Ot.length;)Ot.pop()();Zt=!1,Fe.clear(),c(t)}function mt(t){if(t.fragment!==null){t.update(),k(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(oe)}}function kt(t){const n=[],o=[];ft.forEach(l=>t.indexOf(l)===-1?n.push(l):o.push(l)),o.forEach(l=>l()),ft=n}const Ft=new Set;let Mt;function Lt(){Mt={r:0,c:[],p:Mt}}function Nt(){Mt.r||k(Mt.c),Mt=Mt.p}function rt(t,n){t&&t.i&&(Ft.delete(t),t.i(n))}function vt(t,n,o,l){if(t&&t.o){if(Ft.has(t))return;Ft.add(t),Mt.c.push(()=>{Ft.delete(t),l&&(o&&t.d(1),l())}),t.o(n)}else l&&l()}function tn(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Yt(t){t&&t.c()}function Jt(t,n,o){const{fragment:l,after_update:d}=t.$$;l&&l.m(n,o),oe(()=>{const g=t.$$.on_mount.map(f).filter(D);t.$$.on_destroy?t.$$.on_destroy.push(...g):k(g),t.$$.on_mount=[]}),d.forEach(oe)}function Qt(t,n){const o=t.$$;o.fragment!==null&&(kt(o.after_update),k(o.on_destroy),o.fragment&&o.fragment.d(n),o.on_destroy=o.fragment=null,o.ctx=[])}function vn(t,n){t.$$.dirty[0]===-1&&(Pe.push(t),zt(),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function le(t,n,o,l,d,g,x=null,C=[-1]){const A=lt;c(t);const L=t.$$={fragment:null,ctx:[],props:g,update:s,not_equal:d,bound:T(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(A?A.$$.context:[])),callbacks:T(),dirty:C,skip_bound:!1,root:n.target||A.$$.root};x&&x(L.root);let B=!1;if(L.ctx=o?o(t,n.props||{},(G,ee,...be)=>{const he=be.length?be[0]:ee;return L.ctx&&d(L.ctx[G],L.ctx[G]=he)&&(!L.skip_bound&&L.bound[G]&&L.bound[G](he),B&&vn(t,G)),ee}):[],L.update(),B=!0,k(L.before_update),L.fragment=l?l(L.ctx):!1,n.target){if(n.hydrate){const G=ke(n.target);L.fragment&&L.fragment.l(G),G.forEach(M)}else L.fragment&&L.fragment.c();n.intro&&rt(t.$$.fragment),Jt(t,n.target,n.anchor),ut()}c(A)}class se{constructor(){p(this,"$$"),p(this,"$$set")}$destroy(){Qt(this,1),this.$destroy=s}$on(n,o){if(!D(o))return s;const l=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return l.push(o),()=>{const d=l.indexOf(o);d!==-1&&l.splice(d,1)}}$set(n){this.$$set&&!O(n)&&(this.$$.skip_bound=!0,this.$$set(n),this.$$.skip_bound=!1)}}const Le="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Le);var Ue=(t=>(t.ELLIPSE="ELLIPSE",t.MULTIPOLYGON="MULTIPOLYGON",t.POLYGON="POLYGON",t.POLYLINE="POLYLINE",t.RECTANGLE="RECTANGLE",t.LINE="LINE",t))(Ue||{});function yt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var pt={exports:{}};(function(t){(function(){function n(C,A){var L=C.x-A.x,B=C.y-A.y;return L*L+B*B}function o(C,A,L){var B=A.x,G=A.y,ee=L.x-B,be=L.y-G;if(ee!==0||be!==0){var he=((C.x-B)*ee+(C.y-G)*be)/(ee*ee+be*be);he>1?(B=L.x,G=L.y):he>0&&(B+=ee*he,G+=be*he)}return ee=C.x-B,be=C.y-G,ee*ee+be*be}function l(C,A){for(var L=C[0],B=[L],G,ee=1,be=C.length;ee<be;ee++)G=C[ee],n(G,L)>A&&(B.push(G),L=G);return L!==G&&B.push(G),B}function d(C,A,L,B,G){for(var ee=B,be,he=A+1;he<L;he++){var ue=o(C[he],C[A],C[L]);ue>ee&&(be=he,ee=ue)}ee>B&&(be-A>1&&d(C,A,be,B,G),G.push(C[be]),L-be>1&&d(C,be,L,B,G))}function g(C,A){var L=C.length-1,B=[C[0]];return d(C,0,L,A,B),B.push(C[L]),B}function x(C,A,L){if(C.length<=2)return C;var B=A!==void 0?A*A:1;return C=L?C:l(C,B),C=g(C,B),C}t.exports=x,t.exports.default=x})()})(pt);var Ht=pt.exports;const _t=yt(Ht),At={},It=(t,n)=>At[t]=n,Wt=t=>At[t.type].area(t),Xt=(t,n,o,l)=>At[t.type].intersects(t,n,o,l),Vt=t=>{let n=1/0,o=1/0,l=-1/0,d=-1/0;return t.forEach(([g,x])=>{n=Math.min(n,g),o=Math.min(o,x),l=Math.max(l,g),d=Math.max(d,x)}),{minX:n,minY:o,maxX:l,maxY:d}},un=t=>{let n=0,o=t.length-1;for(let l=0;l<t.length;l++)n+=(t[o][0]+t[l][0])*(t[o][1]-t[l][1]),o=l;return Math.abs(.5*n)},dn=(t,n,o)=>{let l=!1;for(let d=0,g=t.length-1;d<t.length;g=d++){const x=t[d][0],C=t[d][1],A=t[g][0],L=t[g][1];C>o!=L>o&&n<(A-x)*(o-C)/(L-C)+x&&(l=!l)}return l},hn=(t,n=!0)=>{let o="M ";return t.forEach(([l,d],g)=>{g===0?o+=`${l},${d}`:o+=` L ${l},${d}`}),n&&(o+=" Z"),o},on=(t,n=1)=>{const o=t.map(([l,d])=>({x:l,y:d}));return _t(o,n,!0).map(l=>[l.x,l.y])},fn=(t,n)=>{const o=Math.abs(n[0]-t[0]),l=Math.abs(n[1]-t[1]);return Math.sqrt(Math.pow(o,2)+Math.pow(l,2))},Nn={area:t=>Math.PI*t.geometry.rx*t.geometry.ry,intersects:(t,n,o)=>{const{cx:l,cy:d,rx:g,ry:x}=t.geometry,C=0,A=Math.cos(C),L=Math.sin(C),B=n-l,G=o-d,ee=A*B+L*G,be=L*B-A*G;return ee*ee/(g*g)+be*be/(x*x)<=1}};It(Ue.ELLIPSE,Nn);const Yn={area:t=>0,intersects:(t,n,o,l=2)=>{const[[d,g],[x,C]]=t.geometry.points,A=Math.abs((C-g)*n-(x-d)*o+x*g-C*d),L=fn([d,g],[x,C]);return A/L<=l}};It(Ue.LINE,Yn);const Pi={area:t=>{const{polygons:n}=t.geometry;return n.reduce((o,l)=>{const[d,...g]=l.rings,x=un(d.points),C=g.reduce((A,L)=>A+un(L.points),0);return o+x-C},0)},intersects:(t,n,o)=>{const{polygons:l}=t.geometry;for(const d of l){const[g,...x]=d.rings;if(dn(g.points,n,o)){let C=!1;for(const A of x)if(dn(A.points,n,o)){C=!0;break}if(!C)return!0}}return!1}},Ln=t=>{const n=t.reduce((o,l)=>[...o,...l.rings[0].points],[]);return Vt(n)},gn=t=>t.rings.map(n=>hn(n.points)).join(" "),ci=t=>t.polygons.reduce((n,o)=>[...n,...o.rings.reduce((l,d)=>[...l,...d.points],[])],[]),Di=(t,n=1)=>{const o=t.geometry.polygons.map(d=>{const g=d.rings.map(C=>{const A=on(C.points,n);return{...C,points:A}}),x=Vt(g[0].points);return{...d,rings:g,bounds:x}}),l=Ln(o);return{...t,geometry:{...t.geometry,polygons:o,bounds:l}}};It(Ue.MULTIPOLYGON,Pi);const Oi={area:t=>{const n=t.geometry.points;return un(n)},intersects:(t,n,o)=>{const l=t.geometry.points;return dn(l,n,o)}},En=(t,n=1)=>{const o=on(t.geometry.points,n),l=Vt(o);return{...t,geometry:{...t.geometry,bounds:l,points:o}}};It(Ue.POLYGON,Oi);const kn={area:t=>{const n=t.geometry;if(!n.closed||n.points.length<3)return 0;const o=Fn(n.points,n.closed);return un(o)},intersects:(t,n,o,l=2)=>{const d=t.geometry;if(d.closed){const g=Fn(d.points,d.closed);return dn(g,n,o)}else return Ni(d,[n,o],l)}},Fn=(t,n=!1)=>{const o=[];for(let l=0;l<t.length;l++){const d=t[l],g=t[(l+1)%t.length];if(o.push(d.point),(l<t.length-1||n)&&(d.type==="CURVE"||g.type=="CURVE")){const x=$n(d.point,d.type==="CURVE"&&d.outHandle||d.point,g.type==="CURVE"&&g.inHandle||g.point,g.point,10);o.push(...x.slice(1))}}return o},$n=(t,n,o,l,d=10)=>{const g=[];for(let x=0;x<=d;x++){const C=x/d,A=Math.pow(1-C,3)*t[0]+3*Math.pow(1-C,2)*C*n[0]+3*(1-C)*Math.pow(C,2)*o[0]+Math.pow(C,3)*l[0],L=Math.pow(1-C,3)*t[1]+3*Math.pow(1-C,2)*C*n[1]+3*(1-C)*Math.pow(C,2)*o[1]+Math.pow(C,3)*l[1];g.push([A,L])}return g},Ni=(t,n,o)=>{for(let l=0;l<t.points.length-1;l++){const d=t.points[l],g=t.points[l+1];if(d.type==="CURVE"||g.type==="CURVE"){const x=$n(d.point,d.type==="CURVE"&&d.outHandle||d.point,g.type==="CURVE"&&g.inHandle||g.point,g.point,20);for(let C=0;C<x.length-1;C++)if(ui(n,x[C],x[C+1])<=o)return!0}else if(ui(n,d.point,g.point)<=o)return!0}return!1},ui=(t,n,o)=>{const[l,d]=t,[g,x]=n,[C,A]=o,L=C-g,B=A-x,G=Math.sqrt(L*L+B*B);if(G===0)return Math.sqrt((l-g)*(l-g)+(d-x)*(d-x));const ee=((l-g)*L+(d-x)*B)/(G*G);return ee<=0?Math.sqrt((l-g)*(l-g)+(d-x)*(d-x)):ee>=1?Math.sqrt((l-C)*(l-C)+(d-A)*(d-A)):Math.abs((A-x)*l-(C-g)*d+C*x-A*g)/G},Xn=t=>{if(!t.points||t.points.length===0)return"";const n=[],o=t.points[0];n.push(`M ${o.point[0]} ${o.point[1]}`);for(let l=1;l<t.points.length;l++){const d=t.points[l],g=t.points[l-1];if(d.type==="CURVE"||g.type==="CURVE"){const x=g.type==="CURVE"&&g.outHandle||g.point,C=d.type==="CURVE"&&d.inHandle||d.point,A=d.point;n.push(`C ${x[0]} ${x[1]} ${C[0]} ${C[1]} ${A[0]} ${A[1]}`)}else n.push(`L ${d.point[0]} ${d.point[1]}`)}if(t.closed){const l=t.points[t.points.length-1],d=t.points[0];if(l.type==="CURVE"||d.type==="CURVE"){const g=l.outHandle||l.point,x=d.inHandle||d.point,C=d.point;n.push(`C ${g[0]} ${g[1]} ${x[0]} ${x[1]} ${C[0]} ${C[1]}`)}n.push("Z")}return n.join(" ")};It(Ue.POLYLINE,kn);const di={area:t=>t.geometry.w*t.geometry.h,intersects:(t,n,o)=>n>=t.geometry.x&&n<=t.geometry.x+t.geometry.w&&o>=t.geometry.y&&o<=t.geometry.y+t.geometry.h};It(Ue.RECTANGLE,di);const Hn=t=>Rn(t.target),Rn=t=>{var n,o;return(t==null?void 0:t.annotation)!==void 0&&((o=(n=t==null?void 0:t.selector)==null?void 0:n.geometry)==null?void 0:o.bounds)!==void 0},fi=(t,n=!1)=>{const o=typeof t=="string"?t:t.value,l=/(xywh)=(pixel|percent)?:?(.+?),(.+?),(.+?),(.+)*/g,d=[...o.matchAll(l)][0],[g,x,C,A,L,B,G]=d;if(x!=="xywh")throw new Error("Unsupported MediaFragment: "+o);if(C&&C!=="pixel")throw new Error(`Unsupported MediaFragment unit: ${C}`);const[ee,be,he,ue]=[A,L,B,G].map(parseFloat);return{type:Ue.RECTANGLE,geometry:{x:ee,y:be,w:he,h:ue,bounds:{minX:ee,minY:n?be-ue:be,maxX:ee+he,maxY:n?be:be+ue}}}},pi=t=>{const{x:n,y:o,w:l,h:d}=t;return{type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:`xywh=pixel:${n},${o},${l},${d}`}},hi="http://www.w3.org/2000/svg",ei=t=>{const n=l=>{Array.from(l.attributes).forEach(d=>{d.name.startsWith("on")&&l.removeAttribute(d.name)})},o=t.getElementsByTagName("script");return Array.from(o).reverse().forEach(l=>l.parentNode.removeChild(l)),Array.from(t.querySelectorAll("*")).forEach(n),t},Li=t=>{const n=new XMLSerializer().serializeToString(t.documentElement).replace("<svg>",`<svg xmlns="${hi}">`);return new DOMParser().parseFromString(n,"image/svg+xml").documentElement},qn=t=>{const n=new DOMParser().parseFromString(t,"image/svg+xml"),o=n.lookupPrefix(hi),l=n.lookupNamespaceURI(null);return o||l?ei(n).firstChild:ei(Li(n)).firstChild},gi=t=>{const n=ti(t),o=[];let l=[],d=[0,0];for(const g of n)switch(g.type.toUpperCase()){case"M":l.length>0&&(o.push({points:l}),l=[]),d=[g.args[0],g.args[1]],l.push([...d]);break;case"L":d=[g.args[0],g.args[1]],l.push([...d]);break;case"H":d=[g.args[0],d[1]],l.push([...d]);break;case"V":d=[d[0],g.args[0]],l.push([...d]);break;case"C":d=[g.args[4],g.args[5]],l.push([...d]);break;case"Z":break;default:console.warn(`Unsupported SVG path command: ${g.type}`);break}if(l.length>2&&o.push({points:l}),o.length>0){const g=Vt(o[0].points);return{rings:o,bounds:g}}},Fi=t=>{const{point:n,inHandle:o,outHandle:l}=t;if(!o||!l)return!1;const d=o[0]-n[0],g=o[1]-n[1],x=l[0]-n[0],C=l[1]-n[1],A=d*C-g*x;return Math.abs(A)<.01},mi=t=>{const n=ti(t);let o=[],l=[0,0],d=!1;for(let x=0;x<n.length;x++){const C=n[x];switch(C.type.toUpperCase()){case"M":l=[C.args[0],C.args[1]],o.push({type:"CORNER",point:[...l]});break;case"L":l=[C.args[0],C.args[1]],o.push({type:"CORNER",point:[...l]});break;case"C":const A=[C.args[0],C.args[1]],L=[C.args[2],C.args[3]],B=[C.args[4],C.args[5]];if(o.length>0){const ee=o[o.length-1];(A[0]!==ee.point[0]||A[1]!==ee.point[1])&&(ee.type="CURVE",ee.outHandle=A)}const G={type:L[0]!==B[0]||L[1]!==B[1]?"CURVE":"CORNER",point:B};G.type==="CURVE"&&(G.inHandle=L),o.push(G),l=B;break;case"Z":d=!0;break;default:console.warn(`Unsupported SVG path command: ${C.type}`);break}}o=o.map(x=>Fi(x)?{...x,locked:!0}:x);const g=Vt(Fn(o,d));return{points:o,closed:d,bounds:g}},ti=t=>{const n=[],o=t.replace(/,/g," ").trim(),l=/([MmLlHhVvCcZz])\s*([^MmLlHhVvCcZz]*)/g;let d;for(;(d=l.exec(o))!==null;){const[,g,x]=d,C=x.trim()===""?[]:x.trim().split(/\s+/).map(Number).filter(A=>!isNaN(A));n.push({type:g,args:C})}return n},ni=t=>{const[n,o,l]=t.match(/(<polygon points=["|'])([^("|')]*)/)||[],d=l.split(" ").map(g=>g.split(",").map(parseFloat));return{type:Ue.POLYGON,geometry:{points:d,bounds:Vt(d)}}},vi=t=>{const n=qn(t),o=parseFloat(n.getAttribute("cx")),l=parseFloat(n.getAttribute("cy")),d=parseFloat(n.getAttribute("rx")),g=parseFloat(n.getAttribute("ry")),x={minX:o-d,minY:l-g,maxX:o+d,maxY:l+g};return{type:Ue.ELLIPSE,geometry:{cx:o,cy:l,rx:d,ry:g,bounds:x}}},xn=t=>{const n=qn(t),o=parseFloat(n.getAttribute("x1")),l=parseFloat(n.getAttribute("x2")),d=parseFloat(n.getAttribute("y1")),g=parseFloat(n.getAttribute("y2")),x={minX:Math.min(o,l),minY:Math.min(d,g),maxX:Math.max(o,l),maxY:Math.max(d,g)};return{type:Ue.LINE,geometry:{points:[[o,d],[l,g]],bounds:x}}},Cn=t=>{const n=qn(t),o=n.nodeName==="path"?n:Array.from(n.querySelectorAll("path"))[0],l=o==null?void 0:o.getAttribute("d");if(!l)throw new Error("Could not parse SVG path");const d=mi(l);if(!d)throw new Error("Could not parse SVG path");return{type:Ue.POLYLINE,geometry:d}},yi=t=>{const n=qn(t),o=(n.nodeName==="path"?[n]:Array.from(n.querySelectorAll("path"))).map(g=>g.getAttribute("d")||"").map(g=>gi(g)).filter(Boolean),l=o.reduce((g,x)=>[...g,...x.rings[0].points],[]),d=Vt(l);return o.length===1&&o[0].rings.length===1?{type:Ue.POLYGON,geometry:{points:l,bounds:d}}:{type:Ue.MULTIPOLYGON,geometry:{polygons:o,bounds:d}}},bi=t=>{const n=typeof t=="string"?t:t.value;if(n.includes("<polygon points="))return ni(n);if(n.includes("<path ")&&(n.includes(" C ")||!n.includes("Z")))return Cn(n);if(n.includes("<path "))return yi(n);if(n.includes("<ellipse "))return vi(n);if(n.includes("<line "))return xn(n);throw"Unsupported SVG shape: "+n},Mn=t=>`<g>${t.polygons.map(n=>`<path fill-rule="evenodd" d="${gn(n)}" />`).join("")}</g>`,Qn=t=>{let n;switch(t.type){case Ue.POLYGON:{const o=t.geometry,{points:l}=o;n=`<svg><polygon points="${l.map(d=>d.join(",")).join(" ")}" /></svg>`;break}case Ue.ELLIPSE:{const o=t.geometry;n=`<svg><ellipse cx="${o.cx}" cy="${o.cy}" rx="${o.rx}" ry="${o.ry}" /></svg>`;break}case Ue.MULTIPOLYGON:{const o=t.geometry;n=`<svg>${Mn(o)}</svg>`;break}case Ue.LINE:{const o=t.geometry,[[l,d],[g,x]]=o.points;n=`<svg><line x1="${l}" y1="${d}" x2="${g}" y2="${x}" /></svg>`;break}case Ue.POLYLINE:n=`<svg><path d="${Xn(t.geometry)}" /></svg>`}if(n)return{type:"SvgSelector",value:n};throw`Unsupported shape type: ${t.type}`},an=[];for(let t=0;t<256;++t)an.push((t+256).toString(16).slice(1));function An(t,n=0){return(an[t[n+0]]+an[t[n+1]]+an[t[n+2]]+an[t[n+3]]+"-"+an[t[n+4]]+an[t[n+5]]+"-"+an[t[n+6]]+an[t[n+7]]+"-"+an[t[n+8]]+an[t[n+9]]+"-"+an[t[n+10]]+an[t[n+11]]+an[t[n+12]]+an[t[n+13]]+an[t[n+14]]+an[t[n+15]]).toLowerCase()}let Vn;const yn=new Uint8Array(16);function In(){if(!Vn){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Vn=crypto.getRandomValues.bind(crypto)}return Vn(yn)}const wi={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Hi(t,n,o){var g,x;var l;t=t||{};const d=(x=(g=t.random)!=null?g:(l=t.rng)==null?void 0:l.call(t))!=null?x:In();if(d.length<16)throw new Error("Random bytes length must be >= 16");return d[6]=d[6]&15|64,d[8]=d[8]&63|128,An(d)}function zn(t,n,o){return wi.randomUUID&&!t?wi.randomUUID():Hi(t)}var jn=Object.prototype.hasOwnProperty;function mn(t,n){var o,l;if(t===n)return!0;if(t&&n&&(o=t.constructor)===n.constructor){if(o===Date)return t.getTime()===n.getTime();if(o===RegExp)return t.toString()===n.toString();if(o===Array){if((l=t.length)===n.length)for(;l--&&mn(t[l],n[l]););return l===-1}if(!o||typeof t=="object"){l=0;for(o in t)if(jn.call(t,o)&&++l&&!jn.call(n,o)||!(o in n)||!mn(t[o],n[o]))return!1;return Object.keys(n).length===l}}return t!==t&&n!==n}function Un(){}function Ri(t,n){return t!=t?n==n:t!==n||t&&typeof t=="object"||typeof t=="function"}const Tn=[];function a(t,n=Un){let o;const l=new Set;function d(C){if(Ri(t,C)&&(t=C,o)){const A=!Tn.length;for(const L of l)L[1](),Tn.push(L,t);if(A){for(let L=0;L<Tn.length;L+=2)Tn[L][0](Tn[L+1]);Tn.length=0}}}function g(C){d(C(t))}function x(C,A=Un){const L=[C,A];return l.add(L),l.size===1&&(o=n(d,g)||Un),C(t),()=>{l.delete(L),l.size===0&&o&&(o(),o=null)}}return{set:d,update:g,subscribe:x}}const u=t=>{const{subscribe:n,set:o}=a();let l;return n(d=>l=d),t.observe(({changes:d})=>{if(l){(d.deleted||[]).some(x=>x.id===l)&&o(void 0);const g=(d.updated||[]).find(({oldValue:x})=>x.id===l);g&&o(g.newValue.id)}}),{get current(){return l},subscribe:n,set:o}};var v=(t=>(t.EDIT="EDIT",t.SELECT="SELECT",t.NONE="NONE",t))(v||{});const E={selected:[]},I=(t,n,o)=>{const{subscribe:l,set:d}=a(E);let g=n,x=E;l(ue=>x=ue);const C=()=>{mn(x,E)||d(E)},A=()=>{var ue;return((ue=x.selected)==null?void 0:ue.length)===0},L=ue=>{if(A())return!1;const We=typeof ue=="string"?ue:ue.id;return x.selected.some(Se=>Se.id===We)},B=(ue,We)=>{let Se;if(Array.isArray(ue)){if(Se=ue.map(ge=>t.getAnnotation(ge)).filter(Boolean),Se.length<ue.length){console.warn("Invalid selection: "+ue.filter(ge=>!Se.some(Ve=>Ve.id===ge)));return}}else{const ge=t.getAnnotation(ue);if(!ge){console.warn("Invalid selection: "+ue);return}Se=[ge]}const He=Se.reduce((ge,Ve)=>{const Ye=he(Ve);return Ye==="EDIT"?[...ge,{id:Ve.id,editable:!0}]:Ye==="SELECT"?[...ge,{id:Ve.id}]:ge},[]);d({selected:He,event:We})},G=(ue,We)=>{const Se=Array.isArray(ue)?ue:[ue],He=Se.map(ge=>t.getAnnotation(ge)).filter(ge=>!!ge);d({selected:He.map(ge=>{const Ve=We===void 0?he(ge)==="EDIT":We;return{id:ge.id,editable:Ve}})}),He.length!==Se.length&&console.warn("Invalid selection",ue)},ee=ue=>{if(A())return!1;const{selected:We}=x;We.some(({id:Se})=>ue.includes(Se))&&d({selected:We.filter(({id:Se})=>!ue.includes(Se))})},be=ue=>{g=ue,G(x.selected.map(({id:We})=>We))},he=ue=>z(ue,g,o);return t.observe(({changes:ue})=>ee((ue.deleted||[]).map(We=>We.id))),{get event(){return x?x.event:null},get selected(){return x?[...x.selected]:null},get userSelectAction(){return g},clear:C,evalSelectAction:he,isEmpty:A,isSelected:L,setSelected:G,setUserSelectAction:be,subscribe:l,userSelect:B}},z=(t,n,o)=>{const l=o?o.serialize(t):t;return typeof n=="function"?n(l):n||"EDIT"},Y=[];for(let t=0;t<256;++t)Y.push((t+256).toString(16).slice(1));function Q(t,n=0){return(Y[t[n+0]]+Y[t[n+1]]+Y[t[n+2]]+Y[t[n+3]]+"-"+Y[t[n+4]]+Y[t[n+5]]+"-"+Y[t[n+6]]+Y[t[n+7]]+"-"+Y[t[n+8]]+Y[t[n+9]]+"-"+Y[t[n+10]]+Y[t[n+11]]+Y[t[n+12]]+Y[t[n+13]]+Y[t[n+14]]+Y[t[n+15]]).toLowerCase()}let de;const ae=new Uint8Array(16);function _e(){if(!de){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");de=crypto.getRandomValues.bind(crypto)}return de(ae)}const fe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ve={randomUUID:fe};function Ce(t,n,o){var g,x;var l;t=t||{};const d=(x=(g=t.random)!=null?g:(l=t.rng)==null?void 0:l.call(t))!=null?x:_e();if(d.length<16)throw new Error("Random bytes length must be >= 16");return d[6]=d[6]&15|64,d[8]=d[8]&63|128,Q(d)}function ot(t,n,o){return ve.randomUUID&&!t?ve.randomUUID():Ce(t)}const et=t=>{const n=o=>{const l={...o};return o.created&&typeof o.created=="string"&&(l.created=new Date(o.created)),o.updated&&typeof o.updated=="string"&&(l.updated=new Date(o.updated)),l};return{...t,bodies:(t.bodies||[]).map(n),target:n(t.target)}},at=(t,n,o,l)=>({id:ot(),annotation:typeof t=="string"?t:t.id,created:o||new Date,creator:l,...n}),dt=(t,n)=>{const o=new Set(t.bodies.map(l=>l.id));return n.bodies.filter(l=>!o.has(l.id))},$t=(t,n)=>{const o=new Set(n.bodies.map(l=>l.id));return t.bodies.filter(l=>!o.has(l.id))},qt=(t,n)=>n.bodies.map(o=>{const l=t.bodies.find(d=>d.id===o.id);return{newBody:o,oldBody:l&&!mn(l,o)?l:void 0}}).filter(({oldBody:o})=>o).map(({oldBody:o,newBody:l})=>({oldBody:o,newBody:l})),wt=(t,n)=>!mn(t.target,n.target),q=(t,n)=>{const o=dt(t,n),l=$t(t,n),d=qt(t,n);return{oldValue:t,newValue:n,bodiesCreated:o.length>0?o:void 0,bodiesDeleted:l.length>0?l:void 0,bodiesUpdated:d.length>0?d:void 0,targetUpdated:wt(t,n)?{oldTarget:t.target,newTarget:n.target}:void 0}};var Z=(t=>(t.LOCAL="LOCAL",t.REMOTE="REMOTE",t.SILENT="SILENT",t))(Z||{});const ye=(t,n)=>{var o,l;const{changes:d,origin:g}=n;if(!(t.options.origin?t.options.origin===g:g!=="SILENT"))return!1;if(t.options.ignore){const{ignore:x}=t.options,C=A=>A&&A.length>0;if(!(C(d.created)||C(d.deleted))){const A=(o=d.updated)==null?void 0:o.some(B=>C(B.bodiesCreated)||C(B.bodiesDeleted)||C(B.bodiesUpdated)),L=(l=d.updated)==null?void 0:l.some(B=>B.targetUpdated);if(x==="BODY_ONLY"&&A&&!L||x==="TARGET_ONLY"&&L&&!A)return!1}}if(t.options.annotations){const x=new Set([...(d.created||[]).map(C=>C.id),...(d.deleted||[]).map(C=>C.id),...(d.updated||[]).map(({oldValue:C})=>C.id)]);return!!(Array.isArray(t.options.annotations)?t.options.annotations:[t.options.annotations]).find(C=>x.has(C))}else return!0},xe=(t,n)=>{const o=new Set((t.created||[]).map(G=>G.id)),l=new Set((t.updated||[]).map(({newValue:G})=>G.id)),d=new Set((n.created||[]).map(G=>G.id)),g=new Set((n.deleted||[]).map(G=>G.id)),x=new Set((n.updated||[]).map(({oldValue:G})=>G.id)),C=new Set((n.updated||[]).filter(({oldValue:G})=>o.has(G.id)||l.has(G.id)).map(({oldValue:G})=>G.id)),A=[...(t.created||[]).filter(G=>!g.has(G.id)).map(G=>x.has(G.id)?n.updated.find(({oldValue:ee})=>ee.id===G.id).newValue:G),...n.created||[]],L=[...(t.deleted||[]).filter(G=>!d.has(G.id)),...(n.deleted||[]).filter(G=>!o.has(G.id))],B=[...(t.updated||[]).filter(({newValue:G})=>!g.has(G.id)).map(G=>{const{oldValue:ee,newValue:be}=G;if(x.has(be.id)){const he=n.updated.find(ue=>ue.oldValue.id===be.id).newValue;return q(ee,he)}else return G}),...(n.updated||[]).filter(({oldValue:G})=>!C.has(G.id))];return{created:A,deleted:L,updated:B}},Ne=t=>{const n=t.id===void 0?ot():t.id;return{...t,id:n,bodies:t.bodies===void 0?[]:t.bodies.map(o=>({...o,annotation:n})),target:{...t.target,annotation:n}}},Ae=t=>t.id!==void 0,ze=()=>{const t=new Map,n=new Map,o=[],l=(Ee,Oe={})=>{o.push({onChange:Ee,options:Oe})},d=Ee=>{const Oe=o.findIndex(pe=>pe.onChange==Ee);Oe>-1&&o.splice(Oe,1)},g=(Ee,Oe)=>{const pe={origin:Ee,changes:{created:Oe.created||[],updated:Oe.updated||[],deleted:Oe.deleted||[]},state:[...t.values()]};o.forEach(Te=>{ye(Te,pe)&&Te.onChange(pe)})},x=(Ee,Oe=Z.LOCAL)=>{if(Ee.id&&t.get(Ee.id))throw Error(`Cannot add annotation ${Ee.id} - exists already`);{const pe=Ne(Ee);t.set(pe.id,pe),pe.bodies.forEach(Te=>n.set(Te.id,pe.id)),g(Oe,{created:[pe]})}},C=(Ee,Oe)=>{const pe=Ne(typeof Ee=="string"?Oe:Ee),Te=typeof Ee=="string"?Ee:Ee.id,Qe=Te&&t.get(Te);if(Qe){const Me=q(Qe,pe);return Te===pe.id?t.set(Te,pe):(t.delete(Te),t.set(pe.id,pe)),Qe.bodies.forEach(nt=>n.delete(nt.id)),pe.bodies.forEach(nt=>n.set(nt.id,pe.id)),Me}else console.warn(`Cannot update annotation ${Te} - does not exist`)},A=(Ee,Oe=Z.LOCAL,pe=Z.LOCAL)=>{const Te=Ae(Oe)?pe:Oe,Qe=C(Ee,Oe);Qe&&g(Te,{updated:[Qe]})},L=(Ee,Oe=Z.LOCAL)=>{t.get(Ee.id)?A(Ee,Oe):x(Ee,Oe)},B=(Ee,Oe=Z.LOCAL)=>{const pe=Ee.reduce((Te,Qe)=>{const Me=C(Qe);return Me?[...Te,Me]:Te},[]);pe.length>0&&g(Oe,{updated:pe})},G=(Ee,Oe=Z.LOCAL)=>{const pe=Ee.map(Ne),{toAdd:Te,toUpdate:Qe}=pe.reduce((nt,Ct)=>t.get(Ct.id)?{...nt,toUpdate:[...nt.toUpdate,Ct]}:{...nt,toAdd:[...nt.toAdd,Ct]},{toAdd:[],toUpdate:[]}),Me=Qe.map(nt=>C(nt,Oe)).filter(Boolean);Te.forEach(nt=>{t.set(nt.id,nt),nt.bodies.forEach(Ct=>n.set(Ct.id,nt.id))}),g(Oe,{created:Te,updated:Me})},ee=(Ee,Oe=Z.LOCAL)=>{const pe=t.get(Ee.annotation);if(pe){const Te={...pe,bodies:[...pe.bodies,Ee]};t.set(pe.id,Te),n.set(Ee.id,Te.id),g(Oe,{updated:[{oldValue:pe,newValue:Te,bodiesCreated:[Ee]}]})}else console.warn(`Attempt to add body to missing annotation: ${Ee.annotation}`)},be=()=>[...t.values()],he=(Ee=Z.LOCAL)=>{const Oe=[...t.values()];t.clear(),n.clear(),g(Ee,{deleted:Oe})},ue=(Ee,Oe=!0,pe=Z.LOCAL)=>{const Te=Ee.map(Ne);if(Oe){const Qe=[...t.values()];t.clear(),n.clear(),Te.forEach(Me=>{t.set(Me.id,Me),Me.bodies.forEach(nt=>n.set(nt.id,Me.id))}),g(pe,{created:Te,deleted:Qe})}else{const Qe=Ee.reduce((Me,nt)=>{const Ct=nt.id&&t.get(nt.id);return Ct?[...Me,Ct]:Me},[]);if(Qe.length>0)throw Error(`Bulk insert would overwrite the following annotations: ${Qe.map(Me=>Me.id).join(", ")}`);Te.forEach(Me=>{t.set(Me.id,Me),Me.bodies.forEach(nt=>n.set(nt.id,Me.id))}),g(pe,{created:Te})}},We=Ee=>{const Oe=typeof Ee=="string"?Ee:Ee.id,pe=t.get(Oe);if(pe)return t.delete(Oe),pe.bodies.forEach(Te=>n.delete(Te.id)),pe;console.warn(`Attempt to delete missing annotation: ${Oe}`)},Se=(Ee,Oe=Z.LOCAL)=>{const pe=We(Ee);pe&&g(Oe,{deleted:[pe]})},He=(Ee,Oe=Z.LOCAL)=>{const pe=Ee.reduce((Te,Qe)=>{const Me=We(Qe);return Me?[...Te,Me]:Te},[]);pe.length>0&&g(Oe,{deleted:pe})},ge=Ee=>{const Oe=t.get(Ee.annotation);if(Oe){const pe=Oe.bodies.find(Te=>Te.id===Ee.id);if(pe){n.delete(pe.id);const Te={...Oe,bodies:Oe.bodies.filter(Qe=>Qe.id!==Ee.id)};return t.set(Oe.id,Te),{oldValue:Oe,newValue:Te,bodiesDeleted:[pe]}}else console.warn(`Attempt to delete missing body ${Ee.id} from annotation ${Ee.annotation}`)}else console.warn(`Attempt to delete body from missing annotation ${Ee.annotation}`)},Ve=(Ee,Oe=Z.LOCAL)=>{const pe=ge(Ee);pe&&g(Oe,{updated:[pe]})},Ye=(Ee,Oe=Z.LOCAL)=>{const pe=Ee.map(Te=>ge(Te)).filter(Boolean);pe.length>0&&g(Oe,{updated:pe})},tt=Ee=>{const Oe=t.get(Ee);return Oe?{...Oe}:void 0},Xe=Ee=>{const Oe=n.get(Ee);if(Oe){const pe=tt(Oe).bodies.find(Te=>Te.id===Ee);if(pe)return pe;console.error(`Store integrity error: body ${Ee} in index, but not in annotation`)}else console.warn(`Attempt to retrieve missing body: ${Ee}`)},ht=(Ee,Oe)=>{if(Ee.annotation!==Oe.annotation)throw"Annotation integrity violation: annotation ID must be the same when updating bodies";const pe=t.get(Ee.annotation);if(pe){const Te=pe.bodies.find(Me=>Me.id===Ee.id),Qe={...pe,bodies:pe.bodies.map(Me=>Me.id===Te.id?Oe:Me)};return t.set(pe.id,Qe),Te.id!==Oe.id&&(n.delete(Te.id),n.set(Oe.id,Qe.id)),{oldValue:pe,newValue:Qe,bodiesUpdated:[{oldBody:Te,newBody:Oe}]}}else console.warn(`Attempt to add body to missing annotation ${Ee.annotation}`)},st=(Ee,Oe,pe=Z.LOCAL)=>{const Te=ht(Ee,Oe);Te&&g(pe,{updated:[Te]})},Rt=(Ee,Oe=Z.LOCAL)=>{const pe=Ee.map(Te=>ht({id:Te.id,annotation:Te.annotation},Te)).filter(Boolean);g(Oe,{updated:pe})},Tt=Ee=>{const Oe=t.get(Ee.annotation);if(Oe){const pe={...Oe,target:{...Oe.target,...Ee}};return t.set(Oe.id,pe),{oldValue:Oe,newValue:pe,targetUpdated:{oldTarget:Oe.target,newTarget:Ee}}}else console.warn(`Attempt to update target on missing annotation: ${Ee.annotation}`)};return{addAnnotation:x,addBody:ee,all:be,bulkAddAnnotations:ue,bulkDeleteAnnotations:He,bulkDeleteBodies:Ye,bulkUpdateAnnotations:B,bulkUpdateBodies:Rt,bulkUpdateTargets:(Ee,Oe=Z.LOCAL)=>{const pe=Ee.map(Te=>Tt(Te)).filter(Boolean);pe.length>0&&g(Oe,{updated:pe})},bulkUpsertAnnotations:G,clear:he,deleteAnnotation:Se,deleteBody:Ve,getAnnotation:tt,getBody:Xe,observe:l,unobserve:d,updateAnnotation:A,updateBody:st,updateTarget:(Ee,Oe=Z.LOCAL)=>{const pe=Tt(Ee);pe&&g(Oe,{updated:[pe]})},upsertAnnotation:L}},Je=t=>({...t,subscribe:n=>{const o=l=>n(l.state);return t.observe(o),n(t.all()),()=>t.unobserve(o)}});let Ke=()=>({emit(t,...n){for(let o=this.events[t]||[],l=0,d=o.length;l<d;l++)o[l](...n)},events:{},on(t,n){var o;return((o=this.events)[t]||(o[t]=[])).push(n),()=>{var l;this.events[t]=(l=this.events[t])==null?void 0:l.filter(d=>n!==d)}}});const gt=250,jt=(t,n)=>{const o=Ke(),l=(n==null?void 0:n.changes)||[];let d=n?n.pointer:-1,g=!1,x=0;const C=he=>{if(!g){const{changes:ue}=he,We=performance.now();if(We-x>gt)l.splice(d+1),l.push(ue),d=l.length-1;else{const Se=l.length-1;l[Se]=xe(l[Se],ue)}x=We}g=!1};t.observe(C,{origin:Z.LOCAL});const A=he=>he&&he.length>0&&t.bulkDeleteAnnotations(he),L=he=>he&&he.length>0&&t.bulkAddAnnotations(he,!1),B=he=>he&&he.length>0&&t.bulkUpdateAnnotations(he.map(({oldValue:ue})=>ue)),G=he=>he&&he.length>0&&t.bulkUpdateAnnotations(he.map(({newValue:ue})=>ue)),ee=he=>he&&he.length>0&&t.bulkAddAnnotations(he,!1),be=he=>he&&he.length>0&&t.bulkDeleteAnnotations(he);return{canRedo:()=>l.length-1>d,canUndo:()=>d>-1,destroy:()=>t.unobserve(C),getHistory:()=>({changes:[...l],pointer:d}),on:(he,ue)=>o.on(he,ue),redo:()=>{if(l.length-1>d){g=!0;const{created:he,updated:ue,deleted:We}=l[d+1];L(he),G(ue),be(We),o.emit("redo",l[d+1]),d+=1}},undo:()=>{if(d>-1){g=!0;const{created:he,updated:ue,deleted:We}=l[d];A(he),B(ue),ee(We),o.emit("undo",l[d]),d-=1}}}},ie=()=>{const{subscribe:t,set:n}=a([]);return{subscribe:t,set:n}},Ie=(t,n,o,l)=>{const{hover:d,selection:g,store:x,viewport:C}=t,A=new Map;let L=[],B,G;const ee=(Se,He)=>{A.has(Se)?A.get(Se).push(He):A.set(Se,[He])},be=(Se,He)=>{const ge=A.get(Se);if(ge){const Ve=ge.indexOf(He);Ve!==-1&&ge.splice(Ve,1)}},he=(Se,He,ge)=>{A.has(Se)&&setTimeout(()=>{A.get(Se).forEach(Ve=>{if(o){const Ye=Array.isArray(He)?He.map(Xe=>o.serialize(Xe)):o.serialize(He),tt=ge?ge instanceof PointerEvent?ge:o.serialize(ge):void 0;Ve(Ye,tt)}else Ve(He,ge)})},1)},ue=()=>{const{selected:Se}=g,He=(Se||[]).map(({id:ge})=>x.getAnnotation(ge));He.forEach(ge=>{const Ve=L.find(Ye=>Ye.id===ge.id);(!Ve||!mn(Ve,ge))&&he("updateAnnotation",ge,Ve)}),L=L.map(ge=>He.find(({id:Ve})=>Ve===ge.id)||ge)};g.subscribe(({selected:Se})=>{if(!(L.length===0&&Se.length===0)){if(L.length===0&&Se.length>0)L=Se.map(({id:He})=>x.getAnnotation(He));else if(L.length>0&&Se.length===0)L.forEach(He=>{const ge=x.getAnnotation(He.id);ge&&!mn(ge,He)&&he("updateAnnotation",ge,He)}),L=[];else{const He=new Set(L.map(Ve=>Ve.id)),ge=new Set(Se.map(({id:Ve})=>Ve));L.filter(Ve=>!ge.has(Ve.id)).forEach(Ve=>{const Ye=x.getAnnotation(Ve.id);Ye&&!mn(Ye,Ve)&&he("updateAnnotation",Ye,Ve)}),L=[...L.filter(Ve=>ge.has(Ve.id)),...Se.filter(({id:Ve})=>!He.has(Ve)).map(({id:Ve})=>x.getAnnotation(Ve))]}he("selectionChanged",L)}}),d.subscribe(Se=>{!B&&Se?he("mouseEnterAnnotation",x.getAnnotation(Se)):B&&!Se?he("mouseLeaveAnnotation",x.getAnnotation(B)):B&&Se&&(he("mouseLeaveAnnotation",x.getAnnotation(B)),he("mouseEnterAnnotation",x.getAnnotation(Se))),B=Se}),C==null||C.subscribe(Se=>he("viewportIntersect",Se.map(He=>x.getAnnotation(He)))),x.observe(Se=>{l&&(G&&clearTimeout(G),G=setTimeout(ue,1e3));const{created:He,deleted:ge}=Se.changes;(He||[]).forEach(Ve=>he("createAnnotation",Ve)),(ge||[]).forEach(Ve=>he("deleteAnnotation",Ve)),(Se.changes.updated||[]).filter(Ve=>[...Ve.bodiesCreated||[],...Ve.bodiesDeleted||[],...Ve.bodiesUpdated||[]].length>0).forEach(({oldValue:Ve,newValue:Ye})=>{const tt=L.find(Xe=>Xe.id===Ve.id)||Ve;L=L.map(Xe=>Xe.id===Ve.id?Ye:Xe),he("updateAnnotation",Ye,tt)})},{origin:Z.LOCAL}),x.observe(Se=>{if(L){const He=new Set(L.map(Ve=>Ve.id)),ge=(Se.changes.updated||[]).filter(({newValue:Ve})=>He.has(Ve.id)).map(({newValue:Ve})=>Ve);ge.length>0&&(L=L.map(Ve=>ge.find(Ye=>Ye.id===Ve.id)||Ve))}},{origin:Z.REMOTE});const We=Se=>He=>{const{updated:ge}=He;Se?(ge||[]).forEach(Ve=>he("updateAnnotation",Ve.oldValue,Ve.newValue)):(ge||[]).forEach(Ve=>he("updateAnnotation",Ve.newValue,Ve.oldValue))};return n.on("undo",We(!0)),n.on("redo",We(!1)),{on:ee,off:be,emit:he}},Ze=t=>n=>n.reduce((o,l)=>{const{parsed:d,error:g}=t.parse(l);return g?{parsed:o.parsed,failed:[...o.failed,l]}:d?{parsed:[...o.parsed,d],failed:o.failed}:{...o}},{parsed:[],failed:[]}),Be=(t,n,o)=>{const{store:l,selection:d}=t,g=Se=>{if(o){const{parsed:He,error:ge}=o.parse(Se);He?l.addAnnotation(He,Z.REMOTE):console.error(ge)}else l.addAnnotation(et(Se),Z.REMOTE)},x=()=>d.clear(),C=()=>l.clear(),A=Se=>{const He=l.getAnnotation(Se);return o&&He?o.serialize(He):He},L=()=>o?l.all().map(o.serialize):l.all(),B=()=>{var Se;const He=(((Se=d.selected)==null?void 0:Se.map(ge=>ge.id))||[]).map(ge=>l.getAnnotation(ge)).filter(Boolean);return o?He.map(o.serialize):He},G=(Se,He=!0)=>fetch(Se).then(ge=>ge.json()).then(ge=>(be(ge,He),ge)),ee=Se=>{if(typeof Se=="string"){const He=l.getAnnotation(Se);if(l.deleteAnnotation(Se),He)return o?o.serialize(He):He}else{const He=o?o.parse(Se).parsed:Se;if(He)return l.deleteAnnotation(He),Se}},be=(Se,He=!0)=>{if(o){const ge=o.parseAll||Ze(o),{parsed:Ve,failed:Ye}=ge(Se);Ye.length>0&&console.warn(`Discarded ${Ye.length} invalid annotations`,Ye),l.bulkAddAnnotations(Ve,He,Z.REMOTE)}else l.bulkAddAnnotations(Se.map(et),He,Z.REMOTE)},he=(Se,He)=>{Se?d.setSelected(Se,He):d.clear()},ue=Se=>{d.clear(),d.setUserSelectAction(Se)},We=Se=>{if(o){const He=o.parse(Se).parsed,ge=o.serialize(l.getAnnotation(He.id));return l.updateAnnotation(He),ge}else{const He=l.getAnnotation(Se.id);return l.updateAnnotation(et(Se)),He}};return{addAnnotation:g,cancelSelected:x,canRedo:n.canRedo,canUndo:n.canUndo,clearAnnotations:C,getAnnotationById:A,getAnnotations:L,getHistory:n.getHistory,getSelected:B,loadAnnotations:G,redo:n.redo,removeAnnotation:ee,setAnnotations:be,setSelected:he,setUserSelectAction:ue,undo:n.undo,updateAnnotation:We}},it=(t,n,o)=>typeof n=="function"?n(t,o):n,Pt=(t,n)=>typeof t!="function"&&typeof n!="function"?{...t||{},...n||{}}:(o,l)=>{const d=typeof t=="function"?t(o,l):t,g=typeof n=="function"?n(o,l):n;return{...d||{},...g||{}}},Bt="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let rn=t=>crypto.getRandomValues(new Uint8Array(t)),Sn=(t,n,o)=>{let l=(2<<Math.log2(t.length-1))-1,d=-~(1.6*l*n/t.length);return(g=n)=>{let x="";for(;;){let C=o(d),A=d|0;for(;A--;)if(x+=t[C[A]&l]||"",x.length>=g)return x}}},pn=(t,n=21)=>Sn(t,n|0,rn),_i=(t=21)=>{let n="",o=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)n+=Bt[o[t]&63];return n};const Vi=()=>({isGuest:!0,id:pn("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_",20)()}),or=t=>{const n=JSON.stringify(t);let o=0;for(let l=0,d=n.length;l<d;l++){let g=n.charCodeAt(l);o=(o<<5)-o+g,o|=0}return`${o}`},Ei=t=>t?typeof t=="object"?{...t}:t:void 0,uo=(t,n)=>(Array.isArray(t)?t:[t]).map(o=>{const{id:l,type:d,purpose:g,value:x,created:C,modified:A,creator:L,...B}=o;return{id:l||`temp-${or(o)}`,annotation:n,type:d,purpose:g,value:x,creator:Ei(L),created:C?new Date(C):void 0,updated:A?new Date(A):void 0,...B}}),fo=t=>t.map(n=>{var o;const{annotation:l,created:d,updated:g,...x}=n,C={...x,created:d==null?void 0:d.toISOString(),modified:g==null?void 0:g.toISOString()};return(o=C.id)!=null&&o.startsWith("temp-")&&delete C.id,C}),po=["#ff7c00","#1ac938","#e8000b","#8b2be2","#9f4800","#f14cc1","#ffc400","#00d7ff","#023eff"],ho=()=>{const t=[...po];return{assignRandomColor:()=>{const n=Math.floor(Math.random()*t.length),o=t[n];return t.splice(n,1),o},releaseColor:n=>t.push(n)}};_i();const go=(t,n={strict:!0,invertY:!1})=>({parse:o=>ar(o,n),serialize:o=>sr(o,t,n)}),ar=(t,n={strict:!0,invertY:!1})=>{const o=t.id||zn(),{creator:l,created:d,modified:g,body:x,...C}=t,A=uo(x||[],o),L=Array.isArray(t.target)?t.target[0]:t.target,B=typeof L=="string"?L:Array.isArray(L.selector)?L.selector[0]:L.selector,G=typeof B=="string"||(B==null?void 0:B.type)==="FragmentSelector"?fi(B,n.invertY):(B==null?void 0:B.type)==="SvgSelector"?bi(B):void 0,ee=Array.isArray(C.target)?C.target[0]:C.targret;return G||!n.strict?{parsed:{...C,id:o,bodies:A,target:{created:d?new Date(d):void 0,creator:Ei(l),updated:g?new Date(g):void 0,...typeof ee=="string"?{}:ee,annotation:o,selector:G||B}}}:{error:Error(`Invalid selector: ${JSON.stringify(B)}`)}},sr=(t,n,o={strict:!0,invertY:!1})=>{const{selector:l,creator:d,created:g,updated:x,updatedBy:C,...A}=t.target;let L;try{L=l.type==Ue.RECTANGLE?pi(l.geometry):Qn(l)}catch(G){if(o.strict)throw G;L=l}const B={...t,"@context":"http://www.w3.org/ns/anno.jsonld",id:t.id,type:"Annotation",body:fo(t.bodies),created:g==null?void 0:g.toISOString(),creator:d,modified:x==null?void 0:x.toISOString(),target:{...A,source:n,type:"SpecificResource",selector:L}};return delete B.bodies,"annotation"in B.target&&delete B.target.annotation,B},Kn=[];function mo(t,n=s){let o;const l=new Set;function d(C){if(V(t,C)&&(t=C,o)){const A=!Kn.length;for(const L of l)L[1](),Kn.push(L,t);if(A){for(let L=0;L<Kn.length;L+=2)Kn[L][0](Kn[L+1]);Kn.length=0}}}function g(C){d(C(t))}function x(C,A=s){const L=[C,A];return l.add(L),l.size===1&&(o=n(d,g)||s),C(t),()=>{l.delete(L),l.size===0&&o&&(o(),o=null)}}return{set:d,update:g,subscribe:x}}const vo=(t,n)=>{const{naturalWidth:o,naturalHeight:l}=t;if(!o&&!l){const{width:d,height:g}=t;n.setAttribute("viewBox",`0 0 ${d} ${g}`),t.addEventListener("load",x=>{const C=x.target;n.setAttribute("viewBox",`0 0 ${C.naturalWidth} ${C.naturalHeight}`)})}else n.setAttribute("viewBox",`0 0 ${o} ${l}`)},lr=(t,n)=>{vo(t,n);const{subscribe:o,set:l}=mo(1);let d;return window.ResizeObserver&&(d=new ResizeObserver(()=>{const g=n.getBoundingClientRect(),{width:x,height:C}=n.viewBox.baseVal,A=Math.max(g.width/x,g.height/C);l(A)}),d.observe(n.parentElement)),{destroy:()=>{d&&d.disconnect()},subscribe:o}},Wn=(t,n)=>{const o=typeof n=="function"?n(t):n;if(o){const{fill:l,fillOpacity:d,stroke:g,strokeWidth:x,strokeOpacity:C}=o;let A="";return l&&(A+=`fill:${l};`),d||d===0?A+=`fill-opacity:${d};`:l&&(A+="fill-opacity:0.25;"),g&&(A+=`stroke:${g};`,A+=`stroke-width:${x||"1"};`,A+=`stroke-opacity:${C||"1"};`),A}},ii=(t,n=0)=>{const{minX:o,minY:l,maxX:d,maxY:g}=t;return{x:o-n,y:l-n,w:d-o+2*n,h:g-l+2*n}},wn=typeof window>"u"||typeof navigator>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,yo=t=>({}),cr=t=>({grab:t[0]});function bo(t){let n,o,l,d;const g=t[8].default,x=S(g,t,t[7],cr);return{c(){n=U("g"),x&&x.c(),y(n,"class","a9s-annotation selected")},m(C,A){K(C,n,A),x&&x.m(n,null),o=!0,l||(d=[re(n,"pointerup",t[2]),re(n,"pointermove",t[1])],l=!0)},p(C,[A]){x&&x.p&&(!o||A&128)&&P(x,g,C,C[7],o?w(g,C[7],A,yo):N(C[7]),cr)},i(C){o||(rt(x,C),o=!0)},o(C){vt(x,C),o=!1},d(C){C&&M(n),x&&x.d(C),l=!1,k(d)}}}function wo(t,n,o){let{$$slots:l={},$$scope:d}=n;const g=Re();let{shape:x}=n,{editor:C}=n,{transform:A}=n,{svgEl:L}=n,B,G,ee;const be=We=>Se=>{if(B=We,L){const{left:He,top:ge}=L.getBoundingClientRect(),Ve=Se.clientX-He,Ye=Se.clientY-ge;G=A.elementToImage(Ve,Ye)}else{const{offsetX:He,offsetY:ge}=Se;G=A.elementToImage(He,ge)}ee=x,Se.target.setPointerCapture(Se.pointerId),g("grab",Se)},he=We=>{if(B){const[Se,He]=A.elementToImage(We.offsetX,We.offsetY),ge=[Se-G[0],He-G[1]];o(3,x=C(ee,B,ge)),g("change",x)}},ue=We=>{We.target.releasePointerCapture(We.pointerId),B=void 0,ee=x,g("release",We)};return t.$$set=We=>{"shape"in We&&o(3,x=We.shape),"editor"in We&&o(4,C=We.editor),"transform"in We&&o(5,A=We.transform),"svgEl"in We&&o(6,L=We.svgEl),"$$scope"in We&&o(7,d=We.$$scope)},[be,he,ue,x,C,A,L,d,l]}class xi extends se{constructor(n){super(),le(this,n,wo,bo,V,{shape:3,editor:4,transform:5,svgEl:6})}}function _o(t){let n,o,l,d,g,x,C,A,L=t[3]&&ur(t);return{c(){n=U("g"),o=U("circle"),L&&L.c(),d=U("circle"),y(o,"class","a9s-handle-buffer svelte-qtyc7s"),y(o,"cx",t[0]),y(o,"cy",t[1]),y(o,"r",l=t[5]+6/t[2]),y(o,"role","button"),y(o,"tabindex","0"),y(d,"class",g=te(`a9s-handle-dot${t[3]?" selected":""}`)+" svelte-qtyc7s"),y(d,"cx",t[0]),y(d,"cy",t[1]),y(d,"r",t[5]),y(n,"class",x=`a9s-handle ${t[8].class||""}`.trim())},m(B,G){K(B,n,G),ne(n,o),L&&L.m(n,null),ne(n,d),C||(A=[re(o,"dblclick",t[12]),re(o,"pointerenter",t[13]),re(o,"pointerleave",t[14]),re(o,"pointerdown",t[15]),re(o,"pointerdown",t[6]),re(o,"pointerup",t[16]),re(o,"pointerup",t[7])],C=!0)},p(B,G){G&1&&y(o,"cx",B[0]),G&2&&y(o,"cy",B[1]),G&36&&l!==(l=B[5]+6/B[2])&&y(o,"r",l),B[3]?L?L.p(B,G):(L=ur(B),L.c(),L.m(n,d)):L&&(L.d(1),L=null),G&8&&g!==(g=te(`a9s-handle-dot${B[3]?" selected":""}`)+" svelte-qtyc7s")&&y(d,"class",g),G&1&&y(d,"cx",B[0]),G&2&&y(d,"cy",B[1]),G&32&&y(d,"r",B[5]),G&256&&x!==(x=`a9s-handle ${B[8].class||""}`.trim())&&y(n,"class",x)},d(B){B&&M(n),L&&L.d(),C=!1,k(A)}}}function Eo(t){let n,o,l,d,g,x,C,A,L;return{c(){n=U("g"),o=U("circle"),d=U("circle"),x=U("circle"),y(o,"cx",t[0]),y(o,"cy",t[1]),y(o,"r",l=t[5]*10),y(o,"class","a9s-touch-halo"),ce(o,"touched",t[4]),y(d,"cx",t[0]),y(d,"cy",t[1]),y(d,"r",g=t[5]+10/t[2]),y(d,"class","a9s-handle-buffer svelte-qtyc7s"),y(d,"role","button"),y(d,"tabindex","0"),y(x,"class","a9s-handle-dot"),y(x,"cx",t[0]),y(x,"cy",t[1]),y(x,"r",C=t[5]+2/t[2]),y(n,"class","a9s-touch-handle")},m(B,G){K(B,n,G),ne(n,o),ne(n,d),ne(n,x),A||(L=[re(d,"dblclick",t[9]),re(d,"pointerdown",t[10]),re(d,"pointerdown",t[6]),re(d,"pointerup",t[11]),re(d,"pointerup",t[7])],A=!0)},p(B,G){G&1&&y(o,"cx",B[0]),G&2&&y(o,"cy",B[1]),G&32&&l!==(l=B[5]*10)&&y(o,"r",l),G&16&&ce(o,"touched",B[4]),G&1&&y(d,"cx",B[0]),G&2&&y(d,"cy",B[1]),G&36&&g!==(g=B[5]+10/B[2])&&y(d,"r",g),G&1&&y(x,"cx",B[0]),G&2&&y(x,"cy",B[1]),G&36&&C!==(C=B[5]+2/B[2])&&y(x,"r",C)},d(B){B&&M(n),A=!1,k(L)}}}function ur(t){let n,o;return{c(){n=U("circle"),y(n,"class","a9s-handle-selected"),y(n,"cx",t[0]),y(n,"cy",t[1]),y(n,"r",o=t[5]+8/t[2])},m(l,d){K(l,n,d)},p(l,d){d&1&&y(n,"cx",l[0]),d&2&&y(n,"cy",l[1]),d&36&&o!==(o=l[5]+8/l[2])&&y(n,"r",o)},d(l){l&&M(n)}}}function xo(t){let n;function o(d,g){return wn?Eo:_o}let l=o()(t);return{c(){l.c(),n=W()},m(d,g){l.m(d,g),K(d,n,g)},p(d,[g]){l.p(d,g)},i:s,o:s,d(d){d&&M(n),l.d(d)}}}function Co(t,n,o){let l,{x:d}=n,{y:g}=n,{scale:x}=n,{selected:C=void 0}=n,A=!1;const L=ge=>{ge.pointerType==="touch"&&o(4,A=!0)},B=()=>o(4,A=!1);function G(ge){je.call(this,t,ge)}function ee(ge){je.call(this,t,ge)}function be(ge){je.call(this,t,ge)}function he(ge){je.call(this,t,ge)}function ue(ge){je.call(this,t,ge)}function We(ge){je.call(this,t,ge)}function Se(ge){je.call(this,t,ge)}function He(ge){je.call(this,t,ge)}return t.$$set=ge=>{o(8,n=m(m({},n),X(ge))),"x"in ge&&o(0,d=ge.x),"y"in ge&&o(1,g=ge.y),"scale"in ge&&o(2,x=ge.scale),"selected"in ge&&o(3,C=ge.selected)},t.$$.update=()=>{t.$$.dirty&4&&o(5,l=4/x)},n=X(n),[d,g,x,C,A,l,L,B,n,G,ee,be,he,ue,We,Se,He]}class Bn extends se{constructor(n){super(),le(this,n,Co,xo,V,{x:0,y:1,scale:2,selected:3})}}function To(t){let n,o,l,d,g,x,C;return{c(){n=U("g"),o=U("circle"),d=U("circle"),g=U("circle"),y(o,"class","a9s-polygon-midpoint-buffer svelte-12ykj76"),y(o,"cx",t[0]),y(o,"cy",t[1]),y(o,"r",l=1.75*t[2]),y(d,"class","a9s-polygon-midpoint-outer svelte-12ykj76"),y(d,"cx",t[0]),y(d,"cy",t[1]),y(d,"r",t[2]),y(g,"class","a9s-polygon-midpoint-inner svelte-12ykj76"),y(g,"cx",t[0]),y(g,"cy",t[1]),y(g,"r",t[2]),y(n,"class","a9s-polygon-midpoint svelte-12ykj76")},m(A,L){K(A,n,L),ne(n,o),ne(n,d),ne(n,g),x||(C=[re(o,"pointerdown",t[5]),re(o,"pointerdown",t[3])],x=!0)},p(A,L){L&1&&y(o,"cx",A[0]),L&2&&y(o,"cy",A[1]),L&4&&l!==(l=1.75*A[2])&&y(o,"r",l),L&1&&y(d,"cx",A[0]),L&2&&y(d,"cy",A[1]),L&4&&y(d,"r",A[2]),L&1&&y(g,"cx",A[0]),L&2&&y(g,"cy",A[1]),L&4&&y(g,"r",A[2])},d(A){A&&M(n),x=!1,k(C)}}}function So(t){let n;return{c(){n=U("circle"),y(n,"cx",t[0]),y(n,"cy",t[1]),y(n,"r",t[2])},m(o,l){K(o,n,l)},p(o,l){l&1&&y(n,"cx",o[0]),l&2&&y(n,"cy",o[1]),l&4&&y(n,"r",o[2])},d(o){o&&M(n)}}}function ko(t){let n;function o(d,g){return wn?So:To}let l=o()(t);return{c(){l.c(),n=W()},m(d,g){l.m(d,g),K(d,n,g)},p(d,[g]){l.p(d,g)},i:s,o:s,d(d){d&&M(n),l.d(d)}}}function Ao(t,n,o){let l,{x:d}=n,{y:g}=n,{scale:x}=n;const C=L=>{L.pointerType};function A(L){je.call(this,t,L)}return t.$$set=L=>{"x"in L&&o(0,d=L.x),"y"in L&&o(1,g=L.y),"scale"in L&&o(4,x=L.scale)},t.$$.update=()=>{t.$$.dirty&16&&o(2,l=4/x)},[d,g,l,C,x,A]}class zi extends se{constructor(n){super(),le(this,n,Ao,ko,V,{x:0,y:1,scale:4})}}function ji(t){const n=t.slice(),o=n[10][n[6]];return n[28]=o.point,n}function dr(t,n,o){const l=t.slice();return l[28]=n[o],l[30]=o,l}function Ui(t){const n=t.slice(),o=n[10][n[6]];return n[28]=o.point,n}function Wi(t){const n=t.slice(),o=n[10][n[6]];return n[28]=o.point,n}function fr(t){let n,o,l,d;return{c(){n=U("circle"),y(n,"cx",o=t[28][0]),y(n,"cy",l=t[28][1]),y(n,"r",d=ri/t[3]),y(n,"class","svelte-1h2slbm")},m(g,x){K(g,n,x)},p(g,x){x[0]&1088&&o!==(o=g[28][0])&&y(n,"cx",o),x[0]&1088&&l!==(l=g[28][1])&&y(n,"cy",l),x[0]&8&&d!==(d=ri/g[3])&&y(n,"r",d)},d(g){g&&M(n)}}}function pr(t){let n,o,l,d,g,x,C,A,L,B;return{c(){n=U("mask"),o=U("rect"),C=U("circle"),y(o,"x",l=t[9].x),y(o,"y",d=t[9].y),y(o,"width",g=t[9].w),y(o,"height",x=t[9].h),y(o,"class","svelte-1h2slbm"),y(C,"cx",A=t[28][0]),y(C,"cy",L=t[28][1]),y(C,"r",B=ri/t[3]),y(C,"class","svelte-1h2slbm"),y(n,"id",`${t[19]}-inner`),y(n,"class","a9s-polygon-editor-mask svelte-1h2slbm")},m(G,ee){K(G,n,ee),ne(n,o),ne(n,C)},p(G,ee){ee[0]&512&&l!==(l=G[9].x)&&y(o,"x",l),ee[0]&512&&d!==(d=G[9].y)&&y(o,"y",d),ee[0]&512&&g!==(g=G[9].w)&&y(o,"width",g),ee[0]&512&&x!==(x=G[9].h)&&y(o,"height",x),ee[0]&1088&&A!==(A=G[28][0])&&y(C,"cx",A),ee[0]&1088&&L!==(L=G[28][1])&&y(C,"cy",L),ee[0]&8&&B!==(B=ri/G[3])&&y(C,"r",B)},d(G){G&&M(n)}}}function hr(t){let n,o;return n=new Bn({props:{class:"a9s-corner-handle",x:t[28][0],y:t[28][1],scale:t[3],selected:t[8].includes(t[30])}}),n.$on("pointerenter",t[11]),n.$on("pointerleave",t[12]),n.$on("pointerdown",t[15]),n.$on("pointerdown",function(){D(t[27](`HANDLE-${t[30]}`))&&t[27](`HANDLE-${t[30]}`).apply(this,arguments)}),n.$on("pointerup",t[16](t[30])),{c(){Yt(n.$$.fragment)},m(l,d){Jt(n,l,d),o=!0},p(l,d){t=l;const g={};d[0]&32&&(g.x=t[28][0]),d[0]&32&&(g.y=t[28][1]),d[0]&8&&(g.scale=t[3]),d[0]&256&&(g.selected=t[8].includes(t[30])),n.$set(g)},i(l){o||(rt(n.$$.fragment,l),o=!0)},o(l){vt(n.$$.fragment,l),o=!1},d(l){Qt(n,l)}}}function gr(t){let n,o;return n=new zi({props:{x:t[28][0],y:t[28][1],scale:t[3]}}),n.$on("pointerdown",function(){D(t[18](t[6]))&&t[18](t[6]).apply(this,arguments)}),{c(){Yt(n.$$.fragment)},m(l,d){Jt(n,l,d),o=!0},p(l,d){t=l;const g={};d[0]&1088&&(g.x=t[28][0]),d[0]&1088&&(g.y=t[28][1]),d[0]&8&&(g.scale=t[3]),n.$set(g)},i(l){o||(rt(n.$$.fragment,l),o=!0)},o(l){vt(n.$$.fragment,l),o=!1},d(l){Qt(n,l)}}}function Io(t){let n,o,l,d,g,x,C,A,L,B,G,ee,be,he,ue,We,Se,He,ge,Ve,Ye,tt=t[6]!==void 0&&!t[7]&&fr(Wi(t)),Xe=t[6]!==void 0&&!t[7]&&pr(Ui(t)),ht=tn(t[5].points),st=[];for(let Ee=0;Ee<ht.length;Ee+=1)st[Ee]=hr(dr(t,ht,Ee));const Rt=Ee=>vt(st[Ee],1,1,()=>{st[Ee]=null});let Tt=t[6]!==void 0&&!t[7]&&gr(ji(t));return{c(){n=U("defs"),o=U("mask"),l=U("rect"),A=U("polygon"),tt&&tt.c(),Xe&&Xe.c(),B=H(),G=U("polygon"),be=H(),he=U("polygon"),We=H();for(let Ee=0;Ee<st.length;Ee+=1)st[Ee].c();Se=H(),Tt&&Tt.c(),He=W(),y(l,"x",d=t[9].x),y(l,"y",g=t[9].y),y(l,"width",x=t[9].w),y(l,"height",C=t[9].h),y(l,"class","svelte-1h2slbm"),y(A,"points",L=t[5].points.map(mr).join(" ")),y(A,"class","svelte-1h2slbm"),y(o,"id",`${t[19]}-outer`),y(o,"class","a9s-polygon-editor-mask svelte-1h2slbm"),y(G,"class","a9s-outer"),y(G,"mask",`url(#${t[19]}-outer)`),y(G,"points",ee=t[5].points.map(vr).join(" ")),y(he,"class","a9s-inner a9s-shape-handle"),y(he,"mask",`url(#${t[19]}-inner)`),y(he,"style",t[1]),y(he,"points",ue=t[5].points.map(yr).join(" "))},m(Ee,Oe){K(Ee,n,Oe),ne(n,o),ne(o,l),ne(o,A),tt&&tt.m(o,null),Xe&&Xe.m(n,null),K(Ee,B,Oe),K(Ee,G,Oe),K(Ee,be,Oe),K(Ee,he,Oe),K(Ee,We,Oe);for(let pe=0;pe<st.length;pe+=1)st[pe]&&st[pe].m(Ee,Oe);K(Ee,Se,Oe),Tt&&Tt.m(Ee,Oe),K(Ee,He,Oe),ge=!0,Ve||(Ye=[re(G,"pointerup",t[14]),re(G,"pointerdown",function(){D(t[27]("SHAPE"))&&t[27]("SHAPE").apply(this,arguments)}),re(he,"pointermove",t[13]),re(he,"pointerup",t[14]),re(he,"pointerdown",function(){D(t[27]("SHAPE"))&&t[27]("SHAPE").apply(this,arguments)})],Ve=!0)},p(Ee,Oe){if(t=Ee,(!ge||Oe[0]&512&&d!==(d=t[9].x))&&y(l,"x",d),(!ge||Oe[0]&512&&g!==(g=t[9].y))&&y(l,"y",g),(!ge||Oe[0]&512&&x!==(x=t[9].w))&&y(l,"width",x),(!ge||Oe[0]&512&&C!==(C=t[9].h))&&y(l,"height",C),(!ge||Oe[0]&32&&L!==(L=t[5].points.map(mr).join(" ")))&&y(A,"points",L),t[6]!==void 0&&!t[7]?tt?tt.p(Wi(t),Oe):(tt=fr(Wi(t)),tt.c(),tt.m(o,null)):tt&&(tt.d(1),tt=null),t[6]!==void 0&&!t[7]?Xe?Xe.p(Ui(t),Oe):(Xe=pr(Ui(t)),Xe.c(),Xe.m(n,null)):Xe&&(Xe.d(1),Xe=null),(!ge||Oe[0]&32&&ee!==(ee=t[5].points.map(vr).join(" ")))&&y(G,"points",ee),(!ge||Oe[0]&2)&&y(he,"style",t[1]),(!ge||Oe[0]&32&&ue!==(ue=t[5].points.map(yr).join(" ")))&&y(he,"points",ue),Oe[0]&134322472){ht=tn(t[5].points);let pe;for(pe=0;pe<ht.length;pe+=1){const Te=dr(t,ht,pe);st[pe]?(st[pe].p(Te,Oe),rt(st[pe],1)):(st[pe]=hr(Te),st[pe].c(),rt(st[pe],1),st[pe].m(Se.parentNode,Se))}for(Lt(),pe=ht.length;pe<st.length;pe+=1)Rt(pe);Nt()}t[6]!==void 0&&!t[7]?Tt?(Tt.p(ji(t),Oe),Oe[0]&192&&rt(Tt,1)):(Tt=gr(ji(t)),Tt.c(),rt(Tt,1),Tt.m(He.parentNode,He)):Tt&&(Lt(),vt(Tt,1,1,()=>{Tt=null}),Nt())},i(Ee){if(!ge){for(let Oe=0;Oe<ht.length;Oe+=1)rt(st[Oe]);rt(Tt),ge=!0}},o(Ee){st=st.filter(Boolean);for(let Oe=0;Oe<st.length;Oe+=1)vt(st[Oe]);vt(Tt),ge=!1},d(Ee){Ee&&(M(n),M(B),M(G),M(be),M(he),M(We),M(Se),M(He)),tt&&tt.d(),Xe&&Xe.d(),J(st,Ee),Tt&&Tt.d(Ee),Ve=!1,k(Ye)}}}function Po(t){let n,o;return n=new xi({props:{shape:t[0],transform:t[2],editor:t[17],svgEl:t[4],$$slots:{default:[Io,({grab:l})=>({27:l}),({grab:l})=>[l?134217728:0]]},$$scope:{ctx:t}}}),n.$on("change",t[20]),n.$on("grab",t[21]),n.$on("release",t[22]),{c(){Yt(n.$$.fragment)},m(l,d){Jt(n,l,d),o=!0},p(l,d){const g={};d[0]&1&&(g.shape=l[0]),d[0]&4&&(g.transform=l[2]),d[0]&16&&(g.svgEl=l[4]),d[0]&134219754|d[1]&1&&(g.$$scope={dirty:d,ctx:l}),n.$set(g)},i(l){o||(rt(n.$$.fragment,l),o=!0)},o(l){vt(n.$$.fragment,l),o=!1},d(l){Qt(n,l)}}}const Do=250,Oo=1e3,No=12,ri=4.5,mr=t=>t.join(","),vr=t=>t.join(","),yr=t=>t.join(",");function Lo(t,n,o){let l,d,g;const x=Re();let{shape:C}=n,{computedStyle:A}=n,{transform:L}=n,{viewportScale:B=1}=n,{svgEl:G}=n,ee,be=!1,he,ue=[];const We=()=>o(7,be=!0),Se=()=>o(7,be=!1),He=pe=>{if(ue.length>0||!d.some(xt=>xt.visible)){o(6,ee=void 0);return}const[Te,Qe]=L.elementToImage(pe.offsetX,pe.offsetY),Me=xt=>Math.pow(xt[0]-Te,2)+Math.pow(xt[1]-Qe,2),nt=l.points.reduce((xt,St)=>Me(St)<Me(xt)?St:xt),Ct=d.filter(xt=>xt.visible).reduce((xt,St)=>Me(St.point)<Me(xt.point)?St:xt),Et=Math.pow(Oo/B,2);Me(nt)<Et||Me(Ct.point)<Et?o(6,ee=d.indexOf(Ct)):o(6,ee=void 0)},ge=()=>{document.activeElement!==G&&G.focus()},Ve=()=>{o(8,ue=[]),ge()},Ye=pe=>{o(7,be=!0),pe.preventDefault(),pe.stopPropagation(),he=performance.now()},tt=pe=>Te=>{if(!he||wn||performance.now()-he>Do)return;const Qe=ue.includes(pe);Te.metaKey||Te.ctrlKey||Te.shiftKey?Qe?o(8,ue=ue.filter(Me=>Me!==pe)):o(8,ue=[...ue,pe]):Qe&&ue.length>1?o(8,ue=[pe]):Qe?o(8,ue=[]):o(8,ue=[pe]),ge()},Xe=(pe,Te,Qe)=>{ge();let Me;const nt=pe.geometry;ue.length>1?Me=nt.points.map(([Et,xt],St)=>ue.includes(St)?[Et+Qe[0],xt+Qe[1]]:[Et,xt]):Te==="SHAPE"?Me=nt.points.map(([Et,xt])=>[Et+Qe[0],xt+Qe[1]]):Me=nt.points.map(([Et,xt],St)=>Te===`HANDLE-${St}`?[Et+Qe[0],xt+Qe[1]]:[Et,xt]);const Ct=Vt(Me);return{...pe,geometry:{points:Me,bounds:Ct}}},ht=pe=>async Te=>{Te.stopPropagation();const Qe=[...l.points.slice(0,pe+1),d[pe].point,...l.points.slice(pe+1)],Me=Vt(Qe);x("change",{...C,geometry:{points:Qe,bounds:Me}}),await me();const nt=[...document.querySelectorAll(".a9s-handle")][pe+1];if(nt!=null&&nt.firstChild){const Ct=new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:Te.clientX,clientY:Te.clientY,pointerId:Te.pointerId,pointerType:Te.pointerType,isPrimary:Te.isPrimary,buttons:Te.buttons});nt.firstChild.dispatchEvent(Ct)}},st=()=>{if(l.points.length-ue.length<3)return;const pe=l.points.filter((Qe,Me)=>!ue.includes(Me)),Te=Vt(pe);x("change",{...C,geometry:{points:pe,bounds:Te}}),o(8,ue=[])};De(()=>{if(wn)return;const pe=Te=>{(Te.key==="Delete"||Te.key==="Backspace")&&(Te.preventDefault(),st())};return G.addEventListener("pointermove",He),G.addEventListener("keydown",pe),()=>{G.removeEventListener("pointermove",He),G.removeEventListener("keydown",pe)}});const Rt=`polygon-mask-${Math.random().toString(36).substring(2,12)}`;function Tt(pe){je.call(this,t,pe)}function Ee(pe){je.call(this,t,pe)}function Oe(pe){je.call(this,t,pe)}return t.$$set=pe=>{"shape"in pe&&o(0,C=pe.shape),"computedStyle"in pe&&o(1,A=pe.computedStyle),"transform"in pe&&o(2,L=pe.transform),"viewportScale"in pe&&o(3,B=pe.viewportScale),"svgEl"in pe&&o(4,G=pe.svgEl)},t.$$.update=()=>{t.$$.dirty[0]&1&&o(5,l=C.geometry),t.$$.dirty[0]&40&&o(10,d=wn?[]:l.points.map((pe,Te)=>{const Qe=Te===l.points.length-1?l.points[0]:l.points[Te+1],Me=(pe[0]+Qe[0])/2,nt=(pe[1]+Qe[1])/2,Ct=Math.sqrt(Math.pow(Qe[0]-Me,2)+Math.pow(Qe[1]-nt,2))>No/B;return{point:[Me,nt],visible:Ct}})),t.$$.dirty[0]&40&&o(9,g=ii(l.bounds,ri/B))},[C,A,L,B,G,l,ee,be,ue,g,d,We,Se,He,Ve,Ye,tt,Xe,ht,Rt,Tt,Ee,Oe]}class br extends se{constructor(n){super(),le(this,n,Lo,Po,V,{shape:0,computedStyle:1,transform:2,viewportScale:3,svgEl:4},null,[-1,-1])}}function Fo(t){let n,o,l,d,g,x,C,A,L,B,G,ee,be,he,ue,We,Se,He,ge,Ve,Ye,tt,Xe,ht,st,Rt,Tt,Ee,Oe,pe,Te,Qe,Me,nt,Ct,Et,xt,St,nn,cn,en,_n,Pn,bt,sn,Gt,ln,bn,Gn,Dn,ir,On,Ut,rr,co;return Gt=new Bn({props:{class:"a9s-corner-handle-topleft",x:t[5].x,y:t[5].y,scale:t[3]}}),Gt.$on("pointerdown",function(){D(t[12]("TOP_LEFT"))&&t[12]("TOP_LEFT").apply(this,arguments)}),bn=new Bn({props:{class:"a9s-corner-handle-topright",x:t[5].x+t[5].w,y:t[5].y,scale:t[3]}}),bn.$on("pointerdown",function(){D(t[12]("TOP_RIGHT"))&&t[12]("TOP_RIGHT").apply(this,arguments)}),Dn=new Bn({props:{class:"a9s-corner-handle-bottomright",x:t[5].x+t[5].w,y:t[5].y+t[5].h,scale:t[3]}}),Dn.$on("pointerdown",function(){D(t[12]("BOTTOM_RIGHT"))&&t[12]("BOTTOM_RIGHT").apply(this,arguments)}),On=new Bn({props:{class:"a9s-corner-handle-bottomleft",x:t[5].x,y:t[5].y+t[5].h,scale:t[3]}}),On.$on("pointerdown",function(){D(t[12]("BOTTOM_LEFT"))&&t[12]("BOTTOM_LEFT").apply(this,arguments)}),{c(){n=U("defs"),o=U("mask"),l=U("rect"),A=U("rect"),be=H(),he=U("rect"),ge=H(),Ve=U("rect"),st=H(),Rt=U("rect"),pe=H(),Te=U("rect"),Ct=H(),Et=U("rect"),cn=H(),en=U("rect"),sn=H(),Yt(Gt.$$.fragment),ln=H(),Yt(bn.$$.fragment),Gn=H(),Yt(Dn.$$.fragment),ir=H(),Yt(On.$$.fragment),y(l,"class","rect-mask-bg svelte-1njczvj"),y(l,"x",d=t[6].x),y(l,"y",g=t[6].y),y(l,"width",x=t[6].w),y(l,"height",C=t[6].h),y(A,"class","rect-mask-fg svelte-1njczvj"),y(A,"x",L=t[5].x),y(A,"y",B=t[5].y),y(A,"width",G=t[5].w),y(A,"height",ee=t[5].h),y(o,"id",t[8]),y(o,"class","a9s-rectangle-editor-mask svelte-1njczvj"),y(he,"class","a9s-outer"),y(he,"mask",`url(#${t[8]})`),y(he,"x",ue=t[5].x),y(he,"y",We=t[5].y),y(he,"width",Se=t[5].w),y(he,"height",He=t[5].h),y(Ve,"class","a9s-inner a9s-shape-handle"),y(Ve,"style",t[1]),y(Ve,"x",Ye=t[5].x),y(Ve,"y",tt=t[5].y),y(Ve,"width",Xe=t[5].w),y(Ve,"height",ht=t[5].h),y(Rt,"class","a9s-edge-handle a9s-edge-handle-top"),y(Rt,"x",Tt=t[5].x),y(Rt,"y",Ee=t[5].y),y(Rt,"height",1),y(Rt,"width",Oe=t[5].w),y(Te,"class","a9s-edge-handle a9s-edge-handle-right"),y(Te,"x",Qe=t[5].x+t[5].w),y(Te,"y",Me=t[5].y),y(Te,"height",nt=t[5].h),y(Te,"width",1),y(Et,"class","a9s-edge-handle a9s-edge-handle-bottom"),y(Et,"x",xt=t[5].x),y(Et,"y",St=t[5].y+t[5].h),y(Et,"height",1),y(Et,"width",nn=t[5].w),y(en,"class","a9s-edge-handle a9s-edge-handle-left"),y(en,"x",_n=t[5].x),y(en,"y",Pn=t[5].y),y(en,"height",bt=t[5].h),y(en,"width",1)},m(Dt,ct){K(Dt,n,ct),ne(n,o),ne(o,l),ne(o,A),K(Dt,be,ct),K(Dt,he,ct),K(Dt,ge,ct),K(Dt,Ve,ct),K(Dt,st,ct),K(Dt,Rt,ct),K(Dt,pe,ct),K(Dt,Te,ct),K(Dt,Ct,ct),K(Dt,Et,ct),K(Dt,cn,ct),K(Dt,en,ct),K(Dt,sn,ct),Jt(Gt,Dt,ct),K(Dt,ln,ct),Jt(bn,Dt,ct),K(Dt,Gn,ct),Jt(Dn,Dt,ct),K(Dt,ir,ct),Jt(On,Dt,ct),Ut=!0,rr||(co=[re(he,"pointerdown",function(){D(t[12]("SHAPE"))&&t[12]("SHAPE").apply(this,arguments)}),re(Ve,"pointerdown",function(){D(t[12]("SHAPE"))&&t[12]("SHAPE").apply(this,arguments)}),re(Rt,"pointerdown",function(){D(t[12]("TOP"))&&t[12]("TOP").apply(this,arguments)}),re(Te,"pointerdown",function(){D(t[12]("RIGHT"))&&t[12]("RIGHT").apply(this,arguments)}),re(Et,"pointerdown",function(){D(t[12]("BOTTOM"))&&t[12]("BOTTOM").apply(this,arguments)}),re(en,"pointerdown",function(){D(t[12]("LEFT"))&&t[12]("LEFT").apply(this,arguments)})],rr=!0)},p(Dt,ct){t=Dt,(!Ut||ct&64&&d!==(d=t[6].x))&&y(l,"x",d),(!Ut||ct&64&&g!==(g=t[6].y))&&y(l,"y",g),(!Ut||ct&64&&x!==(x=t[6].w))&&y(l,"width",x),(!Ut||ct&64&&C!==(C=t[6].h))&&y(l,"height",C),(!Ut||ct&32&&L!==(L=t[5].x))&&y(A,"x",L),(!Ut||ct&32&&B!==(B=t[5].y))&&y(A,"y",B),(!Ut||ct&32&&G!==(G=t[5].w))&&y(A,"width",G),(!Ut||ct&32&&ee!==(ee=t[5].h))&&y(A,"height",ee),(!Ut||ct&32&&ue!==(ue=t[5].x))&&y(he,"x",ue),(!Ut||ct&32&&We!==(We=t[5].y))&&y(he,"y",We),(!Ut||ct&32&&Se!==(Se=t[5].w))&&y(he,"width",Se),(!Ut||ct&32&&He!==(He=t[5].h))&&y(he,"height",He),(!Ut||ct&2)&&y(Ve,"style",t[1]),(!Ut||ct&32&&Ye!==(Ye=t[5].x))&&y(Ve,"x",Ye),(!Ut||ct&32&&tt!==(tt=t[5].y))&&y(Ve,"y",tt),(!Ut||ct&32&&Xe!==(Xe=t[5].w))&&y(Ve,"width",Xe),(!Ut||ct&32&&ht!==(ht=t[5].h))&&y(Ve,"height",ht),(!Ut||ct&32&&Tt!==(Tt=t[5].x))&&y(Rt,"x",Tt),(!Ut||ct&32&&Ee!==(Ee=t[5].y))&&y(Rt,"y",Ee),(!Ut||ct&32&&Oe!==(Oe=t[5].w))&&y(Rt,"width",Oe),(!Ut||ct&32&&Qe!==(Qe=t[5].x+t[5].w))&&y(Te,"x",Qe),(!Ut||ct&32&&Me!==(Me=t[5].y))&&y(Te,"y",Me),(!Ut||ct&32&&nt!==(nt=t[5].h))&&y(Te,"height",nt),(!Ut||ct&32&&xt!==(xt=t[5].x))&&y(Et,"x",xt),(!Ut||ct&32&&St!==(St=t[5].y+t[5].h))&&y(Et,"y",St),(!Ut||ct&32&&nn!==(nn=t[5].w))&&y(Et,"width",nn),(!Ut||ct&32&&_n!==(_n=t[5].x))&&y(en,"x",_n),(!Ut||ct&32&&Pn!==(Pn=t[5].y))&&y(en,"y",Pn),(!Ut||ct&32&&bt!==(bt=t[5].h))&&y(en,"height",bt);const Si={};ct&32&&(Si.x=t[5].x),ct&32&&(Si.y=t[5].y),ct&8&&(Si.scale=t[3]),Gt.$set(Si);const ki={};ct&32&&(ki.x=t[5].x+t[5].w),ct&32&&(ki.y=t[5].y),ct&8&&(ki.scale=t[3]),bn.$set(ki);const Ai={};ct&32&&(Ai.x=t[5].x+t[5].w),ct&32&&(Ai.y=t[5].y+t[5].h),ct&8&&(Ai.scale=t[3]),Dn.$set(Ai);const Ii={};ct&32&&(Ii.x=t[5].x),ct&32&&(Ii.y=t[5].y+t[5].h),ct&8&&(Ii.scale=t[3]),On.$set(Ii)},i(Dt){Ut||(rt(Gt.$$.fragment,Dt),rt(bn.$$.fragment,Dt),rt(Dn.$$.fragment,Dt),rt(On.$$.fragment,Dt),Ut=!0)},o(Dt){vt(Gt.$$.fragment,Dt),vt(bn.$$.fragment,Dt),vt(Dn.$$.fragment,Dt),vt(On.$$.fragment,Dt),Ut=!1},d(Dt){Dt&&(M(n),M(be),M(he),M(ge),M(Ve),M(st),M(Rt),M(pe),M(Te),M(Ct),M(Et),M(cn),M(en),M(sn),M(ln),M(Gn),M(ir)),Qt(Gt,Dt),Qt(bn,Dt),Qt(Dn,Dt),Qt(On,Dt),rr=!1,k(co)}}}function Ho(t){let n,o;return n=new xi({props:{shape:t[0],transform:t[2],editor:t[7],svgEl:t[4],$$slots:{default:[Fo,({grab:l})=>({12:l}),({grab:l})=>l?4096:0]},$$scope:{ctx:t}}}),n.$on("grab",t[9]),n.$on("change",t[10]),n.$on("release",t[11]),{c(){Yt(n.$$.fragment)},m(l,d){Jt(n,l,d),o=!0},p(l,[d]){const g={};d&1&&(g.shape=l[0]),d&4&&(g.transform=l[2]),d&16&&(g.svgEl=l[4]),d&12394&&(g.$$scope={dirty:d,ctx:l}),n.$set(g)},i(l){o||(rt(n.$$.fragment,l),o=!0)},o(l){vt(n.$$.fragment,l),o=!1},d(l){Qt(n,l)}}}function Ro(t,n,o){let l,d,{shape:g}=n,{computedStyle:x}=n,{transform:C}=n,{viewportScale:A=1}=n,{svgEl:L}=n;const B=(ue,We,Se)=>{const He=ue.geometry.bounds;let[ge,Ve]=[He.minX,He.minY],[Ye,tt]=[He.maxX,He.maxY];const[Xe,ht]=Se;if(We==="SHAPE")ge+=Xe,Ye+=Xe,Ve+=ht,tt+=ht;else{switch(We){case"TOP":case"TOP_LEFT":case"TOP_RIGHT":{Ve+=ht;break}case"BOTTOM":case"BOTTOM_LEFT":case"BOTTOM_RIGHT":{tt+=ht;break}}switch(We){case"LEFT":case"TOP_LEFT":case"BOTTOM_LEFT":{ge+=Xe;break}case"RIGHT":case"TOP_RIGHT":case"BOTTOM_RIGHT":{Ye+=Xe;break}}}const st=Math.min(ge,Ye),Rt=Math.min(Ve,tt),Tt=Math.abs(Ye-ge),Ee=Math.abs(tt-Ve);return{...ue,geometry:{x:st,y:Rt,w:Tt,h:Ee,bounds:{minX:st,minY:Rt,maxX:st+Tt,maxY:Rt+Ee}}}},G=`rect-mask-${Math.random().toString(36).substring(2,12)}`;function ee(ue){je.call(this,t,ue)}function be(ue){je.call(this,t,ue)}function he(ue){je.call(this,t,ue)}return t.$$set=ue=>{"shape"in ue&&o(0,g=ue.shape),"computedStyle"in ue&&o(1,x=ue.computedStyle),"transform"in ue&&o(2,C=ue.transform),"viewportScale"in ue&&o(3,A=ue.viewportScale),"svgEl"in ue&&o(4,L=ue.svgEl)},t.$$.update=()=>{t.$$.dirty&1&&o(5,l=g.geometry),t.$$.dirty&40&&o(6,d=ii(l.bounds,2/A))},[g,x,C,A,L,l,d,B,G,ee,be,he]}class wr extends se{constructor(n){super(),le(this,n,Ro,Ho,V,{shape:0,computedStyle:1,transform:2,viewportScale:3,svgEl:4})}}var _r=Object.prototype.hasOwnProperty;function Bi(t,n){var o,l;if(t===n)return!0;if(t&&n&&(o=t.constructor)===n.constructor){if(o===Date)return t.getTime()===n.getTime();if(o===RegExp)return t.toString()===n.toString();if(o===Array){if((l=t.length)===n.length)for(;l--&&Bi(t[l],n[l]););return l===-1}if(!o||typeof t=="object"){l=0;for(o in t)if(_r.call(t,o)&&++l&&!_r.call(n,o)||!(o in n)||!Bi(t[o],n[o]))return!1;return Object.keys(n).length===l}}return t!==t&&n!==n}const Vo=12,zo=(t,n)=>t.polygons.reduce((o,l,d)=>{const g=l.rings.reduce((x,C,A)=>{const L=C.points.map((B,G)=>{const ee=G===C.points.length-1?C.points[0]:C.points[G+1],be=(B[0]+ee[0])/2,he=(B[1]+ee[1])/2,ue=Math.sqrt(Math.pow(ee[0]-be,2)+Math.pow(ee[1]-he,2))>Vo/n;return{point:[be,he],visible:ue,elementIdx:d,ringIdx:A,pointIdx:G}});return[...x,...L]},[]);return[...o,...g]},[]);function Gi(t){const n=t.slice(),o=n[10][n[6]];return n[29]=o.point,n}function Er(t,n,o){const l=t.slice();return l[30]=n[o],l[32]=o,l}function xr(t,n,o){const l=t.slice();return l[33]=n[o],l[35]=o,l}function Cr(t,n,o){const l=t.slice();return l[29]=n[o],l[37]=o,l}function Yi(t){const n=t.slice(),o=n[10][n[6]];return n[29]=o.point,n}function Xi(t){const n=t.slice(),o=n[10][n[6]];return n[29]=o.point,n}function Tr(t){let n,o,l,d;return{c(){n=U("circle"),y(n,"cx",o=t[29][0]),y(n,"cy",l=t[29][1]),y(n,"r",d=oi/t[3]),y(n,"class","svelte-1vxo6dc")},m(g,x){K(g,n,x)},p(g,x){x[0]&1088&&o!==(o=g[29][0])&&y(n,"cx",o),x[0]&1088&&l!==(l=g[29][1])&&y(n,"cy",l),x[0]&8&&d!==(d=oi/g[3])&&y(n,"r",d)},d(g){g&&M(n)}}}function Sr(t){let n,o,l,d,g,x,C,A,L,B;return{c(){n=U("mask"),o=U("rect"),C=U("circle"),y(o,"x",l=t[9].x),y(o,"y",d=t[9].y),y(o,"width",g=t[9].w),y(o,"height",x=t[9].h),y(o,"class","svelte-1vxo6dc"),y(C,"cx",A=t[29][0]),y(C,"cy",L=t[29][1]),y(C,"r",B=oi/t[3]),y(C,"class","svelte-1vxo6dc"),y(n,"id",`${t[18]}-${t[32]}-inner`),y(n,"class","a9s-multipolygon-editor-mask svelte-1vxo6dc")},m(G,ee){K(G,n,ee),ne(n,o),ne(n,C)},p(G,ee){ee[0]&512&&l!==(l=G[9].x)&&y(o,"x",l),ee[0]&512&&d!==(d=G[9].y)&&y(o,"y",d),ee[0]&512&&g!==(g=G[9].w)&&y(o,"width",g),ee[0]&512&&x!==(x=G[9].h)&&y(o,"height",x),ee[0]&1088&&A!==(A=G[29][0])&&y(C,"cx",A),ee[0]&1088&&L!==(L=G[29][1])&&y(C,"cy",L),ee[0]&8&&B!==(B=oi/G[3])&&y(C,"r",B)},d(G){G&&M(n)}}}function kr(t){let n,o;function l(...d){return t[19](t[32],t[35],t[37],...d)}return n=new Bn({props:{class:"a9s-corner-handle",x:t[29][0],y:t[29][1],scale:t[3],selected:t[8].some(l)}}),n.$on("pointerenter",t[11]),n.$on("pointerleave",t[12]),n.$on("pointerdown",t[14]),n.$on("pointerdown",function(){D(t[28](`HANDLE-${t[32]}-${t[35]}-${t[37]}`))&&t[28](`HANDLE-${t[32]}-${t[35]}-${t[37]}`).apply(this,arguments)}),n.$on("pointerup",t[15](t[32],t[35],t[37])),{c(){Yt(n.$$.fragment)},m(d,g){Jt(n,d,g),o=!0},p(d,g){t=d;const x={};g[0]&32&&(x.x=t[29][0]),g[0]&32&&(x.y=t[29][1]),g[0]&8&&(x.scale=t[3]),g[0]&256&&(x.selected=t[8].some(l)),n.$set(x)},i(d){o||(rt(n.$$.fragment,d),o=!0)},o(d){vt(n.$$.fragment,d),o=!1},d(d){Qt(n,d)}}}function Ar(t){let n,o,l=tn(t[33].points),d=[];for(let x=0;x<l.length;x+=1)d[x]=kr(Cr(t,l,x));const g=x=>vt(d[x],1,1,()=>{d[x]=null});return{c(){for(let x=0;x<d.length;x+=1)d[x].c();n=W()},m(x,C){for(let A=0;A<d.length;A+=1)d[A]&&d[A].m(x,C);K(x,n,C),o=!0},p(x,C){if(C[0]&268491048){l=tn(x[33].points);let A;for(A=0;A<l.length;A+=1){const L=Cr(x,l,A);d[A]?(d[A].p(L,C),rt(d[A],1)):(d[A]=kr(L),d[A].c(),rt(d[A],1),d[A].m(n.parentNode,n))}for(Lt(),A=l.length;A<d.length;A+=1)g(A);Nt()}},i(x){if(!o){for(let C=0;C<l.length;C+=1)rt(d[C]);o=!0}},o(x){d=d.filter(Boolean);for(let C=0;C<d.length;C+=1)vt(d[C]);o=!1},d(x){x&&M(n),J(d,x)}}}function Ir(t){let n,o,l,d,g,x,C,A,L,B,G,ee,be,he,ue,We,Se,He=t[6]!==void 0&&!t[7]&&Tr(Xi(t)),ge=t[6]!==void 0&&!t[7]&&Sr(Yi(t)),Ve=tn(t[30].rings),Ye=[];for(let Xe=0;Xe<Ve.length;Xe+=1)Ye[Xe]=Ar(xr(t,Ve,Xe));const tt=Xe=>vt(Ye[Xe],1,1,()=>{Ye[Xe]=null});return{c(){n=U("g"),o=U("defs"),l=U("mask"),d=U("rect"),L=U("path"),He&&He.c(),ge&&ge.c(),G=U("path"),be=U("path");for(let Xe=0;Xe<Ye.length;Xe+=1)Ye[Xe].c();y(d,"x",g=t[9].x),y(d,"y",x=t[9].y),y(d,"width",C=t[9].w),y(d,"height",A=t[9].h),y(d,"class","svelte-1vxo6dc"),y(L,"d",B=gn(t[30])),y(L,"class","svelte-1vxo6dc"),y(l,"id",`${t[18]}-${t[32]}-outer`),y(l,"class","a9s-multipolygon-editor-mask svelte-1vxo6dc"),y(G,"class","a9s-outer"),y(G,"mask",`url(#${t[18]}-${t[32]}-outer)`),y(G,"fill-rule","evenodd"),y(G,"d",ee=gn(t[30])),y(be,"class","a9s-inner"),y(be,"mask",`url(#${t[18]}-${t[32]}-inner)`),y(be,"style",t[1]),y(be,"fill-rule","evenodd"),y(be,"d",he=gn(t[30]))},m(Xe,ht){K(Xe,n,ht),ne(n,o),ne(o,l),ne(l,d),ne(l,L),He&&He.m(l,null),ge&&ge.m(o,null),ne(n,G),ne(n,be);for(let st=0;st<Ye.length;st+=1)Ye[st]&&Ye[st].m(n,null);ue=!0,We||(Se=[re(G,"pointerup",t[13]),re(G,"pointerdown",function(){D(t[28]("SHAPE"))&&t[28]("SHAPE").apply(this,arguments)}),re(be,"pointerup",t[13]),re(be,"pointerdown",function(){D(t[28]("SHAPE"))&&t[28]("SHAPE").apply(this,arguments)})],We=!0)},p(Xe,ht){if(t=Xe,(!ue||ht[0]&512&&g!==(g=t[9].x))&&y(d,"x",g),(!ue||ht[0]&512&&x!==(x=t[9].y))&&y(d,"y",x),(!ue||ht[0]&512&&C!==(C=t[9].w))&&y(d,"width",C),(!ue||ht[0]&512&&A!==(A=t[9].h))&&y(d,"height",A),(!ue||ht[0]&32&&B!==(B=gn(t[30])))&&y(L,"d",B),t[6]!==void 0&&!t[7]?He?He.p(Xi(t),ht):(He=Tr(Xi(t)),He.c(),He.m(l,null)):He&&(He.d(1),He=null),t[6]!==void 0&&!t[7]?ge?ge.p(Yi(t),ht):(ge=Sr(Yi(t)),ge.c(),ge.m(o,null)):ge&&(ge.d(1),ge=null),(!ue||ht[0]&32&&ee!==(ee=gn(t[30])))&&y(G,"d",ee),(!ue||ht[0]&2)&&y(be,"style",t[1]),(!ue||ht[0]&32&&he!==(he=gn(t[30])))&&y(be,"d",he),ht[0]&268491048){Ve=tn(t[30].rings);let st;for(st=0;st<Ve.length;st+=1){const Rt=xr(t,Ve,st);Ye[st]?(Ye[st].p(Rt,ht),rt(Ye[st],1)):(Ye[st]=Ar(Rt),Ye[st].c(),rt(Ye[st],1),Ye[st].m(n,null))}for(Lt(),st=Ve.length;st<Ye.length;st+=1)tt(st);Nt()}},i(Xe){if(!ue){for(let ht=0;ht<Ve.length;ht+=1)rt(Ye[ht]);ue=!0}},o(Xe){Ye=Ye.filter(Boolean);for(let ht=0;ht<Ye.length;ht+=1)vt(Ye[ht]);ue=!1},d(Xe){Xe&&M(n),He&&He.d(),ge&&ge.d(),J(Ye,Xe),We=!1,k(Se)}}}function Pr(t){let n,o;return n=new zi({props:{x:t[29][0],y:t[29][1],scale:t[3]}}),n.$on("pointerdown",function(){D(t[17](t[6]))&&t[17](t[6]).apply(this,arguments)}),{c(){Yt(n.$$.fragment)},m(l,d){Jt(n,l,d),o=!0},p(l,d){t=l;const g={};d[0]&1088&&(g.x=t[29][0]),d[0]&1088&&(g.y=t[29][1]),d[0]&8&&(g.scale=t[3]),n.$set(g)},i(l){o||(rt(n.$$.fragment,l),o=!0)},o(l){vt(n.$$.fragment,l),o=!1},d(l){Qt(n,l)}}}function jo(t){let n,o,l,d=tn(t[5].polygons),g=[];for(let A=0;A<d.length;A+=1)g[A]=Ir(Er(t,d,A));const x=A=>vt(g[A],1,1,()=>{g[A]=null});let C=t[6]!==void 0&&!t[7]&&Pr(Gi(t));return{c(){for(let A=0;A<g.length;A+=1)g[A].c();n=H(),C&&C.c(),o=W()},m(A,L){for(let B=0;B<g.length;B+=1)g[B]&&g[B].m(A,L);K(A,n,L),C&&C.m(A,L),K(A,o,L),l=!0},p(A,L){if(L[0]&268763114){d=tn(A[5].polygons);let B;for(B=0;B<d.length;B+=1){const G=Er(A,d,B);g[B]?(g[B].p(G,L),rt(g[B],1)):(g[B]=Ir(G),g[B].c(),rt(g[B],1),g[B].m(n.parentNode,n))}for(Lt(),B=d.length;B<g.length;B+=1)x(B);Nt()}A[6]!==void 0&&!A[7]?C?(C.p(Gi(A),L),L[0]&192&&rt(C,1)):(C=Pr(Gi(A)),C.c(),rt(C,1),C.m(o.parentNode,o)):C&&(Lt(),vt(C,1,1,()=>{C=null}),Nt())},i(A){if(!l){for(let L=0;L<d.length;L+=1)rt(g[L]);rt(C),l=!0}},o(A){g=g.filter(Boolean);for(let L=0;L<g.length;L+=1)vt(g[L]);vt(C),l=!1},d(A){A&&(M(n),M(o)),J(g,A),C&&C.d(A)}}}function Uo(t){let n,o;return n=new xi({props:{shape:t[0],transform:t[2],editor:t[16],svgEl:t[4],$$slots:{default:[jo,({grab:l})=>({28:l}),({grab:l})=>[l?268435456:0]]},$$scope:{ctx:t}}}),n.$on("change",t[20]),n.$on("grab",t[21]),n.$on("release",t[22]),{c(){Yt(n.$$.fragment)},m(l,d){Jt(n,l,d),o=!0},p(l,d){const g={};d[0]&1&&(g.shape=l[0]),d[0]&4&&(g.transform=l[2]),d[0]&16&&(g.svgEl=l[4]),d[0]&268437482|d[1]&128&&(g.$$scope={dirty:d,ctx:l}),n.$set(g)},i(l){o||(rt(n.$$.fragment,l),o=!0)},o(l){vt(n.$$.fragment,l),o=!1},d(l){Qt(n,l)}}}const Wo=250,Bo=1e3,oi=4.5;function Go(t,n,o){let l,d,g;const x=Re();let{shape:C}=n,{computedStyle:A}=n,{transform:L}=n,{viewportScale:B=1}=n,{svgEl:G}=n,ee,be=!1,he,ue=[];const We=()=>o(7,be=!0),Se=()=>o(7,be=!1),He=Te=>{if(ue.length>0||!d.some(St=>St.visible)){o(6,ee=void 0);return}const[Qe,Me]=L.elementToImage(Te.offsetX,Te.offsetY),nt=St=>Math.pow(St[0]-Qe,2)+Math.pow(St[1]-Me,2),Ct=ci(l).reduce((St,nn)=>nt(nn)<nt(St)?nn:St),Et=d.filter(St=>St.visible).reduce((St,nn)=>nt(nn.point)<nt(St.point)?nn:St),xt=Math.pow(Bo/B,2);nt(Ct)<xt||nt(Et.point)<xt?o(6,ee=d.indexOf(Et)):o(6,ee=void 0)},ge=()=>{document.activeElement!==G&&G.focus()},Ve=()=>{o(8,ue=[]),ge()},Ye=Te=>{o(7,be=!0),Te.preventDefault(),Te.stopPropagation(),he=performance.now()},tt=(Te,Qe,Me)=>nt=>{if(!he||wn||performance.now()-he>Wo)return;const Ct=xt=>xt.polygon===Te&&xt.ring===Qe&&xt.point===Me,Et=ue.some(Ct);nt.metaKey||nt.ctrlKey||nt.shiftKey?Et?o(8,ue=ue.filter(xt=>!Ct(xt))):o(8,ue=[...ue,{polygon:Te,ring:Qe,point:Me}]):Et&&ue.length>1?o(8,ue=[{polygon:Te,ring:Qe,point:Me}]):Et?o(8,ue=[]):o(8,ue=[{polygon:Te,ring:Qe,point:Me}]),ge()},Xe=(Te,Qe,Me)=>{ge();const nt=Te.geometry.polygons;let Ct;if(Qe==="SHAPE")Ct=nt.map(Et=>{const xt=Et.rings.map((nn,cn)=>({points:nn.points.map((en,_n)=>[en[0]+Me[0],en[1]+Me[1]])})),St=Vt(xt[0].points);return{rings:xt,bounds:St}});else{const[Et,xt,St,nn]=Qe.split("-").map(cn=>parseInt(cn));Ct=nt.map((cn,en)=>{if(en===xt){const _n=cn.rings.map((bt,sn)=>sn===St?{points:bt.points.map((Gt,ln)=>ln===nn?[Gt[0]+Me[0],Gt[1]+Me[1]]:Gt)}:bt),Pn=Vt(_n[0].points);return{rings:_n,bounds:Pn}}else return cn})}return{...Te,geometry:{polygons:Ct,bounds:Ln(Ct)}}},ht=Te=>async Qe=>{Qe.stopPropagation();const Me=d[Te],nt=l.polygons.map((Et,xt)=>{if(xt===Me.elementIdx){const St=Et.rings.map((cn,en)=>en===Me.ringIdx?{points:[...cn.points.slice(0,Me.pointIdx+1),Me.point,...cn.points.slice(Me.pointIdx+1)]}:cn),nn=Vt(St[0].points);return{rings:St,bounds:nn}}else return Et});x("change",{...C,geometry:{polygons:nt,bounds:Ln(nt)}}),await me();const Ct=[...document.querySelectorAll(".a9s-handle")][Te+1];if(Ct!=null&&Ct.firstChild){const Et=new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:Qe.clientX,clientY:Qe.clientY,pointerId:Qe.pointerId,pointerType:Qe.pointerType,isPrimary:Qe.isPrimary,buttons:Qe.buttons});Ct.firstChild.dispatchEvent(Et)}},st=()=>{const Te=l.polygons.map((Qe,Me)=>{if(ue.some(nt=>nt.polygon===Me)){const nt=Qe.rings.map((Et,xt)=>{const St=ue.filter(nn=>nn.polygon===Me&&nn.ring===xt);return St.length&&Et.points.length-St.length>=3?{points:Et.points.filter((nn,cn)=>!St.some(en=>en.point===cn))}:Et}),Ct=Vt(nt[0].points);return{rings:nt,bounds:Ct}}else return Qe});!Bi(l.polygons,Te)&&(x("change",{...C,geometry:{polygons:Te,bounds:Ln(Te)}}),o(8,ue=[]))};De(()=>{if(wn)return;const Te=Qe=>{(Qe.key==="Delete"||Qe.key==="Backspace")&&(Qe.preventDefault(),st())};return G.addEventListener("pointermove",He),G.addEventListener("keydown",Te),()=>{G.removeEventListener("pointermove",He),G.removeEventListener("keydown",Te)}});const Rt=`polygon-mask-${Math.random().toString(36).substring(2,12)}`,Tt=(Te,Qe,Me,{polygon:nt,ring:Ct,point:Et})=>nt===Te&&Ct===Qe&&Et===Me;function Ee(Te){je.call(this,t,Te)}function Oe(Te){je.call(this,t,Te)}function pe(Te){je.call(this,t,Te)}return t.$$set=Te=>{"shape"in Te&&o(0,C=Te.shape),"computedStyle"in Te&&o(1,A=Te.computedStyle),"transform"in Te&&o(2,L=Te.transform),"viewportScale"in Te&&o(3,B=Te.viewportScale),"svgEl"in Te&&o(4,G=Te.svgEl)},t.$$.update=()=>{t.$$.dirty[0]&1&&o(5,l=C.geometry),t.$$.dirty[0]&40&&o(10,d=wn?[]:zo(l,B)),t.$$.dirty[0]&40&&o(9,g=ii(l.bounds,oi/B))},[C,A,L,B,G,l,ee,be,ue,g,d,We,Se,Ve,Ye,tt,Xe,ht,Rt,Tt,Ee,Oe,pe]}class Yo extends se{constructor(n){super(),le(this,n,Go,Uo,V,{shape:0,computedStyle:1,transform:2,viewportScale:3,svgEl:4},null,[-1,-1])}}const Dr=new Map([[Ue.RECTANGLE,wr],[Ue.POLYGON,br],[Ue.MULTIPOLYGON,Yo]]),Or=t=>Dr.get(t.type),Nr=(t,n)=>Dr.set(t,n);function Xo(t,n,o){let l;const d=Re();let{annotation:g}=n,{editor:x}=n,{style:C}=n,{target:A}=n,{transform:L}=n,{viewportScale:B}=n,G;return De(()=>(o(6,G=new x({target:A,props:{shape:g.target.selector,computedStyle:l,transform:L,viewportScale:B,svgEl:A.closest("svg")}})),G.$on("change",ee=>{G.$$set({shape:ee.detail}),d("change",ee.detail)}),G.$on("grab",ee=>d("grab",ee.detail)),G.$on("release",ee=>d("release",ee.detail)),()=>{G.$destroy()})),t.$$set=ee=>{"annotation"in ee&&o(0,g=ee.annotation),"editor"in ee&&o(1,x=ee.editor),"style"in ee&&o(2,C=ee.style),"target"in ee&&o(3,A=ee.target),"transform"in ee&&o(4,L=ee.transform),"viewportScale"in ee&&o(5,B=ee.viewportScale)},t.$$.update=()=>{t.$$.dirty&5&&o(7,l=Wn(g,C)),t.$$.dirty&65&&g&&(G==null||G.$set({shape:g.target.selector})),t.$$.dirty&80&&G&&G.$set({transform:L}),t.$$.dirty&96&&G&&G.$set({viewportScale:B}),t.$$.dirty&192&&G&&l&&G.$set({computedStyle:l})},[g,x,C,A,L,B,G,l]}class Lr extends se{constructor(n){super(),le(this,n,Xo,null,V,{annotation:0,editor:1,style:2,target:3,transform:4,viewportScale:5})}}function qo(t,n,o){const l=Re();let{drawingMode:d}=n,{target:g}=n,{tool:x}=n,{transform:C}=n,{viewportScale:A}=n,L;return De(()=>{const B=g.closest("svg"),G=[],ee=(be,he,ue)=>{B==null||B.addEventListener(be,he,ue),G.push(()=>B==null?void 0:B.removeEventListener(be,he,ue))};return o(5,L=new x({target:g,props:{addEventListener:ee,drawingMode:d,transform:C,viewportScale:A}})),L.$on("create",be=>l("create",be.detail)),()=>{G.forEach(be=>be()),L.$destroy()}}),t.$$set=B=>{"drawingMode"in B&&o(0,d=B.drawingMode),"target"in B&&o(1,g=B.target),"tool"in B&&o(2,x=B.tool),"transform"in B&&o(3,C=B.transform),"viewportScale"in B&&o(4,A=B.viewportScale)},t.$$.update=()=>{t.$$.dirty&40&&L&&L.$set({transform:C}),t.$$.dirty&48&&L&&L.$set({viewportScale:A})},[d,g,x,C,A,L]}class Fr extends se{constructor(n){super(),le(this,n,qo,null,V,{drawingMode:0,target:1,tool:2,transform:3,viewportScale:4})}}function Hr(t){let n,o,l,d,g,x,C,A,L,B;return{c(){n=U("defs"),o=U("mask"),l=U("rect"),A=U("rect"),L=U("rect"),B=U("rect"),y(l,"class","rect-mask-bg svelte-1a76qe7"),y(l,"x",d=t[1]-t[5]),y(l,"y",g=t[2]-t[5]),y(l,"width",x=t[3]+2*t[5]),y(l,"height",C=t[4]+2*t[5]),y(A,"class","rect-mask-fg svelte-1a76qe7"),y(A,"x",t[1]),y(A,"y",t[2]),y(A,"width",t[3]),y(A,"height",t[4]),y(o,"id",t[6]),y(o,"class","a9s-rubberband-rectangle-mask svelte-1a76qe7"),y(L,"class","a9s-outer"),y(L,"mask",`url(#${t[6]})`),y(L,"x",t[1]),y(L,"y",t[2]),y(L,"width",t[3]),y(L,"height",t[4]),y(B,"class","a9s-inner"),y(B,"x",t[1]),y(B,"y",t[2]),y(B,"width",t[3]),y(B,"height",t[4])},m(G,ee){K(G,n,ee),ne(n,o),ne(o,l),ne(o,A),K(G,L,ee),K(G,B,ee)},p(G,ee){ee&34&&d!==(d=G[1]-G[5])&&y(l,"x",d),ee&36&&g!==(g=G[2]-G[5])&&y(l,"y",g),ee&40&&x!==(x=G[3]+2*G[5])&&y(l,"width",x),ee&48&&C!==(C=G[4]+2*G[5])&&y(l,"height",C),ee&2&&y(A,"x",G[1]),ee&4&&y(A,"y",G[2]),ee&8&&y(A,"width",G[3]),ee&16&&y(A,"height",G[4]),ee&2&&y(L,"x",G[1]),ee&4&&y(L,"y",G[2]),ee&8&&y(L,"width",G[3]),ee&16&&y(L,"height",G[4]),ee&2&&y(B,"x",G[1]),ee&4&&y(B,"y",G[2]),ee&8&&y(B,"width",G[3]),ee&16&&y(B,"height",G[4])},d(G){G&&(M(n),M(L),M(B))}}}function Mo(t){let n,o=t[0]&&Hr(t);return{c(){n=U("g"),o&&o.c(),y(n,"class","a9s-annotation a9s-rubberband")},m(l,d){K(l,n,d),o&&o.m(n,null)},p(l,[d]){l[0]?o?o.p(l,d):(o=Hr(l),o.c(),o.m(n,null)):o&&(o.d(1),o=null)},i:s,o:s,d(l){l&&M(n),o&&o.d()}}}function Qo(t,n,o){let l;const d=Re();let{addEventListener:g}=n,{drawingMode:x}=n,{transform:C}=n,{viewportScale:A=1}=n,L,B,G,ee,be,he,ue;const We=Ye=>{const tt=Ye;L=performance.now(),x==="drag"&&(o(0,B=C.elementToImage(tt.offsetX,tt.offsetY)),G=B,o(1,ee=B[0]),o(2,be=B[1]),o(3,he=1),o(4,ue=1))},Se=Ye=>{const tt=Ye;B&&(G=C.elementToImage(tt.offsetX,tt.offsetY),o(1,ee=Math.min(G[0],B[0])),o(2,be=Math.min(G[1],B[1])),o(3,he=Math.abs(G[0]-B[0])),o(4,ue=Math.abs(G[1]-B[1])))},He=Ye=>{const tt=Ye,Xe=performance.now()-L;if(x==="click"){if(Xe>300)return;B?ge():(o(0,B=C.elementToImage(tt.offsetX,tt.offsetY)),G=B,o(1,ee=B[0]),o(2,be=B[1]),o(3,he=1),o(4,ue=1))}else B&&(Xe>300||he*ue>100?(tt.stopPropagation(),ge()):(o(0,B=void 0),G=void 0))},ge=()=>{if(he*ue>15){const Ye={type:Ue.RECTANGLE,geometry:{bounds:{minX:ee,minY:be,maxX:ee+he,maxY:be+ue},x:ee,y:be,w:he,h:ue}};d("create",Ye)}o(0,B=void 0),G=void 0};De(()=>{g("pointerdown",We),g("pointermove",Se),g("pointerup",He,!0)});const Ve=`rect-mask-${Math.random().toString(36).substring(2,12)}`;return t.$$set=Ye=>{"addEventListener"in Ye&&o(7,g=Ye.addEventListener),"drawingMode"in Ye&&o(8,x=Ye.drawingMode),"transform"in Ye&&o(9,C=Ye.transform),"viewportScale"in Ye&&o(10,A=Ye.viewportScale)},t.$$.update=()=>{t.$$.dirty&1024&&o(5,l=2/A)},[B,ee,be,he,ue,l,Ve,g,x,C,A]}class Rr extends se{constructor(n){super(),le(this,n,Qo,Mo,V,{addEventListener:7,drawingMode:8,transform:9,viewportScale:10})}}function qi(t){const n=t.slice(),o=n[2].map(l=>l.join(",")).join(" ");return n[19]=o,n}function Vr(t){let n,o,l,d,g,x,C,A,L,B,G,ee,be,he,ue=t[1]&&zr(t);return{c(){n=U("defs"),o=U("mask"),l=U("rect"),A=U("polygon"),B=U("polygon"),ee=U("polygon"),ue&&ue.c(),he=W(),y(l,"x",d=t[3].x),y(l,"y",g=t[3].y),y(l,"width",x=t[3].w),y(l,"height",C=t[3].h),y(l,"class","svelte-18wrg3t"),y(A,"points",L=t[19]),y(A,"class","svelte-18wrg3t"),y(o,"id",t[5]),y(o,"class","a9s-rubberband-polygon-mask svelte-18wrg3t"),y(B,"class","a9s-outer"),y(B,"mask",`url(#${t[5]})`),y(B,"points",G=t[19]),y(ee,"class","a9s-inner"),y(ee,"points",be=t[19])},m(We,Se){K(We,n,Se),ne(n,o),ne(o,l),ne(o,A),K(We,B,Se),K(We,ee,Se),ue&&ue.m(We,Se),K(We,he,Se)},p(We,Se){Se&8&&d!==(d=We[3].x)&&y(l,"x",d),Se&8&&g!==(g=We[3].y)&&y(l,"y",g),Se&8&&x!==(x=We[3].w)&&y(l,"width",x),Se&8&&C!==(C=We[3].h)&&y(l,"height",C),Se&4&&L!==(L=We[19])&&y(A,"points",L),Se&4&&G!==(G=We[19])&&y(B,"points",G),Se&4&&be!==(be=We[19])&&y(ee,"points",be),We[1]?ue?ue.p(We,Se):(ue=zr(We),ue.c(),ue.m(he.parentNode,he)):ue&&(ue.d(1),ue=null)},d(We){We&&(M(n),M(B),M(ee),M(he)),ue&&ue.d(We)}}}function zr(t){let n,o,l;return{c(){n=U("circle"),y(n,"class","a9s-handle svelte-18wrg3t"),y(n,"cx",o=t[0][0][0]),y(n,"cy",l=t[0][0][1]),y(n,"r",t[4])},m(d,g){K(d,n,g)},p(d,g){g&1&&o!==(o=d[0][0][0])&&y(n,"cx",o),g&1&&l!==(l=d[0][0][1])&&y(n,"cy",l),g&16&&y(n,"r",d[4])},d(d){d&&M(n)}}}function Ko(t){let n,o=t[3]&&Vr(qi(t));return{c(){n=U("g"),o&&o.c(),y(n,"class","a9s-annotation a9s-rubberband")},m(l,d){K(l,n,d),o&&o.m(n,null)},p(l,[d]){l[3]?o?o.p(qi(l),d):(o=Vr(qi(l)),o.c(),o.m(n,null)):o&&(o.d(1),o=null)},i:s,o:s,d(l){l&&M(n),o&&o.d()}}}const Zo=20,Jo=1500;function $o(t,n,o){let l,d,g;const x=Re();let{addEventListener:C}=n,{drawingMode:A}=n,{transform:L}=n,{viewportScale:B=1}=n,G,ee=[],be,he,ue=!1;const We=tt=>{const Xe=tt,{timeStamp:ht,offsetX:st,offsetY:Rt}=Xe;if(G={timeStamp:ht,offsetX:st,offsetY:Rt},A==="drag"&&ee.length===0){const Tt=L.elementToImage(Xe.offsetX,Xe.offsetY);ee.push(Tt),o(10,be=Tt)}},Se=tt=>{const Xe=tt;if(he&&clearTimeout(he),ee.length>0){if(o(10,be=L.elementToImage(Xe.offsetX,Xe.offsetY)),ee.length>2){const ht=fn(be,ee[0])*B;o(1,ue=ht<Zo)}Xe.pointerType==="touch"&&(he=setTimeout(()=>{ge()},Jo))}},He=tt=>{const Xe=tt;if(he&&clearTimeout(he),A==="click"){const ht=Xe.timeStamp-G.timeStamp,st=fn([G.offsetX,G.offsetY],[Xe.offsetX,Xe.offsetY]);if(ht>300||st>15)return;if(ue)Ve();else if(ee.length===0){const Rt=L.elementToImage(Xe.offsetX,Xe.offsetY);ee.push(Rt),o(10,be=Rt)}else ee.push(be)}else{if(ee.length===1&&fn(ee[0],be)<=4){o(0,ee=[]),o(10,be=void 0);return}Xe.stopImmediatePropagation(),ue?Ve():ee.push(be)}},ge=()=>{if(!be)return;const tt=ee.slice(0,-1);if(tt.length<3)return;const Xe={type:Ue.POLYGON,geometry:{bounds:Vt(ee),points:tt}};Wt(Xe)>4&&(o(0,ee=[]),o(10,be=void 0),x("create",Xe))},Ve=()=>{const tt={type:Ue.POLYGON,geometry:{bounds:Vt(ee),points:[...ee]}};o(0,ee=[]),o(10,be=void 0),x("create",tt)};De(()=>{C("pointerdown",We,!0),C("pointermove",Se),C("pointerup",He,!0),C("dblclick",ge,!0)});const Ye=`polygon-mask-${Math.random().toString(36).substring(2,12)}`;return t.$$set=tt=>{"addEventListener"in tt&&o(6,C=tt.addEventListener),"drawingMode"in tt&&o(7,A=tt.drawingMode),"transform"in tt&&o(8,L=tt.transform),"viewportScale"in tt&&o(9,B=tt.viewportScale)},t.$$.update=()=>{t.$$.dirty&512&&o(4,l=4/B),t.$$.dirty&1027&&o(2,d=be?ue?ee:[...ee,be]:[]),t.$$.dirty&516&&o(3,g=d.length>0?ii(Vt(d),2/B):void 0)},[ee,ue,d,g,l,Ye,C,A,L,B,be]}class ea extends se{constructor(n){super(),le(this,n,$o,Ko,V,{addEventListener:6,drawingMode:7,transform:8,viewportScale:9})}}const Mi=new Map([["rectangle",{tool:Rr}],["polygon",{tool:ea}]]),Qi=()=>[...Mi.keys()],Ki=t=>Mi.get(t),jr=(t,n,o={})=>Mi.set(t,{tool:n,opts:o});function ta(t){let n,o,l,d,g;return{c(){n=U("g"),o=U("ellipse"),d=U("ellipse"),y(o,"class","a9s-outer"),y(o,"style",l=t[1]?"display:none;":void 0),y(o,"cx",t[2]),y(o,"cy",t[3]),y(o,"rx",t[4]),y(o,"ry",t[5]),y(d,"class","a9s-inner"),y(d,"style",t[1]),y(d,"cx",t[2]),y(d,"cy",t[3]),y(d,"rx",t[4]),y(d,"ry",t[5]),y(n,"class","a9s-annotation"),y(n,"data-id",g=t[0].id)},m(x,C){K(x,n,C),ne(n,o),ne(n,d)},p(x,[C]){C&2&&l!==(l=x[1]?"display:none;":void 0)&&y(o,"style",l),C&2&&y(d,"style",x[1]),C&1&&g!==(g=x[0].id)&&y(n,"data-id",g)},i:s,o:s,d(x){x&&M(n)}}}function na(t,n,o){let l,{annotation:d}=n,{geom:g}=n,{style:x}=n;const{cx:C,cy:A,rx:L,ry:B}=g;return t.$$set=G=>{"annotation"in G&&o(0,d=G.annotation),"geom"in G&&o(6,g=G.geom),"style"in G&&o(7,x=G.style)},t.$$.update=()=>{t.$$.dirty&129&&o(1,l=Wn(d,x))},[d,l,C,A,L,B,g,x]}class ia extends se{constructor(n){super(),le(this,n,na,ta,V,{annotation:0,geom:6,style:7})}}function ra(t){let n,o,l,d,g;return{c(){n=U("g"),o=U("line"),d=U("line"),y(o,"class","a9s-outer"),y(o,"style",l=t[1]?"display:none;":void 0),y(o,"x1",t[2]),y(o,"y1",t[3]),y(o,"x2",t[4]),y(o,"y2",t[5]),y(d,"class","a9s-inner"),y(d,"style",t[1]),y(d,"x1",t[2]),y(d,"y1",t[3]),y(d,"x2",t[4]),y(d,"y2",t[5]),y(n,"class","a9s-annotation"),y(n,"data-id",g=t[0].id)},m(x,C){K(x,n,C),ne(n,o),ne(n,d)},p(x,[C]){C&2&&l!==(l=x[1]?"display:none;":void 0)&&y(o,"style",l),C&2&&y(d,"style",x[1]),C&1&&g!==(g=x[0].id)&&y(n,"data-id",g)},i:s,o:s,d(x){x&&M(n)}}}function oa(t,n,o){let l,{annotation:d}=n,{geom:g}=n,{style:x}=n;const{points:C}=g,[[A,L],[B,G]]=C;return t.$$set=ee=>{"annotation"in ee&&o(0,d=ee.annotation),"geom"in ee&&o(6,g=ee.geom),"style"in ee&&o(7,x=ee.style)},t.$$.update=()=>{t.$$.dirty&129&&o(1,l=Wn(d,x))},[d,l,A,L,B,G,g,x]}class aa extends se{constructor(n){super(),le(this,n,oa,ra,V,{annotation:0,geom:6,style:7})}}function Ur(t,n,o){const l=t.slice();return l[5]=n[o],l}function Wr(t){let n,o,l;return{c(){n=U("path"),l=U("path"),y(n,"class","a9s-outer"),y(n,"style",o=t[1]?"display:none;":void 0),y(n,"fill-rule","evenodd"),y(n,"d",gn(t[5])),y(l,"class","a9s-inner"),y(l,"style",t[1]),y(l,"fill-rule","evenodd"),y(l,"d",gn(t[5]))},m(d,g){K(d,n,g),K(d,l,g)},p(d,g){g&2&&o!==(o=d[1]?"display:none;":void 0)&&y(n,"style",o),g&2&&y(l,"style",d[1])},d(d){d&&(M(n),M(l))}}}function sa(t){let n,o,l=tn(t[2]),d=[];for(let g=0;g<l.length;g+=1)d[g]=Wr(Ur(t,l,g));return{c(){n=U("g");for(let g=0;g<d.length;g+=1)d[g].c();y(n,"class","a9s-annotation"),y(n,"data-id",o=t[0].id)},m(g,x){K(g,n,x);for(let C=0;C<d.length;C+=1)d[C]&&d[C].m(n,null)},p(g,[x]){if(x&6){l=tn(g[2]);let C;for(C=0;C<l.length;C+=1){const A=Ur(g,l,C);d[C]?d[C].p(A,x):(d[C]=Wr(A),d[C].c(),d[C].m(n,null))}for(;C<d.length;C+=1)d[C].d(1);d.length=l.length}x&1&&o!==(o=g[0].id)&&y(n,"data-id",o)},i:s,o:s,d(g){g&&M(n),J(d,g)}}}function la(t,n,o){let l,{annotation:d}=n,{geom:g}=n,{style:x}=n;const{polygons:C}=g;return t.$$set=A=>{"annotation"in A&&o(0,d=A.annotation),"geom"in A&&o(3,g=A.geom),"style"in A&&o(4,x=A.style)},t.$$.update=()=>{t.$$.dirty&17&&o(1,l=Wn(d,x))},[d,l,C,g,x]}class ca extends se{constructor(n){super(),le(this,n,la,sa,V,{annotation:0,geom:3,style:4})}}function ua(t){let n,o,l,d,g;return{c(){n=U("g"),o=U("polygon"),d=U("polygon"),y(o,"class","a9s-outer"),y(o,"style",l=t[1]?"display:none;":void 0),y(o,"points",t[2].map(da).join(" ")),y(d,"class","a9s-inner"),y(d,"style",t[1]),y(d,"points",t[2].map(fa).join(" ")),y(n,"class","a9s-annotation"),y(n,"data-id",g=t[0].id)},m(x,C){K(x,n,C),ne(n,o),ne(n,d)},p(x,[C]){C&2&&l!==(l=x[1]?"display:none;":void 0)&&y(o,"style",l),C&2&&y(d,"style",x[1]),C&1&&g!==(g=x[0].id)&&y(n,"data-id",g)},i:s,o:s,d(x){x&&M(n)}}}const da=t=>t.join(","),fa=t=>t.join(",");function pa(t,n,o){let l,{annotation:d}=n,{geom:g}=n,{style:x}=n;const{points:C}=g;return t.$$set=A=>{"annotation"in A&&o(0,d=A.annotation),"geom"in A&&o(3,g=A.geom),"style"in A&&o(4,x=A.style)},t.$$.update=()=>{t.$$.dirty&17&&o(1,l=Wn(d,x))},[d,l,C,g,x]}class ha extends se{constructor(n){super(),le(this,n,pa,ua,V,{annotation:0,geom:3,style:4})}}function ga(t){let n,o,l,d,g,x,C;return{c(){n=U("g"),o=U("path"),g=U("path"),y(o,"class",l=te(`a9s-outer ${t[1]}`)+" svelte-1w0132l"),y(o,"style",d=t[3]?"display:none;":void 0),y(o,"d",t[2]),y(g,"class",x=te(`a9s-inner ${t[1]}`)+" svelte-1w0132l"),y(g,"style",t[3]),y(g,"d",t[2]),y(n,"class","a9s-annotation"),y(n,"data-id",C=t[0].id)},m(A,L){K(A,n,L),ne(n,o),ne(n,g)},p(A,[L]){L&2&&l!==(l=te(`a9s-outer ${A[1]}`)+" svelte-1w0132l")&&y(o,"class",l),L&8&&d!==(d=A[3]?"display:none;":void 0)&&y(o,"style",d),L&4&&y(o,"d",A[2]),L&2&&x!==(x=te(`a9s-inner ${A[1]}`)+" svelte-1w0132l")&&y(g,"class",x),L&8&&y(g,"style",A[3]),L&4&&y(g,"d",A[2]),L&1&&C!==(C=A[0].id)&&y(n,"data-id",C)},i:s,o:s,d(A){A&&M(n)}}}function ma(t,n,o){let l,d,g,{annotation:x}=n,{geom:C}=n,{style:A}=n;return t.$$set=L=>{"annotation"in L&&o(0,x=L.annotation),"geom"in L&&o(4,C=L.geom),"style"in L&&o(5,A=L.style)},t.$$.update=()=>{t.$$.dirty&33&&o(3,l=Wn(x,A)),t.$$.dirty&16&&o(2,d=Xn(C)),t.$$.dirty&16&&o(1,g=C.closed?"closed":"open")},[x,g,d,l,C,A]}class va extends se{constructor(n){super(),le(this,n,ma,ga,V,{annotation:0,geom:4,style:5})}}function ya(t){let n,o,l,d,g;return{c(){n=U("g"),o=U("rect"),d=U("rect"),y(o,"class","a9s-outer"),y(o,"style",l=t[5]?"display:none;":void 0),y(o,"x",t[4]),y(o,"y",t[3]),y(o,"width",t[2]),y(o,"height",t[1]),y(d,"class","a9s-inner"),y(d,"style",t[5]),y(d,"x",t[4]),y(d,"y",t[3]),y(d,"width",t[2]),y(d,"height",t[1]),y(n,"class","a9s-annotation"),y(n,"data-id",g=t[0].id)},m(x,C){K(x,n,C),ne(n,o),ne(n,d)},p(x,[C]){C&32&&l!==(l=x[5]?"display:none;":void 0)&&y(o,"style",l),C&16&&y(o,"x",x[4]),C&8&&y(o,"y",x[3]),C&4&&y(o,"width",x[2]),C&2&&y(o,"height",x[1]),C&32&&y(d,"style",x[5]),C&16&&y(d,"x",x[4]),C&8&&y(d,"y",x[3]),C&4&&y(d,"width",x[2]),C&2&&y(d,"height",x[1]),C&1&&g!==(g=x[0].id)&&y(n,"data-id",g)},i:s,o:s,d(x){x&&M(n)}}}function ba(t,n,o){let l,d,g,x,C,{annotation:A}=n,{geom:L}=n,{style:B}=n;return t.$$set=G=>{"annotation"in G&&o(0,A=G.annotation),"geom"in G&&o(6,L=G.geom),"style"in G&&o(7,B=G.style)},t.$$.update=()=>{t.$$.dirty&129&&o(5,l=Wn(A,B)),t.$$.dirty&64&&o(4,{x:d,y:g,w:x,h:C}=L,d,(o(3,g),o(6,L)),(o(2,x),o(6,L)),(o(1,C),o(6,L)))},[A,C,x,g,d,l,L,B]}class wa extends se{constructor(n){super(),le(this,n,ba,ya,V,{annotation:0,geom:6,style:7})}}const _a={elementToImage:(t,n)=>[t,n]},Br=t=>({elementToImage:(n,o)=>{const l=t.getBoundingClientRect(),d=t.createSVGPoint();d.x=n+l.x,d.y=o+l.y;const{x:g,y:x}=d.matrixTransform(t.getScreenCTM().inverse());return[g,x]}}),Ea=250,Gr=(t,n)=>{const o=Re();let l;return{onPointerDown:()=>l=performance.now(),onPointerUp:d=>{if(performance.now()-l<Ea){const{x:g,y:x}=Zi(d,t),C=wn?10:2,A=n.getAt(g,x,void 0,C);A?o("click",{originalEvent:d,annotation:A}):o("click",{originalEvent:d})}}}},Zi=(t,n)=>{const o=n.createSVGPoint(),l=n.getBoundingClientRect(),d=t.clientX-l.x,g=t.clientY-l.y,{left:x,top:C}=n.getBoundingClientRect();return o.x=d+x,o.y=g+C,o.matrixTransform(n.getScreenCTM().inverse())};function Yr(t,n,o){const l=t.slice();return l[39]=n[o],l}function Xr(t,n,o){const l=t.slice();return l[42]=n[o],l}function Ji(t){const n=t.slice(),o=n[42].target.selector;return n[45]=o,n}function qr(t){let n=t[42],o,l,d=Mr(t);return{c(){d.c(),o=W()},m(g,x){d.m(g,x),K(g,o,x),l=!0},p(g,x){x[0]&131072&&V(n,n=g[42])?(Lt(),vt(d,1,1,s),Nt(),d=Mr(g),d.c(),rt(d,1),d.m(o.parentNode,o)):d.p(g,x)},i(g){l||(rt(d),l=!0)},o(g){vt(d),l=!1},d(g){g&&M(o),d.d(g)}}}function xa(t){let n,o;return n=new aa({props:{annotation:t[42],geom:t[45].geometry,style:t[1]}}),{c(){Yt(n.$$.fragment)},m(l,d){Jt(n,l,d),o=!0},p(l,d){const g={};d[0]&131072&&(g.annotation=l[42]),d[0]&131072&&(g.geom=l[45].geometry),d[0]&2&&(g.style=l[1]),n.$set(g)},i(l){o||(rt(n.$$.fragment,l),o=!0)},o(l){vt(n.$$.fragment,l),o=!1},d(l){Qt(n,l)}}}function Ca(t){let n,o;return n=new va({props:{annotation:t[42],geom:t[45].geometry,style:t[1]}}),{c(){Yt(n.$$.fragment)},m(l,d){Jt(n,l,d),o=!0},p(l,d){const g={};d[0]&131072&&(g.annotation=l[42]),d[0]&131072&&(g.geom=l[45].geometry),d[0]&2&&(g.style=l[1]),n.$set(g)},i(l){o||(rt(n.$$.fragment,l),o=!0)},o(l){vt(n.$$.fragment,l),o=!1},d(l){Qt(n,l)}}}function Ta(t){let n,o;return n=new ca({props:{annotation:t[42],geom:t[45].geometry,style:t[1]}}),{c(){Yt(n.$$.fragment)},m(l,d){Jt(n,l,d),o=!0},p(l,d){const g={};d[0]&131072&&(g.annotation=l[42]),d[0]&131072&&(g.geom=l[45].geometry),d[0]&2&&(g.style=l[1]),n.$set(g)},i(l){o||(rt(n.$$.fragment,l),o=!0)},o(l){vt(n.$$.fragment,l),o=!1},d(l){Qt(n,l)}}}function Sa(t){let n,o;return n=new ha({props:{annotation:t[42],geom:t[45].geometry,style:t[1]}}),{c(){Yt(n.$$.fragment)},m(l,d){Jt(n,l,d),o=!0},p(l,d){const g={};d[0]&131072&&(g.annotation=l[42]),d[0]&131072&&(g.geom=l[45].geometry),d[0]&2&&(g.style=l[1]),n.$set(g)},i(l){o||(rt(n.$$.fragment,l),o=!0)},o(l){vt(n.$$.fragment,l),o=!1},d(l){Qt(n,l)}}}function ka(t){let n,o;return n=new wa({props:{annotation:t[42],geom:t[45].geometry,style:t[1]}}),{c(){Yt(n.$$.fragment)},m(l,d){Jt(n,l,d),o=!0},p(l,d){const g={};d[0]&131072&&(g.annotation=l[42]),d[0]&131072&&(g.geom=l[45].geometry),d[0]&2&&(g.style=l[1]),n.$set(g)},i(l){o||(rt(n.$$.fragment,l),o=!0)},o(l){vt(n.$$.fragment,l),o=!1},d(l){Qt(n,l)}}}function Aa(t){var n;let o,l;return o=new ia({props:{annotation:t[42],geom:(n=t[45])==null?void 0:n.geometry,style:t[1]}}),{c(){Yt(o.$$.fragment)},m(d,g){Jt(o,d,g),l=!0},p(d,g){var x;const C={};g[0]&131072&&(C.annotation=d[42]),g[0]&131072&&(C.geom=(x=d[45])==null?void 0:x.geometry),g[0]&2&&(C.style=d[1]),o.$set(C)},i(d){l||(rt(o.$$.fragment,d),l=!0)},o(d){vt(o.$$.fragment,d),l=!1},d(d){Qt(o,d)}}}function Mr(t){let n,o,l,d;const g=[Aa,ka,Sa,Ta,Ca,xa],x=[];function C(A,L){var B,G,ee,be,he,ue;return((B=A[45])==null?void 0:B.type)===Ue.ELLIPSE?0:((G=A[45])==null?void 0:G.type)===Ue.RECTANGLE?1:((ee=A[45])==null?void 0:ee.type)===Ue.POLYGON?2:((be=A[45])==null?void 0:be.type)===Ue.MULTIPOLYGON?3:((he=A[45])==null?void 0:he.type)===Ue.POLYLINE?4:((ue=A[45])==null?void 0:ue.type)===Ue.LINE?5:-1}return~(n=C(t))&&(o=x[n]=g[n](t)),{c(){o&&o.c(),l=W()},m(A,L){~n&&x[n].m(A,L),K(A,l,L),d=!0},p(A,L){let B=n;n=C(A),n===B?~n&&x[n].p(A,L):(o&&(Lt(),vt(x[B],1,1,()=>{x[B]=null}),Nt()),~n?(o=x[n],o?o.p(A,L):(o=x[n]=g[n](A),o.c()),rt(o,1),o.m(l.parentNode,l)):o=null)},i(A){d||(rt(o),d=!0)},o(A){vt(o),d=!1},d(A){A&&M(l),~n&&x[n].d(A)}}}function Qr(t){let n=Hn(t[42])&&!t[10](t[42]),o,l,d=n&&qr(Ji(t));return{c(){d&&d.c(),o=W()},m(g,x){d&&d.m(g,x),K(g,o,x),l=!0},p(g,x){x[0]&132096&&(n=Hn(g[42])&&!g[10](g[42])),n?d?(d.p(Ji(g),x),x[0]&132096&&rt(d,1)):(d=qr(Ji(g)),d.c(),rt(d,1),d.m(o.parentNode,o)):d&&(Lt(),vt(d,1,1,()=>{d=null}),Nt())},i(g){l||(rt(d),l=!0)},o(g){vt(d),l=!1},d(g){g&&M(o),d&&d.d(g)}}}function Kr(t){let n,o,l,d;const g=[Pa,Ia],x=[];function C(A,L){return A[6]?0:A[15]&&A[0]?1:-1}return~(n=C(t))&&(o=x[n]=g[n](t)),{c(){o&&o.c(),l=W()},m(A,L){~n&&x[n].m(A,L),K(A,l,L),d=!0},p(A,L){let B=n;n=C(A),n===B?~n&&x[n].p(A,L):(o&&(Lt(),vt(x[B],1,1,()=>{x[B]=null}),Nt()),~n?(o=x[n],o?o.p(A,L):(o=x[n]=g[n](A),o.c()),rt(o,1),o.m(l.parentNode,l)):o=null)},i(A){d||(rt(o),d=!0)},o(A){vt(o),d=!1},d(A){A&&M(l),~n&&x[n].d(A)}}}function Ia(t){let n=`${t[2]}-${t[7]}`,o,l,d=Zr(t);return{c(){d.c(),o=W()},m(g,x){d.m(g,x),K(g,o,x),l=!0},p(g,x){x[0]&132&&V(n,n=`${g[2]}-${g[7]}`)?(Lt(),vt(d,1,1,s),Nt(),d=Zr(g),d.c(),rt(d,1),d.m(o.parentNode,o)):d.p(g,x)},i(g){l||(rt(d),l=!0)},o(g){vt(d),l=!1},d(g){g&&M(o),d.d(g)}}}function Pa(t){let n,o,l=tn(t[6]),d=[];for(let x=0;x<l.length;x+=1)d[x]=$r(Yr(t,l,x));const g=x=>vt(d[x],1,1,()=>{d[x]=null});return{c(){for(let x=0;x<d.length;x+=1)d[x].c();n=W()},m(x,C){for(let A=0;A<d.length;A+=1)d[A]&&d[A].m(x,C);K(x,n,C),o=!0},p(x,C){if(C[0]&8659266){l=tn(x[6]);let A;for(A=0;A<l.length;A+=1){const L=Yr(x,l,A);d[A]?(d[A].p(L,C),rt(d[A],1)):(d[A]=$r(L),d[A].c(),rt(d[A],1),d[A].m(n.parentNode,n))}for(Lt(),A=l.length;A<d.length;A+=1)g(A);Nt()}},i(x){if(!o){for(let C=0;C<l.length;C+=1)rt(d[C]);o=!0}},o(x){d=d.filter(Boolean);for(let C=0;C<d.length;C+=1)vt(d[C]);o=!1},d(x){x&&M(n),J(d,x)}}}function Zr(t){let n,o;return n=new Fr({props:{target:t[8],tool:t[15],drawingMode:t[14],transform:t[13],viewportScale:t[18]}}),n.$on("create",t[22]),{c(){Yt(n.$$.fragment)},m(l,d){Jt(n,l,d),o=!0},p(l,d){const g={};d[0]&256&&(g.target=l[8]),d[0]&32768&&(g.tool=l[15]),d[0]&16384&&(g.drawingMode=l[14]),d[0]&8192&&(g.transform=l[13]),d[0]&262144&&(g.viewportScale=l[18]),n.$set(g)},i(l){o||(rt(n.$$.fragment,l),o=!0)},o(l){vt(n.$$.fragment,l),o=!1},d(l){Qt(n,l)}}}function Jr(t){let n,o;return n=new Lr({props:{target:t[8],editor:t[39].editor,annotation:t[39].annotation,style:t[1],transform:t[13],viewportScale:t[18]}}),n.$on("change",function(){D(t[23](t[39].annotation))&&t[23](t[39].annotation).apply(this,arguments)}),{c(){Yt(n.$$.fragment)},m(l,d){Jt(n,l,d),o=!0},p(l,d){t=l;const g={};d[0]&256&&(g.target=t[8]),d[0]&64&&(g.editor=t[39].editor),d[0]&64&&(g.annotation=t[39].annotation),d[0]&2&&(g.style=t[1]),d[0]&8192&&(g.transform=t[13]),d[0]&262144&&(g.viewportScale=t[18]),n.$set(g)},i(l){o||(rt(n.$$.fragment,l),o=!0)},o(l){vt(n.$$.fragment,l),o=!1},d(l){Qt(n,l)}}}function $r(t){let n=t[39].annotation.id,o,l,d=Jr(t);return{c(){d.c(),o=W()},m(g,x){d.m(g,x),K(g,o,x),l=!0},p(g,x){x[0]&64&&V(n,n=g[39].annotation.id)?(Lt(),vt(d,1,1,s),Nt(),d=Jr(g),d.c(),rt(d,1),d.m(o.parentNode,o)):d.p(g,x)},i(g){l||(rt(d),l=!0)},o(g){vt(d),l=!1},d(g){g&&M(o),d.d(g)}}}function Da(t){let n,o,l,d,g,x,C=tn(t[17].filter(t[34])),A=[];for(let G=0;G<C.length;G+=1)A[G]=Qr(Xr(t,C,G));const L=G=>vt(A[G],1,1,()=>{A[G]=null});let B=t[8]&&Kr(t);return{c(){n=U("svg"),o=U("g");for(let G=0;G<A.length;G+=1)A[G].c();l=U("g"),B&&B.c(),y(l,"class","drawing"),y(n,"role","application"),y(n,"tabindex",0),y(n,"class","a9s-annotationlayer"),ce(n,"drawing",t[15]),ce(n,"editing",t[5]),ce(n,"hidden",!t[3]),ce(n,"hover",t[16])},m(G,ee){K(G,n,ee),ne(n,o);for(let be=0;be<A.length;be+=1)A[be]&&A[be].m(o,null);ne(n,l),B&&B.m(l,null),t[35](l),t[36](n),d=!0,g||(x=[re(n,"pointerup",function(){D(t[11])&&t[11].apply(this,arguments)}),re(n,"pointerdown",function(){D(t[12])&&t[12].apply(this,arguments)}),re(n,"pointermove",t[24])],g=!0)},p(G,ee){if(t=G,ee[0]&132098){C=tn(t[17].filter(t[34]));let be;for(be=0;be<C.length;be+=1){const he=Xr(t,C,be);A[be]?(A[be].p(he,ee),rt(A[be],1)):(A[be]=Qr(he),A[be].c(),rt(A[be],1),A[be].m(o,null))}for(Lt(),be=C.length;be<A.length;be+=1)L(be);Nt()}t[8]?B?(B.p(t,ee),ee[0]&256&&rt(B,1)):(B=Kr(t),B.c(),rt(B,1),B.m(l,null)):B&&(Lt(),vt(B,1,1,()=>{B=null}),Nt()),(!d||ee[0]&32768)&&ce(n,"drawing",t[15]),(!d||ee[0]&32)&&ce(n,"editing",t[5]),(!d||ee[0]&8)&&ce(n,"hidden",!t[3]),(!d||ee[0]&65536)&&ce(n,"hover",t[16])},i(G){if(!d){for(let ee=0;ee<C.length;ee+=1)rt(A[ee]);rt(B),d=!0}},o(G){A=A.filter(Boolean);for(let ee=0;ee<A.length;ee+=1)vt(A[ee]);vt(B),d=!1},d(G){G&&M(n),J(A,G),B&&B.d(),t[35](null),t[36](null),g=!1,k(x)}}}function Oa(t,n,o){let l,d,g,x,C,A,L,B,G,ee,be,he,ue=s,We=()=>(ue(),ue=b(Te,bt=>o(18,he=bt)),Te);t.$$.on_destroy.push(()=>ue());let{drawingEnabled:Se}=n,{image:He}=n,{preferredDrawingMode:ge}=n,{state:Ve}=n,{style:Ye=void 0}=n,{toolName:tt=Qi()[0]}=n,{user:Xe}=n,{visible:ht=!0}=n,st=0;const Rt=()=>o(7,st+=1),Tt=()=>tt,Ee=()=>Se;let Oe,pe,Te;De(()=>We(o(9,Te=lr(He,pe))));const{hover:Qe,selection:Me,store:nt}=Ve;R(t,Qe,bt=>o(16,G=bt)),R(t,Me,bt=>o(33,ee=bt)),R(t,nt,bt=>o(17,be=bt));let Ct,Et;const xt=bt=>{Ct&&nt.unobserve(Ct);const sn=bt.filter(({editable:Gt})=>Gt).map(({id:Gt})=>Gt);sn.length>0?(o(5,Et=sn.map(Gt=>nt.getAnnotation(Gt)).filter(Gt=>Gt&&Hn(Gt))),Ct=Gt=>{const{updated:ln}=Gt.changes;o(5,Et=ln==null?void 0:ln.map(bn=>bn.newValue))},nt.observe(Ct,{annotations:sn})):o(5,Et=void 0)},St=bt=>{const sn=zn(),Gt={id:sn,bodies:[],target:{annotation:sn,selector:bt.detail,creator:Xe,created:new Date}};nt.addAnnotation(Gt),Me.setSelected(Gt.id)},nn=bt=>sn=>{var Gt;const{target:ln}=bt,bn=600*1e3,Gn=((Gt=ln.creator)==null?void 0:Gt.id)!==Xe.id||!ln.created||new Date().getTime()-ln.created.getTime()>bn;nt.updateTarget({...ln,selector:sn.detail,created:Gn?ln.created:new Date,updated:Gn?new Date:void 0,updatedBy:Gn?Xe:void 0})},cn=bt=>{const{x:sn,y:Gt}=Zi(bt,pe),ln=nt.getAt(sn,Gt,void 0,2);ln?G!==ln.id&&Qe.set(ln.id):Qe.set(void 0)},en=bt=>Hn(bt);function _n(bt){qe[bt?"unshift":"push"](()=>{Oe=bt,o(8,Oe)})}function Pn(bt){qe[bt?"unshift":"push"](()=>{pe=bt,o(4,pe)})}return t.$$set=bt=>{"drawingEnabled"in bt&&o(0,Se=bt.drawingEnabled),"image"in bt&&o(25,He=bt.image),"preferredDrawingMode"in bt&&o(26,ge=bt.preferredDrawingMode),"state"in bt&&o(27,Ve=bt.state),"style"in bt&&o(1,Ye=bt.style),"toolName"in bt&&o(2,tt=bt.toolName),"user"in bt&&o(28,Xe=bt.user),"visible"in bt&&o(3,ht=bt.visible)},t.$$.update=()=>{t.$$.dirty[0]&4&&o(15,{tool:l,opts:d}=Ki(tt)||{tool:void 0,opts:void 0},l,(o(32,d),o(2,tt))),t.$$.dirty[0]&67108864|t.$$.dirty[1]&2&&o(14,g=(d==null?void 0:d.drawingMode)||ge),t.$$.dirty[0]&16&&o(13,x=Br(pe)),t.$$.dirty[0]&16&&o(12,{onPointerDown:C,onPointerUp:A}=Gr(pe,nt),C,(o(11,A),o(4,pe))),t.$$.dirty[1]&4&&xt(ee.selected),t.$$.dirty[0]&32&&o(6,L=Et?Et.map(bt=>({annotation:bt,editor:Or(bt.target.selector)})).filter(bt=>bt.editor):void 0),t.$$.dirty[0]&64&&o(10,B=bt=>L&&L.some(sn=>sn.annotation.id===bt.id))},[Se,Ye,tt,ht,pe,Et,L,st,Oe,Te,B,A,C,x,g,l,G,be,he,Qe,Me,nt,St,nn,cn,He,ge,Ve,Xe,Rt,Tt,Ee,d,ee,en,_n,Pn]}class eo extends se{constructor(n){super(),le(this,n,Oa,Da,V,{drawingEnabled:0,image:25,preferredDrawingMode:26,state:27,style:1,toolName:2,user:28,visible:3,cancelDrawing:29,getDrawingTool:30,isDrawingEnabled:31},null,[-1,-1])}get cancelDrawing(){return this.$$.ctx[29]}get getDrawingTool(){return this.$$.ctx[30]}get isDrawingEnabled(){return this.$$.ctx[31]}}function to(t,n,o=0,l=t.length-1,d=Na){for(;l>o;){if(l-o>600){const A=l-o+1,L=n-o+1,B=Math.log(A),G=.5*Math.exp(2*B/3),ee=.5*Math.sqrt(B*G*(A-G)/A)*(L-A/2<0?-1:1),be=Math.max(o,Math.floor(n-L*G/A+ee)),he=Math.min(l,Math.floor(n+(A-L)*G/A+ee));to(t,n,be,he,d)}const g=t[n];let x=o,C=l;for(ai(t,o,n),d(t[l],g)>0&&ai(t,o,l);x<C;){for(ai(t,x,C),x++,C--;d(t[x],g)<0;)x++;for(;d(t[C],g)>0;)C--}d(t[o],g)===0?ai(t,o,C):(C++,ai(t,C,l)),C<=n&&(o=C+1),n<=C&&(l=C-1)}}function ai(t,n,o){const l=t[n];t[n]=t[o],t[o]=l}function Na(t,n){return t<n?-1:t>n?1:0}class La{constructor(n=9){this._maxEntries=Math.max(4,n),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(n){let o=this.data;const l=[];if(!Ti(n,o))return l;const d=this.toBBox,g=[];for(;o;){for(let x=0;x<o.children.length;x++){const C=o.children[x],A=o.leaf?d(C):C;Ti(n,A)&&(o.leaf?l.push(C):er(n,A)?this._all(C,l):g.push(C))}o=g.pop()}return l}collides(n){let o=this.data;if(!Ti(n,o))return!1;const l=[];for(;o;){for(let d=0;d<o.children.length;d++){const g=o.children[d],x=o.leaf?this.toBBox(g):g;if(Ti(n,x)){if(o.leaf||er(n,x))return!0;l.push(g)}}o=l.pop()}return!1}load(n){if(!(n&&n.length))return this;if(n.length<this._minEntries){for(let l=0;l<n.length;l++)this.insert(n[l]);return this}let o=this._build(n.slice(),0,n.length-1,0);if(!this.data.children.length)this.data=o;else if(this.data.height===o.height)this._splitRoot(this.data,o);else{if(this.data.height<o.height){const l=this.data;this.data=o,o=l}this._insert(o,this.data.height-o.height-1,!0)}return this}insert(n){return n&&this._insert(n,this.data.height-1),this}clear(){return this.data=Jn([]),this}remove(n,o){if(!n)return this;let l=this.data;const d=this.toBBox(n),g=[],x=[];let C,A,L;for(;l||g.length;){if(l||(l=g.pop(),A=g[g.length-1],C=x.pop(),L=!0),l.leaf){const B=Fa(n,l.children,o);if(B!==-1)return l.children.splice(B,1),g.push(l),this._condense(g),this}!L&&!l.leaf&&er(l,d)?(g.push(l),x.push(C),C=0,A=l,l=l.children[0]):A?(C++,l=A.children[C],L=!1):l=null}return this}toBBox(n){return n}compareMinX(n,o){return n.minX-o.minX}compareMinY(n,o){return n.minY-o.minY}toJSON(){return this.data}fromJSON(n){return this.data=n,this}_all(n,o){const l=[];for(;n;)n.leaf?o.push(...n.children):l.push(...n.children),n=l.pop();return o}_build(n,o,l,d){const g=l-o+1;let x=this._maxEntries,C;if(g<=x)return C=Jn(n.slice(o,l+1)),Zn(C,this.toBBox),C;d||(d=Math.ceil(Math.log(g)/Math.log(x)),x=Math.ceil(g/Math.pow(x,d-1))),C=Jn([]),C.leaf=!1,C.height=d;const A=Math.ceil(g/x),L=A*Math.ceil(Math.sqrt(x));no(n,o,l,L,this.compareMinX);for(let B=o;B<=l;B+=L){const G=Math.min(B+L-1,l);no(n,B,G,A,this.compareMinY);for(let ee=B;ee<=G;ee+=A){const be=Math.min(ee+A-1,G);C.children.push(this._build(n,ee,be,d-1))}}return Zn(C,this.toBBox),C}_chooseSubtree(n,o,l,d){for(;d.push(o),!(o.leaf||d.length-1===l);){let g=1/0,x=1/0,C;for(let A=0;A<o.children.length;A++){const L=o.children[A],B=$i(L),G=Va(n,L)-B;G<x?(x=G,g=B<g?B:g,C=L):G===x&&B<g&&(g=B,C=L)}o=C||o.children[0]}return o}_insert(n,o,l){const d=l?n:this.toBBox(n),g=[],x=this._chooseSubtree(d,this.data,o,g);for(x.children.push(n),li(x,d);o>=0&&g[o].children.length>this._maxEntries;)this._split(g,o),o--;this._adjustParentBBoxes(d,g,o)}_split(n,o){const l=n[o],d=l.children.length,g=this._minEntries;this._chooseSplitAxis(l,g,d);const x=this._chooseSplitIndex(l,g,d),C=Jn(l.children.splice(x,l.children.length-x));C.height=l.height,C.leaf=l.leaf,Zn(l,this.toBBox),Zn(C,this.toBBox),o?n[o-1].children.push(C):this._splitRoot(l,C)}_splitRoot(n,o){this.data=Jn([n,o]),this.data.height=n.height+1,this.data.leaf=!1,Zn(this.data,this.toBBox)}_chooseSplitIndex(n,o,l){let d,g=1/0,x=1/0;for(let C=o;C<=l-o;C++){const A=si(n,0,C,this.toBBox),L=si(n,C,l,this.toBBox),B=za(A,L),G=$i(A)+$i(L);B<g?(g=B,d=C,x=G<x?G:x):B===g&&G<x&&(x=G,d=C)}return d||l-o}_chooseSplitAxis(n,o,l){const d=n.leaf?this.compareMinX:Ha,g=n.leaf?this.compareMinY:Ra,x=this._allDistMargin(n,o,l,d),C=this._allDistMargin(n,o,l,g);x<C&&n.children.sort(d)}_allDistMargin(n,o,l,d){n.children.sort(d);const g=this.toBBox,x=si(n,0,o,g),C=si(n,l-o,l,g);let A=Ci(x)+Ci(C);for(let L=o;L<l-o;L++){const B=n.children[L];li(x,n.leaf?g(B):B),A+=Ci(x)}for(let L=l-o-1;L>=o;L--){const B=n.children[L];li(C,n.leaf?g(B):B),A+=Ci(C)}return A}_adjustParentBBoxes(n,o,l){for(let d=l;d>=0;d--)li(o[d],n)}_condense(n){for(let o=n.length-1,l;o>=0;o--)n[o].children.length===0?o>0?(l=n[o-1].children,l.splice(l.indexOf(n[o]),1)):this.clear():Zn(n[o],this.toBBox)}}function Fa(t,n,o){if(!o)return n.indexOf(t);for(let l=0;l<n.length;l++)if(o(t,n[l]))return l;return-1}function Zn(t,n){si(t,0,t.children.length,n,t)}function si(t,n,o,l,d){d||(d=Jn(null)),d.minX=1/0,d.minY=1/0,d.maxX=-1/0,d.maxY=-1/0;for(let g=n;g<o;g++){const x=t.children[g];li(d,t.leaf?l(x):x)}return d}function li(t,n){return t.minX=Math.min(t.minX,n.minX),t.minY=Math.min(t.minY,n.minY),t.maxX=Math.max(t.maxX,n.maxX),t.maxY=Math.max(t.maxY,n.maxY),t}function Ha(t,n){return t.minX-n.minX}function Ra(t,n){return t.minY-n.minY}function $i(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Ci(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Va(t,n){return(Math.max(n.maxX,t.maxX)-Math.min(n.minX,t.minX))*(Math.max(n.maxY,t.maxY)-Math.min(n.minY,t.minY))}function za(t,n){const o=Math.max(t.minX,n.minX),l=Math.max(t.minY,n.minY),d=Math.min(t.maxX,n.maxX),g=Math.min(t.maxY,n.maxY);return Math.max(0,d-o)*Math.max(0,g-l)}function er(t,n){return t.minX<=n.minX&&t.minY<=n.minY&&n.maxX<=t.maxX&&n.maxY<=t.maxY}function Ti(t,n){return n.minX<=t.maxX&&n.minY<=t.maxY&&n.maxX>=t.minX&&n.maxY>=t.minY}function Jn(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function no(t,n,o,l,d){const g=[n,o];for(;g.length;){if(o=g.pop(),n=g.pop(),o-n<=l)continue;const x=n+Math.ceil((o-n)/l/2)*l;to(t,x,n,o,d),g.push(n,x,x,o)}}const ja=()=>{const t=new La,n=new Map,o=()=>[...n.values()],l=()=>{t.clear(),n.clear()},d=x=>{if(!Rn(x))return;const{minX:C,minY:A,maxX:L,maxY:B}=x.selector.geometry.bounds,G={minX:C,minY:A,maxX:L,maxY:B,target:x};t.insert(G),n.set(x.annotation,G)},g=x=>{if(!Rn(x))return;const C=n.get(x.annotation);C&&t.remove(C),n.delete(x.annotation)};return{all:o,clear:l,getAt:(x,C,A=0)=>{const L=t.search({minX:x-A,minY:C-A,maxX:x+A,maxY:C+A}).map(B=>B.target).filter(B=>B.selector.type===Ue.RECTANGLE||Xt(B.selector,x,C,A));return L.length>0?(L.sort((B,G)=>Wt(B.selector)-Wt(G.selector)),L):[]},getIntersecting:(x,C,A,L)=>t.search({minX:x,minY:C,maxX:x+A,maxY:C+L}).map(B=>B.target),insert:d,remove:g,set:(x,C=!0)=>{C&&l();const A=x.reduce((L,B)=>{if(Rn(B)){const{minX:G,minY:ee,maxX:be,maxY:he}=B.selector.geometry.bounds;return[...L,{minX:G,minY:ee,maxX:be,maxY:he,target:B}]}else return L},[]);A.forEach(L=>n.set(L.target.annotation,L)),t.load(A)},size:()=>t.all().length,update:(x,C)=>{g(x),d(C)}}},io=t=>{const n=ze(),o=ja(),l=I(n,t.userSelectAction,t.adapter),d=u(n),g=ie();return n.observe(({changes:x})=>{o.set((x.created||[]).map(C=>C.target),!1),(x.deleted||[]).forEach(C=>o.remove(C.target)),(x.updated||[]).forEach(({oldValue:C,newValue:A})=>o.update(C.target,A.target))}),{store:{...n,getAt:(x,C,A,L)=>{const B=o.getAt(x,C,L);if(A)return B.map(G=>n.getAnnotation(G.annotation)).filter(Boolean).filter(A)[0];{const G=B[0];return G?n.getAnnotation(G.annotation):void 0}},getIntersecting:(x,C,A,L)=>o.getIntersecting(x,C,A,L).map(B=>n.getAnnotation(B.annotation)).filter(Boolean)},selection:l,hover:d,viewport:g}},ro=t=>{const n=io(t);return{...n,store:Je(n.store)}},oo=t=>{let n,o;if(t.nodeName==="CANVAS")n=t,o=n.getContext("2d",{willReadFrequently:!0});else{const d=t;n=document.createElement("canvas"),n.width=d.width,n.height=d.height,o=n.getContext("2d",{willReadFrequently:!0}),o.drawImage(d,0,0,d.width,d.height)}let l=0;for(let d=1;d<10;d++)for(let g=1;g<10;g++){const x=Math.round(g*n.width/10),C=Math.round(d*n.height/10),A=o.getImageData(x,C,1,1).data,L=(.299*A[0]+.587*A[1]+.114*A[2])/255;l+=L}return l/81},ao=t=>{const n=oo(t),o=n>.6?"dark":"light";return console.log(`[Annotorious] Image brightness: ${n.toFixed(1)}. Setting ${o} theme.`),o},tr=(t,n,o)=>n.setAttribute("data-theme",o==="auto"?ao(t):o),so=(t,n)=>({...t,drawingEnabled:t.drawingEnabled===void 0?n.drawingEnabled:t.drawingEnabled,drawingMode:t.drawingMode||n.drawingMode,userSelectAction:t.userSelectAction||n.userSelectAction,theme:t.theme||n.theme}),nr=typeof navigator>"u"?!1:navigator.userAgent.indexOf("Mac OS X")!==-1,lo=(t,n)=>{const o=n||document,l=x=>{const C=x;C.key==="z"&&C.ctrlKey?t.undo():C.key==="y"&&C.ctrlKey&&t.redo()},d=x=>{const C=x;C.key==="z"&&C.metaKey&&(C.shiftKey?t.redo():t.undo())},g=()=>{nr?o.removeEventListener("keydown",d):o.removeEventListener("keydown",l)};return nr?o.addEventListener("keydown",d):o.addEventListener("keydown",l),{destroy:g}},Ua=(t,n={})=>{if(!t)throw"Missing argument: image";const o=typeof t=="string"?document.getElementById(t):t,l=so(n,{drawingEnabled:!0,drawingMode:"drag",userSelectAction:v.EDIT,theme:"light"}),d=ro(l),{selection:g,store:x}=d,C=jt(x,l.initialHistory),A=Ie(d,C,l.adapter,l.autoSave),L=document.createElement("DIV");L.style.position="relative",L.style.display="inline-block",o.style.display="block",o.parentNode.insertBefore(L,o),L.appendChild(o);const B=lo(C);let G=Vi();tr(o,L,l.theme);const ee=new eo({target:L,props:{drawingEnabled:!!l.drawingEnabled,image:o,preferredDrawingMode:l.drawingMode,state:d,style:l.style,user:G}});ee.$on("click",Ee=>{const{originalEvent:Oe,annotation:pe}=Ee.detail;pe?g.userSelect(pe.id,Oe):g.isEmpty()||g.clear()});const be=Be(d,C,l.adapter),he=()=>ee.cancelDrawing(),ue=()=>{ee.$destroy(),L.parentNode.insertBefore(o,L),L.parentNode.removeChild(L),B.destroy(),C.destroy()},We=()=>ee.getDrawingTool(),Se=()=>G,He=()=>ee.isDrawingEnabled(),ge=(Ee,Oe,pe)=>jr(Ee,Oe,pe),Ve=(Ee,Oe)=>Nr(Ee,Oe),Ye=Ee=>{if(!Ki(Ee))throw`No drawing tool named ${Ee}`;ee.$set({toolName:Ee})},tt=Ee=>ee.$set({drawingEnabled:Ee}),Xe=Ee=>{console.warn("Filter not implemented yet")},ht=Ee=>ee.$set({style:Ee}),st=Ee=>tr(o,L,Ee),Rt=Ee=>{G=Ee,ee.$set({user:Ee})},Tt=Ee=>ee.$set({visible:Ee});return{...be,cancelDrawing:he,destroy:ue,getDrawingTool:We,getUser:Se,isDrawingEnabled:He,listDrawingTools:Qi,on:A.on,off:A.off,registerDrawingTool:ge,registerShapeEditor:Ve,setDrawingEnabled:tt,setDrawingTool:Ye,setFilter:Xe,setStyle:ht,setTheme:st,setUser:Rt,setVisible:Tt,element:L,state:d}};e.Editor=xi,e.EditorMount=Lr,e.Handle=Bn,e.IdentityTransform=_a,e.MidpointHandle=zi,e.PolygonEditor=br,e.RectangleEditor=wr,e.RectangleUtil=di,e.RubberbandRectangle=Rr,e.SVGAnnotationLayer=eo,e.ShapeType=Ue,e.ToolMount=Fr,e.UserSelectAction=v,e.W3CImageFormat=go,e.addEventListeners=Gr,e.approximateAsPolygon=Fn,e.boundsFromMultiPolygonElements=Ln,e.boundsFromPoints=Vt,e.chainStyles=Pt,e.computeArea=Wt,e.computePolygonArea=un,e.computeSVGPath=Xn,e.computeStyle=it,e.createBody=at,e.createImageAnnotator=Ua,e.createImageAnnotatorState=io,e.createSVGTransform=Br,e.createSvelteImageAnnotatorState=ro,e.defaultColorProvider=ho,e.detectTheme=ao,e.distance=fn,e.enableResponsive=lr,e.fillDefaults=so,e.getAllCorners=ci,e.getEditor=Or,e.getMaskDimensions=ii,e.getSVGPoint=Zi,e.getTool=Ki,e.initKeyboardCommands=lo,e.intersects=Xt,e.isImageAnnotation=Hn,e.isImageAnnotationTarget=Rn,e.isMac=nr,e.isPointInPolygon=dn,e.isTouch=wn,e.listDrawingTools=Qi,e.multipolygonElementToPath=gn,e.parseFragmentSelector=fi,e.parseSVGSelector=bi,e.parseW3CImageAnnotation=ar,e.pointsToPath=hn,e.registerEditor=Nr,e.registerShapeUtil=It,e.registerTool=jr,e.sampleBrightness=oo,e.serializeFragmentSelector=pi,e.serializeSVGSelector=Qn,e.serializeW3CImageAnnotation=sr,e.setTheme=tr,e.simplifyMultiPolygon=Di,e.simplifyPoints=on,e.simplifyPolygon=En,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});var SceneMaker=SceneMaker||{};SceneMaker.Locales={en:{"i.ActionEvent":"Triggering event:","i.ActionEventPuzzleSolved":"Puzzle solved","i.ActionEventSlideRevealed":"Screen or view accessed","i.ActionEventSlideRevealedFirstTime":"Screen or view accessed for the first time","i.ActionParamsDelay":"Delay (seconds):","i.ActionParamsPuzzle":"Puzzle:","i.ActionParamsPuzzleSolution":"Puzzle solution:","i.ActionParamsScreen":"Screen:","i.ActionParamsScreenReplacement":"Replace with:","i.ActionParamsSlide":"Screen or view:","i.ActionParamsText":"Text:","i.ActionParamsURL":"URL:","i.ActionParamsView":"View","i.ActionType":"Action:","i.ActionTypeChangeBackground":"Change background of screen or view","i.ActionTypeChangeScreen":"Change screen","i.ActionTypeDisableHotzone":"Disable zone","i.ActionTypeEnableHotzone":"Enable zone","i.ActionTypeGoToScreen":"Go to screen","i.ActionTypeHideHotspot":"Hide hotspot","i.ActionTypeOpenLink":"Open link","i.ActionTypeOpenView":"Open view","i.ActionTypePlaySound":"Play sound","i.ActionTypeShowHotspot":"Show hotspot","i.ActionTypeShowText":"Show text","i.ActionTypeSolvePuzzle":"Solve escape room puzzle","i.ActionTypeStopSound":"Stop sound","i.ActionWarningChangeBackground":"If the new background image has different dimensions from the original, the position of the zones will vary.","i.AddCaption":"Caption","i.AddContent":"Add Content","i.AddHotspot":"Add hotspot","i.AddImageURL":"Add image URL","i.AddMultimediaURL":"Add video or audio URL (HTML5 or YouTube)","i.AddScreen":"Add Screen","i.AddView":"Add View","i.AddWebURL":"Add web URL","i.AddZone":"Add zone","i.AreYouSure":"Are you sure?","i.AreYouSureContent":"Are you sure you want to delete this content?","i.AreYouSureDeleteHotspot":"Are you sure you want to delete this hotspot?","i.AreYouSureDeleteHotzone":"Are you sure you want to delete this zone?","i.AreYouSureDeleteScreen":"Are you sure you want to delete this screen?","i.AreYouSureDeleteView":"Are you sure you want to delete this view?","i.AspectRatio":"Aspect ratio","i.Background":"Background","i.cancel":"cancel","i.Continue":"Continue","i.CursorVisibility":"Cursor on hover:","i.CursorVisibilityDefault":"No change","i.CursorVisibilityPointer":"Pointer","i.Delete":"Delete","i.delete":"delete","i.Description":"Description","i.Done":"Done","i.Enabled":"Enabled:","i.Exit":"Exit","i.ExitConfirmation":"You are about to leave Scene Maker. Any changes not saved will be lost.","i.ExitConfirmationMenu":"The scene has been modified. Closing without saving will discard your changes. What would you like to do?","i.exitWSaving":"exit without saving","i.Export":"Export","i.HotspotActions":"Actions to perform when the hotspot is clicked","i.HotspotID":"Hotspot ID:","i.HotzoneActions":"Actions to perform when the zone is clicked","i.HotzoneID":"Zone ID:","i.Image":"Image","i.ImageSource":"Source:","i.ImageSourceGallery":"Gallery","i.ImageSourceURL":"URL","i.ImageURL":"URL:","i.Import":"Import","i.ImportText":"You can import a scene from a JSON file. If you do so, the current scene will be replaced by the imported one.","i.LockAspectRatio":"Maintain aspect ratio:","i.Multimedia":"Video & audio","i.NewAction":"Add action","i.no":"no","i.No":"No","i.NoSlidesOnSaveNotification":"Create at least one screen before saving.","i.Object":"Object","i.Ok":"Ok","i.OSettingsPreview":"Include preview param in the URL.","i.OSettingsUnload":"Unload the web page when hiding the view.","i.Position":"Position","i.PositionX":"X (px):","i.PositionY":"Y (px):","i.Preview":"Preview","i.Properties":"Properties","i.PuzzleOption":"Puzzle #{number}","i.Rotation":"Rotation angle (\xB0):","i.Save":"Save","i.saveAndExit":"save and exit","i.Saved":"Saved","i.Saving":"Saving","i.SceneActions":"Actions","i.SceneCaption":"Scene caption","i.SceneCaptionText":"Text","i.SceneCaptionMode":"Display mode:","i.SceneCaptionModeClosable":"Can be closed","i.SceneCaptionModeFixed":"Always visible","i.SceneCaptionModeMinimizable":"Can be minimized","i.Screen":"Screen","i.ScreenOption":"Screen #{number}","i.Settings":"Settings","i.Size":"Size","i.SizeHeight":"Height (px):","i.SizeWidth":"Width (px):","i.Text":"Text","i.Title":"Scene title","i.Unspecified":"Unspecified","i.Untitled":"Untitled","i.Url":"Url","i.url":"url","i.Video":"Video","i.View":"View","i.ViewOption":"View #{viewNumber} - Screen #{screenNumber}","i.Views":"Views","i.ViewsType":"Choose view type","i.ViewsTypeImage":"Image","i.ViewsTypeOther":"Other content","i.Visibility":"Visibility:","i.VisibilityHidden":"Hidden","i.VisibilityVisible":"Visible","i.WrongImportedFile":"The file must be a JSON file.","i.WrongResource":"This resource is corrupted or incompatible with the current version of Scene Maker and cannot be loaded.","i.yes":"yes","i.Yes":"Yes","i.ZoneTooltip":"Click here to add content"},es:{"i.ActionEvent":"Evento desencadenante:","i.ActionEventPuzzleSolved":"Reto resuelto","i.ActionEventSlideRevealed":"Pantalla o vista accedida","i.ActionEventSlideRevealedFirstTime":"Pantalla o vista accedida por primera vez","i.ActionParamsDelay":"Retraso (segundos):","i.ActionParamsPuzzle":"Reto:","i.ActionParamsPuzzleSolution":"Soluci\xF3n del reto:","i.ActionParamsScreen":"Pantalla:","i.ActionParamsScreenReplacement":"Reemplazar con:","i.ActionParamsSlide":"Pantalla o vista:","i.ActionParamsText":"Texto:","i.ActionParamsURL":"URL:","i.ActionParamsView":"Vista","i.ActionType":"Acci\xF3n:","i.ActionTypeChangeBackground":"Cambiar fondo de una pantalla o vista","i.ActionTypeChangeScreen":"Cambiar pantalla","i.ActionTypeDisableHotzone":"Deshabilitar zona","i.ActionTypeEnableHotzone":"Habilitar zona","i.ActionTypeGoToScreen":"Ir a la pantalla","i.ActionTypeHideHotspot":"Ocultar hotspot","i.ActionTypeOpenLink":"Abrir enlace","i.ActionTypeOpenView":"Abrir vista","i.ActionTypePlaySound":"Reproducir sonido","i.ActionTypeShowHotspot":"Mostrar hotspot","i.ActionTypeShowText":"Mostrar texto","i.ActionTypeSolvePuzzle":"Resolver reto de la escape room","i.ActionTypeStopSound":"Detener sonido","i.ActionWarningChangeBackground":"Si la nueva imagen de fondo tiene dimensiones diferentes a la original, la posici\xF3n de las zonas variar\xE1.","i.AddCaption":"R\xF3tulo","i.AddContent":"A\xF1adir contenido","i.AddHotspot":"A\xF1adir hotspot","i.AddImageURL":"A\xF1adir URL de una imagen","i.AddMultimediaURL":"A\xF1adir URL de video o audio (HTML5 o YouTube)","i.AddScreen":"A\xF1adir pantalla","i.AddView":"A\xF1adir vista","i.AddWebURL":"A\xF1adir URL de una web","i.AddZone":"A\xF1adir zona","i.AreYouSure":"\xBFEst\xE1 seguro?","i.AreYouSureContent":"\xBFEst\xE1 seguro de que desea eliminar este contenido?","i.AreYouSureDeleteHotspot":"\xBFEst\xE1 seguro de que desea eliminar este hotspot?","i.AreYouSureDeleteHotzone":"\xBFEst\xE1 seguro de que desea eliminar esta zona?","i.AreYouSureDeleteScreen":"\xBFEst\xE1 seguro de que desea eliminar esta pantalla?","i.AreYouSureDeleteView":"\xBFEst\xE1 seguro de que desea eliminar esta vista?","i.AspectRatio":"Relaci\xF3n de aspecto","i.Background":"Fondo","i.cancel":"cancelar","i.Continue":"Continuar","i.CursorVisibility":"Cursor al pasar el rat\xF3n:","i.CursorVisibilityDefault":"No cambiar","i.CursorVisibilityPointer":"Puntero","i.Delete":"Borrar","i.delete":"borrar","i.Description":"Descripci\xF3n","i.Done":"Hecho","i.Enabled":"Habilitado:","i.Exit":"Salir","i.ExitConfirmation":"Est\xE1 a punto de salir de Scene Maker. Los cambios no guardados se perder\xE1n.","i.ExitConfirmationMenu":"El escenario ha sido modificado. Si cierra sin guardar, se perder\xE1n los cambios. \xBFQu\xE9 desea hacer?","i.exitWSaving":"salir sin guardar","i.Export":"Exportar","i.HotspotActions":"Acciones al hacer clic en el hotspot","i.HotspotID":"ID del hotspot:","i.HotzoneActions":"Acciones al hacer clic en la zona","i.HotzoneID":"ID de la zona:","i.Image":"Imagen","i.ImageSource":"Fuente:","i.ImageSourceGallery":"Galer\xEDa","i.ImageSourceURL":"URL","i.ImageURL":"URL:","i.Import":"Importar","i.ImportText":"Puedes importar un escenario de un archivo JSON. Si lo haces, el escenario actual ser\xE1 reemplazado por el importado.","i.LockAspectRatio":"Mantener relaci\xF3n de aspecto:","i.Multimedia":"V\xEDdeo & audio","i.NewAction":"A\xF1adir acci\xF3n","i.no":"no","i.No":"No","i.NoSlidesOnSaveNotification":"Cree al menos una pantalla antes de guardar.","i.Object":"Objeto","i.Ok":"Aceptar","i.OSettingsPreview":"Incluir par\xE1metro de previsualizaci\xF3n en la URL.","i.OSettingsUnload":"Cerrar la p\xE1gina web al ocultar la vista.","i.Position":"Posici\xF3n","i.PositionX":"X (px):","i.PositionY":"Y (px):","i.Preview":"Vista previa","i.Properties":"Propiedades","i.PuzzleOption":"Reto #{number}","i.Rotation":"\xC1ngulo de rotaci\xF3n (\xB0):","i.Save":"Guardar","i.saveAndExit":"guardar y salir","i.Saved":"Guardado","i.Saving":"Guardando","i.SceneActions":"Acciones","i.SceneCaption":"R\xF3tulo del escenario","i.SceneCaptionText":"Texto","i.SceneCaptionMode":"Modo de visualizaci\xF3n:","i.SceneCaptionModeClosable":"Se puede cerrar","i.SceneCaptionModeFixed":"Siempre visible","i.SceneCaptionModeMinimizable":"Se puede minimizar","i.Screen":"Pantalla","i.ScreenOption":"Pantalla #{number}","i.Settings":"Configuraci\xF3n","i.Size":"Tama\xF1o","i.SizeHeight":"Alto (px):","i.SizeWidth":"Ancho (px):","i.Text":"Texto","i.Title":"T\xEDtulo del escenario","i.Unspecified":"No especificado","i.Untitled":"Sin t\xEDtulo","i.Url":"Url","i.url":"url","i.Video":"Video","i.View":"Vista","i.ViewOption":"Vista #{viewNumber} - Pantalla #{screenNumber}","i.Views":"Vistas","i.ViewsType":"Elige tipo de vista","i.ViewsTypeImage":"Imagen","i.ViewsTypeOther":"Otro contenido","i.Visibility":"Visibilidad:","i.VisibilityHidden":"Oculto","i.VisibilityVisible":"Visible","i.WrongImportedFile":"El archivo debe ser un archivo JSON.","i.WrongResource":"Este recurso est\xE1 da\xF1ado o es incompatible con la versi\xF3n actual de Scene Maker y no se puede cargar.","i.yes":"s\xED","i.Yes":"S\xED","i.ZoneTooltip":"Haz clic aqu\xED para a\xF1adir contenido"},sr:{"i.ActionEvent":"Triger Doga\u0111aj:","i.ActionEventPuzzleSolved":"Zagonetka re\u0161ena","i.ActionEventSlideRevealed":"Pristupljeno je ekranu ili prikazu","i.ActionEventSlideRevealedFirstTime":"Prvi put je pristupljeno ekranu ili prikazu","i.ActionParamsDelay":"Ka\u0161njenje (sekunde):","i.ActionParamsPuzzle":"Zagonetka:","i.ActionParamsPuzzleSolution":"Re\u0161enje zagonetke:","i.ActionParamsScreen":"Ekran:","i.ActionParamsScreenReplacement":"Zameni sa:","i.ActionParamsSlide":"Ekran ili prikaz:","i.ActionParamsText":"Tekst:","i.ActionParamsURL":"URL:","i.ActionParamsView":"Prikaz","i.ActionType":"Akcija:","i.ActionTypeChangeBackground":"Promeni pozadinu ekrana ili prikaza","i.ActionTypeChangeScreen":"Promeni ekran","i.ActionTypeDisableHotzone":"Onemoguc\u0301i zonu","i.ActionTypeEnableHotzone":"Omoguc\u0301i zonu","i.ActionTypeGoToScreen":"Idi na ekran","i.ActionTypeHideHotspot":"Sakrij hotspot","i.ActionTypeOpenLink":"Otvori link","i.ActionTypeOpenView":"Otvori prikaz","i.ActionTypePlaySound":"Reprodukuj zvuk","i.ActionTypeShowHotspot":"Prika\u017Ei hotspot","i.ActionTypeShowText":"Prika\u017Ei tekst","i.ActionTypeSolvePuzzle":"Re\u0161i zagonetku escape sobe","i.ActionTypeStopSound":"Zaustavi zvuk","i.ActionWarningChangeBackground":"Ako nova pozadinska slika ima druga\u010Dije dimenzije od originalne, polo\u017Eaj zona c\u0301e varirati.","i.AddCaption":"Natpis","i.AddContent":"Dodaj sadr\u017Eaj","i.AddHotspot":"Dodaj hotspot","i.AddImageURL":"Dodaj URL slike","i.AddMultimediaURL":"Dodaj URL videa ili audio zapisa (HTML5 ili YouTube)","i.AddScreen":"Dodaj ekran","i.AddView":"Dodaj prikaz","i.AddWebURL":"Dodaj veb URL","i.AddZone":"Dodaj zonu","i.AreYouSure":"Da li ste sigurni?","i.AreYouSureContent":"Da li ste sigurni da \u017Eelite da obri\u0161ete ovaj sadr\u017Eaj?","i.AreYouSureDeleteHotspot":"Da li ste sigurni da \u017Eelite da obri\u0161ete ovaj hotspot?","i.AreYouSureDeleteHotzone":"Da li ste sigurni da \u017Eelite da obri\u0161ete ovu zonu?","i.AreYouSureDeleteScreen":"Da li ste sigurni da \u017Eelite da obri\u0161ete ovaj ekran?","i.AreYouSureDeleteView":"Da li ste sigurni da \u017Eelite da obri\u0161ete ovaj prikaz?","i.AspectRatio":"Odnos \u0161irine i visine (aspect ratio)","i.Background":"Pozadina","i.cancel":"otka\u017Ei","i.Continue":"Nastavi","i.CursorVisibility":"Kursor pri zadr\u017Eavanju mi\u0161em (on hover):","i.CursorVisibilityDefault":"Bez promena","i.CursorVisibilityPointer":"Pokaziva\u010D","i.Delete":"Obri\u0161i","i.delete":"Obri\u0161i","i.Description":"Opis","i.Done":"Gotovo","i.Enabled":"Omoguc\u0301eno:","i.Exit":"Izlaz","i.ExitConfirmation":"Upravo c\u0301ete napustiti Scene Maker. Sve izmene koje nisu sa\u010Duvane bic\u0301e izgubljene.","i.ExitConfirmationMenu":"Scena je izmenjena. Zatvaranje bez \u010Duvanja c\u0301e odbaciti va\u0161e izmene. \u0160ta \u017Eelite da uradite?","i.exitWSaving":"izlaz bez \u010Duvanja","i.Export":"Izvezi","i.HotspotActions":"Radnje koje se izvr\u0161avaju kada se klikne na hotspot","i.HotspotID":"ID hotspota:","i.HotzoneActions":"Radnje koje se izvr\u0161avaju kada se klikne na zonu","i.HotzoneID":"ID zone:","i.Image":"Slika","i.ImageSource":"Izvor:","i.ImageSourceGallery":"Galerija","i.ImageSourceURL":"URL","i.ImageURL":"URL:","i.Import":"Uvezi","i.ImportText":"Mo\u017Eete uvesti scenario iz JSON datoteke. Ako to u\u010Dinite, trenutni scenario \u0107e biti zamenjen uvezenim.","i.LockAspectRatio":"Odr\u017Eavaj odnos \u0161irine i visine (aspect ratio):","i.Multimedia":"Video i audio","i.NewAction":"Dodaj akciju","i.no":"ne","i.No":"Ne","i.NoSlidesOnSaveNotification":"Napravi barem jedan ekran pre \u010Duvanja.","i.Object":"Objekat","i.Ok":"U redu","i.OSettingsPreview":"Uklju\u010Di parametar pregleda u URL.","i.OSettingsUnload":"Isprazni veb stranicu prilikom skrivanja prikaza.","i.Position":"Polo\u017Eaj","i.PositionX":"X (px):","i.PositionY":"Y (px):","i.Preview":"Pregled","i.Properties":"Svojstva","i.PuzzleOption":"Slagalica #{number}","i.Rotation":"Ugao rotacije (\xB0):","i.Save":"Sa\u010Duvaj","i.saveAndExit":"sa\u010Duvaj i iza\u0111i","i.Saved":"Sa\u010Duvano","i.Saving":"\u010Cuva se","i.SceneActions":"Radnje","i.SceneCaption":"Natpis scene","i.SceneCaptionText":"Tekst","i.SceneCaptionMode":"Re\u017Eim prikaza:","i.SceneCaptionModeClosable":"Mo\u017Ee se zatvoriti","i.SceneCaptionModeFixed":"Uvek vidljivo","i.SceneCaptionModeMinimizable":"Mo\u017Ee se minimizirati","i.Screen":"Ekran","i.ScreenOption":"Ekran #{number}","i.Settings":"Pode\u0161avanja","i.Size":"Veli\u010Dina","i.SizeHeight":"Visina (px):","i.SizeWidth":"\u0160irina (px):","i.Text":"Tekst","i.Title":"Naslov scene","i.Unspecified":"Neodre\u0111eno","i.Untitled":"Bez naslova","i.Url":"URL","i.url":"url","i.Video":"Video","i.View":"Prikaz","i.ViewOption":"Prikaz #{viewNumber} - Ekran #{screenNumber}","i.Views":"Prikazi","i.ViewsType":"Izaberite tip prikaza","i.ViewsTypeImage":"Slika","i.ViewsTypeOther":"Drugi sadr\u017Eaj","i.Visibility":"Vidljivost:","i.VisibilityHidden":"Sakriveno","i.VisibilityVisible":"Vidljivo","i.WrongImportedFile":"Datoteka mora biti JSON datoteka.","i.WrongResource":"Ovaj resurs je o\u0161tec\u0301en ili nije kompatibilan sa trenutnom verzijom Scene Maker-a i ne mo\u017Ee se u\u010Ditati.","i.yes":"da","i.Yes":"Da","i.ZoneTooltip":"Kliknite ovde da biste dodali sadr\u017Eaj"}},SceneMaker.Constant=SceneMaker.Constant||{},SceneMaker.Constant.NONE="none",SceneMaker.Constant.UNKNOWN="Unknown",SceneMaker.Constant.SCREEN="screen",SceneMaker.Constant.VIEW="view",SceneMaker.Constant.VIEW_IMAGE="view_image",SceneMaker.Constant.VIEW_CONTENT="view_content",SceneMaker.Constant.TEXT="text",SceneMaker.Constant.IMAGE="image",SceneMaker.Constant.AUDIO="audio",SceneMaker.Constant.VIDEO="video",SceneMaker.Constant.OBJECT="object",SceneMaker.Constant.IE="Internet Explorer",SceneMaker.Constant.FIREFOX="Mozilla Firefox",SceneMaker.Constant.CHROME="Google Chrome",SceneMaker.Constant.SAFARI="Safari",SceneMaker.Constant.ANDROID_BROWSER="Android Browser",SceneMaker.Constant.MEDIA={},SceneMaker.Constant.MEDIA.IMAGE="image",SceneMaker.Constant.MEDIA.HTML5_VIDEO="HTML5_VIDEO",SceneMaker.Constant.MEDIA.YOUTUBE_VIDEO="YouTube",SceneMaker.Constant.MEDIA.HTML5_AUDIO="HTML5_AUDIO",SceneMaker.Constant.MEDIA.WEB="web",SceneMaker.Constant.MEDIA.REUSABLE_PUZZLE_INSTANCE="reusable_puzzle_instance",SceneMaker.Constant.MEDIA.PDF="pdf",SceneMaker.Constant.MEDIA.DOC="doc",SceneMaker.Constant.MEDIA.PPT="ppt",SceneMaker.Constant.MEDIA.JSON="json",SceneMaker.Constant.WRAPPER={},SceneMaker.Constant.WRAPPER.EMBED="EMBED",SceneMaker.Constant.WRAPPER.OBJECT="OBJECT",SceneMaker.Constant.WRAPPER.IFRAME="IFRAME",SceneMaker.Constant.WRAPPER.VIDEO="VIDEO",SceneMaker.Constant.WRAPPER.AUDIO="AUDIO",SceneMaker.Constant.WRAPPER.IMAGE="IMG",SceneMaker.Configuration=(function(e,r,_){var p,s=function(f){typeof f=="undefined"&&(f={}),p=f,e.ImagesPath=p.ImagesPath,e.StylesheetsPath=p.StylesheetsPath,e.PreviewPath=p.PreviewPath,e.UploadScenePath=p.UploadScenePath},m=function(){return typeof p=="undefined"?{}:p};return{init:s,getConfiguration:m}})(SceneMaker,jQuery),SceneMaker.User=(function(e,r,_){var p,s=function(O){var b={};typeof O=="object"&&(b=O.user),f(b)},m=function(){return Object.keys(p).length>0?p:_},f=function(O){typeof O=="object"?p=O:p={}},T=function(){return p&&typeof p.token=="string"&&p.id},k=function(){return p.name},D=function(){return p.id},V=function(){return p.token};return{init:s,getUser:m,setUser:f,isLogged:T,getName:k,getId:D,getToken:V}})(SceneMaker,jQuery),SceneMaker.I18n=(function(e,r,_){var p="en",s,m,f,T,k,D,V=function(H,W){var re=e.Configuration.getConfiguration();if(s=R(),f=O(),h(re.defaultLanguage)&&(p=re.defaultLanguage),h(H.lang))T=H.lang;else{var y=navigator.language||navigator.userLanguage;h(y)?T=y:typeof W=="object"&&h(W.language)?T=W.language:T=p}D=e.Locales,typeof m=="object"?k=m:k=D},O=function(){for(var H=[],W=R(),re=0;re<W.length;re++)for(var y=Object.keys(W[re]),ke=0;ke<y.length;ke++)H.indexOf(y[ke])==-1&&H.push(y[ke]);return H},b=function(){return f instanceof Array?f:O()},R=function(){var H=[],W=e.Configuration.getConfiguration();return typeof e.Locales=="object"&&H.push(e.Locales),typeof W=="object"&&typeof W.locales=="object"&&(H.push(W.locales),m=W.locales),H},S=function(){return s instanceof Array?s:R()},h=function(H){return typeof H=="string"&&b().indexOf(H)!=-1},w=function(){r("[i18n-key]").each(function(H,W){var re=M(r(W).attr("i18n-key"));if(typeof re!="undefined")switch(W.tagName){case"INPUT":P(W,re);break;case"TEXTAREA":X(W,re);break;case"DIV":N(W,re);break;case"LI":te(W,re);break;case"IMG":ne(W,re);break;default:K(W,re);break}}),r("[i18n-key-tooltip]").each(function(H,W){var re=M(r(W).attr("i18n-key-tooltip"));typeof re!="undefined"&&r(W).attr("title",re)}),r("[i18n-key-href]").each(function(H,W){var re=M(r(W).attr("i18n-key-href"));typeof re!="undefined"&&r(W).attr("href",re)})},P=function(H,W){r(H).val()!==""&&r(H).val(W),r(H).attr("placeholder")&&r(H).attr("placeholder",W)},N=function(H,W){r(H).attr("data-text")!=_&&r(H).attr("data-text",W),r(H).attr("title")!=_&&r(H).attr("title",W),r(H).attr("translateContent")==="true"&&r(H).html(W)},X=function(H,W){r(H).attr("placeholder",W)},te=function(H,W){r(H).attr("data-text")!=_?r(H).attr("data-text",W):K(H,W)},ne=function(H,W){var re="src";typeof r(H).attr("srctoload")!="undefined"&&(re="srctoload"),r(H).attr(re,e.ImagesPath+W)},K=function(H,W){r(H).text(W)},M=function(H,W){var re=J(k,H,W);if(typeof re=="string"||(re=J(D,H,W),typeof re=="string"))return re;var y=/^i\./g;return y.exec(H)!=null?_:H},J=function(H,W,re){return typeof H[T]!="undefined"&&typeof H[T][W]=="string"?U(H[T][W],re):T!=p&&typeof H[p]!="undefined"&&typeof H[p][W]=="string"?U(H[p][W],re):_},U=function(H,W){if(typeof W!="object")return H;for(var re in W){var y="#{"+re+"}";H.indexOf(y)!=-1&&(H=H.replaceAll(y,W[re]))}return H},F=function(){return T};return{init:V,getAvailableLanguages:b,getAvailableLocales:S,getLanguage:F,getTrans:M,translateUI:w}})(SceneMaker,jQuery),SceneMaker.Object=(function(e,r,_){var p=function(){e.Object.PDF.init(),e.Object.GoogleDOC.init()};function s(w,P,N){this.wrapper=w,this.source=P,this.type=N}var m=function(w){var P=null;if(typeof w=="string"){var N=new RegExp("^<video","g");N.exec(w)!==null&&(P="VIDEO");var X=new RegExp("^<audio","g");X.exec(w)!==null&&(P="AUDIO")}if(P===null||typeof P=="undefined"){var te=r(w)[0];typeof te!="undefined"&&(P=te.tagName)}var ne=f(w,P),K;switch(P){case"VIDEO":K=e.Constant.MEDIA.HTML5_VIDEO;break;case"AUDIO":K=e.Constant.MEDIA.HTML5_AUDIO;break;case"IFRAME":default:K=S(ne)}return new s(P,ne,K)},f=function(w,P){var N=null;switch(P){case null:N=w;break;case e.Constant.WRAPPER.IMAGE:case e.Constant.WRAPPER.EMBED:case e.Constant.WRAPPER.IFRAME:N=r(w).attr("src");break;case e.Constant.WRAPPER.OBJECT:typeof r(w).attr("src")!="undefined"?N=r(w).attr("src"):typeof r(w).attr("data")!="undefined"&&(N=r(w).attr("data"));break;case e.Constant.WRAPPER.VIDEO:return e.Video.HTML5.getSources(w);case e.Constant.WRAPPER.AUDIO:return e.Audio.HTML5.getSources(w);default:e.Debugging.log("Unrecognized object wrapper: "+P);break}if(P==null||P==e.Constant.WRAPPER.IFRAME){var X=/(^https?:\/\/docs.google.com\/viewer\?url=)/g,te=N.match(X);te instanceof Array&&te.length===1&&(N=N.replace(te[0],"").replace("&embedded=true",""))}return N},T=/(http(s)?:\/\/)([aA-zZ0-9%=_&+?])+([./-][aA-zZ0-9%=_&+?]+)*[/]?/g,k=/(www[.])([aA-zZ0-9%=_&+?])+([./-][aA-zZ0-9%=_&+?]+)*[/]?/g,D=/(http(s)?:\/\/)?(((youtu.be\/)([aA-zZ0-9-]+))|((www.youtube.com\/((watch\?v=)|(embed\/)|(v\/)))([aA-z0-9-Z&=.])+))/g,V=/^https?:\/\/[^\/]+\/escapeRooms\/[A-Za-z0-9]+\/reusablePuzzleInstances\/[A-Za-z0-9]+\/render$/,O=["mp4","webm","ogg"],b=["jpg","jpeg","png","gif","bmp","svg"],R=["mp3","wav","ogg"],S=function(w){if(typeof w=="object"&&w!==null&&typeof w.length=="number"&&w.length>0&&(w=w[0]),typeof w!="string")return null;if(w.match(V)!==null)return e.Constant.MEDIA.REUSABLE_PUZZLE_INSTANCE;if(w.match(D)!==null)return e.Constant.MEDIA.YOUTUBE_VIDEO;w=w.split("?")[0];var P=h(w);return b.indexOf(P)!==-1?e.Constant.MEDIA.IMAGE:P==="pdf"?e.Constant.MEDIA.PDF:O.indexOf(P)!==-1?e.Constant.MEDIA.HTML5_VIDEO:R.indexOf(P)!==-1?e.Constant.MEDIA.HTML5_AUDIO:P==="json"?e.Constant.MEDIA.JSON:P==="doc"||P==="docx"?e.Constant.MEDIA.DOC:P==="ppt"||P==="pptx"||P==="odp"?e.Constant.MEDIA.PPT:w.match(T)!==null||w.match(k)!==null?e.Constant.MEDIA.WEB:P},h=function(w){return w.split(".").pop().split("&")[0].toLowerCase()};return{init:p,getExtensionFromSrc:h,getObjectInfo:m}})(SceneMaker,jQuery),SceneMaker.Object.PDF=(function(e,r,_){var p=!1,s=function(){p=e.Status.getDevice().features.pdfReader},m=function(T){return T=e.Utils.checkUrlProtocol(T),p?"<iframe src='"+T+"'></iframe>":e.Object.GoogleDOC.generateWrapper(T)},f=function(T,k){if(typeof k!="object"||typeof k.source!="string")return"";var D=T.style?T.style:"",V=m(k.source),O="objectelement";return k.extraClasses&&(O=O+" "+k.extraClasses),"<div id='"+T.id+"' class='"+O+"' objectStyle='"+D+`' objectWrapper="`+V+'"></div>'};return{init:s,generateWrapper:m,renderPDFFromJSON:f}})(SceneMaker,jQuery),SceneMaker.Object.GoogleDOC=(function(e,r,_){var p=function(){},s=function(m){return m=e.Utils.checkUrlProtocol(m),"<iframe src='https://docs.google.com/viewer?url="+m+"&embedded=true'></iframe>"};return{init:p,generateWrapper:s}})(SceneMaker,jQuery),SceneMaker.Renderer=(function(e,r,_){var p=function(){},s=function(h){var w=m(h);if(w){r("section.slides").append(r(w)),e.Marker.drawSlideWithMarkers(h);for(var P=h.views.length,N=0;N<P;N++){var X=h.views[N];e.Marker.drawSlideWithMarkers(X)}}},m=function(h){for(var w="",P=h.views.length,N=0;N<P;N++){var X=h.views[N];w+=f(X)}return r("<article type='"+h.type+"' id='"+h.id+"'>"+w+"</article>")},f=function(h){if(h.type===e.Constant.VIEW_CONTENT)return k(h);if(h.type===e.Constant.VIEW_IMAGE)return T(h)},T=function(h){var w="hide_in_screen",P="<div class='close_view' id='close"+h.id+"'></div>";return"<article class='"+w+"' type='"+e.Constant.VIEW_IMAGE+"' id='"+h.id+"'>"+P+"</article>"},k=function(h){for(var w="",P="hide_in_screen",N="<div class='close_view' id='close"+h.id+"'></div>",X=h.elements.length,te=0;te<X;te++){var ne=h.elements[te];ne.type===e.Constant.TEXT?w+=V(ne):ne.type===e.Constant.IMAGE?w+=O(ne):ne.type===e.Constant.VIDEO?w+=b(ne):ne.type===e.Constant.AUDIO?w+=R(ne):ne.type===e.Constant.OBJECT?(w+=S(ne),P+=" object"):w+=D(ne)}return"<article class='"+P+"' type='"+e.Constant.VIEW_CONTENT+"' id='"+h.id+"'>"+N+w+"</article>"},D=function(h){return"<div id='"+h.id+"' class='view_content_text'></div>"},V=function(h){return"<div id='"+h.id+"' class='view_content_text textArea'>"+h.body+"</div>"},O=function(h){var w=r("<div id='"+h.id+"' class='view_content_image_wrapper'></div>"),P=r("<img class='view_content_image' src='"+h.body+"' style='"+h.style+"' />");if(h.hyperlink){var N=r("<a href='"+h.hyperlink+"' target='blank_'></a>");r(N).append(P),r(w).append(N)}else r(w).append(P);return e.Utils.getOuterHTML(w)},b=function(h){var w="<div id='"+h.id+"' class='view_content_video_wrapper'>",P=e.Video.HTML5.renderVideoFromJSON(h,{id:e.Utils.getId(h.id+"_video"),extraClasses:["view_content_video"],timestamp:!0});return w=w+P+"</div>",w},R=function(h){var w="<div id='"+h.id+"' class='view_content_audio_wrapper'>",P=e.Audio.HTML5.renderAudioFromJSON(h,{id:e.Utils.getId(h.id+"_audio"),extraClasses:["view_content_audio"],timestamp:!0});return w=w+P+"</div>",w},S=function(h){var w=h.settings||{},P=w.unloadObject===!1?"unloadableObject":"",N=e.Object.getObjectInfo(h.body);switch(N.type){case e.Constant.MEDIA.YOUTUBE_VIDEO:return e.Video.Youtube.renderVideoFromJSON(h,{extraClasses:"objectelement youtubeelement "+P});case e.Constant.MEDIA.PDF:return e.Object.PDF.renderPDFFromJSON(h,{extraClasses:P,source:N.source});default:var X=r(h.body),te=X.attr("src");typeof te!="undefined"&&(te=e.Utils.checkWebUrl(te),(N.type===e.Constant.MEDIA.REUSABLE_PUZZLE_INSTANCE||w.addPreviewParamToObject===!0)&&(te=e.Utils.addParamToUrl(te,"escapp_preview",""+e.Status.isPreview())),X.attr("src",te)),N.type===e.Constant.MEDIA.REUSABLE_PUZZLE_INSTANCE&&X.attr("reusablepuzzleinstance","true");var ne=e.Utils.getOuterHTML(X),K=h.style?h.style:"";return"<div id='"+h.id+"' class='objectelement "+P+"' objectStyle='"+K+"' objectWrapper='"+ne+"'></div>"}};return{init:p,renderScreen:s}})(SceneMaker,jQuery),SceneMaker.Scene=(function(e,r){var _=function(p,s){e.ViewerAdapter.applyAspectRatio(p.aspectRatio),e.Renderer.init();for(var m=p.screens,f=0;f<m.length;f++)e.Renderer.renderScreen(m[f]);typeof s=="function"&&s()};return{init:_}})(SceneMaker),SceneMaker.ObjectPlayer=(function(e,r,_){var p=function(f){r.each(f.children(".objectelement"),function(T,k){if(!r(k).hasClass("loadedObject")){r(k).addClass("loadedObject");var D=r(r(k).attr("objectWrapper"));r(k).html("<div style='"+r(k).attr("objectStyle")+"'>"+e.Utils.getOuterHTML(D)+"</div>")}})},s=function(f){r.each(r(f).children('.objectelement:not(".unloadableObject")'),function(T,k){r(k).removeClass("loadedObject"),r(k).html("")})},m=function(f){r(".current").hasClass("object")&&p(r(".current"))};return{loadObject:p,unloadObject:s,aftersetupSize:m}})(SceneMaker,jQuery),SceneMaker.Video=(function(e,r,_){var p=function(){e.Video.HTML5.init(),e.Video.Youtube.init()};return{init:p}})(SceneMaker,jQuery),SceneMaker.Video.Youtube=(function(e,r,_){var p=function(){},s=function(k,O){var V=k.body||k.source,O=O||{};return O.id=k.id?k.id:e.Utils.getId(),O.objectStyle=k.style,f(V,O)},m=function(k){var D="https://www.youtube.com/embed/"+T(k),V="<iframe src='"+D+"' title='YouTube video player' frameborder='0' allowfullscreen></iframe>";return V},f=function(k,D){var V=D&&D.id?D.id:e.Utils.getId(),O="",b="";D&&(D.extraClasses&&(O=O+" "+D.extraClasses),D.objectStyle?b=D.objectStyle:D.style&&(b=D.style));var R=m(k);return"<div id='"+V+"' class='"+O+"' objectStyle='"+b+`' objectWrapper="`+R+'"></div>'},T=function(k){var D=null;if(!k)return D;var V=/https?:\/\/?youtu.be\/([aA-zZ0-9-]+)/g,O=/(https?:\/\/)?(www.youtube.com\/watch\?v=|embed\/)([aA-zZ0-9-]+)[&=.]*/g,b=/(https?:\/\/)?(www.youtube.com\/v\/)([aA-zZ0-9-]+)/g,R=/(https?:\/\/)?(www.youtube.com\/embed\/)([aA-zZ0-9-]+)/g;if(k.match(V)!=null){var S=V.exec(k);return S&&S[1]&&(D=S[1]),D}if(k.match(O)!=null){var S=k.split("&")[0],S=O.exec(k);return S&&S[3]&&(D=S[3]),D}if(k.match(b)!=null){var S=k.split("&")[0],S=b.exec(k);return S&&S[3]&&(D=S[3]),D}if(k.match(R)!=null){var S=k.split("&")[0],S=R.exec(k);return S&&S[3]&&(D=S[3]),D}return D};return{init:p,renderVideoFromJSON:s,renderVideoFromSource:f,getYoutubeIdFromURL:T}})(SceneMaker,jQuery),SceneMaker.Video.HTML5=(function(e,r,_){var p=function(){},s=function(){var h=r("video, audio");r.each(h,function(w,P){var N=P.tagName==="VIDEO";N&&r(P).focus(function(X){this.blur()})})},m=function(h){var w=r(h).find("video, audio");r.each(w,function(P,N){r(N).attr("wasplayingonslideleave")=="true"?N.play():r(N).attr("wasplayingonslideleave")=="false"||typeof r(N).attr("wasplayingonslideleave")=="undefined"&&r(N).attr("autoplayonslideenter")=="true"&&N.play()})},f=function(h){var w=r(h).find("video, audio");r.each(w,function(P,N){var X=!N.paused;r(N).attr("wasplayingonslideleave",X),X&&N.pause()})},T=function(h,w){var P=w||{};return typeof P.id=="undefined"&&(P.id=typeof h!="undefined"&&h.id?h.id:e.Utils.getId()),typeof P.controls=="undefined"&&(P.controls=h.controls),P.style=h.style,P.autoplay=h.autoplay,P.loop=h.loop,k(R(h),P)},k=function(h,w){var P=r("<video></video>");if(r(P).attr("preload","metadata"),w&&w.extraAttrs)for(var N in w.extraAttrs)r(P).attr(N,w.extraAttrs[N]);if(w){if(w.id&&r(P).attr("id",w.id),typeof w.onVideoReady=="string")try{for(var X=w.onVideoReady.split("."),te=window[X[0]],ne=1;ne<X.length;ne++)te=te[X[ne]];typeof te=="function"&&r(P).attr("onloadeddata",w.onVideoReady+"(this)")}catch(J){}if(w.extraClasses)for(var K=w.extraClasses.length,M=0;M<K;M++)r(P).addClass(w.extraClasses[M]);w.controls!==!1&&r(P).attr("controls","controls"),typeof w.autoplay!="undefined"&&r(P).attr("autoplayonslideenter",w.autoplay),typeof w.poster=="string"&&r(P).attr("poster",w.poster),w.loop===!0&&r(P).attr("loop","loop"),w.style&&r(P).attr("style",w.style)}return typeof r(P).attr("onloadeddata")=="undefined"&&r(P).attr("onloadeddata","SceneMaker.Video.HTML5.onVideoReady(this)"),P=e.Utils.getOuterHTML(P),P=P.split("</video>")[0],(!w||w.loadSources!==!1)&&(r.each(h,function(J,U){if(typeof U.src=="string"){var F=U.src;typeof w!="undefined"&&w.timestamp===!0&&(F=e.Utils.addParamToUrl(F,"timestamp",""+new Date().getTime()));var H=U.mimeType?"type='"+U.mimeType+"' ":"";P=P+"<source src='"+F+"' "+H+">"}}),h.length>0&&(P=P+"<p>Your browser does not support HTML5 video.</p>")),P=P+"</video>",P},D=function(h,w,N){var N=N||{};r.each(h,function(X,te){if(typeof te.src=="string"){var ne=te.src;N.timestamp===!0&&(ne=e.Utils.addParamToUrl(ne,"timestamp",""+new Date().getTime()));var K=te.mimeType?"type='"+te.mimeType+"' ":"";r(w).append("<source src='"+ne+"' "+K+">")}}),h.length>0&&r(w).append("<p>Your browser does not support HTML5 video.</p>")},V=function(h){typeof h!="undefined"&&(h.readyState==4||h.readyState==3)&&r(h).attr("loaded","true")},O=function(h){if(typeof h=="string"){for(var w=[],P=new RegExp(`src=('||")([a-z-.://0-9]+)`,"g"),N;N=P.exec(h);)N.length>2&&w.push(N[2]),P.lastIndex=N.index+1;return w.map(function(X){return{src:X,mimeType:b(X)}})}try{return r(h).find("source").map(function(){return{src:this.src,mimeType:b(this.src)}})}catch(X){return[]}return[]},b=function(h){var w=e.Object.getObjectInfo(h).source;return"video/"+w.split(".").pop().split("?")[0]},R=function(h){if(typeof h!="object")return[];if(typeof h.sources=="string")try{var w=JSON.parse(h.sources)}catch(P){return[]}else if(typeof h.sources=="object")var w=h.sources;return w},S=function(h){if(typeof h=="string"){var w=new RegExp(`poster=('||")([a-z.://0-9?=%]+)`,"g"),P=w.exec(h);return typeof P!="undefined"&&P!=null&&P.length>2?P[2]:_}return r(h).attr("poster")};return{init:p,setMultimediaEvents:s,playMultimedia:m,stopMultimedia:f,renderVideoFromJSON:T,renderVideoFromSources:k,addSourcesToVideoTag:D,getSources:O,getSourcesFromJSON:R,getPoster:S,onVideoReady:V}})(SceneMaker,jQuery),SceneMaker.Audio=(function(e,r,_){var p=function(){e.Audio.HTML5.init()};return{init:p}})(SceneMaker,jQuery),SceneMaker.Audio.HTML5=(function(e,r,_){var p,s=function(){var S=new Audio;p={player:S,url:_},S.addEventListener("ended",()=>{p.url=_})},m=function(S){typeof p=="undefined"||typeof p.player=="undefined"||typeof S=="string"&&p.url===S||(p.url=S,p.player.pause(),p.player.currentTime=0,p.player.src=S,p.player.play().then(()=>{}).catch(h=>{p.url=_}))},f=function(S){typeof p=="undefined"||typeof p.player=="undefined"||typeof S=="string"&&p.url===S&&(p.player.pause(),p.url=_)},T=function(S,h){var w=h||{};return typeof w.id=="undefined"&&(w.id=typeof S!="undefined"&&S.id?S.id:e.Utils.getId()),typeof w.controls=="undefined"&&(w.controls=S.controls),w.style=S.style,w.autoplay=S.autoplay,w.loop=S.loop,k(b(S),w)},k=function(S,h){var w=r("<audio></audio>");if(r(w).attr("preload","metadata"),r(w).addClass("veaudioelement"),h&&h.extraAttrs)for(var P in h.extraAttrs)r(w).attr(P,h.extraAttrs[P]);if(h){if(h.id&&r(w).attr("id",h.id),typeof h.onAudioReady=="string")try{for(var N=h.onAudioReady.split("."),X=window[N[0]],te=1;te<N.length;te++)X=X[N[te]];typeof X=="function"&&r(w).attr("onloadeddata",h.onAudioReady+"(this)")}catch(M){}if(h.extraClasses)for(var ne=h.extraClasses.length,K=0;K<ne;K++)r(w).addClass(h.extraClasses[K]);h.controls!==!1&&r(w).attr("controls","controls"),typeof h.autoplay!="undefined"&&r(w).attr("autoplayonslideenter",h.autoplay),h.loop===!0&&r(w).attr("loop","loop"),h.style&&r(w).attr("style",h.style)}return typeof r(w).attr("onloadeddata")=="undefined"&&r(w).attr("onloadeddata","SceneMaker.Audio.HTML5.onAudioReady(this)"),w=e.Utils.getOuterHTML(w),w=w.split("</audio>")[0],(!h||h.loadSources!==!1)&&(r.each(S,function(M,J){if(typeof J.src=="string"){var U=J.src;typeof h!="undefined"&&h.timestamp===!0&&(U=e.Utils.addParamToUrl(U,"timestamp",""+new Date().getTime()));var F=J.mimeType?"type='"+J.mimeType+"' ":"";w=w+"<source src='"+U+"' "+F+">"}}),S.length>0&&(w=w+"<p>Your browser does not support HTML5 audio.</p>")),w=w+"</audio>",w},D=function(S,h,P){var P=P||{};r.each(S,function(N,X){if(typeof X.src=="string"){var te=X.src;P.timestamp===!0&&(te=e.Utils.addParamToUrl(te,"timestamp",""+new Date().getTime()));var ne=X.mimeType?"type='"+X.mimeType+"' ":"";r(h).append("<source src='"+te+"' "+ne+">")}}),S.length>0&&r(h).append("<p>Your browser does not support HTML5 audio.</p>")},V=function(S){typeof S!="undefined"&&(S.readyState==4||S.readyState==3)&&r(S).attr("loaded","true")},O=function(S){if(typeof S=="string"){var h=e.Video.HTML5.getSources(S);return h.map(function(w){return{src:w.src,mimeType:R(w.src)}})}try{return r(S).find("source").map(function(){return{src:this.src,mimeType:R(this.src)}})}catch(w){return[]}return[]},b=function(S){return e.Video.HTML5.getSourcesFromJSON(S)},R=function(S){var h=e.Object.getObjectInfo(S).source,w=h.split(".").pop().split("?")[0],P;switch(w){case"ogg":P="ogg";break;case"mp3":P="mpeg";break;case"wav":P="wav";break;default:P=w;break}return"audio/"+P};return{init:s,playAudio:m,stopAudio:f,renderAudioFromJSON:T,renderAudioFromSources:k,addSourcesToAudioTag:D,onAudioReady:V,getSources:O,getSourcesFromJSON:b,getAudioMimeType:R}})(SceneMaker,jQuery),SceneMaker.Events=(function(e,r,_){var p=!1,s=function(){if(!p){p=!0,r("article").live("slideenter",e.Viewer.onSlideEnterViewer),r("article").live("slideleave",e.Viewer.onSlideLeaveViewer),r(document).on("click",".close_view",e.View.onCloseViewClicked),r(document).on("click",".captionHeaderWrapper img",e.Caption.onCaptionButtonClicked);var f=_;window.onresize=function(){typeof f=="undefined"?(f=!1,setTimeout(function(){f?(f=_,window.onresize()):(f=_,m())},600)):f=!0},r(window).on("orientationchange",function(){r(window).trigger("resize")}),window.onbeforeunload=function(){e.EventsNotifier.notifyEvent("EXIT")}}},m=function(){e.ViewerAdapter.updateInterface()};return{init:s}})(SceneMaker,jQuery),SceneMaker.EventsNotifier=(function(e,r,_){var p=!1,s,m=function(){p||(p=!0,s=new Array)},f=function(D,V){D in s||(s[D]=[]),s[D].push(V)},T=function(D,V){D in s&&s[D].indexOf(V)!==-1&&s[D].splice(s[D].indexOf(V),1)},k=function(D,V,O){if(s){V=V||{},V.triggeredByUser=O!==!1;var b=s[D];if(b)for(var R=0;R<b.length;R++)b[R](V)}};return{init:m,notifyEvent:k,registerCallback:f,unRegisterCallback:T}})(SceneMaker,jQuery),SceneMaker.Viewer=(function(e,r,_){var p,s,m=function(){f(e.getOptions())},f=function(R){e.Editing=!1,r("body").addClass("SceneMakerViewerBody"),p=typeof R=="object"?R:{},e.Debugging.init(R),p.configuration&&e.Configuration&&e.Configuration.init(p.configuration);var S=R.scene;if(e.Utils.init(),e.I18n.init(p,S),e.Debugging.log(`

Scene Maker initiated with scene:
`),e.Debugging.log(JSON.stringify(S)),S=e.Utils.fixScene(S),S===null){e.Utils.showPNotValidDialog();return}s=S,e.Status.init(function(){T(R,S)})},T=function(R,S){e.ViewerAdapter.applyLanguageCSS(),e.EventsNotifier.init(),e.Object.init(),e.Screen.init(),e.View.init(),e.Marker.init(),e.Actions.init(S),e.Caption.init(),e.Slides.init(),e.I18n.translateUI(),e.User.init(R),e.Events.init(),e.Video.init(),e.Audio.init(),e.FullScreen.init(),e.Scene.init(S,function(){k(R,S)})},k=function(R,S){e.Video.HTML5.setMultimediaEvents(),e.Screen.updateCurrentScreenFromHash(),e.Screen.updateScreens(),e.ViewerAdapter.init(R),e.Utils.Loader.preloadResources(S),e.Screen.getCurrentScreenNumber()>0&&e.Slides.triggerSlideEnterEvent(r(e.Screen.getCurrentScreen()).attr("id")),e.Status.isExternalDomain()||window.focus(),e.Escapp.init(R,S)},D=function(){return p},V=function(R){var S=R.target,h=e.Slides.isView(S),w=e.Slides.getCurrentSlide();R.stopPropagation(),h?(setTimeout(function(){var P=r(S);P.hasClass(e.Constant.OBJECT)&&r(w).attr("id")===r(e.Slides.getCurrentSlide()).attr("id")&&e.ObjectPlayer.loadObject(P)},400),e.Video.HTML5.playMultimedia(S)):e.Screen.onEnterScreen(S),e.Actions.checkActionsForSlideEnterEvent(S.id)},O=function(R){var S=R.target,h=e.Slides.isView(S);R.stopPropagation(),h?(r(S).hasClass(e.Constant.OBJECT)&&e.ObjectPlayer.unloadObject(r(S)),e.Video.HTML5.stopMultimedia(S)):e.Screen.onLeaveScreen(S)},b=function(){return s};return{init:m,getOptions:D,getCurrentScene:b,onSlideEnterViewer:V,onSlideLeaveViewer:O}})(SceneMaker,jQuery),SceneMaker.Debugging=(function(e,r,_){var p=!1,s,m=function(b){b&&typeof b.developping=="boolean"?(p=b.developping,p&&b.developmentSettings&&(s=b.developmentSettings)):(p=!1,s=null)},f=function(...b){window.console&&window.console.log&&p&&console.log(...b)},T=function(){p=!0},k=function(){p=!1},D=function(){return p},V=function(){return s?s.actionInit:"nothing"},O=function(){return s&&s.testing_scene?s.testing_scene:(f("Error: Please specify development settings"),null)};return{init:m,log:f,enableDevelopingMode:T,disableDevelopingMode:k,isDevelopping:D,getActionInit:V,getTestingScene:O}})(SceneMaker,jQuery),SceneMaker.Validator=(function(e,r,_){var p=function(){},s=function(m){if(!m||typeof m=="string"&&m.trim()==="")return!1;var f=e.Object.getObjectInfo(m);if(!f||!f.source||!f.type)return!1;if(typeof f.source=="string"){if(f.source.trim()==="")return!1}else if(typeof f.source=="object"){if(f.source.length<1)return!1}else return!1;return!0};return{init:p,validateObject:s}})(SceneMaker,jQuery),SceneMaker.Status=(function(e,r,_){var p,s,m,f,T,k,D,V=function(M){O(),b(),R(),S(),h(),e.Status.Device.init(function(J){p=J,typeof M=="function"&&M()})},O=function(){return s=window.location!=window.parent.location,s},b=function(){if(T=!1,O())try{for(var M=window.parent;M!=window.top;)if(typeof M.location.href=="undefined"){T=!0;break}else M=M.parent;typeof window.top.location.href=="undefined"&&(T=!0)}catch(J){T=!0}return T},R=function(){if(m=_,f="undefined",s&&!T)try{switch(window.frameElement.tagName){case"OBJECT":case"IFRAME":default:f=window.frameElement.tagName,m=window.frameElement}}catch(M){}},S=function(){var M;try{M=document.location.protocol}catch(U){}if(typeof M=="string"){var J=M.match(/[\w]+/);J instanceof Array&&typeof J[0]=="string"?M=J[0]:M=_}typeof M=="string"?D=M:D="unknown"},h=function(){var M=e.Utils.getOptions();typeof M.preview=="boolean"?k=M.preview:k=!1},w=function(){return p},P=function(){return s},N=function(){return m},X=function(){return f},te=function(){return T},ne=function(){return typeof D=="undefined"&&S(),D},K=function(){return k};return{init:V,getDevice:w,isExternalDomain:te,isEmbed:P,getContainer:N,getContainerType:X,getProtocol:ne,isPreview:K}})(SceneMaker,jQuery),SceneMaker.Status.Device=(function(e,r,_){var p=function(O){e.Status.Device.Browser.init(),e.Status.Device.Features.init(),s(O)},s=function(O){var b={};b.browser=e.Status.Device.Browser.fillBrowser(),b.features={},m(b),f(b,function(){b.features=e.Status.Device.Features.fillFeatures(),typeof O=="function"&&O(b)})},m=function(O){O.iPhone=/iPhone/i.test(navigator.userAgent),O.iPad=/iPad/i.test(navigator.userAgent),O.iOS=O.iPhone||O.iPad,O.android=/android/i.test(navigator.userAgent)},f=function(O,b){O.iOS&&O.browser.name===e.Constant.SAFARI?V(b):O.android?O.browser.name===e.Constant.CHROME?D(b):O.browser.name===e.Constant.ANDROID_BROWSER&&k(b):typeof b=="function"&&b()},T=function(O,b){var R=r("head>meta[name='viewport']");R.length===0?r("head").prepend('<meta name="viewport" content="'+O+'"/>'):r(R).attr("content",O),setTimeout(function(){typeof b=="function"&&b()},1250)},k=function(O){T("user-scalable=yes",O)},D=function(O){T("width=device-width,height=device-height,user-scalable=yes",O)},V=function(O){T("user-scalable=yes",O)};return{init:p}})(SceneMaker,jQuery),SceneMaker.Status.Device.Browser=(function(e,r,_){var p="Microsoft Internet Explorer",s="Netscape",m=function(){},f=function(){var O={},b=k();if(b!==-1)return O.name=e.Constant.FIREFOX,O.version=b,O;if(b=D(),b!==-1)return O.name=e.Constant.CHROME,O.version=b,O;if(b=T(),b!==-1)return O.name=e.Constant.IE,O.version=b,O;if(b=V(),b!==-1){var R=/android/i.test(navigator.userAgent);return R?O.name=e.Constant.ANDROID_BROWSER:O.name=e.Constant.SAFARI,O.version=b,O}return O.name=e.Constant.UNKNOWN,O.version=-1,O},T=function(){var O=-1;if(navigator.appName===p){var b=navigator.userAgent,R=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");R.exec(b)!=null&&(O=parseFloat(RegExp.$1))}else if(navigator.appName===s){var b=navigator.userAgent,R=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");R.exec(b)!=null&&(O=parseFloat(RegExp.$1))}return O},k=function(){var O=-1;if(navigator.appName===s){var b=navigator.userAgent,R=new RegExp(".* Firefox/([0-9.]+)");R.exec(b)!=null&&(O=parseFloat(RegExp.$1))}return O},D=function(){var O=-1;if(navigator.appName===s){var b=navigator.userAgent,R=new RegExp(".* Chrome/([0-9.]+)");R.exec(b)!=null&&(O=parseFloat(RegExp.$1))}return O},V=function(){var O=-1;if(navigator.appName===s){var b=navigator.userAgent;if(b.indexOf("Safari")!==-1&&b.indexOf("Chrome")===-1&&b.indexOf("crmo")==-1){var O=-2,R=new RegExp(".* Version/([0-9.]+)");R.exec(b)!=null&&(O=parseFloat(RegExp.$1))}}return O};return{init:m,fillBrowser:f}})(SceneMaker,jQuery),SceneMaker.Status.Device.Features=(function(e,r,_){var p=function(){},s=function(){var f={};return f.fullscreen=e.FullScreen.isFullScreenSupported(),f.touchScreen="ontouchstart"in window,f.localStorage=m(),f.history=typeof history=="object"&&typeof history.back=="function"&&typeof history.go=="function",f.history&&typeof history.pushState=="function"?f.historypushState=!0:f.historypushState=!1,window.File&&window.FileReader&&window.FileList&&window.Blob?f.reader=!0:f.reader=!1,f.pdfReader=!1,typeof navigator.mimeTypes=="object"&&"application/pdf"in navigator.mimeTypes&&(f.pdfReader=!0),f},m=function(){var f=typeof Storage!="undefined";if(f)try{return localStorage.setItem("myKey","myKeyValue"),localStorage.getItem("myKey"),localStorage.removeItem("myKey"),!0}catch(T){return!1}else return!1};return{init:p,fillFeatures:s}})(SceneMaker,jQuery),SceneMaker.ViewerAdapter=(function(e,r,_){var p=!1,s,m,f,T,k,D,V,O,b,R=function(M){p||(p=!0,s=e.FullScreen.canFullScreen(),s=s&&!e.Status.isPreview(),r("#viewbar").show(),e.Status.isPreview()&&r("div#viewerpreview").show(),s?(e.FullScreen.enableFullScreen(),r("#page-fullscreen").show()):r("#page-fullscreen").hide(),P(),e.Text.init())},S=function(M){typeof M!="string"||["4:3","16:9"].indexOf(M)===-1||D!==M&&(D=M,r("body").attr("aspectRatio",M),M==="16:9"?(V=16/9,_referenceSlideWidth=1024,b=576):(V=4/3,_referenceSlideWidth=800,b=600))},h=function(){return D},w=function(){var M=e.I18n.getLanguage();typeof M!="undefined"&&r("body").attr("locale",M)},P=function(){if(typeof V!="undefined"){var M=r(window).width(),J=r(window).height();M===m&&J===f||(m=M,f=J,N())}},N=function(){var M,J,U=25,F=10,H=X(f),W=f-H,re=m,y=(re-F)/(W-U);if(y>V){J=W-U,M=J*V;var ke=re-M;if(ke<F){var ce=F-ke;M=M-ce}}else{M=re-F,J=M/V;var Ge=W-J;if(Ge<U){var lt=U-Ge;J=J-lt}}typeof k!="number"&&(k=b),typeof T!="number"&&(T=_referenceSlideWidth);var c=J/k;k=J,T=M,r("#viewbar").height(H);var we=r(".slides > article"),De=r(".slides > article > article"),Re=r(".slides article");r(Re).css("height",J),r(Re).css("width",M);var je=J/2+H/2,Pe=M/2;r(we).css("margin-top","-"+je+"px"),r(De).css("margin-top","-"+J/2+"px"),r(Re).css("margin-left","-"+Pe+"px");var qe=3/100*M,ft=5/100*M;r(Re).css("padding-left",ft),r(Re).css("padding-right",ft),r(Re).css("padding-top",qe),r(Re).css("padding-bottom",qe);var Ot=23;c<=1?Ot=Ot*K(c,.7):Ot=Ot*K(c,.2),r("div.close_view").css("width",Ot+"px"),r("div.close_view").css("height",Ot+"px"),r("#page-fullscreen").width(r("#page-fullscreen").height()),ne(c),te(c),e.Text.aftersetupSize(c),e.ObjectPlayer.aftersetupSize(c),e.Screen.afterSetupSize(c)},X=function(M){var J=26,U=40,F=M/b,H=40*K(F,.7);return Math.min(Math.max(H,J),U)},te=function(M){var J=r("#fancybox-overlay");if(!(r(J).length<1||!r(J).is(":visible"))){var U=r("#fancybox-wrap"),F=r("#fancybox-content"),H=r("#"+r(F).attr("id")+" > div"),W=r(".current"),re=r(W).cssNumber("padding-top"),y=r(W).cssNumber("padding-left"),ke=r(W).cssNumber("padding-right"),ce=r(W).offset(),Ge=23;M<=1?Ge=Ge*K(M,.7):Ge=Ge*K(M,.2);var lt=r("#fancybox-close");r(lt).width(Ge+"px"),r(lt).height(Ge+"px"),r(lt).css("padding","10px"),r(lt).css("padding-left","4px"),r(U).css("margin-top","0px"),r(U).css("margin-left","0px"),r(U).width(r(W).width()+y+ke),r(U).height(r(W).height()+2*re),r(U).css("top",ce.top+"px"),r(U).css("left",ce.left+"px"),r(F).width("100%"),r(F).height("100%"),r(H).width("100%"),r(H).height("100%")}},ne=function(M){var J=r("div[data-tippy-root]:visible");J.length>0&&J.each(function(U,F){r("[markertooltipid="+r(F).attr("id")+"]").each(function(H,W){typeof W._tippy!="undefined"&&(W._tippy.hide(),W._tippy.show())})})},K=function(M,J){var U=(M-1)*J;return 1+U};return{init:R,getAspectRatio:h,applyAspectRatio:S,applyLanguageCSS:w,updateInterface:P}})(SceneMaker,jQuery),SceneMaker.Text=(function(e,r,_){var p=12,s=function(){m(r("article > div.textArea")),r("article > div.textArea > table").each(function(b,R){m(r(R).find("caption")),r(R).find("td").each(function(te,ne){m(ne)});var S=r(R).attr("style");if(S){var h="",w=e.Utils.getWidthFromStyle(S);if(w){var P=w*100/800;h+="width:"+P+"%;"}var N=e.Utils.getHeightFromStyle(S);if(N){var X=N*100/600;h+="height:"+X+"%;"}h!==""&&r(R).attr("style",h)}})},m=function(b){T(r(b).find("font")),f(r(b).find("[style]"))},f=function(b){r(b).each(function(R,S){var h=r(S).attr("style");if(typeof h=="string"){var w=e.Utils.getFontSizeFromStyle(h);if(!(typeof w!="number"||isNaN(w))){var P=w/p+"rem",N=e.Utils.addFontSizeToStyle(h,P);r(S).attr("style",N)}}})},T=function(b){r(b).each(function(R,S){var h=r(S).attr("size");if(h){var w=parseInt(h);if(!isNaN(w)){r(S).hide();var P=O(w),N=P/p+"rem",X=r("<span style='font-size:"+N+"'></span>");r(X).html(r(S).html()),r(S).before(X),r(S).remove()}}})},k=function(b){b=b*D(b);var R=p,S=r("html");r(S).css("font-size",R*b+"px")},D=function(b){return b<.25?.5:V(b,.25,.3)?.55:V(b,.3,.35)?.65:V(b,.35,.4)?.7:V(b,.4,.5)?.8:V(b,.5,.6)?.85:V(b,.6,.75)?.9:V(b,.75,.95)?.95:(V(b,.95,1.5)||b>1.5,1)},V=function(b,R,S){return b>R&&b<=S},O=function(b){switch(b){case 7:return 48;case 6:return 32;case 5:return 24;case 4:return 18;case 3:return 16;case 2:return 14;case 1:return 12;default:break}};return{init:s,aftersetupSize:k}})(SceneMaker,jQuery),SceneMaker.Utils=(function(e,r){var _=!1,p,s,m=function(){_||(_=!0,p=[],s=new Array,jQuery.fn.cssNumber=function(c){var we=parseInt(this.css(c),10);return isNaN(we)?0:we},jQuery.fn.reverse=[].reverse,String.prototype.replaceAll=function(c,we){var De=this;return De.replace(new RegExp(c.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),we)},Array.prototype.filter||(Array.prototype.filter=function(c){"use strict";if(this===void 0||this===null)throw new TypeError;var we=Object(this),De=we.length>>>0;if(typeof c!="function")throw new TypeError;for(var Re=[],je=arguments.length>=2?arguments[1]:void 0,Pe=0;Pe<De;Pe++)if(Pe in we){var qe=we[Pe];c.call(je,qe,Pe,we)&&Re.push(qe)}return Re}),Array.prototype.map||(Array.prototype.map=function(c){"use strict";if(this===void 0||this===null)throw new TypeError;var we=Object(this),De=we.length>>>0;if(typeof c!="function")throw new TypeError;for(var Re=new Array(De),je=arguments.length>=2?arguments[1]:void 0,Pe=0;Pe<De;Pe++)Pe in we&&(Re[Pe]=c.call(je,we[Pe],Pe,we));return Re}),Array.prototype.indexOf||(Array.prototype.indexOf=function(c){var we=this.length>>>0,De=Number(arguments[1])||0;for(De=De<0?Math.ceil(De):Math.floor(De),De<0&&(De+=we);De<we;De++)if(De in this&&this[De]===c)return De;return-1}),Object.keys||(Object.keys=(function(){"use strict";var c=Object.prototype.hasOwnProperty,we=!{toString:null}.propertyIsEnumerable("toString"),De=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Re=De.length;return function(je){if(typeof je!="object"&&(typeof je!="function"||je===null))throw new TypeError("Object.keys called on non-object");var Pe=[],qe,ft;for(qe in je)c.call(je,qe)&&Pe.push(qe);if(we)for(ft=0;ft<Re;ft++)c.call(je,De[ft])&&Pe.push(De[ft]);return Pe}})()),typeof Array.prototype.forEach!="function"&&(Array.prototype.forEach=function(c){for(var we=0;we<this.length;we++)c.apply(this,[this[we],we,this])}),typeof String.prototype.trim!="function"&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),e.Utils.Loader.init())},f=function(){return e.Editing?e.Editor.getOptions():e.Viewer.getOptions()},T=function(c,we,De){if(we){var Re=c;c=c.replace(c[c.length-1],"")}else{typeof c!="string"&&(c="unicID"),typeof De!="string"&&(De=""),typeof s[c]=="undefined"&&(s[c]=0),s[c]=s[c]+1;var Re=c+De+s[c]}return $("#"+Re).length===0&&p.indexOf(Re)===-1?(p.push(Re),Re):T(c,!1,De)},k=function(c){p.indexOf(c)===-1&&p.push(c)},D=function(){p=[],s=new Array},V=function(c,we){if(typeof c=="object"&&typeof we=="object"&&!(c instanceof Array)){let De=Object.keys(Object.assign({},c,we)),Re=De.length;for(let je=0;je<Re;je++)c[De[je]]=V(c[De[je]],we[De[je]]);return c}else return typeof we!="undefined"?we:c},O=function(c){return typeof c!="object"||!Array.isArray(c.screens)||c.screens.length<1||typeof c.SMVersion!="string"?null:c},b=function(c){return typeof $(c)[0].outerHTML=="undefined"?$(c).clone().wrap("<div></div>").parent().html():$(c)[0].outerHTML},R=function(c,we){if(typeof c!="string"||typeof we!="string")return c;var De=c.split("#");c=De[0];var Re=c.split("?");if(Re.length===2){c=Re[0];for(var je=Re[1],Pe=[],Re=je.split("&"),qe=Re.length,ft=0;ft<qe;ft++){var Ot=Re[ft].split("=");Ot[0]!=we&&Pe.push({key:Ot[0],value:Ot[1]})}for(var Kt=Pe.length,Zt=0;Zt<Kt;Zt++){var zt=Pe[Zt];Zt===0?c=c+"?":c=c+"&",c=c+zt.key+"="+zt.value}}return De.length>1&&(c=c+"#"+De[1]),c},S=function(c,we,De){if(typeof c!="string"||typeof we!="string"||typeof De!="string")return c;c=R(c,we);var Re=c.split("#");c=Re[0];var je=we+"="+De;return c.indexOf("?")>-1?c+="&"+je:c+="?"+je,Re.length>1&&(c=c+"#"+Re[1]),c},h=function(c){var we={};if(typeof c!="string")return we;var De=c.split("?");if(De.length<=1)return we;for(var Re=De[1].split("#")[0].split("&"),je=0;je<Re.length;je++){var Pe=Re[je].split("=");Pe.length===2&&(we[Pe[0]]=Pe[1])}return we},w=function(){try{var c=window.location;if(typeof c=="undefined")return;var we=Math.max(1,Math.min(e.Screen.getScreensQuantity(),parseInt(c.hash.split("?")[0].split("#").pop())));return isNaN(we)?r:we}catch(De){return r}},P=function(c){return c.split("#")[0]},N=function(c){try{if(typeof c=="string"&&c.indexOf("url")===0&&c.length>3){var we=c[4];return we=='"'||we=="'"?c.substring(5,c.length-2):c.substring(4,c.length-1)}}catch(De){}return c},X=function(c,we){return ne(c,we)[0]},te=function(c,we){return ne(c,we)[1]},ne=function(c,we){var De=[],Re=null,je=null;return $.each(c.split(";"),function(Pe,qe){var ft=/width:\s?([0-9]+(\.[0-9]+)?)%/g,Ot=/width:\s?([0-9]+(\.?[0-9]+)?)px/g,Kt=/height:\s?([0-9]+(\.[0-9]+)?)%/g,Zt=/height:\s?([0-9]+(\.?[0-9]+)?)px/g;if(qe.indexOf("width")!==-1){if(qe.match(Ot)){var zt=Ot.exec(qe);zt[1]&&(Re=zt[1])}else if(qe.match(ft)){var zt=ft.exec(qe);if(zt[1]){var me=zt[1];we&&(Re=$(we).width()*me/100)}}}else if(qe.indexOf("height")!==-1){if(qe.match(Zt)){var zt=Zt.exec(qe);zt[1]&&(je=zt[1])}else if(qe.match(Kt)){var zt=Kt.exec(qe);if(zt[1]){var me=zt[1];we&&(je=$(we).height()*me/100)}}}}),De.push(Re),De.push(je),De},K=function(c){if(c){var we=null;return $.each(c.split(";"),function(De,Re){var je=/font-size\s*:\s*((\d*\.)?\d+)px/i;if(Re.match(je)!=null){var Pe=je.exec(Re);if(Pe!==null&&Pe[1]!==null)return we=parseFloat(Pe[1]),!1}}),we}},M=function(c,we){if(typeof c!="string")return null;var De="";return $.each(c.split(";"),function(Re,je){je.indexOf("font-size")===-1&&je!==""&&(De=De+je+"; ")}),we&&(De=De+"font-size:"+we+";"),De},J=function(){var c={};c.width=650,c.height=220,c.text=e.I18n.getTrans("i.WrongResource");var we={};we.text=e.I18n.getTrans("i.Ok"),we.callback=function(){$.fancybox.close()},c.buttons=[we],e.Utils.showDialog(c)},U=function(c){F();var we=$("#notification_template");if($(we).length!==0&&!(!c||!c.text)){var De="90%",Re,je=!1,Pe;e.Editing&&(Pe=e.ImagesPath+"thumbs/content_fail.png"),c.width&&(De=c.width),c.showCloseButton&&(je=c.showCloseButton),c.notificationIconSrc&&(Pe=c.notificationIconSrc),Pe||(c.textWrapperClass="forceCenter"),typeof De=="string"&&De.indexOf("%")!=0&&(De=De.split("%")[0].trim(),De=De*$(window).width()/100);var qe=$(we).parent();$(we).width(De);var ft=$(we).find(".notification_row1"),Ot=$(we).find(".notification_row2"),Kt=$(ft).find(".notificationIcon");if(Pe&&($(Kt).attr("src",Pe),$(Kt).css("display","inline")),c.notificationIconClass&&$(Kt).addClass(c.notificationIconClass),c.textWrapperClass&&$(ft).addClass(c.textWrapperClass),c.buttonsWrapperClass&&$(Ot).addClass(c.buttonsWrapperClass),$(ft).find(".notification_text").html(c.text),c.buttons){var Zt=c.buttons.length;$(c.buttons).reverse().each(function($e,ut){var mt=Zt-$e,kt=$('<a href="#" buttonNumber="'+mt+'" class="button notification_button">'+ut.text+"</a>");ut.extraclass&&$(kt).addClass(ut.extraclass),$(Ot).append(kt)})}if(c.middlerow){var zt=document.createElement("div");$(zt).addClass("notification_middlerow"),$(zt).append(c.middlerow),c.middlerowExtraClass&&$(zt).addClass(c.middlerowExtraClass),$(Ot).before(zt)}e.Utils.addTempShown(qe);var me=$(ft).outerHeight(!0)+$(Ot).outerHeight(!0);if(c.middlerow){var zt=$(we).find(".notification_middlerow");me=me+$(zt).outerHeight(!0)}e.Utils.removeTempShown(qe);var oe=$(we).clone();$(oe).attr("id","notification_template_cloned"),$(qe).append(oe);var Fe=$("#notification_template_cloned");if(c.buttons){Ot=$(Fe).find(".notification_row2"),$(Ot).html("");var Zt=c.buttons.length;$(c.buttons).reverse().each(function(ut,mt){var kt=Zt-ut,Ft=$('<a href="#" buttonNumber="'+kt+'" class="button notification_button">'+mt.text+"</a>");mt.extraclass&&$(Ft).addClass(mt.extraclass),$(Ot).append(Ft),$(Ot).find(".button[buttonNumber='"+kt+"']").click(function(Mt){Mt.preventDefault(),mt.callback()})})}$("a#link_to_notification_template").fancybox({autoDimensions:!1,autoScale:!0,scrolling:"no",width:De,height:me,padding:0,hideOnOverlayClick:!0,hideOnContentClick:!1,showCloseButton:je,onStart:function($e){},onComplete:function($e){},onClosed:function($e){F(),c&&typeof c.onClosedCallback=="function"&&c.onClosedCallback()}}),$("a#link_to_notification_template").trigger("click")}},F=function(){var c=$("#notification_template_wrapper");$(c).html("");var we=document.createElement("div");$(we).attr("id","notification_template");var De=document.createElement("div");$(De).addClass("notification_row1");var Re=document.createElement("img");$(Re).addClass("notificationIcon"),$(Re).attr("style","display:none");var je=document.createElement("span");$(je).addClass("notification_text"),$(De).append(Re),$(De).append(je),$(we).append(De);var Pe=document.createElement("div");$(Pe).addClass("notification_row2"),$(we).append(Pe),$(c).append(we)},H=function(c){return W(e.VERSION)>W(c)},W=function(c){var we=0,De=[100,10,1];try{for(var Re=c.split("."),je=0;je<Re.length;je++)we+=parseFloat(Re[je])*De[je]}catch(Pe){return 0}return we},re={},y=function(c){$(c).each(function(we,De){var Re=$(De).attr("id");typeof Re=="undefined"&&(Re=e.Utils.getId("TmpShownId"),$(De).attr("id",Re));var je=typeof re[Re]!="undefined"?re[Re]:0;re[Re]=je+1,je==0&&$(De).addClass("temp_shown")})},ke=function(c){$(c).each(function(we,De){var Re=$(De).attr("id");typeof Re=="undefined"&&(Re=e.Utils.getId("TmpShownId"),$(De).attr("id",Re));var je=typeof re[Re]!="undefined"?re[Re]:0,Pe=Math.max(0,je-1);re[Re]=Pe,Pe==0&&setTimeout(function(){re[Re]===0&&$(De).removeClass("temp_shown")},1)})},ce=function(c){if(typeof c=="string"){var we=c.match(/^https?:\/\//);if(we instanceof Array&&we.length===1){var De=we[0].replace("://",""),Re=e.Status.getProtocol();if(De!=Re)switch(Re){case"https":c="https"+c.replace(De,"");break;case"http":break;default:break}}}return c},Ge=function(c){return typeof c!="string"||(c=ce(c)),c},lt=function(c){if(typeof c!="string")return c;c=ce(c);var we=e.Utils.getOptions();if(typeof we!="undefined"&&typeof we.escapp!="undefined"&&typeof we.escapp.endpoint=="string")try{var De=new URL(we.escapp.endpoint).hostname,Re=new URL(c).hostname;if(De===Re)return e.Utils.addParamToUrl(c,"escapp_preview",""+e.Status.isPreview())}catch(je){}return c};return{init:m,getOptions:f,getId:T,registerId:k,resetIds:D,deepMerge:V,fixScene:O,getOuterHTML:b,getSrcFromCSS:N,addFontSizeToStyle:M,getFontSizeFromStyle:K,getWidthFromStyle:X,getHeightFromStyle:te,getPixelDimensionsFromStyle:ne,addParamToUrl:S,removeParamFromUrl:R,getParamsFromUrl:h,removeHashFromUrlString:P,getScreenNumberFromHash:w,showDialog:U,showPNotValidDialog:J,isObseleteVersion:H,addTempShown:y,removeTempShown:ke,checkUrlProtocol:ce,checkWebUrl:Ge,checkReusablePuzzleInstanceUrl:lt}})(SceneMaker),SceneMaker.Utils.Loader=(function(e,r){var _=function(){},p=function(h){if(h.screens&&Array.isArray(h.screens))for(let N=0;N<h.screens.length;N++){var w=h.screens[N];if(w.hotspots&&Array.isArray(w.hotspots))for(let X=0;X<w.hotspots.length;X++){var P=w.hotspots[X];if(P.actions&&Array.isArray(P.actions))for(let te=0;te<P.actions.length;te++)s(P.actions[te])}}},s=function(h){if(h.actionType&&h.actionParams&&typeof h.actionParams=="object")switch(h.actionType){case"changeBackground":typeof h.actionParams.url=="string"&&m([h.actionParams.url]);break;case"playSound":typeof h.actionParams.url=="string"&&f([h.actionParams.url]);break;default:break}},m=function(h){for(let w=0;w<h.length;w++){const P=new Image;P.src=h[w]}},f=function(h){for(let w=0;w<h.length;w++){const P=new Audio;P.src=h[w],P.preload="auto"}},T=function(h,w){if(!(typeof h!="string"||typeof w!="function")){var P=document.getElementsByTagName("head")[0];if(P){var N=document.createElement("script");N.setAttribute("src",h),N.setAttribute("type","text/javascript");var X=!1,te=function(){X||typeof w=="function"&&(X=!0,w())},ne=function(){(this.readyState=="complete"||this.readyState=="loaded")&&te()};N.onreadystatechange=ne,N.onload=te,P.appendChild(N)}}},k,D=function(){b()||(k=Date.now(),$("#fancyLoad").trigger("click"))},V=function(h){var w=Date.now()-k;if(w<1250)setTimeout(function(){V(h)},Math.max(0,Math.min(1250-w,1250)));else{var P=!1,N=0;b()&&($.fancybox.close(),P=!0,N=800),typeof h=="function"&&setTimeout(function(){h(P)},N)}},O=function(){$("#fancybox-outer").css("background","rgba(255,255,255,0.9)"),$("#fancybox-wrap").css("margin-top","20px"),$("#fancybox-wrap").css("margin-left","20px")},b=function(){return $("#loading_fancy").is(":visible")},R=function(h,w){var P=document.createElement("img");$(P).addClass("loading_fancy_img"),$(P).attr("src",e.ImagesPath+"icon_loader.gif"),w&&w.style&&$(P).addClass(w.style);var N=document.createElement("div");$(N).addClass("loading_fancy"),$(N).append(P),$(h).html(""),$(h).append(N),$(h).addClass("loadingtmpShown")},S=function(h){$(h).find(".loading_fancy_img").parent().remove(),$(h).removeClass("loadingtmpShown")};return{init:_,preloadResources:p,loadScript:T,prepareFancyboxForFullLoading:O,startLoading:D,stopLoading:V,startLoadingInContainer:R,stopLoadingInContainer:S}})(SceneMaker),SceneMaker.Slides=(function(e,r,_){var p=function(){},s=function(){var S=e.View.getCurrentView();return typeof S=="undefined"||S===null?e.Screen.getCurrentScreen():S},m=function(){var S=e.View.getCurrentViewNumber();return typeof S!="undefined"?S:e.Screen.getCurrentScreenNumber()},f=function(S){var h=r(S),w=h.attr("id");return h.find("img.slide_background#"+w+"_background")},T=function(S){var h=f(S);return h.length>0?h.attr("src"):_},k=function(S,h){var w=r(S);if(w.attr("type")!==e.Constant.VIEW_CONTENT){var P=f(w);P.attr("src",h)}},D=function(S){return S&&S.tagName==="ARTICLE"||typeof S=="object"&&S.length===1&&S[0].tagName==="ARTICLE"?r(S).attr("type"):typeof S=="object"&&typeof S.type=="string"?S.type:null},V=function(S){var h;return typeof S=="string"?h=S:h=r(S).attr("type"),h===e.Constant.SCREEN},O=function(S){var h;return typeof S=="string"?h=S:h=r(S).attr("type"),h===e.Constant.VIEW_IMAGE||h===e.Constant.VIEW_CONTENT},b=function(S){var h=r("#"+S)[0];if(typeof h!="undefined"){if(document.createEvent){var w=document.createEvent("Event");w.initEvent("slideenter",!0,!0),h.dispatchEvent(w)}else if(document.createEventObject){var w=document.createEventObject();h.fireEvent("onslideenter",w)}}},R=function(S){var h=r("#"+S)[0];if(typeof h!="undefined"){if(document.createEvent){var w=document.createEvent("Event");w.initEvent("slideleave",!0,!0),h.dispatchEvent(w)}else if(document.createEventObject){var w=document.createEventObject();h.fireEvent("onslideleave",w)}}};return{init:p,getCurrentSlide:s,getCurrentSlideNumber:m,getSlideBackgroundImg:f,getSlideBackground:T,changeSlideBackground:k,getSlideType:D,isScreen:V,isView:O,triggerSlideEnterEvent:b,triggerSlideLeaveEvent:R}})(SceneMaker,jQuery),SceneMaker.Screen=(function(e,r,_){var p,s,m=function(){},f=function(){return p},T=function(H){p=H,r.each(p,function(W,re){r(re).attr("slidenumber",W+1)})},k=function(){var H=r("section.slides > article");T(H),H.removeClass("current"),r(R(s+1)).addClass("current")},D=function(){return p[s]},V=function(){return s+1},O=function(H){b(H-1)},b=function(H){s=H},R=function(H){var W=H-1;return W<0||W>=p.length?null:p[W]},S=function(){var H=e.Utils.getScreenNumberFromHash();O(H||1)},h=function(){return r("section.slides > article").length},w=function(H){var W=r(H).children("article.show_in_screen");if(W.length===1){var re=W[0],y=r(re).attr("id");e.Slides.triggerSlideEnterEvent(y)}},P=function(H){e.View.closeCurrentView()},N=function(H){te(1)},X=function(){te(-1)},te=function(H){var W=s+H+1;W=Math.min(Math.max(1,W),p.length),ne(W)},ne=function(H,W){W!==!0&&H===V()||H>p.length||H<=0||(!e.Editing&&r.fancybox&&r.fancybox.close(),e.View.closeCurrentView(),K(H))},K=function(H){var W=H-1;W<p.length&&W>=0&&(F(s+1),b(W),k(),U(s+1))},M=function(){ne(p.length)},J=function(H,W){},U=function(H){var W=e.Screen.getScreenWithNumber(H);W&&e.Slides.triggerSlideEnterEvent(W.id)},F=function(H){var W=e.Screen.getScreenWithNumber(H);W&&e.Slides.triggerSlideLeaveEvent(W.id)};return{init:m,getScreens:f,setScreens:T,updateScreens:k,getCurrentScreen:D,getCurrentScreenNumber:V,setCurrentScreenNumber:O,getScreenWithNumber:R,updateCurrentScreenFromHash:S,getScreensQuantity:h,onEnterScreen:w,onLeaveScreen:P,forwardOneScreen:N,backwardOneScreen:X,goToScreenWithNumber:ne,goToLastScreen:M,afterSetupSize:J,triggerScreenEnterEvent:U,triggerScreenLeaveEvent:F}})(SceneMaker,jQuery),SceneMaker.View=(function(e,r,_){var p=null,s=function(){},m=function(){return e.Editing?e.Editor.View.getCurrentView():p===null?null:r("#"+p)},f=function(){var b=m();if(typeof b=="undefined"||b===null)return _;var R=r(b).attr("slidenumber");if(typeof R=="string")try{return parseInt(R)}catch(S){return _}},T=function(b,R){return r(b).children("article[slidenumber='"+R+"']")},k=function(b){var R=b.target.id.substring(5);V(R)},D=function(b){var R=m();if(typeof R!="undefined"&&R!==null){var S=r(R).attr("id");if(b===S)return;V(S)}p=b,r("#"+b).removeClass("hide_in_screen"),r("#"+b).addClass("show_in_screen"),e.Slides.triggerSlideEnterEvent(b)},V=function(b){p=null,r("#"+b).removeClass("show_in_screen"),r("#"+b).addClass("hide_in_screen"),e.Slides.triggerSlideLeaveEvent(b)},O=function(){var b=m();typeof b!="undefined"&&b!==null&&V(r(b).attr("id"))};return{init:s,getCurrentView:m,getCurrentViewNumber:f,getViewWithNumber:T,onCloseViewClicked:k,openView:D,closeView:V,closeCurrentView:O}})(SceneMaker,jQuery),SceneMaker.Marker=(function(e,r,_){var p,s,m,f,T=function(){p={},s={},m={},f=e.ImagesPath+"hotspotgallery/hotspot.png"},k=function(){return f},D=function(N){var X=r("#"+N.id);if(typeof N.background=="string"){var te=N.id+"_background",ne=r("<img>",{id:te,class:"slide_background",src:N.background});X.append(ne)}if(Array.isArray(N.hotzones)&&N.hotzones.length>0)for(j in N.hotzones)O(X,N.hotzones[j]);if(Array.isArray(N.hotspots)&&N.hotspots.length>0)for(i in N.hotspots)V(X,N.hotspots[i]);typeof N.caption!="undefined"&&e.Caption.drawCaption(X,N.caption)},V=function(N,X){if(!(!X||!X.id)){var te=10;if(X.x&&X.y&&!(!X.width||X.width<=0)&&!(!X.height||X.height<=0)){typeof X.image!="string"&&(X.image=f);var ne=parseFloat(X.rotationAngle);(typeof ne!="number"||isNaN(ne)||ne<0||ne>360)&&(ne=0);var K="",M=X.visibility!=="hidden";M===!1&&(K+=" hotspot_hidden");var J=X.cursorVisibility==="pointer";J===!0&&(K+=" hotspot_cursor_pointer");var U=e.Slides.getSlideBackgroundImg(N),F=r("<img>",{src:X.image,class:"hotspot"+K,id:X.id,rotationAngle:ne,css:{position:"absolute",left:X.x+"%",top:X.y+"%",width:X.width+"%",height:X.height+"%",transform:"rotate("+ne+"deg)"}}).appendTo(U.parent());if(Array.isArray(X.actions)&&X.actions.length>0){F.addClass("hotspot_with_actions"),s[X.id]=X,F.on("click",function(){w(X.id)});for(i in X.actions)e.Actions.addActionToHotspot(F,X.actions[i])}}}},O=function(N,X){if(!(!X||!X.id)&&Array.isArray(X.points)){var te=N.attr("id"),ne=X.id,K=R(te),M=S(ne,X.points);K.addAnnotation(M),b(M.id,function(J){if(X.cursorVisibility==="pointer"&&r(J).attr("hotzone_cursor_visibility",X.cursorVisibility),X.enabled===!1?r(J).attr("hotzone_enabled","false"):r(J).attr("hotzone_enabled","true"),Array.isArray(X.actions)&&X.actions.length>0){m[ne]=X;for(i in X.actions)e.Actions.addActionToHotzone(J,X.actions[i])}})}},b=function(N,X){var te,ne=Date.now();function K(){var M=h(N);return M.length>0?(clearInterval(te),X(M),!0):(Date.now()-ne>=1e3&&clearInterval(te),!1)}setTimeout(function(){K()||(te=setInterval(K,200))},0)},R=function(N){if(typeof p[N]=="undefined"&&(p[N]={}),typeof p[N].annotator!="undefined")return p[N].annotator;var X=e.Slides.getSlideBackgroundImg(r("#"+N)),te=Annotorious.createImageAnnotator(X.attr("id"),{drawingEnabled:!1,userSelectAction:"SELECT",style:{fill:"#dddddd00",fillOpacity:0,stroke:"#00000000",strokeWidth:1}});return te.on("selectionChanged",function(ne){Array.isArray(ne)&&ne.length===1&&P(ne[0].id)}),p[N].annotator=te,te},S=function(N,X){var te=X.map(([H])=>H),ne=X.map(([,H])=>H),K=Math.min(...te),M=Math.max(...te),J=Math.min(...ne),U=Math.max(...ne),F={id:N,target:{selector:{type:"POLYGON",geometry:{bounds:{minX:K,minY:J,maxX:M,maxY:U},points:X}}}};return F},h=function(N){return r("g.[data-id='"+N+"']")},w=function(N){e.Actions.performActions(s[N].actions,N)},P=function(N){var X=h(N);r(X).attr("hotzone_enabled")!=="false"&&e.Actions.performActions(m[N].actions,m[N].idAlias)};return{init:T,getDefaultHotspotImg:k,getHotzoneDOM:h,drawSlideWithMarkers:D,createAnnotationFromPointsArray:S}})(SceneMaker,jQuery),SceneMaker.FullScreen=(function(e,r,_){var p,s,m,f=function(){T(),k()},T=function(){try{var K=e.Status.getContainer();if(typeof K!="undefined"){if(typeof r(K).attr("allowfullscreen")=="undefined")r(K).attr("allowfullscreen","true"),r(K).attr("webkitAllowFullScreen","true"),r(K).attr("mozallowfullscreen","true");else if(r(K).attr("allowfullscreen")==="false"){r(K).removeAttr("allowfullscreen"),r(K).removeAttr("webkitAllowFullScreen"),r(K).removeAttr("mozallowfullscreen");return}var M=ne();e.Status.getContainerType()==="OBJECT"&&(r(K).addClass("ScreenMakerFS"),r(M).addClass("ScreenMakerFS"),r(window.parent.document).find("head").append("<style>.ScreenMakerFS:full-screen, :full-screen > object.ScreenMakerFS {width: 100% !important;height: 100% !important;}</style>"),r(window.parent.document).find("head").append("<style>.ScreenMakerFS:-webkit-full-screen, :-webkit-full-screen > object.ScreenMakerFS {width: 100% !important;height: 100% !important;}</style>"),r(window.parent.document).find("head").append("<style>.ScreenMakerFS:-moz-full-screen, :-moz-full-screen > object.ScreenMakerFS {width: 100% !important;height: 100% !important;}</style>"))}}catch(J){}},k=function(){P()?r("#page-fullscreen").removeClass("fsoff").addClass("fson"):r("#page-fullscreen").removeClass("fson").addClass("fsoff")},D=function(){var K=document.createElement("div");return!!(K&&(K.requestFullScreen||K.mozRequestFullScreen||K.webkitRequestFullScreen||K.msRequestFullscreen))},V=function(){return!e.Editing&&O()},O=function(){return e.Status.getDevice().features.fullscreen&&b(te())},b=function(K){return K.fullscreenEnabled||K.mozFullScreenEnabled||K.webkitFullscreenEnabled||K.msFullscreenEnabled},R=function(){r(document).on("click","#page-fullscreen",S),r(te()).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(K){s=p,p=X(te()),m=new Date,k()})},S=function(){var K=te(),M=ne();P()?w(K):h(K,M)},h=function(K,M){M.requestFullscreen?M.requestFullscreen():M.mozRequestFullScreen?M.mozRequestFullScreen():M.webkitRequestFullscreen?(M.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT),setTimeout(function(){K.webkitCurrentFullScreenElement||M.webkitRequestFullScreen()},250)):M.msRequestFullscreen&&M.msRequestFullscreen()},w=function(K){K.exitFullscreen?K.exitFullscreen():K.cancelFullScreen?K.cancelFullScreen():K.mozCancelFullScreen?K.mozCancelFullScreen():K.webkitExitFullscreen?K.webkitExitFullscreen():K.webkitCancelFullScreen?K.webkitCancelFullScreen():K.msExitFullscreen&&K.msExitFullscreen()},P=function(){return e.Status.getContainerType()==="OBJECT"?N():r(X(te())).is("html")},N=function(){var K=X(te());return typeof K!="undefined"&&K!==null},X=function(K){return K.fullscreenElement||K.mozFullScreenElement||K.webkitFullscreenElement||K.msFullscreenElement},te=function(){return e.Status.getContainerType()=="OBJECT"?window.parent.document:document},ne=function(){return e.Status.getContainerType()==="OBJECT"?e.Status.getContainer().parentElement:document.documentElement};return{init:f,isFullScreenSupported:D,canFullScreen:V,enableFullScreen:R,isFullScreen:P}})(SceneMaker,jQuery),SceneMaker.Editor=(function(e,r,_){var p,s,m=!1,f,T,k,D,V=e.Constant.NONE,O=function(){b(e.getOptions())},b=function(oe){r("#waiting_overlay").show(),r("body").addClass("SceneMakerBody"),e.Editing=!0,e.Debugging.init(oe);var Fe;oe?(Fe=oe.scene,p=oe,oe.configuration&&e.Configuration&&e.Configuration.init(oe.configuration)):p={},Fe&&(m=!0),e.Utils.init(),e.I18n.init(p,Fe),e.Status.init(function(){R(oe,Fe)})},R=function(oe,Fe){if(e.ViewerAdapter.applyLanguageCSS(),e.I18n.translateUI(),e.Object.init(),e.Editor.Dummies.init(),e.EventsNotifier.init(),e.Screen.init(),e.Editor.Screen.init(),e.View.init(),e.Editor.View.init(),e.Marker.init(),e.Editor.Marker.init(),e.Editor.Actions.init(),e.Editor.Caption.init(),e.Renderer.init(),e.Slides.init(),e.User.init(oe),e.Video.init(),e.Audio.init(),e.Editor.Settings.init(),m){var Fe=e.Utils.fixScene(Fe);if(Fe===null){r("#waiting_overlay").hide(),e.Utils.showPNotValidDialog();return}s=Fe,e.Editor.Settings.loadSceneSettings(Fe),e.Editor.Renderer.init(Fe),ne(),S(oe,Fe)}else e.Editor.Settings.loadSceneSettings(),S(oe,Fe)},S=function(oe,Fe){if(m){var $e=e.Utils.getScreenNumberFromHash();$e?e.Screen.setCurrentScreenNumber($e):e.Screen.setCurrentScreenNumber(1)}if(e.Screen.updateScreens(),e.Editor.Thumbnails.drawScreenThumbnails(function(){e.Editor.Thumbnails.selectThumbnail(e.Screen.getCurrentScreenNumber()),e.Editor.Thumbnails.moveThumbnailsToScreenWithNumber(e.Screen.getCurrentScreenNumber())}),m&&r(".object_wrapper").hide(),e.Editor.Text.init(),e.Editor.Image.init(),e.Editor.Video.init(),e.Editor.Audio.init(),e.Editor.Object.init(),e.Editor.Thumbnails.init(),e.Editor.Preview.init(),e.Editor.Tools.init(),e.Editor.Clipboard.init(),e.Editor.Events.init(),e.Editor.Utils.Loader.unloadAllObjects(),e.Screen.getCurrentScreenNumber()>0&&e.Slides.triggerSlideEnterEvent(r(e.Screen.getCurrentScreen()).attr("id")),!m){var ut=e.Editor.Dummies.getDummy(e.Constant.SCREEN,{slideNumber:1});e.Editor.Screen.addScreen(ut),e.Screen.goToScreenWithNumber(1)}m||e.Editor.Settings.displaySettings(),window.focus(),r("#waiting_overlay").hide()},h=function(oe){var Fe=e.Screen.getCurrentScreen();if(e.Slides.isScreen(Fe)){var $e=r(oe.currentTarget).attr("type"),ut=e.Editor.Dummies.getDummy($e,{screenId:r(Fe).attr("id"),slideNumber:r(Fe).find("article").length+1});e.Editor.View.addView(Fe,ut),r.fancybox.close()}},w=function(oe){r(this).removeClass("editable"),Pe(r(this));var Fe=r("#menuselect").clone();r(Fe).removeAttr("id"),r(Fe).find("a").css("display","none").addClass("thumb_shown"),e.Editor.Tools.hideZoneToolTip(r(this).find(".zone_tooltip")),r(this).append(Fe),e.Editor.Events.addZoneThumbsEvents(this)},P=function(){Pe(r(this).parent());var oe={};oe.width=375,oe.height=135;var Fe=je(),$e=Fe.attr("type");($e==="audio"||$e==="object"&&Fe.attr("object_type")===e.Constant.MEDIA.YOUTUBE_VIDEO)&&($e="video"),oe.notificationIconSrc=e.ImagesPath+"thumbs/"+$e+".png",oe.text=e.I18n.getTrans("i.AreYouSureContent");var ut={};ut.text=e.I18n.getTrans("i.no"),ut.callback=function(){r.fancybox.close()};var mt={};mt.text=e.I18n.getTrans("i.delete"),mt.callback=function(){var kt=je();kt.html(""),kt.removeAttr("type"),kt.addClass("editable"),e.Editor.Tools.addTooltipToZone(kt),X(null),e.Editor.Slides.updateThumbnail(e.Slides.getCurrentSlide()),r.fancybox.close()},oe.buttons=[ut,mt],e.Utils.showDialog(oe)},N=function(oe){X(r(this)),oe.stopPropagation(),oe.preventDefault()},X=function(oe){Pe(oe),ne(),te(oe),e.Editor.Tools.loadToolsForZone(oe)},te=function(oe){r(oe).removeClass("zoneUnselected"),r(oe).addClass("zoneSelected")},ne=function(oe){oe?(r(oe).removeClass("zoneSelected"),r(oe).addClass("zoneUnselected")):(r(".zoneSelected").addClass("zoneUnselected"),r(".zoneSelected").removeClass("zoneSelected"))},K=function(oe){var Fe=r(oe.target),$e=r(Fe).parent();if(!r(Fe).hasClass("noSelectableElement")){if(r("#fancybox-content").is(":visible")||r(Fe).is("polygon")||r($e).hasClass("selectable")||r($e).hasClass("preventNoselectable")||jQuery.contains(r("#toolbar_wrapper")[0],oe.target)||oe.target.id==="toolbar_wrapper")return;var ut=!1;if(r(".cke_dialog").each(function(mt,kt){if(kt&&jQuery.contains(kt,oe.target))return ut=!0,!1}),ut)return}M()},M=function(){e.Editor.Tools.cleanZoneTool(je()),Pe(null),ne()},J=function(oe){oe.append("<div class='delete_content'></div>")},U=function(oe){var Fe=r(oe.target);oe.stopPropagation(),e.Slides.isScreen(Fe)?e.Editor.Screen.onEnterScreen(Fe):(e.Editor.Utils.Loader.loadObjectsInEditorSlide(Fe),setTimeout(function(){r(Fe).find(".object_wrapper").show()},500)),e.Editor.Thumbnails.selectThumbnail(e.Screen.getCurrentScreenNumber()),M(),e.Editor.Tools.loadToolsForSlide(Fe)},F=function(oe){var Fe=r(oe.target);oe.stopPropagation(),e.Slides.isScreen(Fe)?e.Editor.Screen.onLeaveScreen(Fe):(e.Editor.Utils.Loader.unloadObjectsInEditorSlide(Fe),r(".object_wrapper").hide())},H=function(){var oe={},Fe=e.Utils.getOptions();return oe=e.Editor.Settings.getSettings(),Fe&&typeof Fe.erId=="number"&&(oe.erId=Fe.erId),oe.screens=[],e.Editor.Utils.Loader.loadAllObjects(),r(".object_wrapper").show(),r("section.slides > article").each(function($e,ut){var mt={};e.Slides.isScreen(ut)&&(e.Utils.addTempShown(ut),mt=e.Editor.Marker.saveSlideWithMarkers(ut),mt.views=[],r(ut).find("article").each(function(kt,Ft){var Mt=W(Ft,oe,!0);mt.views.push(Mt)}),e.Utils.removeTempShown(ut),oe.screens.push(mt))}),e.Editor.Utils.Loader.unloadAllObjects(),e.Editor.Utils.Loader.loadObjectsInEditorSlide(e.Screen.getCurrentScreen()),e.Debugging.log(`

Scene Maker save the following scene:
`),e.Debugging.log(JSON.stringify(oe)),oe},W=function(oe,Fe){switch(r(oe).attr("type")){case e.Constant.VIEW_IMAGE:return re(oe,Fe);case e.Constant.VIEW_CONTENT:return y(oe,Fe)}},re=function(oe){e.Utils.addTempShown(oe);var Fe=e.Editor.Marker.saveSlideWithMarkers(oe);return e.Utils.removeTempShown(oe),Fe},y=function(oe,Fe){return slide={},slide.id=r(oe).attr("id"),slide.type=r(oe).attr("type"),slide.elements=[],e.Utils.addTempShown(oe),r(oe).find("div.view_content_zone").each(function($e,ut){var mt={};mt.id=r(ut).attr("id"),mt.type=r(ut).attr("type");var kt=r(ut).attr("elSettings");if(typeof kt=="string")try{mt.settings=JSON.parse(kt)}catch(Qt){}if(mt.type==e.Constant.TEXT){var Ft=e.Editor.Text.getCKEditorFromZone(ut);Ft!==null?mt.body=Ft.getData():mt.body=""}else if(mt.type==e.Constant.IMAGE)mt.body=r(ut).find("img").attr("src"),mt.style=e.Editor.Utils.getStylesInPercentages(r(ut),r(ut).find("img")),r(ut).attr("hyperlink")&&(mt.hyperlink=r(ut).attr("hyperlink"));else if(mt.type==e.Constant.VIDEO){var Mt=r(ut).find("video"),Lt=r(Mt).attr("poster");typeof Lt=="string"&&(mt.poster=Lt),mt.style=e.Editor.Utils.getStylesForFitContent();var Nt="";r(Mt).find("source").each(function(Qt,vn){Qt!==0&&(Nt=Nt+",");var le=e.Utils.removeParamFromUrl(r(vn).attr("src"),"timestamp"),se=typeof r(vn).attr("type")!="undefined"?', "type": "'+r(vn).attr("type")+'"':"";Nt=Nt+'{"src":"'+le+'"'+se+"}"}),Nt="["+Nt+"]",mt.sources=Nt}else if(mt.type==e.Constant.AUDIO){var rt=r(ut).find("audio");mt.style=e.Editor.Utils.getStylesForFitContent();var Nt="";r(rt).find("source").each(function(vn,le){vn!==0&&(Nt=Nt+",");var se=e.Utils.removeParamFromUrl(r(le).attr("src"),"timestamp"),Le=typeof r(le).attr("type")!="undefined"?', "type": "'+r(le).attr("type")+'"':"";Nt=Nt+'{"src":"'+se+'"'+Le+"}"}),Nt="["+Nt+"]",mt.sources=Nt}else if(mt.type===e.Constant.OBJECT){var vt=r(ut).find(".object_wrapper")[0],tn=r(vt).children()[0],Yt=r(tn).clone();Yt.removeAttr("style");var Jt=e.Utils.removeParamFromUrl(Yt.attr("src"),"escapp_preview");Yt.attr("src",Jt),mt.body=e.Utils.getOuterHTML(Yt),mt.style=e.Editor.Utils.getStylesForFitContent(),mt.subtype=e.Object.getObjectInfo(Yt).type}else mt.type;slide.elements.push(mt)}),e.Utils.removeTempShown(oe),slide},ke=function(oe,Fe,$e,ut){if(e.Debugging.isDevelopping()){f=JSON.stringify(oe),setTimeout(function(){$e()},5e3);return}var mt=typeof f=="undefined"&&!m,kt;mt?kt="POST":kt="PUT";var Ft={};typeof e.User.getToken()!="undefined"&&(Ft.authenticity_token=e.User.getToken());var Mt=JSON.stringify(oe);Ft["scene[json]"]=Mt,r.ajax({type:kt,url:e.UploadScenePath,data:Ft,success:function(Lt){f=Mt,mt&&typeof Lt!="undefined"&&Lt.uploadPath&&(e.UploadScenePath=e.Utils.checkUrlProtocol(Lt.uploadPath),e.Status.getDevice().features.historypushState&&window.top.history.replaceState("","",e.UploadScenePath)),typeof $e=="function"&&$e(Lt)},error:function(Lt,Nt){typeof ut=="function"&&ut()}})},ce=function(){if(e.Screen.getScreens().length===0){var oe={};oe.width=600,oe.height=150,oe.text=e.I18n.getTrans("i.NoSlidesOnSaveNotification");var Fe={};Fe.text=e.I18n.getTrans("i.Ok"),Fe.callback=function(){r.fancybox.close()},oe.buttons=[Fe],e.Utils.showDialog(oe);return}var $e=H();const ut=JSON.stringify($e,null,2),mt=new Blob([ut],{type:"application/json"}),kt=URL.createObjectURL(mt),Ft=document.createElement("a");Ft.href=kt,Ft.download=e.Editor.Utils.toPascalCase($e.title)+"_"+e.Editor.Utils.getDateISO()+".json",document.body.appendChild(Ft),Ft.click(),document.body.removeChild(Ft),URL.revokeObjectURL(Ft)},Ge=async function(){const Fe=r("#import_file_input")[0].files[0];if(!Fe||!Fe.name.endsWith(".json"))return we(!1),!1;let $e;try{const ut=await Fe.text();$e=JSON.parse(ut)}catch(ut){return we(!0),!1}if($e){if($e=e.Utils.fixScene($e),$e===null)return we(!0),!1;r.fancybox.close(),r('article[type="'+e.Constant.SCREEN+'"]').remove(),e.Editor.Marker.resetData(),e.Utils.resetIds(),p.scene=$e,b(p)}},lt=function(){r("#importSceneFancybox").trigger("click")},c=function(oe){const Fe=oe.target,$e=Fe.files[0];if($e){if(!$e.name.endsWith(".json"))return Fe.value="",we(!1);r("#import_file_button").show()}},we=function(oe){var Fe={};Fe.width=650,Fe.height=220,oe===!0?Fe.text=e.I18n.getTrans("i.WrongResource"):Fe.text=e.I18n.getTrans("i.WrongImportedFile");var $e={};$e.text=e.I18n.getTrans("i.Ok"),$e.callback=function(){r.fancybox.close()},Fe.buttons=[$e],e.Utils.showDialog(Fe)},De=function(){return p},Re=function(){var oe=je();if(typeof oe!="undefined"&&oe!==null)return"ZONE";var Fe=e.Editor.Marker.getCurrentHotspot();if(typeof Fe!="undefined"&&Fe!==null)return"HOTSPOT";var $e=e.Editor.Marker.getCurrentHotzoneId();return typeof $e!="undefined"&&$e!==null?"HOTZONE":"NONE"},je=function(){return T||null},Pe=function(oe){r(oe).attr("id")!=r(T).attr("id")&&(k=T,T=oe)},qe=function(){return k||null},ft=function(){return D},Ot=function(oe){D=oe},Kt=function(oe){return oe&&r(oe).find(".delete_content").length===0},Zt=function(){return V},zt=function(oe){V=oe},me=function(){try{var oe;if(typeof f!="undefined")oe=f;else if(typeof s!="undefined")oe=JSON.stringify(s);else return!0;var Fe=e.Editor.saveScene();return oe!==JSON.stringify(Fe)}catch($e){return!0}};return{init:O,getOptions:De,getCurrentElementType:Re,getCurrentArea:je,setCurrentArea:Pe,selectContentZone:X,getLastArea:qe,cleanArea:M,getCurrentContainer:ft,setCurrentContainer:Ot,getContentAddMode:Zt,setContentAddMode:zt,isZoneEmpty:Kt,saveScene:H,sendScene:ke,exportSceneToJSON:ce,importSceneFromJSON:Ge,importSceneFromJSONFancybox:lt,onImportFileChange:c,onSlideEnterEditor:U,onSlideLeaveEditor:F,onViewThumbClicked:h,onEditableClicked:w,onSelectableClicked:N,onNoSelectableClicked:K,onDeleteItemClicked:P,addDeleteButton:J,hasSceneChanged:me}})(SceneMaker,jQuery),SceneMaker.Editor.Slides=(function(e,r,_){var p=function(){var O=e.Slides.getCurrentSlide();e.Slides.isView(O)?e.Editor.View.removeView(O):e.Editor.Screen.removeScreen(O)},s=function(O){var b=e.Editor.Thumbnails.getThumbnailForSlide(O),R=e.Editor.Thumbnails.getThumbnailURLForSlide(O);r(b).error(function(S){m(O,b,e.Editor.Thumbnails.getDefaultThumbnailURLForSlide(O))}),m(O,b,R)},m=function(O,b,R){e.Slides.isScreen(O)&&r("#screen_selected > img").attr("src",R),r(b).attr("src",R)},f=function(){return!(r(".wysiwygInstance").is(":focus")||r("#fancybox-content").is(":visible")||r("input").is(":focus")||e.Editor&&e.Editor.getCurrentArea()!==null)},T=function(O,b){var R=r(O);if(R.attr("type")!==e.Constant.VIEW_CONTENT){var S=e.Slides.getSlideBackgroundImg(R);if(S.length===0){var h=R.attr("id")+"_background";S=r("<img>",{id:h,class:"slide_background"}),R.append(S)}S.attr("src",b),r(O).find("div.change_bg_button").hide(),e.Editor.Slides.updateThumbnail(O),e.Editor.Tools.loadToolsForSlide(O)}r.fancybox.close()},k=function(O){var b={};return r(O).find("div[type='text']").each(function(R,S){var h=r(S).attr("id"),w=e.Editor.Text.getCKEditorFromZone(S);h&&w!==null&&(b[h]=w.getData())}),b},D=function(O,b,R){R!==!0&&(R=!1);var S=r(O).find("article[type='"+e.Constant.VIEW_CONTENT+"']");e.Utils.addTempShown(O),e.Utils.addTempShown(S),r(O).find("div[type='text']").each(function(h,w){var P;if(R?P=r(w).attr("copyid"):P=r(w).attr("id"),P&&b[P]){var N=b[P];e.Editor.Text.launchTextEditor({},r(w),N)}}),e.Utils.removeTempShown(S),e.Utils.removeTempShown(O)},V=function(O){r(O).find("div[type='text'],div.wysiwygTextArea").each(function(b,R){r(R).html("")})};return{removeCurrentSlide:p,updateThumbnail:s,isSlideFocused:f,setSlideBackground:T,copyTextAreasOfSlide:k,loadTextAreasOfSlide:D,cleanTextAreasOfSlide:V}})(SceneMaker,jQuery),SceneMaker.Editor.Dummies=(function(e,r){var _=function(){},p=function(b,R){switch(b){case e.Constant.SCREEN:return typeof R.screenId=="undefined"&&(R.screenId=e.Utils.getId("article")),s(R);case e.Constant.VIEW_IMAGE:return typeof R.viewId=="undefined"&&(R.viewId=e.Utils.getId(R.screenId+"_article")),m(R);case e.Constant.VIEW_CONTENT:return typeof R.viewId=="undefined"&&(R.viewId=e.Utils.getId(R.screenId+"_article")),f(R)}},s=function(b){var R="<article id='article_id_to_change' type='"+e.Constant.SCREEN+"' slidenumber='slidenumber_to_change'><div class='change_bg_button'></div></article>";return O(R,b.slideNumber,b.screenId)},m=function(b){var R="<article id='article_id_to_change' type='"+e.Constant.VIEW_IMAGE+"' slidenumber='slidenumber_to_change'><div class='change_bg_button'></div></article>";return O(R,b.slideNumber,b.viewId)},f=function(b){var R="<article id='article_id_to_change' type='"+e.Constant.VIEW_CONTENT+"' slidenumber='slidenumber_to_change'><div id='div_id_to_change' class='view_content_zone editable selectable'></div></article>";return O(R,b.slideNumber,b.viewId,b.zoneIds)},T=function(b,R){switch(b.type){case e.Constant.SCREEN:return k(b,R);case e.Constant.VIEW_IMAGE:return D(b,R);case e.Constant.VIEW_CONTENT:return V(b,R)}},k=function(b,R){return R.screenId=b.id,s(R)},D=function(b,R){return R.viewId=b.id,m(R)},V=function(b,R){R.viewId=b.id;var S=[];for(el in b.elements)S.push(b.elements[el].id);R.zoneIds=S;var h=f(R);return h=h.replace(/editable /g,""),h},O=function(b,R,S,h){var w=b,P=0;if(typeof S!="undefined")e.Utils.registerId(S);else return;for(w.indexOf("article_id_to_change")!=-1&&(w=w.replace("article_id_to_change",S)),w.indexOf("slidenumber_to_change")!=-1&&(w=w.replace("slidenumber_to_change",R));w.indexOf("div_id_to_change")!=-1;){if(h){var N=h[P];P++,e.Utils.registerId(N)}else var N=e.Utils.getId(S+"_zone");w=w.replace("div_id_to_change",N)}return w};return{init:_,getDummy:p,getScaffoldForSlide:T}})(SceneMaker),SceneMaker.Editor.Renderer=(function(e,r,_){var p,s=function(b){p=!1,m(b)},m=function(b){p=!0;for(var R=b.screens,S=0;S<R.length;S++)f(R[S]);p=!1},f=function(b){var R={};R.slideNumber=e.Screen.getScreensQuantity()+1,R.screenId=b.id.toString();var S=e.Editor.Dummies.getScaffoldForSlide(b,R);if(S){e.Editor.Screen.appendScreen(S),e.Screen.updateScreens(),e.Screen.goToLastScreen();var h=r(S).attr("id"),w=r("#"+h),P=b.views;if(P)for(var N=P.length,X=0;X<N;X++){var te=P[X];T(te,{screenDOM:w,slideNumber:X+1})}e.Editor.Marker.drawSlideWithMakers(b,w)}},T=function(b,R){b.type===e.Constant.VIEW_CONTENT?V(b,R):b.type===e.Constant.VIEW_IMAGE&&D(b,R)},k=function(b,R){var S=e.Editor.Dummies.getScaffoldForSlide(b,{slideNumber:R.slideNumber});e.Editor.View.appendView(R.screenDOM,S)},D=function(b,R){k(b,R);var S=r("#"+b.id);e.Editor.Marker.drawSlideWithMakers(b,S)},V=function(b,R){k(b,R);var S=r("#"+b.id);e.Utils.addTempShown(S);for(var h=b.elements.length,w=0;w<h;w++){var P=b.elements[w],N=P.id,X=r("div#"+N);if(X.length!==0){if(P.settings){var te=JSON.stringify(P.settings);r(X).attr("elSettings",te)}if(P.type===e.Constant.TEXT)e.Editor.Text.launchTextEditor({},X,P.body);else if(P.type===e.Constant.IMAGE)e.Editor.Image.drawImage(P.body,X,P.style,P.hyperlink,P.options);else if(P.type===e.Constant.VIDEO){var ne=[];typeof P.poster=="string"&&(ne.poster=P.poster),ne.autoplay=P.autoplay,e.Editor.Video.HTML5.drawVideo(e.Video.HTML5.getSourcesFromJSON(P),ne,X,P.style)}else if(P.type===e.Constant.AUDIO){var ne=[];ne.autoplay=P.autoplay,e.Editor.Audio.HTML5.drawAudio(e.Audio.HTML5.getSourcesFromJSON(P),ne,X,P.style)}else P.type===e.Constant.OBJECT&&e.Editor.Object.drawObject(P.body,{area:X,style:P.style});var K=!0;e.Editor.isZoneEmpty(X)&&(K=!1,r(X).addClass("editable")),e.Editor.Tools.addTooltipToZone(X,K)}}e.Utils.removeTempShown(S)},O=function(){return p};return{init:s,isRendering:O}})(SceneMaker,jQuery),SceneMaker.Editor.Carousel=(function(e,r,_){var p=function(h,w){if(h){var P=1,N=5,X=null,te="",ne="",K=null,M=790,J=!1,U=!0,F=!1,H=null;w&&(w.rows&&(P=w.rows),w.rowItems&&(N=w.rowItems),w.scrollItems&&(X=w.scrollItems),w.styleClass&&(te=w.styleClass),w.titleClass&&(ne=w.titleClass),w.callback&&(K=w.callback),w.width&&(M=w.width),w.startAtLastElement&&(J=w.startAtLastElement),typeof w.pagination=="boolean"&&(U=w.pagination),typeof w.sortable=="boolean"&&(F=w.sortable),w.afterCreateCarruselFunction&&(H=w.afterCreateCarruselFunction));var W=P>1,re="";if(te&&(re="_"+te),X||(X=N),W)var y="multiple_row"+re;else var y="single_row"+re;var ke=r("#"+h);ke.attr("class","image_carousel image_carousel_"+y),ke.removeAttr("id");var ce=document.createElement("div");r(ce).html(r(ke).html()),r(ke).html(""),ce.setAttribute("id",h);var Ge=document.createElement("div");Ge.setAttribute("class","clearfix");var lt=document.createElement("a"),c=document.createElement("a");if(lt.setAttribute("class","prev"),c.setAttribute("class","next"),r(lt).addClass("prev_"+y),r(c).addClass("next_"+y),lt.setAttribute("href","#"),c.setAttribute("href","#"),lt.setAttribute("id","carousel_prev"+h),c.setAttribute("id","carousel_next"+h),r(lt).html("<span>prev</span>"),r(c).html("<span>next</span>"),r(ke).append(Ge),r(ke).append(lt),r(ke).append(c),U){var we=document.createElement("div");we.setAttribute("class","pagination pagination_"+y),we.setAttribute("id","carousel_pag"+h),r(ke).append(we)}if(r(ce).children().addClass("carousel_element_"+y),r(ce).children().each(function(Re,je){r(je).children().addClass("carousel_element_"+y)}),K&&typeof K=="function"&&r(ce).children().click(function(Re){K(Re)}),W)s(h,ke,ce,P,N,X,y,M,H);else{if(r(ke).prepend(ce),J)var De=r(ce).children().length-N+1;else var De=0;T(h,h,P,[],N,X,M,De,function(){U&&V(h),F&&r("#"+h).sortable(),typeof H=="function"&&H()})}}},s=function(h,w,P,N,X,te,ne,K,M){var J=[],U=0,F;for(F=0;F<N;F++)window[P.id+"_row"+F]=document.createElement("div"),window[P.id+"_row"+F].setAttribute("id",P.id+"_row"+F),window[P.id+"_row"+F].setAttribute("class","carousel_wrapper_"+ne),F!=0&&J.push(P.id+"_row"+F);for(r(P).children().each(function(W,re){r(window[P.id+"_row"+W%N]).append(re)}),F=N-1;F>=0;F--)if(r(w).prepend(window[P.id+"_row"+F]),F==0){var H=P.id+"_row"+F;T(H,h,N,J,X,te,K,null,function(){U++,m(U,N,M)})}else f(P.id+"_row"+F,X,te,K,function(){U++,m(U,N,M)})},m=function(h,w,P){h===w&&typeof P=="function"&&P()},f=function(h,w,P,N,X){r("#"+h).carouFredSel({auto:!1,circular:!1,infinite:!1,width:N,scroll:{items:P,fx:"scroll",duration:1e3,timeoutDuration:2e3},items:{visible:{min:w,max:w}},onCreate:X})},T=function(h,w,P,N,X,te,ne,K,M){if(K||(K=0),r("#"+h).carouFredSel({circular:!1,infinite:!1,auto:!1,width:ne,scroll:{items:te,duration:1e3,timeoutDuration:2e3},items:{visible:{min:X,max:X},start:K},prev:{button:"#carousel_prev"+w},next:{button:"#carousel_next"+w},pagination:"#carousel_pag"+w,onCreate:M}),N){var J="";r(N).each(function(U,F){U!=0&&(J=J+", "),J=J+"#"+F}),r("#"+h).trigger("configuration",["synchronise",J])}r("#"+h).attr("rows",P)},k=function(h){r("#"+h).html("");var w=h+"_row0";if(r("#"+w).attr("rows")){var P=r("#"+w).attr("rows"),N;for(N=0;N<P;N++)D(h+"_row"+N);r("#"+w).attr("id",h)}else D(h)},D=function(h){var w=r("#"+h).parent().parent();r(w).hasClass("image_carousel")&&(r(w).removeClass(),r(w).html(""),r(w).attr("id",h))},V=function(h){var w=r("#"+h).parent().parent();r(w).hasClass("image_carousel")&&r(w).find(".pagination").attr("style","")},O=function(h,w){r(w).is("IMG")&&(w=r(w).parent()),r("#"+h).trigger("slideTo",w)},b=function(h,w){r("#"+h).trigger("next",w)},R=function(h,w){r("#"+h).trigger("prev",w)},S=function(h,w,P){r("#"+h).trigger("insertItem",[w,P])};return{createCarousel:p,cleanCarousel:k,goToElement:O,advanceCarousel:b,backCarousel:R,insertElement:S}})(SceneMaker,jQuery),SceneMaker.Editor.Scrollbar=(function(e,r,_){var p=function(f,T){if(f){var k=null,D=!1;T&&(T.callback&&(k=T.callback),T.horizontalScroll&&(D=T.horizontalScroll));var V=r("#"+f);r(V).mCustomScrollbar({scrollInertia:0,autoDraggerLength:!0,horizontalScroll:D}),r(V).find(".mCSB_container").css("margin-right","5px"),setTimeout(function(){r(V).mCustomScrollbar("update"),setTimeout(function(){T&&T.scrollTop===!0||r(V).mCustomScrollbar("scrollTo","bottom"),typeof k=="function"&&k()},150)},100)}},s=function(f){var T=r("#"+f);r(T).html(""),r(T).removeClass()},m=function(f,T){var k=r(T).attr("id"),D=typeof k=="string";if(!D){var V=e.Utils.getId("tmp");r(T).attr("id",V),k=V}r("#"+f).mCustomScrollbar("scrollTo","#"+k),D||r(T).removeAttr("id",V)};return{createScrollbar:p,cleanScrollbar:s,goToElement:m}})(SceneMaker,jQuery),SceneMaker.Editor.Video=(function(e,r,_){var p=!1,s=null,m=e.Constant.NONE,f="tab_video_from_url_content",T=function(){if(!p){p=!0,e.Editor.Video.HTML5.init();var S=r("#"+f).find("input");r("#tab_video_from_url_content .previewButton").click(function(h){e.Validator.validateObject(r(S).val())?(s=e.Editor.Utils.autocompleteUrls(r(S).val()),e.Editor.Object.drawPreview("tab_video_from_url_content",s)):s=null})}},k=function(S){r("#tab_video_from_url_content").find("input").val(""),e.Editor.Object.resetPreview("tab_video_from_url_content")},D=function(S){S&&(s=S,V())},V=function(){switch(m){case e.Constant.EVIDEO:e.Editor.EVideo.onVideoSelected(s);break;default:e.Editor.Object.drawPreviewObject(s)}m=e.Constant.NONE},O=function(){return m},b=function(S){switch(e.Editor.Utils.hideNonDefaultTabs(),S){case e.Constant.NONE:break;case e.Constant.EVIDEO:r("#tab_audio_soundcloud").hide();break}m=S},R=function(){var S="tab_video_from_url";return e.Configuration.getConfiguration().Youtube&&(S="tab_video_youtube"),S};return{init:T,onLoadTab:k,addVideo:D,addContent:V,getAddContentMode:O,setAddContentMode:b,getDefaultTab:R}})(SceneMaker,jQuery),SceneMaker.Editor.Audio=(function(e,r,_){var p=function(){e.Editor.Audio.HTML5.init()};return{init:p}})(SceneMaker,jQuery),SceneMaker.Editor.Audio.HTML5=(function(e,r,_){var p=function(){},s=function(D){var V=e.Audio.HTML5.getSources(D);if(V.length>0){var O={};O.timestamp=!0,f(V,O)}},m=function(D){var V={};V.timestamp=!0,f([{src:D}],V)},f=function(D,V,O,b){var R;O?R=O:R=e.Editor.getCurrentArea(),R.attr("type","audio");var S=!1;V&&V.autoplay&&(S=V.autoplay);var h=document.createElement("audio");h.setAttribute("class","view_content_audio"),h.setAttribute("controls","controls"),h.setAttribute("preload","metadata"),h.setAttribute("autoplayonslideenter",S),b&&h.setAttribute("style",b),r(R).html(""),r(R).append(h),e.Audio.HTML5.addSourcesToAudioTag(D,h,{timestamp:!0}),e.Editor.addDeleteButton(r(R)),e.Editor.Tools.loadToolsForZone(R)},T=function(D,V){var O=e.Audio.HTML5.getSources(D);if(O.length>0){var V=V||{};return e.Audio.HTML5.renderAudioFromSources(O,V)}},k=function(D,V){return e.Audio.HTML5.renderAudioFromSources([{src:D}],V)};return{init:p,drawAudioWithWrapper:s,drawAudioWithUrl:m,drawAudio:f,renderAudioFromWrapper:T,renderAudioWithURL:k}})(SceneMaker,jQuery),SceneMaker.Editor.Video.HTML5=(function(e,r,_){var p=function(){},s=function(D){var V=e.Video.HTML5.getSources(D);if(V.length>0){var O={},b=e.Video.HTML5.getPoster(D);typeof b=="string"&&(O.poster=b),O.timestamp=!0,f(V,O)}},m=function(D){var V={};V.timestamp=!0,f([{src:D}],V)},f=function(D,V,O,b){var R;O?R=O:R=e.Editor.getCurrentArea(),R.attr("type","video");var S,h=!1;V&&(V.poster&&(S=V.poster),V.autoplay&&(h=V.autoplay));var w=document.createElement("video");w.setAttribute("class","view_content_video"),w.setAttribute("controls","controls"),w.setAttribute("preload","metadata"),typeof S=="string"&&w.setAttribute("poster",S),w.setAttribute("autoplayonslideenter",h),b&&w.setAttribute("style",b),r(R).html(""),r(R).append(w),e.Video.HTML5.addSourcesToVideoTag(D,w,{timestamp:!0}),e.Editor.addDeleteButton(r(R)),e.Editor.Tools.loadToolsForZone(R)},T=function(D,V){var O=e.Video.HTML5.getSources(D);if(O.length>0){var V=V||{},b=e.Video.HTML5.getPoster(D);return typeof b=="string"&&(V.poster=b),e.Video.HTML5.renderVideoFromSources(O,V)}},k=function(D,V){return e.Video.HTML5.renderVideoFromSources([{src:D}],V)};return{init:p,drawVideoWithUrl:m,drawVideo:f,drawVideoWithWrapper:s,renderVideoFromWrapper:T,renderVideoWithURL:k}})(SceneMaker,jQuery),SceneMaker.Editor.Video.Youtube=(function(e,r,_){var p=function(T){var k=e.Video.Youtube.getYoutubeIdFromURL(T);return k!=null?s(k):"Youtube Video ID can't be founded."},s=function(T){var k="https://www.youtube.com/embed/"+T,D="<iframe src='"+k+"' frameborder='0'></iframe>";return D},m=function(T){var k=e.Video.Youtube.getYoutubeIdFromURL(T);return k!=null?f(k):"<p class='objectPreview'>Youtube Video ID can't be founded.</p>"},f=function(T){var k="https://www.youtube.com/embed/"+T;k=e.Utils.addParamToUrl(k,"wmode","opaque");var D='<iframe class="objectPreview" src="'+k+'" frameborder="0"></iframe>';return D};return{generateWrapperForYoutubeVideoUrl:p,generatePreviewWrapperForYoutubeVideoUrl:m}})(SceneMaker,jQuery),SceneMaker.Editor.Image=(function(e,r,_){var p=!1,s=null,m=e.Constant.NONE,f="tab_pic_from_url_content",T="picture_url",k=function(){p||(p=!0,r("#"+f+" .previewButton").click(function(h){var w=r("#"+T).val();if(e.Validator.validateObject(w)){var P=e.Object.getObjectInfo(w).source;P!==null&&(s=e.Editor.Utils.autocompleteUrls(P),e.Editor.Object.drawPreview(f,s,{contentAddMode:m}))}}))},D=function(h){h=="url"&&V()},V=function(){if(m===e.Constant.SCREEN){var h=r(e.Slides.getCurrentSlide()),w=e.Slides.getSlideBackground(h);if(typeof w=="string"){r("#"+T).val(w),r("#"+f+" .previewButton").trigger("click"),r("#"+f+" .previewimgbox button").hide();return}}s=null,e.Editor.Object.resetPreview(f),r("#"+T).val("")},O=function(){switch(m){case e.Constant.SCREEN:e.Editor.Slides.setSlideBackground(e.Slides.getCurrentSlide(),s);break;default:e.Editor.Object.drawPreviewObject(s,{forceType:e.Constant.MEDIA.IMAGE})}m=e.Constant.NONE},b=function(h,w,P,N,X){var te,ne=!1;if(w?(te=w,ne=!0):te=e.Editor.getCurrentArea(),!(typeof te=="undefined"||te===null)){var K;if(P)K=e.Editor.Utils.setStyleInPixels(P,te);else{var M=r(te).width();K="width:"+M+"px;"}var J=e.Utils.getId(),U="draggable"+J;if(te.attr("type","image"),N&&te.attr("hyperlink",N),te.html("<img class='view_content_image' id='"+U+"' draggable='true' title='Click to drag' src='"+h+"' style='"+K+"'/>"),!P){var F=r("#"+U);r(F).load(function(){e.Utils.addTempShown([r(te).parent(),r(te),r(F)]);var H=e.Editor.Utils.dimentionsToDraw(r(te).width(),r(te).height(),r(F).width(),r(F).height());e.Utils.removeTempShown([r(te).parent(),r(te),r(F)]),r(F).width(H.width),H.height>0&&r(F).height(H.height)})}e.Editor.addDeleteButton(te),r("#"+U).draggable({cursor:"move",stop:function(){r(this).parent().click()}}),ne===!1&&e.Editor.Slides.updateThumbnail(e.Slides.getCurrentSlide())}},R=function(){return m},S=function(h){e.Editor.Utils.hideNonDefaultTabs(),m=h};return{init:k,onLoadTab:D,drawImage:b,addContent:O,getAddContentMode:R,setAddContentMode:S}})(SceneMaker,jQuery),SceneMaker.Editor.Object=(function(e,r,_){var p=!1,s=null,m="tab_object_from_url_content",f="object_web_input",T,k=function(){p||(p=!0,e.Editor.Object.Web.init(),e.Editor.Object.GoogleDOC.init(),e.Editor.Object.PDF.init(),r("#"+m+" .previewButton").click(function(J){e.Validator.validateObject(r("#"+f).val())&&(s=e.Editor.Utils.autocompleteUrls(r("#"+f).val()),V(m,s))}),T=r('<a href="#objectSettings_fancybox" style="display:none"></a>'),r(T).fancybox({autoDimensions:!1,height:400,width:400,scrolling:"no",showCloseButton:!1,padding:0,onStart:function(J){K()},onComplete:function(J){},onClosed:function(J){}}))},D=function(){s=null,b(m),r("#"+f).val("")},V=function(J,U,F){r("#"+J+" .previewimgbox").css("background-image","none"),r("#"+J+" .previewimgbox img.imagePreview").remove(),r("#"+J+" .previewimgbox .objectPreview").remove();var H=r(w(U));r("#"+J+" .previewimgbox").append(H),O(U,H),r("#"+J+" .previewimgbox button").show()},O=function(J,U){var F=e.Object.getObjectInfo(J);if(F.wrapper===e.Constant.WRAPPER.VIDEO||F.wrapper===null&&F.type===e.Constant.MEDIA.HTML5_VIDEO){var H=typeof F.source=="object"?F.source:[{src:F.source}];e.Video.HTML5.addSourcesToVideoTag(H,U,{timestamp:!0})}else if(F.wrapper===e.Constant.WRAPPER.AUDIO||F.wrapper===null&&F.type===e.Constant.MEDIA.HTML5_AUDIO){var H=typeof F.source=="object"?F.source:[{src:F.source}];e.Audio.HTML5.addSourcesToAudioTag(H,U,{timestamp:!0})}},b=function(J){r("#"+J+" .previewimgbox button").hide(),r("#"+J+" .previewimgbox img.imagePreview").remove(),r("#"+J+" .previewimgbox .objectPreview").remove(),r("#"+J+" .previewimgbox").css("background-image","")},R=function(){S(s)},S=function(J,U){J&&(N(J,U),r.fancybox.close())},h=function(J,ke){var F=r("#"+J).parent(),H=r("#"+J).width()/r("#"+J).height(),W=Math.round(ke/H),re=Math.round(ke);r(F).width(re),r(F).height(W);var y=W,ke=re;r("#"+J).width(ke),r("#"+J).height(y)},w=function(J,U){var F=e.Object.getObjectInfo(J),H=F.type;if(U&&typeof U.forceType=="string"&&(H=U.forceType),H===e.Constant.MEDIA.REUSABLE_PUZZLE_INSTANCE)return e.Editor.Object.Web.generatePreviewWrapperForReusablePuzzleInstance(F.source);switch(F.wrapper){case null:switch(H){case e.Constant.MEDIA.IMAGE:return"<img class='imagePreview' src='"+J+"'></img>";case e.Constant.MEDIA.PDF:return e.Editor.Object.PDF.generatePreviewWrapper(J);case e.Constant.MEDIA.DOC:case e.Constant.MEDIA.PPT:return e.Editor.Object.GoogleDOC.generatePreviewWrapper(J);case e.Constant.MEDIA.YOUTUBE_VIDEO:return e.Editor.Video.Youtube.generatePreviewWrapperForYoutubeVideoUrl(J);case e.Constant.MEDIA.HTML5_VIDEO:return e.Editor.Video.HTML5.renderVideoWithURL(J,{loadSources:!1,extraClasses:["objectPreview"]});case e.Constant.MEDIA.HTML5_AUDIO:return e.Editor.Audio.HTML5.renderAudioWithURL(J,{loadSources:!1,extraClasses:["objectPreview"]});case e.Constant.MEDIA.WEB:return e.Editor.Object.Web.generatePreviewWrapperForWeb(J);default:e.Debugging.log("Unrecognized object source type")}break;case e.Constant.WRAPPER.IMAGE:return"<img class='imagePreview' src='"+F.source+"'></img>";case e.Constant.WRAPPER.EMBED:return P(J);case e.Constant.WRAPPER.OBJECT:return P(J);case e.Constant.WRAPPER.IFRAME:return P(J);case e.Constant.WRAPPER.VIDEO:return e.Editor.Video.HTML5.renderVideoFromWrapper(J,{loadSources:!1,extraClasses:["objectPreview"]});case e.Constant.WRAPPER.AUDIO:return e.Editor.Audio.HTML5.renderAudioFromWrapper(J,{loadSources:!1,extraClasses:["objectPreview"]});default:e.Debugging.log("Unrecognized object wrapper: "+F.wrapper);break}},P=function(J){var U=r(J);return r(U).addClass("objectPreview"),r(U).attr("wmode","opaque"),r(U).removeAttr("width"),r(U).removeAttr("height"),typeof r(U).attr("src")!="undefined"&&r(U).attr("src",e.Utils.checkWebUrl(r(U).attr("src"))),typeof r(U).attr("scrolling")!="undefined"&&r(U).attr("scrolling","auto"),U},N=function(J,U){if(e.Validator.validateObject(J)){U=typeof U=="undefined"?{}:U;var F=e.Object.getObjectInfo(J),H=e.Editor.getCurrentArea(),W="";if(U&&(U.area&&(H=U.area),U.style&&(W=U.style),U.forceType&&(F.type=U.forceType)),F.type===e.Constant.MEDIA.REUSABLE_PUZZLE_INSTANCE&&U.wrapperGenerated!==!0)return U.wrapperGenerated=!0,N(e.Editor.Object.Web.generateWrapperForReusablePuzzleInstance(F.source),U);switch(F.wrapper){case null:switch(F.type){case e.Constant.MEDIA.IMAGE:e.Editor.Image.drawImage(J);break;case e.Constant.MEDIA.PDF:return U.wrapperGenerated=!0,N(e.Editor.Object.PDF.generateWrapper(F.source),U);case e.Constant.MEDIA.DOC:case e.Constant.MEDIA.PPT:return N(e.Editor.Object.GoogleDOC.generateWrapper(J),U);case e.Constant.MEDIA.YOUTUBE_VIDEO:return N(e.Editor.Video.Youtube.generateWrapperForYoutubeVideoUrl(J),U);case e.Constant.MEDIA.HTML5_VIDEO:e.Editor.Video.HTML5.drawVideoWithUrl(J);break;case e.Constant.MEDIA.HTML5_AUDIO:e.Editor.Audio.HTML5.drawAudioWithUrl(J);break;case e.Constant.MEDIA.WEB:return N(e.Editor.Object.Web.generateWrapperForWeb(J),U);default:e.Debugging.log("Unrecognized object source type: "+F.type);break}break;case e.Constant.WRAPPER.IMAGE:e.Editor.Image.drawImage(F.source);break;case e.Constant.WRAPPER.EMBED:case e.Constant.WRAPPER.OBJECT:case e.Constant.WRAPPER.IFRAME:if([e.Constant.MEDIA.PDF].indexOf(F.type)!=-1&&!U.wrapperGenerated)return N(F.source,U);X(J,F.type,H,W);break;case e.Constant.WRAPPER.VIDEO:e.Editor.Video.HTML5.drawVideoWithWrapper(J);break;case e.Constant.WRAPPER.AUDIO:e.Editor.Audio.HTML5.drawAudioWithWrapper(J);break;default:e.Debugging.log("Unrecognized object wrapper: "+F.wrapper);break}e.Editor.Tools.loadToolsForZone(H)}},X=function(J,U,F,H){F.attr("type","object"),F.attr("object_type",U);var W=document.createElement("div");H&&W.setAttribute("style",H),r(W).addClass("object_wrapper");var re=r(J);r(re).css("pointer-events","none"),r(re).attr("class","view_content_object"),r(re).attr("wmode","opaque"),typeof r(re).attr("scrolling")!="undefined"&&r(re).attr("scrolling","auto"),r(F).html(""),r(F).append(W),e.Editor.addDeleteButton(r(F)),r(W).append(re),te(re,F),e.Editor.Tools.loadToolbarForObject(J)},te=function(J,U){var F=U.width(),H=U.height(),W=J.width(),re=J.height(),y=re/W;W>F&&(J.width(F),J.height(W*y),W=F,re=J.height()),re>H&&(J.height(H),J.width(re/y),W=J.width(),re=H);var ke=J.parent();r(ke).hasClass("object_wrapper")&&(r(ke).height(J.height()),r(ke).width(J.width()))},ne=function(){r(T).trigger("click")},K=function(){var J=r("#objectSettings_fancybox"),U=r(e.Editor.getCurrentArea()),F=U.find("div.object_wrapper").children().first(),H=F.attr("reusablepuzzleinstance")==="true";J.find("input[type='hidden'][name='elId']").val(U.attr("id"));var W={},re=H===!1,y=H;try{W=JSON.parse(U.attr("elSettings"))}catch(Ge){}typeof W.unloadObject!="undefined"&&(re=W.unloadObject),typeof W.addPreviewParamToObject!="undefined"&&(y=W.addPreviewParamToObject);var ke=J.find("input[type='checkbox'][name='unloadObject']");ke.prop("checked",re);var ce=J.find("input[type='checkbox'][name='addPreviewParamToObject']");ce.prop("checked",y),ce.attr("defaultvalue",H),e.Editor.Utils.enableElementSettingsField(ke,!0),e.Editor.Utils.enableElementSettingsField(ce,H===!1)},M=function(){var J=r("#objectSettings_fancybox"),U=J.find("input[type='hidden'][name='elId']").val(),F=r("#"+U),H=F.find("div.object_wrapper").children().first(),W={};try{W=JSON.parse(r(area).attr("elsettings"))}catch(ke){}W.unloadObject=J.find("input[type='checkbox'][name='unloadObject']").is(":checked"),W.addPreviewParamToObject=J.find("input[type='checkbox'][name='addPreviewParamToObject']").is(":checked");var re=JSON.stringify(W);F.attr("elSettings",re);var y=H.attr("src");W.addPreviewParamToObject?y=e.Utils.addParamToUrl(y,"escapp_preview",""+e.Status.isPreview()):y=e.Utils.removeParamFromUrl(y,"escapp_preview"),H.attr("src",y),r.fancybox.close()};return{init:k,onLoadTab:D,drawObject:N,renderObjectPreview:w,resizeObject:h,drawPreview:V,resetPreview:b,drawPreviewElement:R,drawPreviewObject:S,showObjectSettings:ne,onObjectSettingsDone:M}})(SceneMaker,jQuery),SceneMaker.Editor.Object.Web=(function(e,r,_){var p=function(){},s=function(k){return k=e.Utils.checkWebUrl(k),"<iframe src='"+k+"' wmode='opaque'></iframe>"},m=function(k){return k=e.Utils.checkReusablePuzzleInstanceUrl(k),"<iframe src='"+k+"' reusablepuzzleinstance='true' wmode='opaque'></iframe>"},f=function(k){return k=e.Utils.checkWebUrl(k),"<iframe class='objectPreview' src='"+k+"' wmode='opaque'></iframe>"},T=function(k){return k=e.Utils.checkReusablePuzzleInstanceUrl(k),f(k)};return{init:p,generatePreviewWrapperForWeb:f,generateWrapperForReusablePuzzleInstance:m,generateWrapperForWeb:s,generatePreviewWrapperForReusablePuzzleInstance:T}})(SceneMaker,jQuery),SceneMaker.Editor.Object.PDF=(function(e,r,_){var p=function(){},s=function(f){return e.Object.PDF.generateWrapper(f)},m=function(f){var T=e.Object.PDF.generateWrapper(f),k=r(T);return r(k).addClass("objectPreview"),e.Utils.getOuterHTML(k)};return{init:p,generateWrapper:s,generatePreviewWrapper:m}})(SceneMaker,jQuery),SceneMaker.Editor.Object.GoogleDOC=(function(e,r,_){var p=function(){},s=function(f){return e.Object.GoogleDOC.generateWrapper(f)},m=function(f){var T=e.Object.GoogleDOC.generateWrapper(f),k=r(T);return r(k).addClass("objectPreview"),e.Utils.getOuterHTML(k)};return{init:p,generatePreviewWrapper:m,generateWrapper:s}})(SceneMaker,jQuery),SceneMaker.Editor.Text=(function(e,r,_){var p=!1,s={},m=function(){p||(p=!0,r(document).on("click",".textthumb",f),CKEDITOR.on("dialogDefinition",function(S){var h=S.data.name,w=S.data.definition;switch(h){case"link":w.getContents("info").remove("linkType");var P=w.getContents("info").get("protocol").items;P.splice(3,1),P.splice(2,1),w.removeContents("advanced");var N=w.getContents("target"),K=N.get("linkTargetType");K.default="_blank",K.items.splice(6,1),K.items.splice(4,1),K.items.splice(1,1),K.items.splice(0,1);break;case"table":w.removeContents("advanced");var X=w.getContents("info"),te=X.get("cmbAlign");te.items.splice(0,1),te.default="center",X.remove("selHeaders");break;case"image":w.removeContents("advanced");var ne=w.getContents("Link"),K=ne.get("cmbTarget");K.default="_blank",K.items.splice(4,1),K.items.splice(2,1),K.items.splice(0,1);break;case"MediaEmbedDialog":break}}))},f=function(S,h,w,P){m();var N;h?N=h:N=r(this).parents(".selectable"),N.attr("type","text");var X=r("article").has(N),te=r("article > article").has(N);typeof r(N).attr("id")=="undefined"&&r(N).attr("id",e.Utils.getId("TmpShownId"));var ne=P&&P.disableTmpShown;ne||e.Utils.addTempShown(N);var K=r(N).height(),M=r(N).width();ne||e.Utils.removeTempShown(N);var J=e.Utils.getId(),U=r("<div id='"+J+"' class='wysiwygTextArea'></div>");r(U).attr("style","width: 100%; height: 100%"),r(N).append(U);var F={};F.toolbar="Full",F.toolbar_Full=[{name:"first",items:["Bold","Italic","Underline","-","Subscript","Superscript","Font","FontSize","TextColor","BGColor"]},"/",{name:"lists",items:["NumberedList","BulletedList","Table"]},{name:"alignment",items:["JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"link",items:["Link"]},{name:"Objects",items:["Image","MediaEmbed"]},{name:"symbols",items:["SpecialChar"]}],F.sharedSpaces={top:"toolbar_text"},F.toolbarCanCollapse=!1,F.resize_enabled=!1,F.removePlugins="elementspath",F.extraPlugins="tableresize,autogrow,specialchar,mediaembed",P&&P.autogrow&&(F.autoGrow_minHeight=34,F.autoGrow_maxHeight=800),F.specialChars=[],F.specialChars=F.specialChars.concat([["&alpha;","Alpha"]],[["&beta;","Beta"]],[["&gamma;","Gamma"]],[["&delta;","Delta"]],[["&epsilon;","Epsilon"]],[["&zeta;","Zeta"]],[["&eta;","Eta"]],[["&theta;","Theta"]],[["&iota;","Iota"]],[["&kappa;","Kappa"]],[["&lambda;","Lambda"]],[["&mu;","Mu"]],[["&nu;","Nu"]],[["&xi;","Xi"]],[["&omicron;","Omicron"]],[["&pi;","Pi"]],[["&rho;","Rho"]],[["&sigma;","Sigma"]],[["&tau;","Tau"]],[["&upsilon;","Upsilon"]],[["&phi;","Phi"]],[["&chi;","Chi"]],[["&psi;","Psi"]],[["&omega;","Omega"]],[["&divide;",""]],[["&radic;",""]],[["&bull;",""]],[["&middot;",""]],[["&plusmn;",""]],[["&frac14;",""]],[["&frac12;",""]],[["&frac34;",""]],[["&permil;",""]],[["&weierp;",""]],[["&image;",""]],[["&real;",""]],[["&forall;",""]],[["&part;",""]],[["&exist;",""]],[["&empty;",""]],[["&nabla;",""]],[["&isin;",""]],[["&notin;",""]],[["&ni;",""]],[["&prod;",""]],[["&sum;",""]],[["&minus;",""]],[["&lowast;",""]],[["&prop;",""]],[["&infin;",""]],[["&ang;",""]],[["&and;",""]],[["&or;",""]],[["&cap;",""]],[["&cup;",""]],[["&int;",""]],[["&cong;",""]],[["&asymp;",""]],[["&ne;",""]],[["&equiv;",""]],[["&le;",""]],[["&ge;",""]],[["&sub;",""]],[["&sup;",""]],[["&nsub;",""]],[["&sube;",""]],[["&supe;",""]],[["&oplus;",""]],[["&otimes;",""]],[["&perp;",""]],[["&lang;",""]],[["&rang;",""]],[["&lceil;",""]],[["&rceil;",""]],[["&lfloor;",""]],[["&rfloor;",""]],[["&fnof;",""]],[["&lsquo;",""]],[["&rsquo;",""]],[["&ldquo;",""]],[["&rdquo;",""]],[["&larr;",""]],[["&uarr;",""]],[["&darr;",""]],[["&rarr;",""]],[["&harr;",""]],[["&crarr;",""]],[["&lArr;",""]],[["&uArr;",""]],[["&dArr;",""]],[["&rArr;",""]],[["&hArr;",""]],[["&euro;","Euro"]],[["&cent;","Cent"]],[["&pound;","Pound"]],[["&yen;",""]],[["&curren;",""]],[["&brvbar;",""]],[["&sect;",""]],[["&copy;",""]],[["&reg;",""]],[["&ordf;",""]],[["&ordm;",""]],[["&deg;",""]],[["&laquo;",""]],[["&raquo;",""]],[["&not;",""]],[["&para;",""]],[["&loz;",""]],[["&spades;",""]],[["&clubs;",""]],[["&hearts;",""]],[["&diams;",""]],[["&dagger;",""]]),F.width="100%",F.height=K,F.fontSize_defaultLabel="12";var H=CKEDITOR.basePath.substr(0,CKEDITOR.basePath.indexOf("editor/"));F.skin="sceneMaker,"+H+"editor/skins/sceneMaker/";var W=typeof w!="string"||P&&P.forceNew;if(W){var re=36,y="center",ke="color:#000",ce=ke;P&&(typeof P.fontSize=="number"&&(re=P.fontSize),P.placeholder===!0&&(ke="color:#ccc")),w="<p style='text-align:"+y+";'><span autoColor='true' style='"+ke+"'><span style='font-size:"+re+"px;'>&shy</span></span></p>",initial_text_blank="<p style='text-align:"+y+";'><span autoColor='true' style='"+ce+"'><span style='font-size:"+re+"px;'>&shy</span></span></p>"}var Ge=CKEDITOR.appendTo(J,F),lt=M,c=K;W||(ne||e.Utils.addTempShown([X,te,N]),setTimeout(function(){s[Ge.name]!==!0?(s[Ge.name]=!1,ne||e.Utils.removeTempShown([X,te,N])):s[Ge.name]=_},6e3)),Ge.on("instanceReady",function(){w&&Ge.setData(w,function(){R(Ge),W&&Ge.focus(),P&&typeof P.callback=="function"&&P.callback()}),W||(typeof s[Ge.name]=="undefined"?(s[Ge.name]=!0,ne||e.Utils.removeTempShown([X,te,N])):s[Ge.name]=_),P&&typeof P.onKeyup=="function"&&P.placeholder!=!0&&Ge.document.on("keyup",function(we){P.onKeyup(N,Ge,we)}),!w&&P&&typeof P.callback=="function"&&P.callback()}),Ge.on("resize",function(we){}),Ge.on("focus",function(we){if(P&&P.placeholder===!0){var De=r(w).text().replace(/\s+/g,""),Re=r(we.editor.getData()).text().replace(/\s+/g,"");De==Re&&setTimeout(function(){we.editor.setData(initial_text_blank,function(){P&&typeof P.onKeyup=="function"&&Ge.document.on("keyup",function(Pe){P.onKeyup(N,Ge,Pe)})}),we.editor.focus()},20)}var je=k(we.editor.container.$);e.Editor.selectContentZone(je)}),Ge.getPlainText=b,e.Editor.addDeleteButton(N)},T=function(S){if(!S||typeof CKEDITOR=="undefined"||typeof CKEDITOR.instances=="undefined")return null;var h=null;return jQuery.each(CKEDITOR.instances,function(w,P){var N=k(P.container.$);if(r(N).attr("id")===r(S).attr("id")){h=P;return}}),h},k=function(S){return r("div[type='text']").has(S)},D=function(S){var h=T(S);return h?V(h):null},V=function(S){var h=r(document.getElementById("cke_contents_"+S.name)).find("iframe")[0];return r(h).contents()[0]},O=function(S){if(!S||typeof CKEDITOR=="undefined"||typeof CKEDITOR.instances=="undefined")return null;r(S).hasClass(".cke_skin_sceneMaker")||(S=r(S).find(".cke_skin_sceneMaker"),S.length>0&&(S=S[0]));var h=null;return jQuery.each(CKEDITOR.instances,function(w,P){if(S===P.container.$){h=P;return}}),h},b=function(){var S="",h=0;return r(this.getSnapshot()).each(function(w,P){P.tagName!="SCRIPT"&&(h!=0&&(S=S+`
`),S=S+r(P).text(),h+=1)}),S},R=function(S){if(CKEDITOR.env.webkit){var h=r(document.getElementById("cke_contents_"+S.name)).find("iframe")[0];h.style.display="none",h.style.display="block"}};return{init:m,launchTextEditor:f,getCKEditorFromZone:T,getCKEditorIframeContentFromZone:D,getCKEditorFromTextArea:O}})(SceneMaker,jQuery),SceneMaker.Editor.Thumbnails=(function(e,r,_){var p="screens_list",s="views_list",m,f,T=_,k=_,D=function(){},V=function(y){m=y,e.Editor.Scrollbar.cleanScrollbar(p),r("#"+p).hide();var ke=[],ce=[],Ge=0;r(".slides > article").each(function(c,we){var De=te(we),Re=M(we);De&&(Ge+=1,ke.push(r("<img id='screenThumbnail"+Ge+"' class='image_slidethumbnail' slideNumber='"+Ge+"' action='goToScreenWithNumber' src='"+De+"' defaultsrc='"+Re+"'/>")),ce.push(Ge))});var lt={};lt.titleArray=ce,lt.callback=b,lt.onImageErrorCallback=O,e.Editor.Utils.Loader.loadImagesOnContainer(ke,p,lt)},O=function(y){var ke=e.Screen.getScreenWithNumber(r(y).attr("slidenumber")),ce=M(ke),Ge=e.Editor.Thumbnails.getThumbnailForSlide(ke);r(Ge).attr("src",ce),e.Screen.getCurrentScreen()===ke&&r("#screen_selected > img").attr("src",thumbnailURL)},b=function(){r("#"+p).find("img.image_slidethumbnail").each(function(ke,ce){var Ge=r(ce).parent();r(Ge).addClass("wrapper_slidethumbnail"),r(Ge).addClass("preventNoselectable"),r(Ge).append("<div class='delete_slide delete_screen'></div>");var lt=r(Ge).find("p");r(lt).addClass("ptext_barbutton"),r(ce).click(function(c){S(c)})}),r(".barbutton").css("background-color","transparent");var y=new Array;y.callback=R,r("#"+p).show(),e.Editor.Scrollbar.createScrollbar(p,y)},R=function(){r("#"+p).sortable({items:'div.wrapper_slidethumbnail:has(img[action="goToScreenWithNumber"])',change:function(y,ke){},start:function(y,ke){},stop:function(y,ke){var ce=ke.item,Ge=r(ke.item).find("img.image_slidethumbnail[slidenumber]");if(!isNaN(r(Ge).attr("slidenumber"))){var lt=parseInt(r(Ge).attr("slidenumber")),c;r("#screens_list").find("img.image_slidethumbnail[slidenumber]").each(function(we,De){var Re=parseInt(r(De).attr("slidenumber")),je=we+1;Re===lt&&Re!=je&&(c=je)}),e.Editor.Screen.moveScreenTo(lt,c)}}}),typeof m=="function"&&(m(),m=_)},S=function(y){switch(r(y.target).attr("action")){case"goToScreenWithNumber":e.Screen.goToScreenWithNumber(r(y.target).attr("slideNumber"));break;default:return}},h=function(y){r("#screens_list img.image_slidethumbnail").removeClass("selectedScreenThumbnail"),r("#screens_list img.image_slidethumbnail[slideNumber="+y+"]").addClass("selectedScreenThumbnail"),r("#screens_list div.wrapper_slidethumbnail").removeClass("selectedThumbnailBackground"),r("#screens_list img.image_slidethumbnail[slideNumber="+y+"]").parent("div.wrapper_slidethumbnail").addClass("selectedThumbnailBackground");var ke=T===_||y>T;T=y;var ce=e.Screen.getScreenWithNumber(y);re(ce)||w(ke?Math.max(y-5,1):y)},w=function(y){var ke=r("img.image_slidethumbnail[slideNumber="+y+"]");e.Editor.Scrollbar.goToElement(p,ke)},P=function(y){var ke=r("#views_list img.image_slidethumbnail[slideNumber="+y+"]").parent();e.Editor.Scrollbar.goToElement(s,ke)},N=function(y){if(e.Slides.isView(y))return X(y);var ke=r(y).attr("slidenumber");return r("#screens_list img.image_slidethumbnail[slideNumber="+ke+"]")},X=function(y){var ke=r(y).attr("slidenumber");return r("#views_list img.image_slidethumbnail[slideNumber="+ke+"]")},te=function(y){return r(y).attr("type")===e.Constant.VIEW_CONTENT?ne(y):K(y)},ne=function(y){var ke=r(y).children("div.view_content_zone");if(ke.length===1&&!e.Editor.isZoneEmpty(ke)&&ke.attr("type")=="image"){var ce=ke.find("img");if(r(ce).length===1&&typeof r(ce).attr("src")=="string")return r(ce).attr("src")}return M(y)},K=function(y){var ke=e.Slides.getSlideBackground(y);return typeof ke!="undefined"?ke:M(y)},M=function(y){return r(y).attr("type")===e.Constant.VIEW_CONTENT?e.ImagesPath+"slidesthumbs/view_content_template.png":e.ViewerAdapter.getAspectRatio()==="16:9"?e.ImagesPath+"slidesthumbs/screen_template_16-9.png":e.ImagesPath+"slidesthumbs/screen_template_4-3.png"},J=function(y,ke){f=ke,e.Editor.Scrollbar.cleanScrollbar(s),r("#"+s).hide();var ce=[],Ge=0;r(y).each(function(c,we){if(!e.Slides.isView(we))return e.Debugging.log("Invalid view type"),!0;var De=te(we),Re=M(we);Ge+=1,ce.push(r("<img id='viewThumbnail"+Ge+"' class='image_slidethumbnail' slideNumber='"+Ge+"' src='"+De+"' defaultsrc='"+Re+"'/>"))});var lt={};lt.callback=U,e.Editor.Utils.Loader.loadImagesOnContainer(ce,s,lt)},U=function(){r("#"+s).find("img.image_slidethumbnail").each(function(ke,ce){var Ge=r(ce).parent();r(Ge).addClass("wrapper_slidethumbnail"),r(Ge).append("<div class='delete_slide delete_view'></div>"),r(Ge).find("p").addClass("ptext_barbutton"),r(ce).click(function(lt){H(lt)})});var y=new Array;y.horizontalScroll=!0,y.callback=F,r("#"+s).show(),e.Editor.Scrollbar.createScrollbar(s,y)},F=function(){typeof f=="function"&&(f(),f=_)},H=function(y){var ke=r(y.target).attr("slideNumber");e.Editor.View.openViewWithNumber(ke)},W=function(y){if(r("#views_list img.image_slidethumbnail").removeClass("selectedViewThumbnail"),y!==null){r("#views_list img.image_slidethumbnail[slideNumber="+y+"]").addClass("selectedViewThumbnail");var ke=k===_||y>k;k=y;var ce=e.View.getViewWithNumber(e.Screen.getCurrentScreen(),y);re(ce)||P(ke?Math.max(y-7,1):y)}},re=function(y){var ke=N(y),ce=r(ke).offset();if(typeof ce=="undefined"||ce===null)return!0;if(e.Slides.isView(y)){var Ge=ce.left;return Ge>466&&Ge<1119}else{var lt=ce.top;return lt>132&&lt<667}};return{init:D,drawScreenThumbnails:V,drawViewThumbnails:J,selectThumbnail:h,selectViewThumbnail:W,moveThumbnailsToScreenWithNumber:w,moveThumbnailsToViewWithNumber:P,getThumbnailURLForSlide:te,getDefaultThumbnailURLForSlide:M,getThumbnailForSlide:N,isThumbnailVisible:re}})(SceneMaker,jQuery),SceneMaker.Editor.Settings=(function(e,r,_){var p,s=function(){},m=function(h){typeof h!="undefined"?(p=JSON.parse(JSON.stringify(h)),delete p.screens):p={},p.SMVersion=e.VERSION,(typeof p.aspectRatio!="string"||["4:3","16:9"].indexOf(p.aspectRatio)===-1)&&(p.aspectRatio="16:9"),e.ViewerAdapter.applyAspectRatio(p.aspectRatio)},f=function(){var h=JSON.parse(JSON.stringify(p));return(typeof h.title!="string"||h.title.trim()==="")&&(h.title=e.I18n.getTrans("i.Untitled")),h.avatar=T(),h},T=function(){for(var h=r("section.slides > article"),w=0;w<h.length;w++){var P=h[w];if(e.Slides.isScreen(P)){var N=e.Slides.getSlideBackground(P);if(typeof N!="undefined")return N}}return e.ImagesPath+"logos/scene_maker_escapp_thumbnail.png"},k=function(){r("a#edit_scene_details").fancybox({autoDimensions:!1,autoScale:!0,scrolling:"no",width:1e3,height:700,padding:0,hideOnOverlayClick:!1,hideOnContentClick:!1,showCloseButton:!0,onStart:function(){D()},onComplete:function(h){}}),r("a#edit_scene_details").trigger("click")},D=function(){typeof p.title=="string"?r("#scene_details_input_title").val(p.title):r("#scene_details_input_title").val("");var h=e.ViewerAdapter.getAspectRatio();typeof h!="undefined"&&r("#scene_details_select_aspectRatio").val(h),e.Editor.Actions.loadActions(r("#sceneActions"),p,"SCENE"),V()},V=function(){var h=O();h?(r("#save_scene_details").removeClass("buttonDisabledOnSettings"),r("#save_scene_details").removeAttr("disabled"),r("#save_scene_details").removeAttr("title")):(r("#save_scene_details").addClass("buttonDisabledOnSettings"),r("#save_scene_details").attr("disabled","true"))},O=function(){return!0},b=function(h){e.ViewerAdapter.applyAspectRatio(h),e.Editor.Thumbnails.drawScreenThumbnails(function(){e.Editor.Thumbnails.selectThumbnail(e.Screen.getCurrentScreenNumber())})},R=function(h){h.preventDefault(),!r(h.target).hasClass("buttonDisabledOnSettings")&&(p=S(),b(p.aspectRatio),r.fancybox.close())},S=function(){var h={};h.SMVersion=e.VERSION;var w=r("#scene_details_input_title").val();typeof w=="string"&&(h.title=w);var P=r("#scene_details_select_aspectRatio").val();typeof P=="string"&&["4:3","16:9"].indexOf(P)!==-1?h.aspectRatio=P:h.aspectRatio="4:3";var N=e.Editor.Actions.getActionsJSON(r("#sceneActions"));return N.length>0&&(h.actions=N),h};return{init:s,loadSceneSettings:m,getSettings:f,displaySettings:k,onSaveSceneSettingsButtonClicked:R}})(SceneMaker,jQuery),SceneMaker.Editor.Tools=(function(e,r,_){var p=!1,s=function(){p||(p=!0,m(),r.each(r("#toolbar_wrapper a.tool_action, div.tool_action"),function(Pe,qe){r(qe).on("click",function(ft){return typeof e.Editor.Tools[r(qe).attr("action")]=="function"&&(r(qe).find(".toolbar_scene_wrapper").hasClass("toolbar_scene_wrapper_disabled")||e.Editor.Tools[r(qe).attr("action")](this)),!1})}),e.Editor.Tools.Menu.init())},m=function(){var Pe=e.Screen.getCurrentScreen();typeof Pe!="undefined"&&k(Pe)},f=function(){r("#toolbar_wrapper").show()},T=function(){r("#toolbar_wrapper").hide()},k=function(Pe){D();var qe=r(Pe).attr("type");switch(r(".toolbar_scene_wrapper_slideTools:not(.toolbar_"+qe+")").hide(),r("#toolbar_slide .toolbar_btn.tool_action:not(.toolbar_"+qe+")").hide(),qe){case e.Constant.VIEW_CONTENT:r("#toolbar_slide").removeClass("toolbar_slide_screen").addClass("toolbar_slide_view_content");break;case e.Constant.VIEW_IMAGE:case e.Constant.SCREEN:r("#toolbar_slide").removeClass("toolbar_slide_view_content").addClass("toolbar_slide_screen"),r("div.tool_action[action='changeBackground']").show(),typeof e.Slides.getSlideBackground(Pe)!="undefined"?(r("div.tool_action[action='addHotspot']").show(),r("div.tool_action[action='addHotzone']").show(),r("div.tool_action[action='addCaption']").show()):(r("div.tool_action[action='addHotspot']").hide(),r("div.tool_action[action='addHotzone']").hide(),r("div.tool_action[action='addCaption']").hide());break;default:return}},D=function(){r(".toolbar_scene_wrapper_slideTools").removeClass("toolbar_scene_wrapper_disabled"),r(".menuselect_hide").hide(),r(".delete_content").hide(),W()},V,O="enabled",b=function(Pe){switch(Pe){case"enabled":R();break;case"loading":S();break;case"disabled":h();break;default:return}},R=function(){O!=="enabled"&&(O="enabled",w(),r("#toolbar_save").find(".toolbar_scene_wrapper").removeClass("toolbar_scene_wrapper_loading"),r("#toolbar_save").find(".toolbar_scene_wrapper").removeClass("toolbar_scene_wrapper_disabled"),r("#toolbar_save").find("p.toolbar_scene_title").html(e.I18n.getTrans("i.Save")),r(".menu_option.menu_action[action='saveScene']").parent().removeClass("menu_item_disabled"),r(".menu_option.menu_action[action='saveScene']").find("span").html(e.I18n.getTrans("i.Save")))},S=function(){O!=="loading"&&(O="loading",r("#toolbar_save").find(".toolbar_scene_wrapper").addClass("toolbar_scene_wrapper_disabled"),r("#toolbar_save").find(".toolbar_scene_wrapper").addClass("toolbar_scene_wrapper_loading"),r("#toolbar_save").find("p.toolbar_scene_title").html(e.I18n.getTrans("i.Saving")),r(".menu_option.menu_action[action='saveScene']").parent().addClass("menu_item_disabled"),r(".menu_option.menu_action[action='saveScene']").find("span").html(e.I18n.getTrans("i.Saving")))},h=function(){O!=="disabled"&&(O="disabled",r("#toolbar_save").find(".toolbar_scene_wrapper").removeClass("toolbar_scene_wrapper_loading"),r("#toolbar_save").find(".toolbar_scene_wrapper").addClass("toolbar_scene_wrapper_disabled"),r("#toolbar_save").find("p.toolbar_scene_title").html(e.I18n.getTrans("i.Saved")),w(),V=setTimeout(function(){b("enabled")},5e3),r(".menu_option.menu_action[action='saveScene']").parent().addClass("menu_item_disabled"),r(".menu_option.menu_action[action='saveScene']").find("span").html(e.I18n.getTrans("i.Saved")))},w=function(){typeof V!="undefined"&&clearTimeout(V)},P=function(Pe){J(e.Editor.getLastArea());var qe=r(Pe).attr("type");switch(qe){case"text":F(qe);break;case"image":F(qe);break;case"video":F(qe);break;case"object":var ft=r(Pe).find(".object_wrapper").children()[0];H(ft);break;case _:r(Pe).find(".menuselect_hide").show(),M(r(Pe).find(".zone_tooltip"));return;default:break}r(Pe).find(".delete_content").show()},N=function(Pe){for(var qe=r(Pe).find("div.view_content_zone"),ft=0;ft<qe.length;ft++)X(qe[ft])},X=function(Pe,qe){var ft="",Ot="true";qe===!0&&(ft="style='display:none'",Ot="false");var Kt="<span class='zone_tooltip' visible='"+Ot+"' "+ft+" >"+e.I18n.getTrans("i.ZoneTooltip")+"</span>";r(Pe).append(Kt),Kt=r(Pe).find(".zone_tooltip"),qe===!0?M(Kt):te(Kt)},te=function(Pe){var qe=r("div").has(Pe);r(Pe).show(),r(Pe).attr("visible","true"),r(qe).attr("tooltip","true"),r(Pe).css("margin-top")==="0px"&&ne(Pe)},ne=function(Pe){var qe=r("div").has(Pe),ft=r("article").has(qe);e.Utils.addTempShown([ft,qe,Pe]);var Ot=r(qe).height(),Kt=r(Pe).height(),Zt=(Ot-Kt)/2;e.Utils.removeTempShown([ft,qe,Pe]),r(Pe).css("margin-top",Zt+"px")},K=function(Pe){r("span.zone_tooltip").each(function(qe,ft){ne(ft)}),typeof Pe=="function"&&Pe(!0)},M=function(Pe){var qe=r("div").has(Pe);r(Pe).hide(),r(Pe).attr("visible","false"),r(qe).attr("tooltip","false")},J=function(Pe){W();var qe=r(Pe).find(".zone_tooltip");e.Editor.isZoneEmpty(Pe)?(r(Pe).find(".menuselect_hide").remove(),r(Pe).removeClass("zoneUnselected").removeClass("zoneSelected").addClass("editable"),te(qe)):(r(Pe).find(".menuselect_hide").hide(),r(Pe).find(".delete_content").hide(),M(qe))},U=function(Pe){F(Pe)},F=function(Pe){W(Pe);var qe="toolbar_"+Pe;r("#toolbar_element").children().hide(),r("#toolbar_element").find("."+qe).css("display","inline-block"),document.getElementById("toolbar_settings_wrapper").style.top="-4px"},H=function(Pe){var qe=e.Object.getObjectInfo(Pe);switch(qe.type){case e.Constant.MEDIA.WEB:F(e.Constant.MEDIA.WEB);break;default:F("object");break}},W=function(Pe){Pe!=="hotspot"&&e.Editor.Marker.setCurrentHotspot(_),Pe!=="hotzone"&&e.Editor.Marker.setCurrentHotzoneId(_),r("#toolbar_element").children().hide()},re=function(){e.Editor.Tools.Menu.exit()},y=function(){W(),e.Editor.Settings.displaySettings()},ke=function(){W(),e.Editor.Tools.Menu.saveScene()},ce=function(){W(),e.Editor.Preview.preview()},Ge=function(){r("#hidden_button_to_change_slide_background").trigger("click")},lt=function(){e.Editor.Slides.removeCurrentSlide()},c=function(){e.Editor.Marker.addHotspot()},we=function(){e.Editor.Marker.addHotzone()},De=function(){W(),e.Editor.Caption.addCaption()},Re=function(){e.Editor.Marker.deleteCurrentHotmarker()},je=function(Pe){switch(e.Editor.getCurrentElementType()){case"HOTSPOT":e.Editor.Marker.showHotspotSettings();break;case"HOTZONE":e.Editor.Marker.showHotzoneSettings();break;case"ZONE":switch(r(e.Editor.getCurrentArea()).attr("type")){case e.Constant.OBJECT:e.Editor.Object.showObjectSettings();break;default:break}break}};return{init:s,loadToolsForSlide:k,loadToolsForElement:U,loadToolsForZone:P,loadToolbarForObject:H,cleanZoneTool:J,cleanToolbar:m,enableToolbar:f,disableToolbar:T,save:ke,displaySettings:y,preview:ce,deleteSlide:lt,changeBackground:Ge,addHotspot:c,addHotzone:we,addCaption:De,deleteHotmarker:Re,addTooltipsToSlide:N,addTooltipToZone:X,showZoneToolTip:te,hideZoneToolTip:M,setAllTooltipMargins:K,changeSaveButtonStatus:b,showElementSettings:je,exit:re}})(SceneMaker,jQuery),SceneMaker.Editor.Tools.Menu=(function(e,r,_){var p=!1,s=function(){if(!p){p=!0,r.each(r("#menu a.menu_action"),function(P,N){r(N).on("click",function(X){return X.preventDefault(),r(N).parent().hasClass("menu_item_disabled")||typeof e.Editor.Tools.Menu[r(N).attr("action")]=="function"&&(e.Editor.Tools.Menu[r(N).attr("action")](this),m()),!1})}),r("a.menu_option_main, a.menu_option:not('.menu_action')").on("click",function(P){return P.preventDefault(),!1});var h=e.Utils.getOptions();typeof h.exitURL!="string"?(r(".menu_option.menu_action[action='exit']").parent().hide(),r("#toolbar_exit_btn").hide()):e.exitPath=h.exitURL,r("#menu").show();var w=!1;r("a:.menu_option_main").on("click",function(){r("#menu li > ul.menu_option_main").css("display")==="none"?(r("#menu li > ul.menu_option_main").css("display","block"),r("ul:.menu_option_main li").hover(function(P){r(this).children("ul").css("display","block").on("mouseenter",function(){w=!0,r(this).mouseleave(function(N){w=!1})})},function(){w||r("ul:.menu_option_main li > ul").css("display","none")})):r("#menu li > ul.menu_option_main").css("display","none")}),r(document).click(function(){r("#menu li > ul.menu_option_main").hide()})}},m=function(){r("#menu li > ul.menu_option_main").hide()},f=function(){e.Editor.Settings.displaySettings()},T=function(){if(e.Screen.getScreens().length===0){var h={};h.width=600,h.height=150,h.text=e.I18n.getTrans("i.NoSlidesOnSaveNotification");var w={};w.text=e.I18n.getTrans("i.Ok"),w.callback=function(){r.fancybox.close()},h.buttons=[w],e.Utils.showDialog(h);return}e.Editor.Tools.changeSaveButtonStatus("loading");var P=e.Editor.saveScene();e.Editor.sendScene(P,"save",function(){e.Editor.Tools.changeSaveButtonStatus("disabled")},function(){e.Editor.Tools.changeSaveButtonStatus("enabled")})},k=function(){e.Editor.Preview.preview()},D=function(){if(e.Editor.hasSceneChanged()){var h={};h.width=600,h.height=200,h.notificationIconSrc=e.ImagesPath+"icons/save_document.png",h.text=e.I18n.getTrans("i.ExitConfirmationMenu"),h.buttons=[];var w={};w.text=e.I18n.getTrans("i.cancel"),w.callback=function(){r.fancybox.close()},h.buttons.push(w);var P={};P.text=e.I18n.getTrans("i.exitWSaving"),P.callback=function(){V(),r.fancybox.close()},h.buttons.push(P);var N={};N.text=e.I18n.getTrans("i.saveAndExit"),N.callback=function(){r("#waiting_overlay").show(),e.Editor.Tools.changeSaveButtonStatus("loading");var X=e.Editor.saveScene();e.Editor.sendScene(X,"save",function(){e.Editor.Tools.changeSaveButtonStatus("disabled"),V()},function(){e.Editor.Tools.changeSaveButtonStatus("enabled"),r("#waiting_overlay").hide()}),r.fancybox.close()},h.buttons.push(N),e.Utils.showDialog(h)}else V()},V=function(){e.Editor.Events.allowExitWithoutConfirmation(),window.top.location.href=e.exitPath},O=function(){return r("#addScreenButton").trigger("click"),!1},b=function(){return r("#addViewButton").trigger("click"),!1},R=function(){return e.Editor.exportSceneToJSON(),!1},S=function(){return e.Editor.importSceneFromJSONFancybox(),!1};return{init:s,displaySettings:f,saveScene:T,preview:k,addScreen:O,addView:b,exportToJSON:R,importFromJSON:S,exit:D}})(SceneMaker,jQuery),SceneMaker.Editor.Utils=(function(e,r,_){var p=function(h,w,P,N){var X={width:P,height:N},te=h/w,ne=P/N;return te>ne?(X.width=ne*w,X.height=w,X):(X.width=h,X.height=h/ne,X)},s=function(h,w){var P="";r.each(h.split(";"),function(X,te){te.indexOf("width")===-1&&te.indexOf("height")===-1&&(P=P+te+"; ")});var N=e.Utils.getPixelDimensionsFromStyle(h,w);return N&&N[0]&&(P=P+"width: "+N[0]+"px; ",N[1]&&(P=P+"height: "+N[1]+"px; ")),P},m=function(h,w){var P=w.width()*100/h.width(),N=w.height()*100/h.height(),X=w.position().top*100/h.height(),te=w.position().left*100/h.width();return"position: relative; width:"+P+"%; height:"+N+"%; top:"+X+"%; left:"+te+"%;"},f=function(){return"position: relative; width:100%; height:100%; top:0%; left:0%;"},T=function(h){var w=/(^http(s)?:\/\/)/g,P=/(^#)/g,N=e.Object.getObjectInfo(h);return N.wrapper===null&&h.match(w)===null&&h.match(P)===null?"http://"+h:h},k,D=function(h){switch(r(".fancy_tab_content").hide(),r("#"+h+"_content").show(),r(".fancy_tab").removeClass("fancy_selected"),r("#"+h).addClass("fancy_selected"),h){case"tab_pic_from_url":e.Editor.Image.onLoadTab("url");break;case"tab_video_from_url":e.Editor.Video.onLoadTab();break;case"tab_object_from_url":e.Editor.Object.onLoadTab("url");break;default:break}return!1},V=function(){r("div.fancy_tabs a.fancy_tab:not(.disabled)").show()},O=function(h){var w={};w.width=650,w.height=190,w.text=h;var P={};P.text=e.I18n.getTrans("i.Ok"),P.callback=function(){r.fancybox.close()},w.buttons=[P],e.Utils.showDialog(w)},b=function(h,w){if(h instanceof Array){for(var P=0;P<h.length;P++)b(h[P],w);return}if(w)r(h).parent().removeClass("disableSettingsField"),r(h).removeAttr("disabled");else{if(r(h).is("input")){if(r(h).attr("type")==="checkbox"){var N=r(h).attr("defaultvalue")==="true";r(h).prop("checked",N)}}else if(r(h).is("select")){var X=r(h).find("option[selected='selected']").val();r(h).val(X)}r(h).parent().addClass("disableSettingsField"),r(h).attr("disabled","disabled")}},R=function(h){return h.trim().toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+(.)/g,(w,P)=>P.toUpperCase()).replace(/^\w/,w=>w.toUpperCase()).replace(/\s/g,"")},S=function(){const h=new Date,w=P=>String(P).padStart(2,"0");return`${h.getFullYear()}-${w(h.getMonth()+1)}-${w(h.getDate())}_${w(h.getHours())}-${w(h.getMinutes())}-${w(h.getSeconds())}`};return{dimentionsToDraw:p,setStyleInPixels:s,getStylesInPercentages:m,getStylesForFitContent:f,autocompleteUrls:T,loadTab:D,hideNonDefaultTabs:V,showErrorDialog:O,enableElementSettingsField:b,toPascalCase:R,getDateISO:S}})(SceneMaker,jQuery),SceneMaker.Editor.Utils.Loader=(function(e,r,_){var p=function(b){T(r(b).find(".object_wrapper"))},s=function(b){k(r(b).find(".object_wrapper"))},m=function(){T(r(".object_wrapper"))},f=function(){k(r(".object_wrapper"))},T=function(b){r.each(b,function(R,S){var h=r(S).attr("htmlContent");typeof h!="undefined"&&(r(S).html(h),r(S).removeAttr("htmlContent"))})},k=function(b){r.each(b,function(R,S){var h=r(S).html();typeof h!="undefined"&&h!==""&&(r(S).attr("htmlContent",r(S).html()),r(S).html(""))})},D=function(b,R,S){var h=b,w=b.length,P=0;r.each(b,function(N,X){r(X).load(function(te){P=P+1,P===w&&V(h,R,S)}),r(X).error(function(te){P=P+1,S.filterUnloadedImages===!0&&h.splice(h.indexOf(X),1),P===w&&V(h,R,S)})})},V=function(b,R,S){r.each(b,function(h,w){O(w,b,R,S)}),typeof S.callback=="function"&&S.callback(S)},O=function(b,R,S,h){var w=h.titleArray;w&&w[R.indexOf(b)]?r("#"+S).append("<div><p>"+w[R.indexOf(b)]+"</p>"+e.Utils.getOuterHTML(b)+"</div>"):r("#"+S).append("<div>"+e.Utils.getOuterHTML(b)+"</div>")};return{loadObjectsInEditorSlide:p,unloadObjectsInEditorSlide:s,loadAllObjects:m,unloadAllObjects:f,loadImagesOnContainer:D}})(SceneMaker,jQuery),SceneMaker.Editor.Screen=(function(e,r,_){var p=function(){},s=function(F){var F=r(F);e.Screen.getCurrentScreen()?r(e.Screen.getCurrentScreen()).after(F):m(F);var H=e.Screen.getCurrentScreenNumber();e.Screen.setCurrentScreenNumber(H+1),e.Screen.triggerScreenLeaveEvent(H),e.Screen.updateScreens(),e.Screen.triggerScreenEnterEvent(e.Screen.getCurrentScreenNumber()),e.Editor.Thumbnails.drawScreenThumbnails(function(){e.Editor.Thumbnails.selectThumbnail(e.Screen.getCurrentScreenNumber()),e.Editor.Thumbnails.moveThumbnailsToScreenWithNumber(e.Screen.getCurrentScreenNumber())})},m=function(U){r(".slides").append(U)},f=function(){var U=e.Editor.Dummies.getDummy(e.Constant.SCREEN,{slideNumber:e.Screen.getScreensQuantity()+1});return s(U),r.fancybox.close(),!1},T=function(U){return r(U).children("article").length},k=function(U){e.Editor.Slides.updateThumbnail(U),r("#bottomside").show(),O(U);var F=r(U).attr("id"),H=r("#"+F+" > article");e.Editor.Thumbnails.drawViewThumbnails(H,function(){})},D=function(U){b(U);var F=e.Editor.View.getCurrentView();F&&e.Editor.View.closeView(F),r("#bottomside").hide(),r("#screen_selected > img").attr("src","")},V=function(){var U=e.Screen.getCurrentScreen();O(U)},O=function(U){r("#screen_selected_img").addClass("selectedScreenThumbnailInViews");var F=e.Editor.View.getCurrentView();F&&e.Editor.View.closeView(F),e.Editor.Tools.loadToolsForSlide(U)},b=function(U){r("#screen_selected_img").removeClass("selectedScreenThumbnailInViews"),e.Editor.Marker.cancelAnnotationSelectedForSlide(r(U).attr("id"))},R=function(U){var F=r(U.target).prev("img").attr("slidenumber"),H=r("article[type='screen'][slidenumber='"+F+"']")[0];S(H)},S=function(U){var F={};F.width=375,F.height=130,F.notificationIconSrc=e.Editor.Thumbnails.getThumbnailURLForSlide(U),F.notificationIconClass="notificationIconDeleteSlide",F.text=e.I18n.getTrans("i.AreYouSureDeleteScreen");var H={};H.text=e.I18n.getTrans("i.no"),H.callback=function(){r.fancybox.close()};var W={};W.text=e.I18n.getTrans("i.delete"),W.callback=function(){h(U),r.fancybox.close()},F.buttons=[H,W],e.Utils.showDialog(F)},h=function(U){if(U!==null){e.Screen.getCurrentScreen()===U&&D(U);var F=r(U).attr("id"),H=r(U).attr("slidenumber"),W=e.Screen.getCurrentScreenNumber();r(U).remove(),e.Editor.Marker.afterDeleteSlide(F),H<=W&&(W-1>0?e.Screen.setCurrentScreenNumber(W-1):e.Screen.getScreensQuantity()>1&&e.Screen.setCurrentScreenNumber(1)),e.Screen.updateScreens(),e.Editor.Thumbnails.drawScreenThumbnails(function(){if(typeof e.Screen.getCurrentScreen()!="undefined"){var re=e.Screen.getCurrentScreenNumber();e.Editor.Thumbnails.selectThumbnail(re),e.Editor.Thumbnails.moveThumbnailsToScreenWithNumber(re),e.Screen.triggerScreenEnterEvent(re)}})}},w=function(U,F){var H=e.Screen.getScreenWithNumber(U),W=e.Screen.getScreenWithNumber(F);if(!(typeof H=="undefined"||typeof W=="undefined")&&!(typeof H.length!==_&&(H=r(H)[0],typeof H=="undefined"))&&!(typeof W.length!==_&&(W=r(W)[0],typeof W=="undefined"))&&!(H.tagName!="ARTICLE"||W.tagName!="ARTICLE"||H==W)){var re=null;if(F>U)re="after";else if(F<U)re="before";else return;var y=!1,ke=e.Screen.getCurrentScreen(),ce=parseInt(r(ke).attr("slidenumber"));ke===H&&(y=!0);var Ge=e.Editor.Slides.copyTextAreasOfSlide(H);if(r(H).remove(),re=="after")r(W).after(H);else if(re=="before")r(W).before(H);else return;e.Utils.addTempShown(H),e.Editor.Marker.refreshDraggables(H),e.Editor.Slides.cleanTextAreasOfSlide(H),e.Editor.Slides.loadTextAreasOfSlide(H,Ge),e.Utils.removeTempShown(H),e.Screen.setScreens(r("section.slides > article")),r("#screens_list").find("div.wrapper_slidethumbnail:has(img[slidenumber])").each(function(c,we){var De=c+1,Re=r(we).find("p.ptext_barbutton");r(Re).html(De);var je=r(we).find("img.image_slidethumbnail");r(je).attr("slidenumber",De)});var lt;y?lt=F:U>ce&&F<=ce?lt=ce+1:U<ce&&F>=ce&&(lt=ce-1),typeof lt=="number"&&e.Screen.setCurrentScreenNumber(lt),e.Screen.updateScreens()}},P=function(U,F){if(typeof U!="undefined"){var H=r(U).attr("id");e.Editor.Slides.cleanTextAreasOfSlide(U),U=N(U);var W=r(U).attr("id"),re=e.Screen.getCurrentScreen();re?r(re).after(U):r("section#slides_panel").append(U);var y=r("#"+W);e.Editor.Marker.refreshDraggables(y),e.Editor.Marker.copyMarkers(H,W),F.textAreas&&e.Editor.Slides.loadTextAreasOfSlide(y,F.textAreas,!0),e.Screen.updateScreens(),e.Editor.Thumbnails.drawScreenThumbnails(function(){re?(e.Screen.goToScreenWithNumber(e.Screen.getCurrentScreenNumber()+1),e.Editor.Thumbnails.moveThumbnailsToScreenWithNumber(e.Screen.getCurrentScreenNumber())):(e.Screen.goToScreenWithNumber(1),e.Editor.Thumbnails.moveThumbnailsToScreenWithNumber(1))}),r(y).find("[copyid]").removeAttr("copyid")}},N=function(U){var F=r(U),H=F.attr("id"),W=e.Utils.getId("article");F.attr("id",W);var re=F.find("img.slide_background#"+H+"_background");r(re).attr("id",W+"_background");var y=F.children("article");return y.each(function(ke,ce){X(ce,W)}),U},X=function(U,F){var H=r(U);switch(H.attr("type")){case e.Constant.VIEW_IMAGE:return te(H,F);case e.Constant.VIEW_CONTENT:return ne(H,F)}},te=function(U,F){var H=U.attr("id"),W=e.Utils.getId(F+"_article");U.attr("id",W);var re=U.find("img.slide_background#"+H+"_background");r(re).attr("id",W+"_background")},ne=function(U,F){var H=e.Utils.getId(F+"_article");U.attr("id",H),U.children("div[id].view_content_zone").each(function(W,re){re=K(re,H)})},K=function(U,F){r(U).attr("copyid",r(U).attr("id"));var H=e.Utils.getId(F+"_zone");return r(U).attr("id",H),r(U).find("[id]").each(function(W,re){re=M(re,H)}),U},M=function(U,F){var H=J(U),W=e.Utils.getId(F+"_"+H);return r(U).attr("id",W),U},J=function(U){var F=r(r(U).attr("id").split("_")).last()[0];return F.length>1?F.substring(0,F.length-1):F};return{init:p,addScreen:s,appendScreen:m,onClickAddScreenButton:f,onEnterScreen:k,onLeaveScreen:D,openScreen:O,closeScreen:b,onDeleteScreenClicked:R,removeScreen:S,onClickOpenScreen:V,getViewsQuantity:T,moveScreenTo:w,copyScreen:P}})(SceneMaker,jQuery),SceneMaker.Editor.View=(function(e,r,_){var p,s=function(){},m=function(){return p},f=function(M){p=M},T=function(M,U){var U=r(U).css("display","none")[0];k(M,U),e.Editor.Tools.addTooltipsToSlide(U),e.Editor.View.openView(U),e.Editor.Thumbnails.drawViewThumbnails(r(M).find("article"),function(){e.Editor.Thumbnails.selectViewThumbnail(r(U).attr("slidenumber"))})},k=function(M,J){r(M).append(J)},D=function(){return r("#addViewFancybox").trigger("click"),e.Editor.Utils.loadTab("tab_views"),!1},V=function(M){var J=e.Screen.getCurrentScreen(),U=r(M.target).prev("img").attr("slidenumber"),F=r(J).find("article[slidenumber='"+U+"']")[0];O(F)},O=function(M){var J={};J.width=375,J.height=130,J.notificationIconSrc=e.Editor.Thumbnails.getThumbnailURLForSlide(M),J.notificationIconClass="notificationIconDeleteSlide",J.text=e.I18n.getTrans("i.AreYouSureDeleteView");var U={};U.text=e.I18n.getTrans("i.no"),U.callback=function(){r.fancybox.close()};var F={};F.text=e.I18n.getTrans("i.delete"),F.callback=function(){b(M),r.fancybox.close()},J.buttons=[U,F],e.Utils.showDialog(J)},b=function(M){if(typeof M=="object"){var J=r(M).parent(),U=e.View.getCurrentView(),F=r(U).attr("id"),H=U===M;H&&N(M),r(M).remove(),e.Editor.Marker.afterDeleteSlide(F);var W=r(J).find("article");r(W).each(function(re,y){r(y).attr("slidenumber",re+1)}),e.Editor.Thumbnails.drawViewThumbnails(W,function(){H===!1&&e.Editor.Thumbnails.selectViewThumbnail(r(U).attr("slidenumber"))}),H&&e.Editor.Screen.openScreen(J)}},R=function(M){var J=e.Screen.getCurrentScreen(),U=r(J).find("article"),F=U[M-1];S(F)},S=function(M){var J=m();if(J)N(J);else{var U=r(M).parent();e.Editor.Screen.closeScreen(U)}f(M),h(M),e.Editor.Thumbnails.selectViewThumbnail(r(M).attr("slidenumber")),e.Slides.triggerSlideEnterEvent(r(M).attr("id"))},h=function(M){r(M).css("display","block")},w=function(M){r(M).css("display","none")},P=function(M){var J=e.Screen.getCurrentScreen(),U=r(J).find("article"),F=U[M-1];N(F)},N=function(M){var J=r(M).attr("id");f(null),e.Editor.Thumbnails.selectViewThumbnail(null),w(M),e.Editor.Marker.cancelAnnotationSelectedForSlide(J),e.Slides.triggerSlideLeaveEvent(J)},X=function(M){ne(1)},te=function(){ne(-1)},ne=function(M){var J=e.View.getCurrentViewNumber();typeof J=="undefined"&&(J=0);var U=e.Editor.Screen.getViewsQuantity(e.Screen.getCurrentScreen()),F=J+M,H=Math.min(Math.max(0,F),U);F===H&&K(F)},K=function(M){M===0?e.Editor.Screen.onClickOpenScreen():e.Editor.View.openViewWithNumber(M)};return{init:s,addView:T,appendView:k,onClickAddViewButton:D,onDeleteViewClicked:V,removeView:O,getCurrentView:m,openViewWithNumber:R,openView:S,closeViewWithNumber:P,closeView:N,forwardOneView:X,backwardOneView:te}})(SceneMaker,jQuery),SceneMaker.Editor.Marker=(function(e,r,_){var p=!1,s,m,f,T,k="NONE",D,V,O=function(){p||(p=!0,s={},T={},D=r('<a href="#hotspotSettings_fancybox" style="display:none"></a>'),r(D).fancybox({autoDimensions:!1,height:690,width:920,scrolling:"no",showCloseButton:!1,padding:0,onStart:function(le){c()},onComplete:function(le){},onClosed:function(le){}}),V=r('<a href="#hotzoneSettings_fancybox" style="display:none"></a>'),r(V).fancybox({autoDimensions:!1,height:690,width:920,scrolling:"no",showCloseButton:!1,padding:0,onStart:function(le){ut()},onComplete:function(le){},onClosed:function(le){}}))},b=function(le){var se={hotspots:{},hotzones:{},caption:{}};return se},R=function(le,se){le&&(typeof le.background=="string"&&e.Editor.Slides.setSlideBackground(se,le.background),h(le.id,le.hotzones),S(le.id,le.hotspots),e.Editor.Caption.loadCaption(le.id,le.caption))},S=function(le,se){Array.isArray(se)&&se.forEach(function(Le,Ue){e.Utils.registerId(Le.id);var yt,pt;r("body").attr("aspectRatio")==="16:9"?(yt=1024,pt=576):(yt=800,pt=600),Le.x=Le.x*yt/100,Le.y=Le.y*pt/100,Le.width=Le.width*yt/100,Le.height=Le.height*pt/100,M(le,Le),Array.isArray(Le.actions)&&Le.actions.length>0&&(s[le].hotspots[Le.id].actions=Le.actions)})},h=function(le,se){Array.isArray(se)&&r(se).each(function(Le,Ue){w(le,Ue)})},w=function(le,se){if(Array.isArray(se.points)){var Le;typeof se.id=="string"?Le=se.id:Le=e.Utils.getId("annotation-");var Ue;typeof se.idAlias=="string"?Ue=se.idAlias:Ue=e.Utils.getId("zone-"),T[Le]=Ue,e.Utils.registerId(Ue);var yt=e.Marker.createAnnotationFromPointsArray(Le,se.points),pt=me(le);pt.addAnnotation(yt),s[le].hotzones[Le]={},s[le].hotzones[Le].cursorVisibility=se.cursorVisibility,s[le].hotzones[Le].enabled=se.enabled,Array.isArray(se.actions)&&se.actions.length>0&&(s[le].hotzones[Le].actions=se.actions)}},P=function(){k==="HOTSPOT"?te("HOTSPOT"):X("HOTSPOT")},N=function(){k==="HOTZONE"?te("HOTZONE"):X("HOTZONE")},X=function(le){switch(k=le,le){case"HOTSPOT":te("HOTZONE"),r("#slides_panel").addClass("hotspot_active");break;case"HOTZONE":te("HOTSPOT"),r("#slides_panel").addClass("hotzone_active"),Zt();break;case"NONE":te("HOTSPOT"),te("HOTZONE");break}},te=function(le){switch(k===le&&(k="NONE"),le){case"HOTSPOT":r("#slides_panel").removeClass("hotspot_active"),Lt(_);break;case"HOTZONE":r("#slides_panel").removeClass("hotzone_active"),f=_,zt();break;default:break}},ne=function(le){var se=r(le.target);if(k!=="NONE")if(se.closest('article[type="'+e.Constant.SCREEN+'"]').length===0)X("NONE");else switch(k){case"HOTSPOT":K(le);break;case"HOTZONE":break;default:break}else se.hasClass("hotspot")&&Ge(se)},K=function(le){le.preventDefault(),le.stopPropagation();var se=e.Slides.getCurrentSlide(),Le=r(se).attr("id"),Ue=e.Utils.getId("hotspot-"),yt=42,pt=se.getBoundingClientRect(),Ht=le.clientX-pt.left-yt/2,_t=le.clientY-pt.top-yt/2;M(Le,{id:Ue,x:Ht,y:_t}),X("NONE")},M=function(le,se){typeof se.image!="string"&&(se.image=e.Marker.getDefaultHotspotImg()),typeof se.lockAspectRatio!="boolean"&&(se.lockAspectRatio=!0),typeof se.visibility!="string"&&(se.visibility="visible"),typeof se.cursorVisibility!="string"&&(se.cursorVisibility="pointer"),typeof se.width!="number"&&(se.width=42),typeof se.height!="number"&&(se.height=42);var Le=parseFloat(se.rotationAngle);(typeof Le!="number"||isNaN(Le)||Le<0||Le>360)&&(Le=0);var Ue=r("#"+le),yt=e.Slides.getSlideBackgroundImg(Ue),pt=r("<img>",{src:se.image,class:"hotspot",id:se.id,rotationAngle:Le,css:{position:"absolute",left:se.x,top:se.y,width:se.width+"px",height:se.height+"px",transform:"rotate("+Le+"deg)"}}).appendTo(yt.parent());U(pt),typeof s[le]=="undefined"&&(s[le]=b()),s[le].hotspots[se.id]={},s[le].hotspots[se.id].lockAspectRatio=se.lockAspectRatio,s[le].hotspots[se.id].visibility=se.visibility,s[le].hotspots[se.id].cursorVisibility=se.cursorVisibility,J(pt)},J=function(le){le.draggable({start:function(se,Le){Ge(le)},stop:function(se,Le){U(le)}})},U=function(le,se=15){const Le=le.parent();H(Le,le,se)&&W(Le,le)},F=function(le,se,Le=0){const Ue=le.innerWidth(),yt=le.innerHeight(),pt=se.outerWidth(),Ht=se.outerHeight(),_t=se.position();return _t.left>=-Le&&_t.top>=-Le&&_t.left+pt<=Ue+Le&&_t.top+Ht<=yt+Le},H=function(le,se,Le=0){const Ue=le.innerWidth(),yt=le.innerHeight(),pt=se.outerWidth(),Ht=se.outerHeight(),_t=se.position();return _t.left+pt<=+Le||_t.top+Ht<=+Le||_t.left>=Ue-Le||_t.top>=yt-Le},W=function(le,se,Le=0){const Ue=le.innerWidth(),yt=le.innerHeight(),pt=se.outerWidth(),Ht=se.outerHeight();let{left:_t,top:At}=se.position();_t=Math.max(Le,Math.min(_t,Ue-pt-Le)),At=Math.max(Le,Math.min(At,yt-Ht-Le)),se.stop(!0).animate({left:_t,top:At},1e3)},re=function(le){r(le).find("img.hotspot").each(function(){var se=r(this);J(se)})},y=function(le,se){ke(le,se),r("#"+se).children("article").each(function(Le,Ue){var yt=r(Ue).attr("id"),pt=le+yt.slice(se.length);ke(pt,yt)})},ke=function(le,se){if(typeof s[se]=="undefined"&&(s[se]=b()),typeof s[le]!="undefined"){s[se]=JSON.parse(JSON.stringify(s[le]));var Le=r("#"+se);if(typeof s[se].annotator!="undefined"){delete s[se].annotator,s[se].hotzones={};var Ue=e.Slides.getSlideBackgroundImg(Le);Ue.parent("div[data-theme]").remove(),Ue.prependTo(Le)}var yt={};Le.children("img.hotspot").each(function(on,fn){var Nn=r(fn).attr("id"),Yn=e.Utils.getId("hotspot-");r(fn).attr("id",Yn),yt[Nn]=Yn});for(var pt in yt){var Ht=yt[pt],_t=Object.assign({},s[se].hotspots[pt]);typeof _t!="undefined"&&Object.keys(_t).length>0&&(s[se].hotspots[Ht]=_t),delete s[se].hotspots[pt]}for(var At=vn(r("#"+le)),It=At.hotzones,Wt={},Xt=0;Xt<It.length;Xt++){var Vt=It[Xt].id;It[Xt].id=e.Utils.getId("annotation-"),Wt[Vt]=It[Xt].id,delete It[Xt].idAlias}for(var un in s[se].hotspots){var dn=s[se].hotspots[un];s[se].hotspots[un].actions=ce(dn.actions,un,le,se,yt,Wt)}for(var hn=0;hn<It.length;hn++)It[hn].actions=ce(It[hn].actions,It[hn].id,le,se,yt,Wt);Array.isArray(It)&&It.length>0&&h(se,It)}},ce=function(le,se,Le,Ue,yt,pt){if(Array.isArray(le))for(var Ht=le.length,_t=0;_t<Ht;_t++){var At=le[_t];switch(At.actionType){case"openView":if(At.actionParams&&typeof At.actionParams.view=="string"){var It=At.actionParams.view,Wt;if(It.startsWith(Le))Wt=Ue+It.slice(Le.length);else if(It.split("_")[0]===Le.split("_")[0]){var Xt=Ue.split("_")[0];Wt=Xt+It.slice(Xt.length)}typeof Wt=="string"&&(le[_t].actionParams.view=Wt)}break;case"showHotspot":case"hideHotspot":if(At.actionParams&&typeof At.actionParams.hotspotId=="string"){var Vt=At.actionParams.hotspotId,un=Object.keys(yt).includes(Vt);un&&(At.actionParams.hotspotId=yt[Vt])}break;case"enableHotzone":case"disableHotzone":if(At.actionParams&&typeof At.actionParams.hotzoneId=="string"){var dn=At.actionParams.hotzoneId,hn=Object.keys(pt).includes(dn);hn&&(At.actionParams.hotzoneId=pt[dn])}break}}return le},Ge=function(le){Lt(le),e.Editor.Tools.loadToolsForElement("hotspot")},lt=function(){r(D).trigger("click")},c=function(){var le=r(e.Slides.getCurrentSlide()).attr("id"),se=r(m),Le=se.attr("id"),Ue=s[le].hotspots[Le];r("#hotspotIdInput").val(Le),we(function(){r("#hotspotImageGallery img").removeClass("selected");var Wt=se.attr("src"),Xt=r("#hotspotImageGallery").find("img[src='"+Wt+"']")[0];typeof Xt=="undefined"?(r("#hotspotImageURL").val(Wt),r("#hotspotImageSource").val("url").trigger("change")):(r(Xt).addClass("selected"),r("#hotspotImageSource").val("gallery").trigger("change"),e.Editor.Carousel.goToElement("hotspotImageGallery",Xt))});var yt=parseFloat(se.css("left")),pt=parseFloat(se.css("top"));r("#hotspotPositionX").val(yt),r("#hotspotPositionY").val(pt),typeof s[le].hotspots[Le].lockAspectRatio=="boolean"&&r("#hotspotLockAspectRatio").prop("checked",s[le].hotspots[Le].lockAspectRatio);var Ht=se.width(),_t=se.height(),At=Math.round(Ht/_t*100)/100;r("#hotspotSizeWidth").val(Ht),r("#hotspotSizeHeight").val(_t),r("#hotspotAspectRatio").val(At);var It=se.attr("rotationAngle");!isNaN(It)&&It>=0&&It<=360?r("#hotspotRotation").val(It):r("#hotspotRotation").val(0),typeof s[le].hotspots[Le].visibility=="string"?r("#hotspotVisibility").val(s[le].hotspots[Le].visibility):r("#hotspotVisibility").val("visible"),typeof s[le].hotspots[Le].cursorVisibility=="string"?r("#hotspotCursorVisibility").val(s[le].hotspots[Le].cursorVisibility):r("#hotspotCursorVisibility").val("pointer"),e.Editor.Actions.loadActions(r("#hotspotActions"),Ue,"HOTSPOT")},we=function(le){Re();var se=[{src:e.ImagesPath+"hotspotgallery/hotspot.png"},{src:e.ImagesPath+"hotspotgallery/arrow.png"},{src:e.ImagesPath+"hotspotgallery/arrow_turn.png"},{src:e.ImagesPath+"hotspotgallery/magnifying_glass.png"},{src:e.ImagesPath+"hotspotgallery/eye.png"},{src:e.ImagesPath+"hotspotgallery/hand.png"},{src:e.ImagesPath+"hotspotgallery/hand2.png"},{src:e.ImagesPath+"hotspotgallery/wheel.png"},{src:e.ImagesPath+"hotspotgallery/info.png"},{src:e.ImagesPath+"hotspotgallery/dialogue.png"},{src:e.ImagesPath+"hotspotgallery/dialogue2.png",aspectRatio:1.164},{src:e.ImagesPath+"hotspotgallery/pin.png",aspectRatio:.774},{src:e.ImagesPath+"hotspotgallery/close.png"},{src:e.ImagesPath+"hotspotgallery/warning.png"},{src:e.ImagesPath+"hotspotgallery/warning_yellow.png"},{src:e.ImagesPath+"hotspotgallery/warning_red.png"},{src:e.ImagesPath+"hotspotgallery/key.png",aspectRatio:.779},{src:e.ImagesPath+"hotspotgallery/painting.png",aspectRatio:.891},{src:e.ImagesPath+"hotspotgallery/keypad_standard.png"},{src:e.ImagesPath+"hotspotgallery/keypad_retro.png"},{src:e.ImagesPath+"hotspotgallery/keypad_futuristic.png"},{src:e.ImagesPath+"hotspotgallery/decoder_disk_standard.png"},{src:e.ImagesPath+"hotspotgallery/decoder_disk_basic.png"},{src:e.ImagesPath+"hotspotgallery/decoder_disk_retro.png"},{src:e.ImagesPath+"hotspotgallery/decoder_disk_futuristic.png"},{src:e.ImagesPath+"hotspotgallery/safebox_standard.png"},{src:e.ImagesPath+"hotspotgallery/safebox_retro.png"},{src:e.ImagesPath+"hotspotgallery/safebox_futuristic.png",aspectRatio:1.286},{src:e.ImagesPath+"hotspotgallery/signal_generator.png"},{src:e.ImagesPath+"hotspotgallery/switch_standard_off.png",aspectRatio:.767},{src:e.ImagesPath+"hotspotgallery/switch_standard_on.png",aspectRatio:.767},{src:e.ImagesPath+"hotspotgallery/switch_retro_off.png",aspectRatio:.743},{src:e.ImagesPath+"hotspotgallery/switch_retro_on.png",aspectRatio:.743},{src:e.ImagesPath+"hotspotgallery/switch_futuristic_off.png",aspectRatio:.762},{src:e.ImagesPath+"hotspotgallery/switch_futuristic_on.png",aspectRatio:.762},{src:e.ImagesPath+"hotspotgallery/switches_container_standard.png",aspectRatio:1.779},{src:e.ImagesPath+"hotspotgallery/switches_container_retro.png",aspectRatio:1.779},{src:e.ImagesPath+"hotspotgallery/switches_container_futuristic.png",aspectRatio:16/9},{src:e.ImagesPath+"hotspotgallery/wires_container_standard.png",aspectRatio:1.687},{src:e.ImagesPath+"hotspotgallery/wires_container_retro.png",aspectRatio:1.93},{src:e.ImagesPath+"hotspotgallery/wires_container_futuristic.png",aspectRatio:1.875},{src:e.ImagesPath+"hotspotgallery/chessboard_standard.png"},{src:e.ImagesPath+"hotspotgallery/chessboard_realistic.png"},{src:e.ImagesPath+"hotspotgallery/chessboard_futuristic.png"},{src:e.ImagesPath+"hotspotgallery/chessbox_standard.png",aspectRatio:.564},{src:e.ImagesPath+"hotspotgallery/chessbox_realistic.png",aspectRatio:.564},{src:e.ImagesPath+"hotspotgallery/hidden_path_tablet.png",aspectRatio:16/9},{src:e.ImagesPath+"hotspotgallery/hidden_path_map.png",aspectRatio:16/9},{src:e.ImagesPath+"hotspotgallery/hidden_path_futuristic.png",aspectRatio:16/9},{src:e.ImagesPath+"hotspotgallery/basic_text_box.png",aspectRatio:16/9},{src:e.ImagesPath+"hotspotgallery/clock_standard.png"},{src:e.ImagesPath+"hotspotgallery/clock_retro.png"},{src:e.ImagesPath+"hotspotgallery/clock_futuristic.png"},{src:e.ImagesPath+"hotspotgallery/wired_bomb.png",aspectRatio:.82}],Le=[];r.each(se,function(yt,pt){var Ht=r("<img src='"+pt.src+"'/>");typeof pt.aspectRatio=="number"&&Ht.attr("aspectratio",pt.aspectRatio),Le.push(Ht)});var Ue={};Ue.callback=De,Ue.afterDrawCarouselCallback=le,e.Editor.Utils.Loader.loadImagesOnContainer(Le,"hotspotImageGallery",Ue)},De=function(le){var se=r("#hotspotImageGallery"),Le=se.parent();se.show(),e.Utils.addTempShown([Le,se]);var Ue=new Array;Ue.rows=1,Ue.rowItems=9,Ue.scrollItems=9,Ue.afterCreateCarruselFunction=function(){setTimeout(function(){e.Utils.removeTempShown([Le,se]),typeof le.afterDrawCarouselCallback=="function"&&le.afterDrawCarouselCallback()},100)},e.Editor.Carousel.createCarousel("hotspotImageGallery",Ue)},Re=function(){e.Editor.Carousel.cleanCarousel("hotspotImageGallery"),r("#hotspotImageGallery").hide()},je=function(le){var se=le.target.value;if(se==="gallery"){var Le=r("#hotspotImageGallery").parent().parent();r(Le).show(),r("#hotspotImageURLWrapper").hide(),r("#hotspotImageURL").val(""),Pe()}else if(se==="url"){var Le=r("#hotspotImageGallery").parent().parent();r(Le).hide(),r("#hotspotImageURLWrapper").show(),Pe()}},Pe=function(){var le=r("#hotspotImageURLPreviewWrapper"),se=r("#hotspotImageURL").val();typeof se=="string"&&se.trim()!==""?le.html("<img src='"+se+"'>").show():le.html("").hide()},qe=function(le){var se=r(le.target);r("#hotspotImageGallery").find("img").removeClass("selected"),se.addClass("selected");var Le=parseFloat(se.attr("aspectratio"));isNaN(parseFloat(Le))&&(Le=1);var Ue=r("#hotspotSizeWidth").val()/r("#hotspotSizeHeight").val();if(Le!==Ue&&Le>0){var yt=Math.round(r("#hotspotSizeWidth").val()/Le);r("#hotspotSizeHeight").val(yt),r("#hotspotAspectRatio").val(Le)}},ft=function(le){var se=r("#hotspotLockAspectRatio").prop("checked");if(se){var Le=parseFloat(r("#hotspotAspectRatio").val()),Ue=Math.round(r("#hotspotSizeWidth").val()/Le);r("#hotspotSizeHeight").val(Ue)}},Ot=function(le){var se=r("#hotspotLockAspectRatio").prop("checked");if(se){var Le=parseFloat(r("#hotspotAspectRatio").val()),Ue=Math.round(r("#hotspotSizeHeight").val()*Le);r("#hotspotSizeWidth").val(Ue)}},Kt=function(le){var se=r(e.Slides.getCurrentSlide()).attr("id"),Le=r(m),Ue=Le.attr("id"),yt={},pt;switch(r("#hotspotImageSource").val()){case"gallery":var Ht=r("#hotspotImageGallery img.selected");Ht.length&&(pt=Ht.attr("src"));break;case"url":pt=r("#hotspotImageURL").val();break;default:break}typeof pt!="string"&&(pt=e.Marker.getDefaultHotspotImg()),Le.attr("src",pt);var _t=parseFloat(r("#hotspotPositionX").val()),At=parseFloat(r("#hotspotPositionY").val());typeof _t=="number"&&!Number.isNaN(_t)&&_t>=0&&Le.css("left",_t+"px"),typeof At=="number"&&!Number.isNaN(At)&&At>=0&&Le.css("top",At+"px"),yt.lockAspectRatio=r("#hotspotLockAspectRatio").prop("checked");var It=r("#hotspotSizeWidth").val(),Wt=r("#hotspotSizeHeight").val();It>0&&Le.width(It),Wt>0&&Le.height(Wt);var Xt=parseFloat(r("#hotspotRotation").val());!isNaN(Xt)&&Xt>=0&&Xt<=360&&(Le.attr("rotationAngle",Xt),Le.css("transform","rotate("+Xt+"deg)")),yt.visibility=r("#hotspotVisibility").val(),yt.cursorVisibility=r("#hotspotCursorVisibility").val(),U(Le);var Vt=e.Editor.Actions.getActionsJSON(r("#hotspotActions"));Vt.length>0&&(yt.actions=Vt),s[se].hotspots[Ue]=yt,r.fancybox.close()},Zt=function(){var le=r(e.Slides.getCurrentSlide()),se=le.attr("id");if(typeof s[se]=="undefined"||typeof s[se].annotator=="undefined"){var Le=le.children("img.slide_background");if(Le.length===0){te("HOTZONE");return}me(se)}le.find("div > svg.a9s-annotationlayer").css("pointer-events","auto"),s[se].annotator.setDrawingEnabled(!0),s[se].annotator.setUserSelectAction("NONE"),s[se].annotator.off("selectionChanged",oe)},zt=function(){var le=r(e.Slides.getCurrentSlide()),se=le.attr("id");le.find("div > svg.a9s-annotationlayer").css("pointer-events","none"),typeof s[se]!="undefined"&&typeof s[se].annotator!="undefined"&&(s[se].annotator.setDrawingEnabled(!1),s[se].annotator.setUserSelectAction("EDIT"),s[se].annotator.on("selectionChanged",oe))},me=function(le){if(typeof s[le]=="undefined"&&(s[le]=b()),typeof s[le].annotator!="undefined")return s[le].annotator;var se=r("#"+le),Le=e.Slides.getSlideBackgroundImg(se),Ue=Annotorious.createImageAnnotator(Le.attr("id"),{drawingEnabled:!1,drawingMode:"click",userSelectAction:"EDIT",style:{fill:"#dddddd",fillOpacity:.25,stroke:"#000000",strokeWidth:1}});Ue.setDrawingTool("polygon"),Ue.on("createAnnotation",pt=>{T[pt.id]=e.Utils.getId("zone-"),s[le].hotzones[pt.id]={},s[le].hotzones[pt.id].cursorVisibility="default",s[le].hotzones[pt.id].enabled=!0,te("HOTZONE")}),Ue.on("selectionChanged",oe);var yt=r(se.find("div > svg.a9s-annotationlayer").parent());return se.children("img.hotspot").each(function(pt,Ht){yt.append(Ht)}),s[le].annotator=Ue,Ue},oe=function(le){Array.isArray(le)&&le.length===1&&Fe(le[0].id)},Fe=function(le){k==="HOTSPOT"&&te("HOTSPOT"),f=le,e.Editor.Tools.loadToolsForElement("hotzone")},$e=function(){r(V).trigger("click")},ut=function(){var le=r(e.Slides.getCurrentSlide()).attr("id"),se=f,Le=s[le].hotzones[se];r("#hotzoneIdInput").val(T[se]),typeof s[le].hotzones[se].cursorVisibility=="string"?r("#hotzoneCursorVisibility").val(s[le].hotzones[se].cursorVisibility):r("#hotzoneCursorVisibility").val("default"),s[le].hotzones[se].enabled===!1?r("#hotzoneEnabled").val("false"):r("#hotzoneEnabled").val("true"),e.Editor.Actions.loadActions(r("#hotzoneActions"),Le,"HOTZONE")},mt=function(le){var se=r(e.Slides.getCurrentSlide()).attr("id"),Le=f,Ue={};Ue.enabled=r("#hotzoneEnabled").val()!=="false",Ue.cursorVisibility=r("#hotzoneCursorVisibility").val();var yt=e.Editor.Actions.getActionsJSON(r("#hotzoneActions"));yt.length>0&&(Ue.actions=yt),s[se].hotzones[Le]=Ue,r.fancybox.close()},kt=function(){return s},Ft=function(le){s=le},Mt=function(){return m},Lt=function(le){m=le,r("img.hotspot").removeClass("hotspot_selected"),typeof le!="undefined"&&r(le).addClass("hotspot_selected")},Nt=function(){return f},rt=function(le){f=le,typeof le=="undefined"&&tn(r(e.Slides.getCurrentSlide()).attr("id"))},vt=function(le){return T[le]},tn=function(le){typeof s[le]!="undefined"&&typeof s[le].annotator!="undefined"&&s[le].annotator.cancelSelected()},Yt=function(){var le;if(typeof m!="undefined")le=!0;else if(typeof f=="undefined")return;var se={};se.width=375,se.height=130,le?(se.text=e.I18n.getTrans("i.AreYouSureDeleteHotspot"),se.notificationIconSrc=r(m).attr("src"),se.notificationIconClass="notificationIconDeleteHotspot"):(se.text=e.I18n.getTrans("i.AreYouSureDeleteHotzone"),se.notificationIconSrc=e.ImagesPath+"thumbs/hotzone.png");var Le={};Le.text=e.I18n.getTrans("i.no"),Le.callback=function(){r.fancybox.close()};var Ue={};Ue.text=e.I18n.getTrans("i.delete"),Ue.callback=function(){var yt=r(e.Slides.getCurrentSlide()).attr("id");if(le){var pt=r(m),Ht=pt.attr("id");pt.remove(),delete s[yt].hotspots[Ht],Lt(_)}else{var _t=s[yt].annotator;typeof _t!="undefined"&&_t.removeAnnotation(f),delete s[yt].hotzones[f],f=_}e.Editor.Tools.cleanToolbar(),r.fancybox.close()},se.buttons=[Le,Ue],e.Utils.showDialog(se)},Jt=function(le){typeof s!="undefined"&&typeof s[le]!="undefined"&&delete s[le]},Qt=function(){s={},T={},m=_,f=_,k="NONE"},vn=function(le){var se={};se.id=r(le).attr("id"),se.type=r(le).attr("type");var Le=e.Slides.getSlideBackground(le);if(typeof Le=="string"&&(se.background=Le),typeof s[se.id]!="undefined"){var Ue=Object.keys(s[se.id].hotspots);Ue.length>0&&(se.hotspots=[],Ue.forEach(Ht=>{var _t=r("img.hotspot[id='"+Ht+"']"),At=parseFloat(_t.css("left")),It=parseFloat(_t.css("top")),Wt=s[se.id].hotspots[Ht],Xt,Vt;r("body").attr("aspectRatio")==="16:9"?(Xt=1024,Vt=576):(Xt=800,Vt=600);var un=(At*100/Xt).toFixed(4),dn=(It*100/Vt).toFixed(4),hn=(_t.width()*100/Xt).toFixed(4),on=(_t.height()*100/Vt).toFixed(4),fn={id:Ht,x:un,y:dn,image:_t.attr("src"),width:hn,height:on,lockAspectRatio:Wt.lockAspectRatio,rotationAngle:_t.attr("rotationAngle"),visibility:Wt.visibility,cursorVisibility:Wt.cursorVisibility};Array.isArray(Wt.actions)&&Wt.actions.length>0&&(fn.actions=Wt.actions),se.hotspots.push(fn)}));var yt=s[se.id].annotator;if(typeof yt!="undefined"){var pt=yt.getAnnotations();pt.length>0&&(se.hotzones=[],pt.forEach(Ht=>{var _t=Ht.id,At=s[se.id].hotzones[_t],It=Ht.target.selector.geometry.points,Wt={id:_t,idAlias:T[_t],points:It,cursorVisibility:At.cursorVisibility,enabled:At.enabled};Array.isArray(At.actions)&&At.actions.length>0&&(Wt.actions=At.actions),se.hotzones.push(Wt)}))}se=e.Editor.Caption.saveCaption(se)}return se};return{init:O,drawSlideWithMakers:R,refreshDraggables:re,copyMarkers:y,addHotspot:P,addHotzone:N,onClick:ne,getSlideData:kt,setSlideData:Ft,getDefaultSlideConfig:b,getCurrentHotspot:Mt,setCurrentHotspot:Lt,showHotspotSettings:lt,getCurrentHotzoneId:Nt,setCurrentHotzoneId:rt,getAliasForHotzone:vt,showHotzoneSettings:$e,cancelAnnotationSelectedForSlide:tn,deleteCurrentHotmarker:Yt,afterDeleteSlide:Jt,resetData:Qt,onHotspotImageSourceChange:je,onClickHotspotImageGallery:qe,checkHotspotImageURLPreview:Pe,onInputHotspotSizeWidth:ft,onInputHotspotSizeHeight:Ot,onHotspotSettingsDone:Kt,onHotzoneSettingsDone:mt,saveSlideWithMarkers:vn}})(SceneMaker,jQuery),SceneMaker.Editor.Actions=(function(e,r,_){var p=!1,s=function(){if(!p){p=!0;var S=[],h=e.Editor.getOptions().nPuzzles;if(typeof h=="number"&&h>0)for(var w=0;w<h;w++){var P=w+1;S.push({value:P,text:e.I18n.getTrans("i.PuzzleOption",{number:P})})}r("div.actionWrapperTemplate div.actionParamsPuzzle select, div.actionWrapperTemplate div.actionEventParamsPuzzle select").each(function(){var N=r(this);N.empty(),N.append(r("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),r.each(S,function(X,te){N.append(r("<option>",{value:te.value,text:te.text}))})})}},m=function(S){var h=r("div.actionWrapperTemplate"),w=[];r('article[type="'+e.Constant.SCREEN+'"]').each(function(){var F=r(this);w.push({value:F.attr("id"),text:e.I18n.getTrans("i.ScreenOption",{number:F.attr("slidenumber")})})}),h.find("div.actionParamsScreen select").each(function(){var F=r(this);F.empty(),F.append(r("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),r.each(w,function(H,W){F.append(r("<option>",{value:W.value,text:W.text}))})}),h.find("div.actionParamsScreenReplacement select").each(function(){var F=r(this);F.empty(),F.append(r("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),r.each(w,function(H,W){F.append(r("<option>",{value:W.value,text:W.text}))})});var P=[],N=[],X=[],te=r(e.Screen.getCurrentScreen()),ne=te.attr("id");r("article[type='screen'] > article").each(function(){var F=r(this),H=r(this).parent(),W={value:F.attr("id"),text:e.I18n.getTrans("i.ViewOption",{screenNumber:H.attr("slidenumber"),viewNumber:F.attr("slidenumber")})};P.push(W),H.attr("id")===ne&&N.push(W),F.attr("type")===e.Constant.VIEW_IMAGE&&X.push(W)});var K;S==="SCENE"?K=P:K=N,h.find("div.actionParamsView select").each(function(){var F=r(this);F.empty(),F.append(r("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),r.each(K,function(H,W){F.append(r("<option>",{value:W.value,text:W.text}))})}),h.find("div.actionEventParamsSlide select").each(function(){var F=r(this);F.empty(),F.append(r("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),r.each(w,function(H,W){F.append(r("<option>",{value:W.value,text:W.text}))}),r.each(P,function(H,W){F.append(r("<option>",{value:W.value,text:W.text}))})}),h.find("div.actionParamsSlide select").each(function(){var F=r(this);F.empty(),F.append(r("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),r.each(w,function(H,W){F.append(r("<option>",{value:W.value,text:W.text}))}),r.each(X,function(H,W){F.append(r("<option>",{value:W.value,text:W.text}))})});var M=[];r("img.hotspot").each(function(){var F=r(this);M.push({value:F.attr("id"),text:F.attr("id")})}),h.find("div.actionParamsHotspotId select").each(function(){var F=r(this);F.empty(),F.append(r("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),r.each(M,function(H,W){F.append(r("<option>",{value:W.value,text:W.text}))})});var J=[],U=e.Editor.Marker.getSlideData();Object.keys(U).forEach((F,H)=>{Object.keys(U[F].hotzones).forEach((W,re)=>{J.push({value:W,text:e.Editor.Marker.getAliasForHotzone(W)})})}),h.find("div.actionParamsHotzoneId select").each(function(){var F=r(this);F.empty(),F.append(r("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),r.each(J,function(H,W){F.append(r("<option>",{value:W.value,text:W.text}))})})},f=function(S,h,w){if(r(S).find("div.actionWrapper:not(.actionWrapperTemplate)").remove(),m(w),r(S).addClass("actions_container"),typeof w=="string"&&r(S).addClass("actions_container_"+w),Array.isArray(h.actions)&&h.actions.length>0)for(var P=0;P<h.actions.length;P++){var N=h.actions[P];if(typeof N.actionType=="string"&&N.actionType!=="none"){var X=T(S);if(typeof N.event!="undefined"&&typeof N.event.eventType=="string"&&N.event.eventType!=="none"&&(X.find("select.actionEvent").val(N.event.eventType).trigger("change"),typeof N.event.eventParams!="undefined")){if(typeof N.event.eventParams.puzzleId=="string"){var te=X.find("div.actionEventParamsPuzzle select");te.val(N.event.eventParams.puzzleId)}if(typeof N.event.eventParams.slide=="string"){var ne=X.find("div.actionEventParamsSlide select");ne.val(N.event.eventParams.slide)}}if(X.find("select.actionType").val(N.actionType).trigger("change"),typeof N.actionParams!="undefined"){if(typeof N.actionParams.screen=="string"){var K=X.find("div.actionParamsScreen select");K.val(N.actionParams.screen)}if(typeof N.actionParams.screenReplacement=="string"){var M=X.find("div.actionParamsScreenReplacement select");M.val(N.actionParams.screenReplacement)}if(typeof N.actionParams.view=="string"){var J=X.find("div.actionParamsView select");J.val(N.actionParams.view)}if(typeof N.actionParams.slide=="string"){var U=X.find("div.actionParamsSlide select");U.val(N.actionParams.slide)}if(typeof N.actionParams.text=="string"){var F=X.find("div.actionParamsText textarea");F.val(N.actionParams.text)}if(typeof N.actionParams.url=="string"){var H=X.find("div.actionParamsURL input");H.val(N.actionParams.url)}if(typeof N.actionParams.hotspotId=="string"){var W=X.find("div.actionParamsHotspotId select");W.val(N.actionParams.hotspotId)}if(typeof N.actionParams.hotzoneId=="string"){var re=X.find("div.actionParamsHotzoneId select");re.val(N.actionParams.hotzoneId)}if(typeof N.actionParams.puzzleId=="string"){var y=X.find("div.actionParamsPuzzle select");y.val(N.actionParams.puzzleId),O(N.actionParams.puzzleId,X)}if(typeof N.actionParams.delay=="string"){const ce=parseInt(N.actionParams.delay,10);if(!Number.isNaN(ce)&&ce>0){var ke=X.find("div.actionParamsDelay input");ke.val(ce)}}}}}},T=function(S){var h=r("div.actionWrapperTemplate").clone().removeClass("actionWrapperTemplate").show(),w=r(S);if(w.hasClass("actions_container_SCENE")){var P=["none","goToScreen","openView","showHotspot","hideHotspot","enableHotzone","disableHotzone","changeBackground","changeScreen","playSound","stopSound"];h.find("select.actionType option").each(function(){var N=r(this).val();P.includes(N)||r(this).remove()})}else h.find("div.setting_scene").remove();return r(S).append(h),h},k=function(S){var h=S.target.value,w=r(S.target).closest("div.actionWrapper"),P=w.find("div.actionEventParamsSlide"),N=P.find("select"),X=w.find("div.actionEventParamsPuzzle"),te=X.find("select");h==="puzzleSolved"?(te.prop("selectedIndex",0),X.show()):X.hide(),h==="slideRevealedFirstTime"||h==="slideRevealed"?(N.prop("selectedIndex",0),P.show()):P.hide()},D=function(S){var h=S.target.value,w=r(S.target).closest("div.actionWrapper"),P=w.find("div.actionParamsScreen"),N=P.find("select"),X=w.find("div.actionParamsScreenReplacement"),te=X.find("select"),ne=w.find("div.actionParamsView"),K=ne.find("select"),M=w.find("div.actionParamsSlide"),J=M.find("select"),U=w.find("div.actionParamsText"),F=U.find("textarea"),H=w.find("div.actionParamsURL"),W=H.find("input"),re=w.find("div.actionParamsHotspotId"),y=re.find("select"),ke=w.find("div.actionParamsHotzoneId"),ce=ke.find("select"),Ge=w.find("div.actionParamsPuzzle"),lt=Ge.find("select"),c=w.find("div.actionParamsPuzzleSolution"),we=w.find("div.actionParamsDelay"),De=we.find("input"),Re=w.find("div.ActionWarningChangeBackground");h==="goToScreen"||h==="changeScreen"?(N.prop("selectedIndex",0),P.show()):P.hide(),h==="changeScreen"?(te.prop("selectedIndex",0),X.show()):X.hide(),h==="openView"?(K.prop("selectedIndex",0),ne.show()):ne.hide(),h==="changeBackground"?(J.prop("selectedIndex",0),M.show(),Re.show()):(M.hide(),Re.hide()),h==="showText"?(F.val(""),U.show()):U.hide(),h==="openLink"||h==="changeBackground"||h==="playSound"||h==="stopSound"?(W.val(""),H.show()):H.hide(),h==="showHotspot"||h==="hideHotspot"?(y.prop("selectedIndex",0),re.show()):re.hide(),h==="enableHotzone"||h==="disableHotzone"?(ce.prop("selectedIndex",0),ke.show()):ke.hide(),h==="solvePuzzle"?(lt.prop("selectedIndex",0),Ge.show()):Ge.hide(),h!=="none"?(De.val("0"),we.show()):we.hide(),c.hide()},V=function(S){var h=S.target.value,w=r(S.target).closest("div.actionWrapper");O(h,w)},O=function(S,h){var w=h.find("div.actionParamsPuzzleSolution"),P=w.find("input");if(S!=="none"){var N=h.parent(),X="";N.hasClass("actions_container_HOTSPOT")?X=r("#hotspotIdInput").val():N.hasClass("actions_container_HOTZONE")&&(X=r("#hotzoneIdInput").val()),P.val(X),w.show()}else P.val(),w.hide()},b=function(S){r(S.target).closest(".actionWrapper").remove()},R=function(S){var h=[],w=r(S).hasClass("actions_container_SCENE");return r(S).find("div.actionWrapper").each(function(P,N){var X=r(this),te=X.find("select.actionType").val();if(te!=="none"){var ne={actionType:te,actionParams:{}},K=X.find("div.actionParamsScreen select");K.is(":visible")&&(ne.actionParams.screen=K.val());var M=X.find("div.actionParamsScreenReplacement select");M.is(":visible")&&(ne.actionParams.screenReplacement=M.val());var J=X.find("div.actionParamsView select");J.is(":visible")&&(ne.actionParams.view=J.val());var U=X.find("div.actionParamsSlide select");U.is(":visible")&&(ne.actionParams.slide=U.val());var F=X.find("div.actionParamsText textarea");F.is(":visible")&&(ne.actionParams.text=F.val());var H=X.find("div.actionParamsURL input");H.is(":visible")&&(ne.actionParams.url=e.Editor.Utils.autocompleteUrls(H.val()));var W=X.find("div.actionParamsHotspotId select");W.is(":visible")&&(ne.actionParams.hotspotId=W.val());var re=X.find("div.actionParamsHotzoneId select");re.is(":visible")&&(ne.actionParams.hotzoneId=re.val());var y=X.find("div.actionParamsPuzzle select");y.is(":visible")&&(ne.actionParams.puzzleId=y.val());var ke=X.find("div.actionParamsDelay input");if(ke.is(":visible")){const c=parseInt(ke.val(),10);!Number.isNaN(c)&&c>0&&(ne.actionParams.delay=c+"")}Object.keys(ne.actionParams).length===0&&delete ne.actionParams;var ce=X.find("select.actionEvent").val();if(ce!=="none"){ne.event={eventType:ce,eventParams:{}};var Ge=X.find("div.actionEventParamsPuzzle select");Ge.is(":visible")&&(ne.event.eventParams.puzzleId=Ge.val());var lt=X.find("div.actionEventParamsSlide select");lt.is(":visible")&&(ne.event.eventParams.slide=lt.val())}if(w&&typeof ne.event=="undefined")return;h.push(ne)}}),h};return{init:s,loadActions:f,onActionEventChange:k,onActionTypeChange:D,addNewAction:T,onPuzzleChange:V,onDeleteAction:b,getActionsJSON:R}})(SceneMaker,jQuery),SceneMaker.Editor.Caption=(function(e,r,_){var p=!1,s,m=function(){p||(p=!0,s=r('<a href="#caption_fancybox" style="display:none"></a>'),r(s).fancybox({autoDimensions:!1,height:690,width:920,scrolling:"no",showCloseButton:!1,padding:0,onStart:function(b){f()},onComplete:function(b){},onClosed:function(b){}}))},f=function(){var b=r(e.Slides.getCurrentSlide()).attr("id"),R=e.Editor.Marker.getSlideData(),S={};typeof R[b]!="undefined"&&typeof R[b].caption!="undefined"&&(S=R[b].caption),typeof S.text=="string"?r("#captionText").val(S.text):r("#captionText").val(""),typeof S.mode=="string"?r("#captionMode").val(S.mode):r("#captionMode").val("minimizable")},T=function(){r(s).trigger("click")},k=function(b){var R=r(e.Slides.getCurrentSlide()).attr("id"),S={};S.text=r("#captionText").val(),S.mode=r("#captionMode").val();var h=e.Editor.Marker.getSlideData();typeof h[R]=="undefined"&&(h[R]=e.Editor.Marker.getDefaultSlideConfig()),h[R].caption=S,e.Editor.Marker.setSlideData(h),r.fancybox.close()},D=function(b,R){if(O(R)!==!1){var S=e.Editor.Marker.getSlideData();typeof S[b]=="undefined"&&(S[b]=e.Editor.Marker.getDefaultSlideConfig()),S[b].caption=R,e.Editor.Marker.setSlideData(S)}},V=function(b){var R=e.Editor.Marker.getSlideData();return typeof R[b.id]!="undefined"&&O(R[b.id].caption)&&(b.caption=R[b.id].caption),b},O=function(b){return!(typeof b!="object"||typeof b.text!="string")};return{init:m,addCaption:T,onCaptionDone:k,loadCaption:D,saveCaption:V}})(SceneMaker,jQuery),SceneMaker.Editor.Preview=(function(e,r,_){var p=function(){},s=function(){var k=1;typeof e.PreviewPath!="undefined"&&r("#preview_action").attr("href",e.PreviewPath+"#"+k),window.SCENE_MAKER_OPTIONS_PREVIEW=JSON.parse(JSON.stringify(e.Utils.getOptions())),window.SCENE_MAKER_OPTIONS_PREVIEW.preview=!0,window.SCENE_MAKER_OPTIONS_PREVIEW.scene=e.Editor.saveScene(),m(),r("#preview_action").trigger("click")},m=function(){r("#preview_action").fancybox({width:f().width,height:f().height,padding:0,autoScale:!1,transitionIn:"none",transitionOut:"none",type:"iframe",onStart:function(){e.Editor.Utils.Loader.unloadObjectsInEditorSlide(e.Screen.getCurrentScreen())},onClosed:function(){e.Editor.Utils.Loader.loadObjectsInEditorSlide(e.Screen.getCurrentScreen())},onComplete:function(){}})},f=function(){var k={};return r("body").attr("aspectRatio")==="16:9"?(k.width=1e3,k.height=670):(k.width=910,k.height=680),k},T=function(){return scenePreview};return{init:p,preview:s,getPreview:T}})(SceneMaker,jQuery),SceneMaker.Editor.Clipboard=(function(e,r,_){var p,s,m="SceneMakerClipboard",f=function(){p=[null,null,null]},T=function(D){if(!(!D||!e.Slides.isScreen(D))){p[0]=e.Utils.getOuterHTML(r(D).clone()[0]);var V={};V.textAreas=e.Editor.Slides.copyTextAreasOfSlide(D),p[1]=V,e.Status.getDevice().features.localStorage&&localStorage.setItem(m,JSON.stringify(p))}},k=function(){if(s){var D=new Date().getTime()-s;if(D<500)return}if(s=new Date().getTime(),e.Status.getDevice().features.localStorage){var V=localStorage.getItem(m);if(V!==null)var O=JSON.parse(V)}if(O||(O=p),O[0])O[0]=r(O[0])[0];else return;var b=r(O[0]).clone()[0],R={};O[1]&&O[1].textAreas&&(R.textAreas=O[1].textAreas),e.Editor.Screen.copyScreen(b,R)};return{init:f,copy:T,paste:k}})(SceneMaker,jQuery),SceneMaker.Editor.Events=(function(e,r,_){var p=!1,s,m=!1,f=function(){p||(p=!0,r(document).on("click","#addScreenButton",e.Editor.Screen.onClickAddScreenButton),r(document).on("click","#addViewButton",e.Editor.View.onClickAddViewButton),r(document).on("click","#screen_selected_img",e.Editor.Screen.onClickOpenScreen),r(document).on("click","#save_scene_details",e.Editor.Settings.onSaveSceneSettingsButtonClicked),r(document).on("click","div.viewthumb",e.Editor.onViewThumbClicked),r(document).on("click",".editable",e.Editor.onEditableClicked),r(document).on("click",".selectable",e.Editor.onSelectableClicked),r(document).on("click",':not(".selectable"):not(".preventNoselectable")',e.Editor.onNoSelectableClicked),r(document).on("click",".delete_screen",e.Editor.Screen.onDeleteScreenClicked),r(document).on("click",".delete_view",e.Editor.View.onDeleteViewClicked),r(document).on("click",".delete_content",e.Editor.onDeleteItemClicked),r(document).on("click",".change_bg_button",e.Editor.Tools.changeBackground),r(document).on("click","#tab_pic_from_url_content button.button_addContent",e.Editor.Image.addContent),r(document).on("click","#tab_object_from_url_content button.button_addContent",e.Editor.Object.drawPreviewElement),r(document).on("click","#tab_video_from_url_content button.button_addContent",e.Editor.Video.addContent),r(document).on("change","#hotspotImageSource",e.Editor.Marker.onHotspotImageSourceChange),r(document).on("click","#hotspotImageGallery img",e.Editor.Marker.onClickHotspotImageGallery),r(document).on("blur","#hotspotImageURL",e.Editor.Marker.checkHotspotImageURLPreview),r(document).on("input","#hotspotSizeWidth",e.Editor.Marker.onInputHotspotSizeWidth),r(document).on("input","#hotspotSizeHeight",e.Editor.Marker.onInputHotspotSizeHeight),r(document).on("click","#hotspotSettingsDone",e.Editor.Marker.onHotspotSettingsDone),r(document).on("click","#hotzoneSettingsDone",e.Editor.Marker.onHotzoneSettingsDone),r(document).on("click","div.actions_container button.add_action",function(){e.Editor.Actions.addNewAction(r(this).closest("div.actions_container"))}),r(document).on("change","select.actionEvent",e.Editor.Actions.onActionEventChange),r(document).on("change","select.actionType",e.Editor.Actions.onActionTypeChange),r(document).on("click","div.delete_action",e.Editor.Actions.onDeleteAction),r(document).on("change","div.actionParamsPuzzle select",e.Editor.Actions.onPuzzleChange),r(document).on("click","#objectSettingsDone",e.Editor.Object.onObjectSettingsDone),r(document).on("click","#captionDone",e.Editor.Caption.onCaptionDone),r(document).on("change","#import_file_input",e.Editor.onImportFileChange),r(document).on("click","#import_file_button",e.Editor.importSceneFromJSON),r(document).on("click",k),r(document).bind("keydown",D),r(document).bind("keyup",V),r("article").live("slideenter",e.Editor.onSlideEnterEditor),r("article").live("slideleave",e.Editor.onSlideLeaveEditor),r(document).on("click","#waiting_overlay",function(R){R.stopPropagation(),R.preventDefault()}),r(window).on("orientationchange",function(){r(window).trigger("resize")}),r("a#addViewFancybox").fancybox({autoDimensions:!1,scrolling:"no",width:800,height:740,padding:0,onStart:function(R){e.Editor.setContentAddMode(e.Constant.VIEW);var S=r(R).attr("zone");e.Editor.setCurrentArea(r("#"+S)),e.Editor.Utils.loadTab("tab_views")},onClosed:function(R){e.Editor.setContentAddMode(e.Constant.NONE)}}),r("a#importSceneFancybox").fancybox({autoDimensions:!1,scrolling:"no",width:800,height:740,padding:0,onStart:function(R){r("#import_file_input").val(""),r("#import_file_button").hide(),e.Editor.Utils.loadTab("tab_import")},onClosed:function(R){}}),r("#fancyLoad").fancybox({type:"inline",autoDimensions:!1,scrolling:"no",autoScale:!0,width:"100%",height:"100%",padding:0,margin:0,overlayOpacity:0,overlayColor:"#fff",showCloseButton:!1,onComplete:function(R){e.Utils.Loader.prepareFancyboxForFullLoading()},onClosed:function(R){}}),r("#hidden_button_to_change_slide_background").fancybox({autoDimensions:!1,width:800,scrolling:"no",height:600,padding:0,onStart:function(R){e.Editor.Image.setAddContentMode(e.Constant.SCREEN),e.Editor.Utils.loadTab("tab_pic_from_url")},onClosed:function(R){e.Editor.Image.setAddContentMode(e.Constant.NONE)}}),window.onbeforeunload=O,s=!0)},T=function(R){r(R).find("a.addpicture").fancybox({autoDimensions:!1,width:800,scrolling:"no",height:600,padding:0,onStart:function(S){var h=r(S).attr("zone");e.Editor.setCurrentArea(r("#"+h)),e.Editor.Image.setAddContentMode(e.Constant.NONE),e.Editor.Utils.loadTab("tab_pic_from_url")}}),r(R).find("a.addobject").fancybox({autoDimensions:!1,width:800,height:600,scrolling:"no",padding:0,onStart:function(S){var h=r(S).attr("zone");e.Editor.setCurrentArea(r("#"+h)),e.Editor.Utils.loadTab("tab_object_from_url")},onClosed:function(S){e.Editor.Object.resetPreview("tab_object_from_url_content")}}),r(R).find("a.addvideo").fancybox({autoDimensions:!1,width:800,scrolling:"no",height:600,padding:0,onStart:function(S){var h=r(S).attr("zone");e.Editor.setCurrentArea(r("#"+h)),e.Editor.Utils.loadTab(e.Editor.Video.getDefaultTab())},onClosed:function(S){e.Editor.Object.resetPreview("tab_video_from_url_content")}})},k=function(R){e.Editor.Marker.onClick(R)},D=function(R){switch(R.keyCode){case 39:e.Editor.Slides.isSlideFocused()&&(e.Slides.isScreen(e.Screen.getCurrentScreen())&&e.Editor.View.forwardOneView(),R.preventDefault());break;case 40:e.Editor.Slides.isSlideFocused()&&(e.Screen.forwardOneScreen(),R.preventDefault());break;case 37:e.Editor.Slides.isSlideFocused()&&(e.Slides.isScreen(e.Screen.getCurrentScreen())&&e.Editor.View.backwardOneView(),R.preventDefault());break;case 38:e.Editor.Slides.isSlideFocused()&&(e.Screen.backwardOneScreen(),R.preventDefault());break;case 17:m=!0;break;case 67:e.Editor.Slides.isSlideFocused()&&m&&e.Screen.getCurrentScreenNumber()&&e.Editor.Clipboard.copy(e.Screen.getCurrentScreen());break;case 86:e.Editor.Slides.isSlideFocused()&&m&&e.Editor.Clipboard.paste();break;case 46:e.Editor.Slides.isSlideFocused()&&e.Editor.Slides.removeCurrentSlide();break}},V=function(R){switch(R.keyCode){case 17:m=!1;break}},O=function(){if(s&&e.Editor.hasSceneChanged()){var R=e.I18n.getTrans("i.ExitConfirmation");return R}},b=function(){s=!1};return{init:f,addZoneThumbsEvents:T,allowExitWithoutConfirmation:b}})(SceneMaker,jQuery);
