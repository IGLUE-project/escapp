var SceneMaker=SceneMaker||{};SceneMaker.VERSION="1.0.0",SceneMaker.getOptions=function(){try{if(window.parent.SCENE_MAKER_OPTIONS_PREVIEW)return window.parent.SCENE_MAKER_OPTIONS_PREVIEW;if(window.SCENE_MAKER_OPTIONS)return window.SCENE_MAKER_OPTIONS;if(window.parent.SCENE_MAKER_OPTIONS)return window.parent.SCENE_MAKER_OPTIONS}catch(e){}};/*! jQuery v1.7.2 jquery.com | jquery.org/license */(function(e,n){function w(a){return h.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function l(a){if(!Hn[a]){var u=ce.body,y=h("<"+a+">").appendTo(u),_=y.css("display");y.remove(),(_==="none"||_==="")&&(pn||(pn=ce.createElement("iframe"),pn.frameBorder=pn.width=pn.height=0),u.appendChild(pn),(!kn||!pn.createElement)&&(kn=(pn.contentWindow||pn.contentDocument).document,kn.write((h.support.boxModel?"<!doctype html>":"")+"<html><body>"),kn.close()),y=kn.createElement(a),kn.body.appendChild(y),_=h.css(y,"display"),u.removeChild(pn)),Hn[a]=_}return Hn[a]}function c(a,u){var y={};return h.each(Vn.concat.apply([],Vn.slice(0,u)),function(){y[this]=a}),y}function m(){hn=n}function f(){return setTimeout(m,0),hn=h.now()}function T(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}function A(){try{return new e.XMLHttpRequest}catch(a){}}function D(a,u){a.dataFilter&&(u=a.dataFilter(u,a.dataType));var y=a.dataTypes,_={},P,U,X=y.length,K,fe=y[0],ae,_e,he,ye,Ce;for(P=1;P<X;P++){if(P===1)for(U in a.converters)typeof U=="string"&&(_[U.toLowerCase()]=a.converters[U]);if(ae=fe,fe=y[P],fe==="*")fe=ae;else if(ae!=="*"&&ae!==fe){if(_e=ae+" "+fe,he=_[_e]||_["* "+fe],!he){Ce=n;for(ye in _)if(K=ye.split(" "),(K[0]===ae||K[0]==="*")&&(Ce=_[K[1]+" "+fe],Ce)){ye=_[ye],ye===!0?he=Ce:Ce===!0&&(he=ye);break}}!he&&!Ce&&h.error("No conversion from "+_e.replace(" "," to ")),he!==!0&&(u=he?he(u):Ce(ye(u)))}}return u}function z(a,u,y){var _=a.contents,P=a.dataTypes,U=a.responseFields,X,K,fe,ae;for(K in U)K in y&&(u[U[K]]=y[K]);for(;P[0]==="*";)P.shift(),X===n&&(X=a.mimeType||u.getResponseHeader("content-type"));if(X){for(K in _)if(_[K]&&_[K].test(X)){P.unshift(K);break}}if(P[0]in y)fe=P[0];else{for(K in y){if(!P[0]||a.converters[K+" "+P[0]]){fe=K;break}ae||(ae=K)}fe=fe||ae}if(fe)return fe!==P[0]&&P.unshift(fe),y[fe]}function O(a,u,y,_){if(h.isArray(u))h.each(u,function(U,X){y||ci.test(a)?_(a,X):O(a+"["+(typeof X=="object"?U:"")+"]",X,y,_)});else if(!y&&h.type(u)==="object")for(var P in u)O(a+"["+P+"]",u[P],y,_);else _(a,u)}function E(a,u){var y,_,P=h.ajaxSettings.flatOptions||{};for(y in u)u[y]!==n&&((P[y]?a:_||(_={}))[y]=u[y]);_&&h.extend(!0,a,_)}function L(a,u,y,_,P,U){P=P||u.dataTypes[0],U=U||{},U[P]=!0;for(var X=a[P],K=0,fe=X?X.length:0,ae=a===ti,_e;K<fe&&(ae||!_e);K++)_e=X[K](u,y,_),typeof _e=="string"&&(!ae||U[_e]?_e=n:(u.dataTypes.unshift(_e),_e=L(a,u,y,_,_e,U)));return(ae||!_e)&&!U["*"]&&(_e=L(a,u,y,_,"*",U)),_e}function v(a){return function(u,y){if(typeof u!="string"&&(y=u,u="*"),h.isFunction(y))for(var _=u.toLowerCase().split(pi),P=0,U=_.length,X,K,fe;P<U;P++)X=_[P],fe=/^\+/.test(X),fe&&(X=X.substr(1)||"*"),K=a[X]=a[X]||[],K[fe?"unshift":"push"](y)}}function p(a,u,y){var _=u==="width"?a.offsetWidth:a.offsetHeight,P=u==="width"?1:0,U=4;if(_>0){if(y!=="border")for(;P<U;P+=2)y||(_-=parseFloat(h.css(a,"padding"+_n[P]))||0),y==="margin"?_+=parseFloat(h.css(a,y+_n[P]))||0:_-=parseFloat(h.css(a,"border"+_n[P]+"Width"))||0;return _+"px"}if(_=Sn(a,u),(_<0||_==null)&&(_=a.style[u]),fn.test(_))return _;if(_=parseFloat(_)||0,y)for(;P<U;P+=2)_+=parseFloat(h.css(a,"padding"+_n[P]))||0,y!=="padding"&&(_+=parseFloat(h.css(a,"border"+_n[P]+"Width"))||0),y==="margin"&&(_+=parseFloat(h.css(a,y+_n[P]))||0);return _+"px"}function S(a){var u=ce.createElement("div");return wn.appendChild(u),u.innerHTML=a.outerHTML,u.firstChild}function k(a){var u=(a.nodeName||"").toLowerCase();u==="input"?F(a):u!=="script"&&typeof a.getElementsByTagName!="undefined"&&h.grep(a.getElementsByTagName("input"),F)}function F(a){(a.type==="checkbox"||a.type==="radio")&&(a.defaultChecked=a.checked)}function G(a){return typeof a.getElementsByTagName!="undefined"?a.getElementsByTagName("*"):typeof a.querySelectorAll!="undefined"?a.querySelectorAll("*"):[]}function Z(a,u){var y;u.nodeType===1&&(u.clearAttributes&&u.clearAttributes(),u.mergeAttributes&&u.mergeAttributes(a),y=u.nodeName.toLowerCase(),y==="object"?u.outerHTML=a.outerHTML:y!=="input"||a.type!=="checkbox"&&a.type!=="radio"?y==="option"?u.selected=a.defaultSelected:y==="input"||y==="textarea"?u.defaultValue=a.defaultValue:y==="script"&&u.text!==a.text&&(u.text=a.text):(a.checked&&(u.defaultChecked=u.checked=a.checked),u.value!==a.value&&(u.value=a.value)),u.removeAttribute(h.expando),u.removeAttribute("_submit_attached"),u.removeAttribute("_change_attached"))}function te(a,u){if(u.nodeType===1&&h.hasData(a)){var y,_,P,U=h._data(a),X=h._data(u,U),K=U.events;if(K){delete X.handle,X.events={};for(y in K)for(_=0,P=K[y].length;_<P;_++)h.event.add(u,y,K[y][_])}X.data&&(X.data=h.extend({},X.data))}}function M(a,u){return h.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function V(a){var u=at.split("|"),y=a.createDocumentFragment();if(y.createElement)for(;u.length;)y.createElement(u.pop());return y}function ie(a,u,y){if(u=u||0,h.isFunction(u))return h.grep(a,function(P,U){var X=!!u.call(P,U,P);return X===y});if(u.nodeType)return h.grep(a,function(P,U){return P===u===y});if(typeof u=="string"){var _=h.grep(a,function(P){return P.nodeType===1});if(Ne.test(u))return h.filter(u,_,!y);u=h.filter(u,_)}return h.grep(a,function(P,U){return h.inArray(P,u)>=0===y})}function R(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function Y(){return!0}function N(){return!1}function Q(a,u,y){var _=u+"defer",P=u+"queue",U=u+"mark",X=h._data(a,_);X&&(y==="queue"||!h._data(a,P))&&(y==="mark"||!h._data(a,U))&&setTimeout(function(){!h._data(a,P)&&!h._data(a,U)&&(h.removeData(a,_,!0),X.fire())},0)}function oe(a){for(var u in a)if(!(u==="data"&&h.isEmptyObject(a[u]))&&u!=="toJSON")return!1;return!0}function b(a,u,y){if(y===n&&a.nodeType===1){var _="data-"+u.replace(ot,"-$1").toLowerCase();if(y=a.getAttribute(_),typeof y=="string"){try{y=y==="true"?!0:y==="false"?!1:y==="null"?null:h.isNumeric(y)?+y:Xe.test(y)?h.parseJSON(y):y}catch(P){}h.data(a,u,y)}else y=n}return y}function Le(a){var u=Re[a]={},y,_;for(a=a.split(/\s+/),y=0,_=a.length;y<_;y++)u[a[y]]=!0;return u}var ce=e.document,J=e.navigator,me=e.location,h=(function(){function a(){if(!u.isReady){try{ce.documentElement.doScroll("left")}catch(re){setTimeout(a,1);return}u.ready()}}var u=function(re,ke){return new u.fn.init(re,ke,P)},y=e.jQuery,_=e.$,P,U=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,X=/\S/,K=/^\s+/,fe=/\s+$/,ae=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,_e=/^[\],:{}\s]*$/,he=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,ye=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Ce=/(?:^|:|,)(?:\s*\[)+/g,lt=/(webkit)[ \/]([\w.]+)/,$e=/(opera)(?:.*version)?[ \/]([\w.]+)/,ct=/(msie) ([\w.]+)/,pt=/(mozilla)(?:.*? rv:([\w.]+))?/,Mt=/-([a-z]|[0-9])/ig,Yt=/^-ms-/,bt=function(re,ke){return(ke+"").toUpperCase()},q=J.userAgent,ee,be,xe,De=Object.prototype.toString,Ae=Object.prototype.hasOwnProperty,Ve=Array.prototype.push,Je=Array.prototype.slice,Ke=String.prototype.trim,mt=Array.prototype.indexOf,Ft={};return u.fn=u.prototype={constructor:u,init:function(re,ke,Ze){var Be,rt,Dt,jt;if(!re)return this;if(re.nodeType)return this.context=this[0]=re,this.length=1,this;if(re==="body"&&!ke&&ce.body)return this.context=ce,this[0]=ce.body,this.selector=re,this.length=1,this;if(typeof re=="string"){if(re.charAt(0)!=="<"||re.charAt(re.length-1)!==">"||re.length<3?Be=U.exec(re):Be=[null,re,null],Be&&(Be[1]||!ke)){if(Be[1])return ke=ke instanceof u?ke[0]:ke,jt=ke?ke.ownerDocument||ke:ce,Dt=ae.exec(re),Dt?u.isPlainObject(ke)?(re=[ce.createElement(Dt[1])],u.fn.attr.call(re,ke,!0)):re=[jt.createElement(Dt[1])]:(Dt=u.buildFragment([Be[1]],[jt]),re=(Dt.cacheable?u.clone(Dt.fragment):Dt.fragment).childNodes),u.merge(this,re);if(rt=ce.getElementById(Be[2]),rt&&rt.parentNode){if(rt.id!==Be[2])return Ze.find(re);this.length=1,this[0]=rt}return this.context=ce,this.selector=re,this}return!ke||ke.jquery?(ke||Ze).find(re):this.constructor(ke).find(re)}return u.isFunction(re)?Ze.ready(re):(re.selector!==n&&(this.selector=re.selector,this.context=re.context),u.makeArray(re,this))},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return Je.call(this,0)},get:function(re){return re==null?this.toArray():re<0?this[this.length+re]:this[re]},pushStack:function(re,ke,Ze){var Be=this.constructor();return u.isArray(re)?Ve.apply(Be,re):u.merge(Be,re),Be.prevObject=this,Be.context=this.context,ke==="find"?Be.selector=this.selector+(this.selector?" ":"")+Ze:ke&&(Be.selector=this.selector+"."+ke+"("+Ze+")"),Be},each:function(re,ke){return u.each(this,re,ke)},ready:function(re){return u.bindReady(),be.add(re),this},eq:function(re){return re=+re,re===-1?this.slice(re):this.slice(re,re+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(Je.apply(this,arguments),"slice",Je.call(arguments).join(","))},map:function(re){return this.pushStack(u.map(this,function(ke,Ze){return re.call(ke,Ze,ke)}))},end:function(){return this.prevObject||this.constructor(null)},push:Ve,sort:[].sort,splice:[].splice},u.fn.init.prototype=u.fn,u.extend=u.fn.extend=function(){var re,ke,Ze,Be,rt,Dt,jt=arguments[0]||{},en=1,Tn=arguments.length,cn=!1;for(typeof jt=="boolean"&&(cn=jt,jt=arguments[1]||{},en=2),typeof jt!="object"&&!u.isFunction(jt)&&(jt={}),Tn===en&&(jt=this,--en);en<Tn;en++)if((re=arguments[en])!=null)for(ke in re)Ze=jt[ke],Be=re[ke],jt!==Be&&(cn&&Be&&(u.isPlainObject(Be)||(rt=u.isArray(Be)))?(rt?(rt=!1,Dt=Ze&&u.isArray(Ze)?Ze:[]):Dt=Ze&&u.isPlainObject(Ze)?Ze:{},jt[ke]=u.extend(cn,Dt,Be)):Be!==n&&(jt[ke]=Be));return jt},u.extend({noConflict:function(re){return e.$===u&&(e.$=_),re&&e.jQuery===u&&(e.jQuery=y),u},isReady:!1,readyWait:1,holdReady:function(re){re?u.readyWait++:u.ready(!0)},ready:function(re){if(re===!0&&!--u.readyWait||re!==!0&&!u.isReady){if(!ce.body)return setTimeout(u.ready,1);if(u.isReady=!0,re!==!0&&--u.readyWait>0)return;be.fireWith(ce,[u]),u.fn.trigger&&u(ce).trigger("ready").off("ready")}},bindReady:function(){if(!be){if(be=u.Callbacks("once memory"),ce.readyState==="complete")return setTimeout(u.ready,1);if(ce.addEventListener)ce.addEventListener("DOMContentLoaded",xe,!1),e.addEventListener("load",u.ready,!1);else if(ce.attachEvent){ce.attachEvent("onreadystatechange",xe),e.attachEvent("onload",u.ready);var re=!1;try{re=e.frameElement==null}catch(ke){}ce.documentElement.doScroll&&re&&a()}}},isFunction:function(re){return u.type(re)==="function"},isArray:Array.isArray||function(re){return u.type(re)==="array"},isWindow:function(re){return re!=null&&re==re.window},isNumeric:function(re){return!isNaN(parseFloat(re))&&isFinite(re)},type:function(re){return re==null?String(re):Ft[De.call(re)]||"object"},isPlainObject:function(re){if(!re||u.type(re)!=="object"||re.nodeType||u.isWindow(re))return!1;try{if(re.constructor&&!Ae.call(re,"constructor")&&!Ae.call(re.constructor.prototype,"isPrototypeOf"))return!1}catch(Ze){return!1}var ke;for(ke in re);return ke===n||Ae.call(re,ke)},isEmptyObject:function(re){for(var ke in re)return!1;return!0},error:function(re){throw new Error(re)},parseJSON:function(re){if(typeof re!="string"||!re)return null;if(re=u.trim(re),e.JSON&&e.JSON.parse)return e.JSON.parse(re);if(_e.test(re.replace(he,"@").replace(ye,"]").replace(Ce,"")))return new Function("return "+re)();u.error("Invalid JSON: "+re)},parseXML:function(re){if(typeof re!="string"||!re)return null;var ke,Ze;try{e.DOMParser?(Ze=new DOMParser,ke=Ze.parseFromString(re,"text/xml")):(ke=new ActiveXObject("Microsoft.XMLDOM"),ke.async="false",ke.loadXML(re))}catch(Be){ke=n}return(!ke||!ke.documentElement||ke.getElementsByTagName("parsererror").length)&&u.error("Invalid XML: "+re),ke},noop:function(){},globalEval:function(re){re&&X.test(re)&&(e.execScript||function(ke){e.eval.call(e,ke)})(re)},camelCase:function(re){return re.replace(Yt,"ms-").replace(Mt,bt)},nodeName:function(re,ke){return re.nodeName&&re.nodeName.toUpperCase()===ke.toUpperCase()},each:function(re,ke,Ze){var Be,rt=0,Dt=re.length,jt=Dt===n||u.isFunction(re);if(Ze)if(jt){for(Be in re)if(ke.apply(re[Be],Ze)===!1)break}else for(;rt<Dt&&ke.apply(re[rt++],Ze)!==!1;);else if(jt){for(Be in re)if(ke.call(re[Be],Be,re[Be])===!1)break}else for(;rt<Dt&&ke.call(re[rt],rt,re[rt++])!==!1;);return re},trim:Ke?function(re){return re==null?"":Ke.call(re)}:function(re){return re==null?"":(re+"").replace(K,"").replace(fe,"")},makeArray:function(re,ke){var Ze=ke||[];if(re!=null){var Be=u.type(re);re.length==null||Be==="string"||Be==="function"||Be==="regexp"||u.isWindow(re)?Ve.call(Ze,re):u.merge(Ze,re)}return Ze},inArray:function(re,ke,Ze){var Be;if(ke){if(mt)return mt.call(ke,re,Ze);for(Be=ke.length,Ze=Ze?Ze<0?Math.max(0,Be+Ze):Ze:0;Ze<Be;Ze++)if(Ze in ke&&ke[Ze]===re)return Ze}return-1},merge:function(re,ke){var Ze=re.length,Be=0;if(typeof ke.length=="number")for(var rt=ke.length;Be<rt;Be++)re[Ze++]=ke[Be];else for(;ke[Be]!==n;)re[Ze++]=ke[Be++];return re.length=Ze,re},grep:function(re,ke,Ze){var Be=[],rt;Ze=!!Ze;for(var Dt=0,jt=re.length;Dt<jt;Dt++)rt=!!ke(re[Dt],Dt),Ze!==rt&&Be.push(re[Dt]);return Be},map:function(re,ke,Ze){var Be,rt,Dt=[],jt=0,en=re.length,Tn=re instanceof u||en!==n&&typeof en=="number"&&(en>0&&re[0]&&re[en-1]||en===0||u.isArray(re));if(Tn)for(;jt<en;jt++)Be=ke(re[jt],jt,Ze),Be!=null&&(Dt[Dt.length]=Be);else for(rt in re)Be=ke(re[rt],rt,Ze),Be!=null&&(Dt[Dt.length]=Be);return Dt.concat.apply([],Dt)},guid:1,proxy:function(re,ke){if(typeof ke=="string"){var Ze=re[ke];ke=re,re=Ze}if(!u.isFunction(re))return n;var Be=Je.call(arguments,2),rt=function(){return re.apply(ke,Be.concat(Je.call(arguments)))};return rt.guid=re.guid=re.guid||rt.guid||u.guid++,rt},access:function(re,ke,Ze,Be,rt,Dt,jt){var en,Tn=Ze==null,cn=0,wi=re.length;if(Ze&&typeof Ze=="object"){for(cn in Ze)u.access(re,ke,cn,Ze[cn],1,Dt,Be);rt=1}else if(Be!==n){if(en=jt===n&&u.isFunction(Be),Tn&&(en?(en=ke,ke=function(Vi,or,_i){return en.call(u(Vi),_i)}):(ke.call(re,Be),ke=null)),ke)for(;cn<wi;cn++)ke(re[cn],Ze,en?Be.call(re[cn],cn,ke(re[cn],Ze)):Be,jt);rt=1}return rt?re:Tn?ke.call(re):wi?ke(re[0],Ze):Dt},now:function(){return new Date().getTime()},uaMatch:function(re){re=re.toLowerCase();var ke=lt.exec(re)||$e.exec(re)||ct.exec(re)||re.indexOf("compatible")<0&&pt.exec(re)||[];return{browser:ke[1]||"",version:ke[2]||"0"}},sub:function(){function re(Ze,Be){return new re.fn.init(Ze,Be)}u.extend(!0,re,this),re.superclass=this,re.fn=re.prototype=this(),re.fn.constructor=re,re.sub=this.sub,re.fn.init=function(Ze,Be){return Be&&Be instanceof u&&!(Be instanceof re)&&(Be=re(Be)),u.fn.init.call(this,Ze,Be,ke)},re.fn.init.prototype=re.fn;var ke=re(ce);return re},browser:{}}),u.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(re,ke){Ft["[object "+ke+"]"]=ke.toLowerCase()}),ee=u.uaMatch(q),ee.browser&&(u.browser[ee.browser]=!0,u.browser.version=ee.version),u.browser.webkit&&(u.browser.safari=!0),X.test("\xA0")&&(K=/^[\s\xA0]+/,fe=/[\s\xA0]+$/),P=u(ce),ce.addEventListener?xe=function(){ce.removeEventListener("DOMContentLoaded",xe,!1),u.ready()}:ce.attachEvent&&(xe=function(){ce.readyState==="complete"&&(ce.detachEvent("onreadystatechange",xe),u.ready())}),u})(),Re={};h.Callbacks=function(a){a=a?Re[a]||Le(a):{};var u=[],y=[],_,P,U,X,K,fe,ae=function(ye){var Ce,lt,$e,ct,pt;for(Ce=0,lt=ye.length;Ce<lt;Ce++)$e=ye[Ce],ct=h.type($e),ct==="array"?ae($e):ct==="function"&&(!a.unique||!he.has($e))&&u.push($e)},_e=function(ye,Ce){for(Ce=Ce||[],_=!a.memory||[ye,Ce],P=!0,U=!0,fe=X||0,X=0,K=u.length;u&&fe<K;fe++)if(u[fe].apply(ye,Ce)===!1&&a.stopOnFalse){_=!0;break}U=!1,u&&(a.once?_===!0?he.disable():u=[]:y&&y.length&&(_=y.shift(),he.fireWith(_[0],_[1])))},he={add:function(){if(u){var ye=u.length;ae(arguments),U?K=u.length:_&&_!==!0&&(X=ye,_e(_[0],_[1]))}return this},remove:function(){if(u)for(var ye=arguments,Ce=0,lt=ye.length;Ce<lt;Ce++)for(var $e=0;$e<u.length&&!(ye[Ce]===u[$e]&&(U&&$e<=K&&(K--,$e<=fe&&fe--),u.splice($e--,1),a.unique));$e++);return this},has:function(ye){if(u){for(var Ce=0,lt=u.length;Ce<lt;Ce++)if(ye===u[Ce])return!0}return!1},empty:function(){return u=[],this},disable:function(){return u=y=_=n,this},disabled:function(){return!u},lock:function(){return y=n,(!_||_===!0)&&he.disable(),this},locked:function(){return!y},fireWith:function(ye,Ce){return y&&(U?a.once||y.push([ye,Ce]):(!a.once||!_)&&_e(ye,Ce)),this},fire:function(){return he.fireWith(this,arguments),this},fired:function(){return!!P}};return he};var Ue=[].slice;h.extend({Deferred:function(a){var u=h.Callbacks("once memory"),y=h.Callbacks("once memory"),_=h.Callbacks("memory"),P="pending",U={resolve:u,reject:y,notify:_},X={done:u.add,fail:y.add,progress:_.add,state:function(){return P},isResolved:u.fired,isRejected:y.fired,then:function(ae,_e,he){return K.done(ae).fail(_e).progress(he),this},always:function(){return K.done.apply(K,arguments).fail.apply(K,arguments),this},pipe:function(ae,_e,he){return h.Deferred(function(ye){h.each({done:[ae,"resolve"],fail:[_e,"reject"],progress:[he,"notify"]},function(Ce,lt){var $e=lt[0],ct=lt[1],pt;h.isFunction($e)?K[Ce](function(){pt=$e.apply(this,arguments),pt&&h.isFunction(pt.promise)?pt.promise().then(ye.resolve,ye.reject,ye.notify):ye[ct+"With"](this===K?ye:this,[pt])}):K[Ce](ye[ct])})}).promise()},promise:function(ae){if(ae==null)ae=X;else for(var _e in X)ae[_e]=X[_e];return ae}},K=X.promise({}),fe;for(fe in U)K[fe]=U[fe].fire,K[fe+"With"]=U[fe].fireWith;return K.done(function(){P="resolved"},y.disable,_.lock).fail(function(){P="rejected"},u.disable,_.lock),a&&a.call(K,K),K},when:function(a){function u(he){return function(ye){X[he]=arguments.length>1?Ue.call(arguments,0):ye,ae.notifyWith(_e,X)}}function y(he){return function(ye){_[he]=arguments.length>1?Ue.call(arguments,0):ye,--K||ae.resolveWith(ae,_)}}var _=Ue.call(arguments,0),P=0,U=_.length,X=Array(U),K=U,fe=U,ae=U<=1&&a&&h.isFunction(a.promise)?a:h.Deferred(),_e=ae.promise();if(U>1){for(;P<U;P++)_[P]&&_[P].promise&&h.isFunction(_[P].promise)?_[P].promise().then(y(P),ae.reject,u(P)):--K;K||ae.resolveWith(ae,_)}else ae!==a&&ae.resolveWith(ae,U?[a]:[]);return _e}}),h.support=(function(){var a,u,y,_,P,U,X,K,fe,ae,_e,he,ye=ce.createElement("div"),Ce=ce.documentElement;if(ye.setAttribute("className","t"),ye.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",u=ye.getElementsByTagName("*"),y=ye.getElementsByTagName("a")[0],!u||!u.length||!y)return{};_=ce.createElement("select"),P=_.appendChild(ce.createElement("option")),U=ye.getElementsByTagName("input")[0],a={leadingWhitespace:ye.firstChild.nodeType===3,tbody:!ye.getElementsByTagName("tbody").length,htmlSerialize:!!ye.getElementsByTagName("link").length,style:/top/.test(y.getAttribute("style")),hrefNormalized:y.getAttribute("href")==="/a",opacity:/^0.55/.test(y.style.opacity),cssFloat:!!y.style.cssFloat,checkOn:U.value==="on",optSelected:P.selected,getSetAttribute:ye.className!=="t",enctype:!!ce.createElement("form").enctype,html5Clone:ce.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0},h.boxModel=a.boxModel=ce.compatMode==="CSS1Compat",U.checked=!0,a.noCloneChecked=U.cloneNode(!0).checked,_.disabled=!0,a.optDisabled=!P.disabled;try{delete ye.test}catch(lt){a.deleteExpando=!1}if(!ye.addEventListener&&ye.attachEvent&&ye.fireEvent&&(ye.attachEvent("onclick",function(){a.noCloneEvent=!1}),ye.cloneNode(!0).fireEvent("onclick")),U=ce.createElement("input"),U.value="t",U.setAttribute("type","radio"),a.radioValue=U.value==="t",U.setAttribute("checked","checked"),U.setAttribute("name","t"),ye.appendChild(U),X=ce.createDocumentFragment(),X.appendChild(ye.lastChild),a.checkClone=X.cloneNode(!0).cloneNode(!0).lastChild.checked,a.appendChecked=U.checked,X.removeChild(U),X.appendChild(ye),ye.attachEvent)for(_e in{submit:1,change:1,focusin:1})ae="on"+_e,he=ae in ye,he||(ye.setAttribute(ae,"return;"),he=typeof ye[ae]=="function"),a[_e+"Bubbles"]=he;return X.removeChild(ye),X=_=P=ye=U=null,h(function(){var lt,$e,ct,pt,Mt,Yt,bt,q,ee,be,xe,De,Ae,Ve=ce.getElementsByTagName("body")[0];!Ve||(q=1,Ae="padding:0;margin:0;border:",xe="position:absolute;top:0;left:0;width:1px;height:1px;",De=Ae+"0;visibility:hidden;",ee="style='"+xe+Ae+"5px solid #000;",be="<div "+ee+"display:block;'><div style='"+Ae+"0;display:block;overflow:hidden;'></div></div><table "+ee+"' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>",lt=ce.createElement("div"),lt.style.cssText=De+"width:0;height:0;position:static;top:0;margin-top:"+q+"px",Ve.insertBefore(lt,Ve.firstChild),ye=ce.createElement("div"),lt.appendChild(ye),ye.innerHTML="<table><tr><td style='"+Ae+"0;display:none'></td><td>t</td></tr></table>",K=ye.getElementsByTagName("td"),he=K[0].offsetHeight===0,K[0].style.display="",K[1].style.display="none",a.reliableHiddenOffsets=he&&K[0].offsetHeight===0,e.getComputedStyle&&(ye.innerHTML="",bt=ce.createElement("div"),bt.style.width="0",bt.style.marginRight="0",ye.style.width="2px",ye.appendChild(bt),a.reliableMarginRight=(parseInt((e.getComputedStyle(bt,null)||{marginRight:0}).marginRight,10)||0)===0),typeof ye.style.zoom!="undefined"&&(ye.innerHTML="",ye.style.width=ye.style.padding="1px",ye.style.border=0,ye.style.overflow="hidden",ye.style.display="inline",ye.style.zoom=1,a.inlineBlockNeedsLayout=ye.offsetWidth===3,ye.style.display="block",ye.style.overflow="visible",ye.innerHTML="<div style='width:5px;'></div>",a.shrinkWrapBlocks=ye.offsetWidth!==3),ye.style.cssText=xe+De,ye.innerHTML=be,$e=ye.firstChild,ct=$e.firstChild,Mt=$e.nextSibling.firstChild.firstChild,Yt={doesNotAddBorder:ct.offsetTop!==5,doesAddBorderForTableAndCells:Mt.offsetTop===5},ct.style.position="fixed",ct.style.top="20px",Yt.fixedPosition=ct.offsetTop===20||ct.offsetTop===15,ct.style.position=ct.style.top="",$e.style.overflow="hidden",$e.style.position="relative",Yt.subtractsBorderForOverflowNotVisible=ct.offsetTop===-5,Yt.doesNotIncludeMarginInBodyOffset=Ve.offsetTop!==q,e.getComputedStyle&&(ye.style.marginTop="1%",a.pixelMargin=(e.getComputedStyle(ye,null)||{marginTop:0}).marginTop!=="1%"),typeof lt.style.zoom!="undefined"&&(lt.style.zoom=1),Ve.removeChild(lt),bt=ye=lt=null,h.extend(a,Yt))}),a})();var Xe=/^(?:\{.*\}|\[.*\])$/,ot=/([A-Z])/g;h.extend({cache:{},uuid:0,expando:"jQuery"+(h.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?h.cache[a[h.expando]]:a[h.expando],!!a&&!oe(a)},data:function(a,u,y,_){if(h.acceptData(a)){var P,U,X,K=h.expando,fe=typeof u=="string",ae=a.nodeType,_e=ae?h.cache:a,he=ae?a[K]:a[K]&&K,ye=u==="events";return(!he||!_e[he]||!ye&&!_&&!_e[he].data)&&fe&&y===n?void 0:(he||(ae?a[K]=he=++h.uuid:he=K),_e[he]||(_e[he]={},ae||(_e[he].toJSON=h.noop)),(typeof u=="object"||typeof u=="function")&&(_?_e[he]=h.extend(_e[he],u):_e[he].data=h.extend(_e[he].data,u)),P=U=_e[he],_||(U.data||(U.data={}),U=U.data),y!==n&&(U[h.camelCase(u)]=y),ye&&!U[u]?P.events:(fe?(X=U[u],X==null&&(X=U[h.camelCase(u)])):X=U,X))}},removeData:function(a,u,y){if(h.acceptData(a)){var _,P,U,X=h.expando,K=a.nodeType,fe=K?h.cache:a,ae=K?a[X]:X;if(!fe[ae])return;if(u&&(_=y?fe[ae]:fe[ae].data,_)){for(h.isArray(u)||(u in _?u=[u]:(u=h.camelCase(u),u in _?u=[u]:u=u.split(" "))),P=0,U=u.length;P<U;P++)delete _[u[P]];if(!(y?oe:h.isEmptyObject)(_))return}if(!y&&(delete fe[ae].data,!oe(fe[ae])))return;h.support.deleteExpando||!fe.setInterval?delete fe[ae]:fe[ae]=null,K&&(h.support.deleteExpando?delete a[X]:a.removeAttribute?a.removeAttribute(X):a[X]=null)}},_data:function(a,u,y){return h.data(a,u,y,!0)},acceptData:function(a){if(a.nodeName){var u=h.noData[a.nodeName.toLowerCase()];if(u)return u!==!0&&a.getAttribute("classid")===u}return!0}}),h.fn.extend({data:function(a,u){var y,_,P,U,X,K=this[0],fe=0,ae=null;if(a===n){if(this.length&&(ae=h.data(K),K.nodeType===1&&!h._data(K,"parsedAttrs"))){for(P=K.attributes,X=P.length;fe<X;fe++)U=P[fe].name,U.indexOf("data-")===0&&(U=h.camelCase(U.substring(5)),b(K,U,ae[U]));h._data(K,"parsedAttrs",!0)}return ae}return typeof a=="object"?this.each(function(){h.data(this,a)}):(y=a.split(".",2),y[1]=y[1]?"."+y[1]:"",_=y[1]+"!",h.access(this,function(_e){if(_e===n)return ae=this.triggerHandler("getData"+_,[y[0]]),ae===n&&K&&(ae=h.data(K,a),ae=b(K,a,ae)),ae===n&&y[1]?this.data(y[0]):ae;y[1]=_e,this.each(function(){var he=h(this);he.triggerHandler("setData"+_,y),h.data(this,a,_e),he.triggerHandler("changeData"+_,y)})},null,u,arguments.length>1,null,!1))},removeData:function(a){return this.each(function(){h.removeData(this,a)})}}),h.extend({_mark:function(a,u){a&&(u=(u||"fx")+"mark",h._data(a,u,(h._data(a,u)||0)+1))},_unmark:function(a,u,y){if(a!==!0&&(y=u,u=a,a=!1),u){y=y||"fx";var _=y+"mark",P=a?0:(h._data(u,_)||1)-1;P?h._data(u,_,P):(h.removeData(u,_,!0),Q(u,y,"mark"))}},queue:function(a,u,y){var _;if(a)return u=(u||"fx")+"queue",_=h._data(a,u),y&&(!_||h.isArray(y)?_=h._data(a,u,h.makeArray(y)):_.push(y)),_||[]},dequeue:function(a,u){u=u||"fx";var y=h.queue(a,u),_=y.shift(),P={};_==="inprogress"&&(_=y.shift()),_&&(u==="fx"&&y.unshift("inprogress"),h._data(a,u+".run",P),_.call(a,function(){h.dequeue(a,u)},P)),y.length||(h.removeData(a,u+"queue "+u+".run",!0),Q(a,u,"queue"))}}),h.fn.extend({queue:function(a,u){var y=2;return typeof a!="string"&&(u=a,a="fx",y--),arguments.length<y?h.queue(this[0],a):u===n?this:this.each(function(){var _=h.queue(this,a,u);a==="fx"&&_[0]!=="inprogress"&&h.dequeue(this,a)})},dequeue:function(a){return this.each(function(){h.dequeue(this,a)})},delay:function(a,u){return a=h.fx&&h.fx.speeds[a]||a,u=u||"fx",this.queue(u,function(y,_){var P=setTimeout(y,a);_.stop=function(){clearTimeout(P)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,u){function y(){--X||_.resolveWith(P,[P])}typeof a!="string"&&(u=a,a=n),a=a||"fx";for(var _=h.Deferred(),P=this,U=P.length,X=1,K=a+"defer",fe=a+"queue",ae=a+"mark",_e;U--;)(_e=h.data(P[U],K,n,!0)||(h.data(P[U],fe,n,!0)||h.data(P[U],ae,n,!0))&&h.data(P[U],K,h.Callbacks("once memory"),!0))&&(X++,_e.add(y));return y(),_.promise(u)}});var Tt=/[\n\t\r]/g,ze=/\s+/,et=/\r/g,Pe=/^(?:button|input)$/i,We=/^(?:button|input|object|select|textarea)$/i,xt=/^a(?:rea)?$/i,Et=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,le=h.support.getSetAttribute,Oe,ft,Ct;h.fn.extend({attr:function(a,u){return h.access(this,h.attr,a,u,arguments.length>1)},removeAttr:function(a){return this.each(function(){h.removeAttr(this,a)})},prop:function(a,u){return h.access(this,h.prop,a,u,arguments.length>1)},removeProp:function(a){return a=h.propFix[a]||a,this.each(function(){try{this[a]=n,delete this[a]}catch(u){}})},addClass:function(a){var u,y,_,P,U,X,K;if(h.isFunction(a))return this.each(function(fe){h(this).addClass(a.call(this,fe,this.className))});if(a&&typeof a=="string"){for(u=a.split(ze),y=0,_=this.length;y<_;y++)if(P=this[y],P.nodeType===1)if(!P.className&&u.length===1)P.className=a;else{for(U=" "+P.className+" ",X=0,K=u.length;X<K;X++)~U.indexOf(" "+u[X]+" ")||(U+=u[X]+" ");P.className=h.trim(U)}}return this},removeClass:function(a){var u,y,_,P,U,X,K;if(h.isFunction(a))return this.each(function(fe){h(this).removeClass(a.call(this,fe,this.className))});if(a&&typeof a=="string"||a===n){for(u=(a||"").split(ze),y=0,_=this.length;y<_;y++)if(P=this[y],P.nodeType===1&&P.className)if(a){for(U=(" "+P.className+" ").replace(Tt," "),X=0,K=u.length;X<K;X++)U=U.replace(" "+u[X]+" "," ");P.className=h.trim(U)}else P.className=""}return this},toggleClass:function(a,u){var y=typeof a,_=typeof u=="boolean";return h.isFunction(a)?this.each(function(P){h(this).toggleClass(a.call(this,P,this.className,u),u)}):this.each(function(){if(y==="string")for(var P,U=0,X=h(this),K=u,fe=a.split(ze);P=fe[U++];)K=_?K:!X.hasClass(P),X[K?"addClass":"removeClass"](P);else(y==="undefined"||y==="boolean")&&(this.className&&h._data(this,"__className__",this.className),this.className=this.className||a===!1?"":h._data(this,"__className__")||"")})},hasClass:function(a){for(var u=" "+a+" ",y=0,_=this.length;y<_;y++)if(this[y].nodeType===1&&(" "+this[y].className+" ").replace(Tt," ").indexOf(u)>-1)return!0;return!1},val:function(a){var u,y,_,P=this[0];{if(arguments.length)return _=h.isFunction(a),this.each(function(U){var X=h(this),K;this.nodeType===1&&(_?K=a.call(this,U,X.val()):K=a,K==null?K="":typeof K=="number"?K+="":h.isArray(K)&&(K=h.map(K,function(fe){return fe==null?"":fe+""})),u=h.valHooks[this.type]||h.valHooks[this.nodeName.toLowerCase()],(!u||!("set"in u)||u.set(this,K,"value")===n)&&(this.value=K))});if(P)return u=h.valHooks[P.type]||h.valHooks[P.nodeName.toLowerCase()],u&&"get"in u&&(y=u.get(P,"value"))!==n?y:(y=P.value,typeof y=="string"?y.replace(et,""):y==null?"":y)}}}),h.extend({valHooks:{option:{get:function(a){var u=a.attributes.value;return!u||u.specified?a.value:a.text}},select:{get:function(a){var u,y,_,P,U=a.selectedIndex,X=[],K=a.options,fe=a.type==="select-one";if(U<0)return null;for(y=fe?U:0,_=fe?U+1:K.length;y<_;y++)if(P=K[y],P.selected&&(h.support.optDisabled?!P.disabled:P.getAttribute("disabled")===null)&&(!P.parentNode.disabled||!h.nodeName(P.parentNode,"optgroup"))){if(u=h(P).val(),fe)return u;X.push(u)}return fe&&!X.length&&K.length?h(K[U]).val():X},set:function(a,u){var y=h.makeArray(u);return h(a).find("option").each(function(){this.selected=h.inArray(h(this).val(),y)>=0}),y.length||(a.selectedIndex=-1),y}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,u,y,_){var P,U,X,K=a.nodeType;if(a&&K!==3&&K!==8&&K!==2){if(_&&u in h.attrFn)return h(a)[u](y);if(typeof a.getAttribute=="undefined")return h.prop(a,u,y);if(X=K!==1||!h.isXMLDoc(a),X&&(u=u.toLowerCase(),U=h.attrHooks[u]||(Et.test(u)?ft:Oe)),y!==n){if(y===null){h.removeAttr(a,u);return}return U&&"set"in U&&X&&(P=U.set(a,y,u))!==n?P:(a.setAttribute(u,""+y),y)}return U&&"get"in U&&X&&(P=U.get(a,u))!==null?P:(P=a.getAttribute(u),P===null?n:P)}},removeAttr:function(a,u){var y,_,P,U,X,K=0;if(u&&a.nodeType===1)for(_=u.toLowerCase().split(ze),U=_.length;K<U;K++)P=_[K],P&&(y=h.propFix[P]||P,X=Et.test(P),X||h.attr(a,P,""),a.removeAttribute(le?P:y),X&&y in a&&(a[y]=!1))},attrHooks:{type:{set:function(a,u){if(Pe.test(a.nodeName)&&a.parentNode)h.error("type property can't be changed");else if(!h.support.radioValue&&u==="radio"&&h.nodeName(a,"input")){var y=a.value;return a.setAttribute("type",u),y&&(a.value=y),u}}},value:{get:function(a,u){return Oe&&h.nodeName(a,"button")?Oe.get(a,u):u in a?a.value:null},set:function(a,u,y){if(Oe&&h.nodeName(a,"button"))return Oe.set(a,u,y);a.value=u}}},propFix:{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,u,y){var _,P,U,X=a.nodeType;if(a&&X!==3&&X!==8&&X!==2)return U=X!==1||!h.isXMLDoc(a),U&&(u=h.propFix[u]||u,P=h.propHooks[u]),y!==n?P&&"set"in P&&(_=P.set(a,y,u))!==n?_:a[u]=y:P&&"get"in P&&(_=P.get(a,u))!==null?_:a[u]},propHooks:{tabIndex:{get:function(a){var u=a.getAttributeNode("tabindex");return u&&u.specified?parseInt(u.value,10):We.test(a.nodeName)||xt.test(a.nodeName)&&a.href?0:n}}}}),h.attrHooks.tabindex=h.propHooks.tabIndex,ft={get:function(a,u){var y,_=h.prop(a,u);return _===!0||typeof _!="boolean"&&(y=a.getAttributeNode(u))&&y.nodeValue!==!1?u.toLowerCase():n},set:function(a,u,y){var _;return u===!1?h.removeAttr(a,y):(_=h.propFix[y]||y,_ in a&&(a[_]=!0),a.setAttribute(y,y.toLowerCase())),y}},le||(Ct={name:!0,id:!0,coords:!0},Oe=h.valHooks.button={get:function(a,u){var y;return y=a.getAttributeNode(u),y&&(Ct[u]?y.nodeValue!=="":y.specified)?y.nodeValue:n},set:function(a,u,y){var _=a.getAttributeNode(y);return _||(_=ce.createAttribute(y),a.setAttributeNode(_)),_.nodeValue=u+""}},h.attrHooks.tabindex.set=Oe.set,h.each(["width","height"],function(a,u){h.attrHooks[u]=h.extend(h.attrHooks[u],{set:function(y,_){if(_==="")return y.setAttribute(u,"auto"),_}})}),h.attrHooks.contenteditable={get:Oe.get,set:function(a,u,y){u===""&&(u="false"),Oe.set(a,u,y)}}),h.support.hrefNormalized||h.each(["href","src","width","height"],function(a,u){h.attrHooks[u]=h.extend(h.attrHooks[u],{get:function(y){var _=y.getAttribute(u,2);return _===null?n:_}})}),h.support.style||(h.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||n},set:function(a,u){return a.style.cssText=""+u}}),h.support.optSelected||(h.propHooks.selected=h.extend(h.propHooks.selected,{get:function(a){var u=a.parentNode;return u&&(u.selectedIndex,u.parentNode&&u.parentNode.selectedIndex),null}})),h.support.enctype||(h.propFix.enctype="encoding"),h.support.checkOn||h.each(["radio","checkbox"],function(){h.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),h.each(["radio","checkbox"],function(){h.valHooks[this]=h.extend(h.valHooks[this],{set:function(a,u){if(h.isArray(u))return a.checked=h.inArray(h(a).val(),u)>=0}})});var Rt=/^(?:textarea|input|select)$/i,Wt=/^([^\.]*)?(?:\.(.+))?$/,nn=/(?:^|\s)hover(\.\S+)?\b/,rn=/^key/,Zt=/^(?:mouse|contextmenu)|click/,Vt=/^(?:focusinfocus|focusoutblur)$/,Qt=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,st=function(a){var u=Qt.exec(a);return u&&(u[1]=(u[1]||"").toLowerCase(),u[3]=u[3]&&new RegExp("(?:^|\\s)"+u[3]+"(?:\\s|$)")),u},ht=function(a,u){var y=a.attributes||{};return(!u[1]||a.nodeName.toLowerCase()===u[1])&&(!u[2]||(y.id||{}).value===u[2])&&(!u[3]||u[3].test((y.class||{}).value))},qt=function(a){return h.event.special.hover?a:a.replace(nn,"mouseenter$1 mouseleave$1")};h.event={add:function(a,u,y,_,P){var U,X,K,fe,ae,_e,he,ye,Ce,lt,$e,ct;if(!(a.nodeType===3||a.nodeType===8||!u||!y||!(U=h._data(a)))){for(y.handler&&(Ce=y,y=Ce.handler,P=Ce.selector),y.guid||(y.guid=h.guid++),K=U.events,K||(U.events=K={}),X=U.handle,X||(U.handle=X=function(pt){return typeof h!="undefined"&&(!pt||h.event.triggered!==pt.type)?h.event.dispatch.apply(X.elem,arguments):n},X.elem=a),u=h.trim(qt(u)).split(" "),fe=0;fe<u.length;fe++)ae=Wt.exec(u[fe])||[],_e=ae[1],he=(ae[2]||"").split(".").sort(),ct=h.event.special[_e]||{},_e=(P?ct.delegateType:ct.bindType)||_e,ct=h.event.special[_e]||{},ye=h.extend({type:_e,origType:ae[1],data:_,handler:y,guid:y.guid,selector:P,quick:P&&st(P),namespace:he.join(".")},Ce),$e=K[_e],$e||($e=K[_e]=[],$e.delegateCount=0,(!ct.setup||ct.setup.call(a,_,he,X)===!1)&&(a.addEventListener?a.addEventListener(_e,X,!1):a.attachEvent&&a.attachEvent("on"+_e,X))),ct.add&&(ct.add.call(a,ye),ye.handler.guid||(ye.handler.guid=y.guid)),P?$e.splice($e.delegateCount++,0,ye):$e.push(ye),h.event.global[_e]=!0;a=null}},global:{},remove:function(a,u,y,_,P){var U=h.hasData(a)&&h._data(a),X,K,fe,ae,_e,he,ye,Ce,lt,$e,ct,pt;if(U&&(Ce=U.events)){for(u=h.trim(qt(u||"")).split(" "),X=0;X<u.length;X++){if(K=Wt.exec(u[X])||[],fe=ae=K[1],_e=K[2],!fe){for(fe in Ce)h.event.remove(a,fe+u[X],y,_,!0);continue}for(lt=h.event.special[fe]||{},fe=(_?lt.delegateType:lt.bindType)||fe,ct=Ce[fe]||[],he=ct.length,_e=_e?new RegExp("(^|\\.)"+_e.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null,ye=0;ye<ct.length;ye++)pt=ct[ye],(P||ae===pt.origType)&&(!y||y.guid===pt.guid)&&(!_e||_e.test(pt.namespace))&&(!_||_===pt.selector||_==="**"&&pt.selector)&&(ct.splice(ye--,1),pt.selector&&ct.delegateCount--,lt.remove&&lt.remove.call(a,pt));ct.length===0&&he!==ct.length&&((!lt.teardown||lt.teardown.call(a,_e)===!1)&&h.removeEvent(a,fe,U.handle),delete Ce[fe])}h.isEmptyObject(Ce)&&($e=U.handle,$e&&($e.elem=null),h.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(a,u,y,_){if(!y||y.nodeType!==3&&y.nodeType!==8){var P=a.type||a,U=[],X,K,fe,ae,_e,he,ye,Ce,lt,$e;if(Vt.test(P+h.event.triggered)||(P.indexOf("!")>=0&&(P=P.slice(0,-1),K=!0),P.indexOf(".")>=0&&(U=P.split("."),P=U.shift(),U.sort()),(!y||h.event.customEvent[P])&&!h.event.global[P]))return;if(a=typeof a=="object"?a[h.expando]?a:new h.Event(P,a):new h.Event(P),a.type=P,a.isTrigger=!0,a.exclusive=K,a.namespace=U.join("."),a.namespace_re=a.namespace?new RegExp("(^|\\.)"+U.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,he=P.indexOf(":")<0?"on"+P:"",!y){X=h.cache;for(fe in X)X[fe].events&&X[fe].events[P]&&h.event.trigger(a,u,X[fe].handle.elem,!0);return}if(a.result=n,a.target||(a.target=y),u=u!=null?h.makeArray(u):[],u.unshift(a),ye=h.event.special[P]||{},ye.trigger&&ye.trigger.apply(y,u)===!1)return;if(lt=[[y,ye.bindType||P]],!_&&!ye.noBubble&&!h.isWindow(y)){for($e=ye.delegateType||P,ae=Vt.test($e+P)?y:y.parentNode,_e=null;ae;ae=ae.parentNode)lt.push([ae,$e]),_e=ae;_e&&_e===y.ownerDocument&&lt.push([_e.defaultView||_e.parentWindow||e,$e])}for(fe=0;fe<lt.length&&!a.isPropagationStopped();fe++)ae=lt[fe][0],a.type=lt[fe][1],Ce=(h._data(ae,"events")||{})[a.type]&&h._data(ae,"handle"),Ce&&Ce.apply(ae,u),Ce=he&&ae[he],Ce&&h.acceptData(ae)&&Ce.apply(ae,u)===!1&&a.preventDefault();return a.type=P,!_&&!a.isDefaultPrevented()&&(!ye._default||ye._default.apply(y.ownerDocument,u)===!1)&&(P!=="click"||!h.nodeName(y,"a"))&&h.acceptData(y)&&he&&y[P]&&(P!=="focus"&&P!=="blur"||a.target.offsetWidth!==0)&&!h.isWindow(y)&&(_e=y[he],_e&&(y[he]=null),h.event.triggered=P,y[P](),h.event.triggered=n,_e&&(y[he]=_e)),a.result}},dispatch:function(a){a=h.event.fix(a||e.event);var u=(h._data(this,"events")||{})[a.type]||[],y=u.delegateCount,_=[].slice.call(arguments,0),P=!a.exclusive&&!a.namespace,U=h.event.special[a.type]||{},X=[],K,fe,ae,_e,he,ye,Ce,lt,$e,ct,pt;if(_[0]=a,a.delegateTarget=this,!U.preDispatch||U.preDispatch.call(this,a)!==!1){if(y&&(!a.button||a.type!=="click")){for(_e=h(this),_e.context=this.ownerDocument||this,ae=a.target;ae!=this;ae=ae.parentNode||this)if(ae.disabled!==!0){for(ye={},lt=[],_e[0]=ae,K=0;K<y;K++)$e=u[K],ct=$e.selector,ye[ct]===n&&(ye[ct]=$e.quick?ht(ae,$e.quick):_e.is(ct)),ye[ct]&&lt.push($e);lt.length&&X.push({elem:ae,matches:lt})}}for(u.length>y&&X.push({elem:this,matches:u.slice(y)}),K=0;K<X.length&&!a.isPropagationStopped();K++)for(Ce=X[K],a.currentTarget=Ce.elem,fe=0;fe<Ce.matches.length&&!a.isImmediatePropagationStopped();fe++)$e=Ce.matches[fe],(P||!a.namespace&&!$e.namespace||a.namespace_re&&a.namespace_re.test($e.namespace))&&(a.data=$e.data,a.handleObj=$e,he=((h.event.special[$e.origType]||{}).handle||$e.handler).apply(Ce.elem,_),he!==n&&(a.result=he,he===!1&&(a.preventDefault(),a.stopPropagation())));return U.postDispatch&&U.postDispatch.call(this,a),a.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,u){return a.which==null&&(a.which=u.charCode!=null?u.charCode:u.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,u){var y,_,P,U=u.button,X=u.fromElement;return a.pageX==null&&u.clientX!=null&&(y=a.target.ownerDocument||ce,_=y.documentElement,P=y.body,a.pageX=u.clientX+(_&&_.scrollLeft||P&&P.scrollLeft||0)-(_&&_.clientLeft||P&&P.clientLeft||0),a.pageY=u.clientY+(_&&_.scrollTop||P&&P.scrollTop||0)-(_&&_.clientTop||P&&P.clientTop||0)),!a.relatedTarget&&X&&(a.relatedTarget=X===a.target?u.toElement:X),!a.which&&U!==n&&(a.which=U&1?1:U&2?3:U&4?2:0),a}},fix:function(a){if(a[h.expando])return a;var u,y,_=a,P=h.event.fixHooks[a.type]||{},U=P.props?this.props.concat(P.props):this.props;for(a=h.Event(_),u=U.length;u;)y=U[--u],a[y]=_[y];return a.target||(a.target=_.srcElement||ce),a.target.nodeType===3&&(a.target=a.target.parentNode),a.metaKey===n&&(a.metaKey=a.ctrlKey),P.filter?P.filter(a,_):a},special:{ready:{setup:h.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,u,y){h.isWindow(this)&&(this.onbeforeunload=y)},teardown:function(a,u){this.onbeforeunload===u&&(this.onbeforeunload=null)}}},simulate:function(a,u,y,_){var P=h.extend(new h.Event,y,{type:a,isSimulated:!0,originalEvent:{}});_?h.event.trigger(P,null,u):h.event.dispatch.call(u,P),P.isDefaultPrevented()&&y.preventDefault()}},h.event.handle=h.event.dispatch,h.removeEvent=ce.removeEventListener?function(a,u,y){a.removeEventListener&&a.removeEventListener(u,y,!1)}:function(a,u,y){a.detachEvent&&a.detachEvent("on"+u,y)},h.Event=function(a,u){if(!(this instanceof h.Event))return new h.Event(a,u);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?Y:N):this.type=a,u&&h.extend(this,u),this.timeStamp=a&&a.timeStamp||h.now(),this[h.expando]=!0},h.Event.prototype={preventDefault:function(){this.isDefaultPrevented=Y;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=Y;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=Y,this.stopPropagation()},isDefaultPrevented:N,isPropagationStopped:N,isImmediatePropagationStopped:N},h.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,u){h.event.special[a]={delegateType:u,bindType:u,handle:function(y){var _=this,P=y.relatedTarget,U=y.handleObj,X=U.selector,K;return(!P||P!==_&&!h.contains(_,P))&&(y.type=U.origType,K=U.handler.apply(this,arguments),y.type=u),K}}}),h.support.submitBubbles||(h.event.special.submit={setup:function(){if(h.nodeName(this,"form"))return!1;h.event.add(this,"click._submit keypress._submit",function(a){var u=a.target,y=h.nodeName(u,"input")||h.nodeName(u,"button")?u.form:n;y&&!y._submit_attached&&(h.event.add(y,"submit._submit",function(_){_._submit_bubble=!0}),y._submit_attached=!0)})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&h.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){if(h.nodeName(this,"form"))return!1;h.event.remove(this,"._submit")}}),h.support.changeBubbles||(h.event.special.change={setup:function(){if(Rt.test(this.nodeName))return(this.type==="checkbox"||this.type==="radio")&&(h.event.add(this,"propertychange._change",function(a){a.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),h.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,h.event.simulate("change",this,a,!0))})),!1;h.event.add(this,"beforeactivate._change",function(a){var u=a.target;Rt.test(u.nodeName)&&!u._change_attached&&(h.event.add(u,"change._change",function(y){this.parentNode&&!y.isSimulated&&!y.isTrigger&&h.event.simulate("change",this.parentNode,y,!0)}),u._change_attached=!0)})},handle:function(a){var u=a.target;if(this!==u||a.isSimulated||a.isTrigger||u.type!=="radio"&&u.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){return h.event.remove(this,"._change"),Rt.test(this.nodeName)}}),h.support.focusinBubbles||h.each({focus:"focusin",blur:"focusout"},function(a,u){var y=0,_=function(P){h.event.simulate(u,P.target,h.event.fix(P),!0)};h.event.special[u]={setup:function(){y++===0&&ce.addEventListener(a,_,!0)},teardown:function(){--y===0&&ce.removeEventListener(a,_,!0)}}}),h.fn.extend({on:function(a,u,y,_,P){var U,X;if(typeof a=="object"){typeof u!="string"&&(y=y||u,u=n);for(X in a)this.on(X,u,y,a[X],P);return this}if(y==null&&_==null?(_=u,y=u=n):_==null&&(typeof u=="string"?(_=y,y=n):(_=y,y=u,u=n)),_===!1)_=N;else if(!_)return this;return P===1&&(U=_,_=function(K){return h().off(K),U.apply(this,arguments)},_.guid=U.guid||(U.guid=h.guid++)),this.each(function(){h.event.add(this,a,_,y,u)})},one:function(a,u,y,_){return this.on(a,u,y,_,1)},off:function(a,u,y){if(a&&a.preventDefault&&a.handleObj){var _=a.handleObj;return h(a.delegateTarget).off(_.namespace?_.origType+"."+_.namespace:_.origType,_.selector,_.handler),this}if(typeof a=="object"){for(var P in a)this.off(P,u,a[P]);return this}return(u===!1||typeof u=="function")&&(y=u,u=n),y===!1&&(y=N),this.each(function(){h.event.remove(this,a,y,u)})},bind:function(a,u,y){return this.on(a,null,u,y)},unbind:function(a,u){return this.off(a,null,u)},live:function(a,u,y){return h(this.context).on(a,this.selector,u,y),this},die:function(a,u){return h(this.context).off(a,this.selector||"**",u),this},delegate:function(a,u,y,_){return this.on(u,a,y,_)},undelegate:function(a,u,y){return arguments.length==1?this.off(a,"**"):this.off(u,a,y)},trigger:function(a,u){return this.each(function(){h.event.trigger(a,u,this)})},triggerHandler:function(a,u){if(this[0])return h.event.trigger(a,u,this[0],!0)},toggle:function(a){var u=arguments,y=a.guid||h.guid++,_=0,P=function(U){var X=(h._data(this,"lastToggle"+a.guid)||0)%_;return h._data(this,"lastToggle"+a.guid,X+1),U.preventDefault(),u[X].apply(this,arguments)||!1};for(P.guid=y;_<u.length;)u[_++].guid=y;return this.click(P)},hover:function(a,u){return this.mouseenter(a).mouseleave(u||a)}}),h.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,u){h.fn[u]=function(y,_){return _==null&&(_=y,y=null),arguments.length>0?this.on(u,null,y,_):this.trigger(u)},h.attrFn&&(h.attrFn[u]=!0),rn.test(u)&&(h.event.fixHooks[u]=h.event.keyHooks),Zt.test(u)&&(h.event.fixHooks[u]=h.event.mouseHooks)}),(function(){function a(q,ee,be,xe,De,Ae){for(var Ve=0,Je=xe.length;Ve<Je;Ve++){var Ke=xe[Ve];if(Ke){var mt=!1;for(Ke=Ke[q];Ke;){if(Ke[_]===be){mt=xe[Ke.sizset];break}if(Ke.nodeType===1){if(Ae||(Ke[_]=be,Ke.sizset=Ve),typeof ee!="string"){if(Ke===ee){mt=!0;break}}else if(he.filter(ee,[Ke]).length>0){mt=Ke;break}}Ke=Ke[q]}xe[Ve]=mt}}}function u(q,ee,be,xe,De,Ae){for(var Ve=0,Je=xe.length;Ve<Je;Ve++){var Ke=xe[Ve];if(Ke){var mt=!1;for(Ke=Ke[q];Ke;){if(Ke[_]===be){mt=xe[Ke.sizset];break}if(Ke.nodeType===1&&!Ae&&(Ke[_]=be,Ke.sizset=Ve),Ke.nodeName.toLowerCase()===ee){mt=Ke;break}Ke=Ke[q]}xe[Ve]=mt}}}var y=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,_="sizcache"+(Math.random()+"").replace(".",""),P=0,U=Object.prototype.toString,X=!1,K=!0,fe=/\\/g,ae=/\r\n/g,_e=/\W/;[0,0].sort(function(){return K=!1,0});var he=function(q,ee,be,xe){be=be||[],ee=ee||ce;var De=ee;if(ee.nodeType!==1&&ee.nodeType!==9)return[];if(!q||typeof q!="string")return be;var Ae,Ve,Je,Ke,mt,Ft,re,ke,Ze=!0,Be=he.isXML(ee),rt=[],Dt=q;do if(y.exec(""),Ae=y.exec(Dt),Ae&&(Dt=Ae[3],rt.push(Ae[1]),Ae[2])){Ke=Ae[3];break}while(Ae);if(rt.length>1&&lt.exec(q))if(rt.length===2&&Ce.relative[rt[0]])Ve=bt(rt[0]+rt[1],ee,xe);else for(Ve=Ce.relative[rt[0]]?[ee]:he(rt.shift(),ee);rt.length;)q=rt.shift(),Ce.relative[q]&&(q+=rt.shift()),Ve=bt(q,Ve,xe);else if(!xe&&rt.length>1&&ee.nodeType===9&&!Be&&Ce.match.ID.test(rt[0])&&!Ce.match.ID.test(rt[rt.length-1])&&(mt=he.find(rt.shift(),ee,Be),ee=mt.expr?he.filter(mt.expr,mt.set)[0]:mt.set[0]),ee)for(mt=xe?{expr:rt.pop(),set:pt(xe)}:he.find(rt.pop(),rt.length===1&&(rt[0]==="~"||rt[0]==="+")&&ee.parentNode?ee.parentNode:ee,Be),Ve=mt.expr?he.filter(mt.expr,mt.set):mt.set,rt.length>0?Je=pt(Ve):Ze=!1;rt.length;)Ft=rt.pop(),re=Ft,Ce.relative[Ft]?re=rt.pop():Ft="",re==null&&(re=ee),Ce.relative[Ft](Je,re,Be);else Je=rt=[];if(Je||(Je=Ve),Je||he.error(Ft||q),U.call(Je)==="[object Array]")if(!Ze)be.push.apply(be,Je);else if(ee&&ee.nodeType===1)for(ke=0;Je[ke]!=null;ke++)Je[ke]&&(Je[ke]===!0||Je[ke].nodeType===1&&he.contains(ee,Je[ke]))&&be.push(Ve[ke]);else for(ke=0;Je[ke]!=null;ke++)Je[ke]&&Je[ke].nodeType===1&&be.push(Ve[ke]);else pt(Je,be);return Ke&&(he(Ke,De,be,xe),he.uniqueSort(be)),be};he.uniqueSort=function(q){if(Mt&&(X=K,q.sort(Mt),X))for(var ee=1;ee<q.length;ee++)q[ee]===q[ee-1]&&q.splice(ee--,1);return q},he.matches=function(q,ee){return he(q,null,null,ee)},he.matchesSelector=function(q,ee){return he(ee,null,null,[q]).length>0},he.find=function(q,ee,be){var xe,De,Ae,Ve,Je,Ke;if(!q)return[];for(De=0,Ae=Ce.order.length;De<Ae;De++)if(Je=Ce.order[De],(Ve=Ce.leftMatch[Je].exec(q))&&(Ke=Ve[1],Ve.splice(1,1),Ke.substr(Ke.length-1)!=="\\"&&(Ve[1]=(Ve[1]||"").replace(fe,""),xe=Ce.find[Je](Ve,ee,be),xe!=null))){q=q.replace(Ce.match[Je],"");break}return xe||(xe=typeof ee.getElementsByTagName!="undefined"?ee.getElementsByTagName("*"):[]),{set:xe,expr:q}},he.filter=function(q,ee,be,xe){for(var De,Ae,Ve,Je,Ke,mt,Ft,re,ke,Ze=q,Be=[],rt=ee,Dt=ee&&ee[0]&&he.isXML(ee[0]);q&&ee.length;){for(Ve in Ce.filter)if((De=Ce.leftMatch[Ve].exec(q))!=null&&De[2]){if(mt=Ce.filter[Ve],Ft=De[1],Ae=!1,De.splice(1,1),Ft.substr(Ft.length-1)==="\\")continue;if(rt===Be&&(Be=[]),Ce.preFilter[Ve]){if(De=Ce.preFilter[Ve](De,rt,be,Be,xe,Dt),!De)Ae=Je=!0;else if(De===!0)continue}if(De)for(re=0;(Ke=rt[re])!=null;re++)Ke&&(Je=mt(Ke,De,re,rt),ke=xe^Je,be&&Je!=null?ke?Ae=!0:rt[re]=!1:ke&&(Be.push(Ke),Ae=!0));if(Je!==n){if(be||(rt=Be),q=q.replace(Ce.match[Ve],""),!Ae)return[];break}}if(q===Ze)if(Ae==null)he.error(q);else break;Ze=q}return rt},he.error=function(q){throw new Error("Syntax error, unrecognized expression: "+q)};var ye=he.getText=function(q){var ee,be,xe=q.nodeType,De="";if(xe){if(xe===1||xe===9||xe===11){if(typeof q.textContent=="string")return q.textContent;if(typeof q.innerText=="string")return q.innerText.replace(ae,"");for(q=q.firstChild;q;q=q.nextSibling)De+=ye(q)}else if(xe===3||xe===4)return q.nodeValue}else for(ee=0;be=q[ee];ee++)be.nodeType!==8&&(De+=ye(be));return De},Ce=he.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{class:"className",for:"htmlFor"},attrHandle:{href:function(q){return q.getAttribute("href")},type:function(q){return q.getAttribute("type")}},relative:{"+":function(q,ee){var be=typeof ee=="string",xe=be&&!_e.test(ee),De=be&&!xe;xe&&(ee=ee.toLowerCase());for(var Ae=0,Ve=q.length,Je;Ae<Ve;Ae++)if(Je=q[Ae]){for(;(Je=Je.previousSibling)&&Je.nodeType!==1;);q[Ae]=De||Je&&Je.nodeName.toLowerCase()===ee?Je||!1:Je===ee}De&&he.filter(ee,q,!0)},">":function(q,ee){var be,xe=typeof ee=="string",De=0,Ae=q.length;if(xe&&!_e.test(ee)){for(ee=ee.toLowerCase();De<Ae;De++)if(be=q[De],be){var Ve=be.parentNode;q[De]=Ve.nodeName.toLowerCase()===ee?Ve:!1}}else{for(;De<Ae;De++)be=q[De],be&&(q[De]=xe?be.parentNode:be.parentNode===ee);xe&&he.filter(ee,q,!0)}},"":function(q,ee,be){var xe,De=P++,Ae=a;typeof ee=="string"&&!_e.test(ee)&&(ee=ee.toLowerCase(),xe=ee,Ae=u),Ae("parentNode",ee,De,q,xe,be)},"~":function(q,ee,be){var xe,De=P++,Ae=a;typeof ee=="string"&&!_e.test(ee)&&(ee=ee.toLowerCase(),xe=ee,Ae=u),Ae("previousSibling",ee,De,q,xe,be)}},find:{ID:function(q,ee,be){if(typeof ee.getElementById!="undefined"&&!be){var xe=ee.getElementById(q[1]);return xe&&xe.parentNode?[xe]:[]}},NAME:function(q,ee){if(typeof ee.getElementsByName!="undefined"){for(var be=[],xe=ee.getElementsByName(q[1]),De=0,Ae=xe.length;De<Ae;De++)xe[De].getAttribute("name")===q[1]&&be.push(xe[De]);return be.length===0?null:be}},TAG:function(q,ee){if(typeof ee.getElementsByTagName!="undefined")return ee.getElementsByTagName(q[1])}},preFilter:{CLASS:function(q,ee,be,xe,De,Ae){if(q=" "+q[1].replace(fe,"")+" ",Ae)return q;for(var Ve=0,Je;(Je=ee[Ve])!=null;Ve++)Je&&(De^(Je.className&&(" "+Je.className+" ").replace(/[\t\n\r]/g," ").indexOf(q)>=0)?be||xe.push(Je):be&&(ee[Ve]=!1));return!1},ID:function(q){return q[1].replace(fe,"")},TAG:function(q,ee){return q[1].replace(fe,"").toLowerCase()},CHILD:function(q){if(q[1]==="nth"){q[2]||he.error(q[0]),q[2]=q[2].replace(/^\+|\s*/g,"");var ee=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(q[2]==="even"&&"2n"||q[2]==="odd"&&"2n+1"||!/\D/.test(q[2])&&"0n+"+q[2]||q[2]);q[2]=ee[1]+(ee[2]||1)-0,q[3]=ee[3]-0}else q[2]&&he.error(q[0]);return q[0]=P++,q},ATTR:function(q,ee,be,xe,De,Ae){var Ve=q[1]=q[1].replace(fe,"");return!Ae&&Ce.attrMap[Ve]&&(q[1]=Ce.attrMap[Ve]),q[4]=(q[4]||q[5]||"").replace(fe,""),q[2]==="~="&&(q[4]=" "+q[4]+" "),q},PSEUDO:function(q,ee,be,xe,De){if(q[1]==="not")if((y.exec(q[3])||"").length>1||/^\w/.test(q[3]))q[3]=he(q[3],null,null,ee);else{var Ae=he.filter(q[3],ee,be,!0^De);return be||xe.push.apply(xe,Ae),!1}else if(Ce.match.POS.test(q[0])||Ce.match.CHILD.test(q[0]))return!0;return q},POS:function(q){return q.unshift(!0),q}},filters:{enabled:function(q){return q.disabled===!1&&q.type!=="hidden"},disabled:function(q){return q.disabled===!0},checked:function(q){return q.checked===!0},selected:function(q){return q.parentNode&&q.parentNode.selectedIndex,q.selected===!0},parent:function(q){return!!q.firstChild},empty:function(q){return!q.firstChild},has:function(q,ee,be){return!!he(be[3],q).length},header:function(q){return/h\d/i.test(q.nodeName)},text:function(q){var ee=q.getAttribute("type"),be=q.type;return q.nodeName.toLowerCase()==="input"&&be==="text"&&(ee===be||ee===null)},radio:function(q){return q.nodeName.toLowerCase()==="input"&&q.type==="radio"},checkbox:function(q){return q.nodeName.toLowerCase()==="input"&&q.type==="checkbox"},file:function(q){return q.nodeName.toLowerCase()==="input"&&q.type==="file"},password:function(q){return q.nodeName.toLowerCase()==="input"&&q.type==="password"},submit:function(q){var ee=q.nodeName.toLowerCase();return(ee==="input"||ee==="button")&&q.type==="submit"},image:function(q){return q.nodeName.toLowerCase()==="input"&&q.type==="image"},reset:function(q){var ee=q.nodeName.toLowerCase();return(ee==="input"||ee==="button")&&q.type==="reset"},button:function(q){var ee=q.nodeName.toLowerCase();return ee==="input"&&q.type==="button"||ee==="button"},input:function(q){return/input|select|textarea|button/i.test(q.nodeName)},focus:function(q){return q===q.ownerDocument.activeElement}},setFilters:{first:function(q,ee){return ee===0},last:function(q,ee,be,xe){return ee===xe.length-1},even:function(q,ee){return ee%2===0},odd:function(q,ee){return ee%2===1},lt:function(q,ee,be){return ee<be[3]-0},gt:function(q,ee,be){return ee>be[3]-0},nth:function(q,ee,be){return be[3]-0===ee},eq:function(q,ee,be){return be[3]-0===ee}},filter:{PSEUDO:function(q,ee,be,xe){var De=ee[1],Ae=Ce.filters[De];if(Ae)return Ae(q,be,ee,xe);if(De==="contains")return(q.textContent||q.innerText||ye([q])||"").indexOf(ee[3])>=0;if(De==="not"){for(var Ve=ee[3],Je=0,Ke=Ve.length;Je<Ke;Je++)if(Ve[Je]===q)return!1;return!0}he.error(De)},CHILD:function(q,ee){var be,xe,De,Ae,Ve,Je,Ke,mt=ee[1],Ft=q;switch(mt){case"only":case"first":for(;Ft=Ft.previousSibling;)if(Ft.nodeType===1)return!1;if(mt==="first")return!0;Ft=q;case"last":for(;Ft=Ft.nextSibling;)if(Ft.nodeType===1)return!1;return!0;case"nth":if(be=ee[2],xe=ee[3],be===1&&xe===0)return!0;if(De=ee[0],Ae=q.parentNode,Ae&&(Ae[_]!==De||!q.nodeIndex)){for(Je=0,Ft=Ae.firstChild;Ft;Ft=Ft.nextSibling)Ft.nodeType===1&&(Ft.nodeIndex=++Je);Ae[_]=De}return Ke=q.nodeIndex-xe,be===0?Ke===0:Ke%be===0&&Ke/be>=0}},ID:function(q,ee){return q.nodeType===1&&q.getAttribute("id")===ee},TAG:function(q,ee){return ee==="*"&&q.nodeType===1||!!q.nodeName&&q.nodeName.toLowerCase()===ee},CLASS:function(q,ee){return(" "+(q.className||q.getAttribute("class"))+" ").indexOf(ee)>-1},ATTR:function(q,ee){var be=ee[1],xe=he.attr?he.attr(q,be):Ce.attrHandle[be]?Ce.attrHandle[be](q):q[be]!=null?q[be]:q.getAttribute(be),De=xe+"",Ae=ee[2],Ve=ee[4];return xe==null?Ae==="!=":!Ae&&he.attr?xe!=null:Ae==="="?De===Ve:Ae==="*="?De.indexOf(Ve)>=0:Ae==="~="?(" "+De+" ").indexOf(Ve)>=0:Ve?Ae==="!="?De!==Ve:Ae==="^="?De.indexOf(Ve)===0:Ae==="$="?De.substr(De.length-Ve.length)===Ve:Ae==="|="?De===Ve||De.substr(0,Ve.length+1)===Ve+"-":!1:De&&xe!==!1},POS:function(q,ee,be,xe){var De=ee[2],Ae=Ce.setFilters[De];if(Ae)return Ae(q,be,ee,xe)}}},lt=Ce.match.POS,$e=function(q,ee){return"\\"+(ee-0+1)};for(var ct in Ce.match)Ce.match[ct]=new RegExp(Ce.match[ct].source+/(?![^\[]*\])(?![^\(]*\))/.source),Ce.leftMatch[ct]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Ce.match[ct].source.replace(/\\(\d+)/g,$e));Ce.match.globalPOS=lt;var pt=function(q,ee){return q=Array.prototype.slice.call(q,0),ee?(ee.push.apply(ee,q),ee):q};try{Array.prototype.slice.call(ce.documentElement.childNodes,0)[0].nodeType}catch(q){pt=function(ee,be){var xe=0,De=be||[];if(U.call(ee)==="[object Array]")Array.prototype.push.apply(De,ee);else if(typeof ee.length=="number")for(var Ae=ee.length;xe<Ae;xe++)De.push(ee[xe]);else for(;ee[xe];xe++)De.push(ee[xe]);return De}}var Mt,Yt;ce.documentElement.compareDocumentPosition?Mt=function(q,ee){return q===ee?(X=!0,0):!q.compareDocumentPosition||!ee.compareDocumentPosition?q.compareDocumentPosition?-1:1:q.compareDocumentPosition(ee)&4?-1:1}:(Mt=function(q,ee){if(q===ee)return X=!0,0;if(q.sourceIndex&&ee.sourceIndex)return q.sourceIndex-ee.sourceIndex;var be,xe,De=[],Ae=[],Ve=q.parentNode,Je=ee.parentNode,Ke=Ve;if(Ve===Je)return Yt(q,ee);if(!Ve)return-1;if(!Je)return 1;for(;Ke;)De.unshift(Ke),Ke=Ke.parentNode;for(Ke=Je;Ke;)Ae.unshift(Ke),Ke=Ke.parentNode;be=De.length,xe=Ae.length;for(var mt=0;mt<be&&mt<xe;mt++)if(De[mt]!==Ae[mt])return Yt(De[mt],Ae[mt]);return mt===be?Yt(q,Ae[mt],-1):Yt(De[mt],ee,1)},Yt=function(q,ee,be){if(q===ee)return be;for(var xe=q.nextSibling;xe;){if(xe===ee)return-1;xe=xe.nextSibling}return 1}),(function(){var q=ce.createElement("div"),ee="script"+new Date().getTime(),be=ce.documentElement;q.innerHTML="<a name='"+ee+"'/>",be.insertBefore(q,be.firstChild),ce.getElementById(ee)&&(Ce.find.ID=function(xe,De,Ae){if(typeof De.getElementById!="undefined"&&!Ae){var Ve=De.getElementById(xe[1]);return Ve?Ve.id===xe[1]||typeof Ve.getAttributeNode!="undefined"&&Ve.getAttributeNode("id").nodeValue===xe[1]?[Ve]:n:[]}},Ce.filter.ID=function(xe,De){var Ae=typeof xe.getAttributeNode!="undefined"&&xe.getAttributeNode("id");return xe.nodeType===1&&Ae&&Ae.nodeValue===De}),be.removeChild(q),be=q=null})(),(function(){var q=ce.createElement("div");q.appendChild(ce.createComment("")),q.getElementsByTagName("*").length>0&&(Ce.find.TAG=function(ee,be){var xe=be.getElementsByTagName(ee[1]);if(ee[1]==="*"){for(var De=[],Ae=0;xe[Ae];Ae++)xe[Ae].nodeType===1&&De.push(xe[Ae]);xe=De}return xe}),q.innerHTML="<a href='#'></a>",q.firstChild&&typeof q.firstChild.getAttribute!="undefined"&&q.firstChild.getAttribute("href")!=="#"&&(Ce.attrHandle.href=function(ee){return ee.getAttribute("href",2)}),q=null})(),ce.querySelectorAll&&(function(){var q=he,ee=ce.createElement("div"),be="__sizzle__";if(ee.innerHTML="<p class='TEST'></p>",!ee.querySelectorAll||ee.querySelectorAll(".TEST").length!==0){he=function(De,Ae,Ve,Je){if(Ae=Ae||ce,!Je&&!he.isXML(Ae)){var Ke=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(De);if(Ke&&(Ae.nodeType===1||Ae.nodeType===9)){if(Ke[1])return pt(Ae.getElementsByTagName(De),Ve);if(Ke[2]&&Ce.find.CLASS&&Ae.getElementsByClassName)return pt(Ae.getElementsByClassName(Ke[2]),Ve)}if(Ae.nodeType===9){if(De==="body"&&Ae.body)return pt([Ae.body],Ve);if(Ke&&Ke[3]){var mt=Ae.getElementById(Ke[3]);if(!mt||!mt.parentNode)return pt([],Ve);if(mt.id===Ke[3])return pt([mt],Ve)}try{return pt(Ae.querySelectorAll(De),Ve)}catch(rt){}}else if(Ae.nodeType===1&&Ae.nodeName.toLowerCase()!=="object"){var Ft=Ae,re=Ae.getAttribute("id"),ke=re||be,Ze=Ae.parentNode,Be=/^\s*[+~]/.test(De);re?ke=ke.replace(/'/g,"\\$&"):Ae.setAttribute("id",ke),Be&&Ze&&(Ae=Ae.parentNode);try{if(!Be||Ze)return pt(Ae.querySelectorAll("[id='"+ke+"'] "+De),Ve)}catch(rt){}finally{re||Ft.removeAttribute("id")}}}return q(De,Ae,Ve,Je)};for(var xe in q)he[xe]=q[xe];ee=null}})(),(function(){var q=ce.documentElement,ee=q.matchesSelector||q.mozMatchesSelector||q.webkitMatchesSelector||q.msMatchesSelector;if(ee){var be=!ee.call(ce.createElement("div"),"div"),xe=!1;try{ee.call(ce.documentElement,"[test!='']:sizzle")}catch(De){xe=!0}he.matchesSelector=function(De,Ae){if(Ae=Ae.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']"),!he.isXML(De))try{if(xe||!Ce.match.PSEUDO.test(Ae)&&!/!=/.test(Ae)){var Ve=ee.call(De,Ae);if(Ve||!be||De.document&&De.document.nodeType!==11)return Ve}}catch(Je){}return he(Ae,null,null,[De]).length>0}}})(),(function(){var q=ce.createElement("div");if(q.innerHTML="<div class='test e'></div><div class='test'></div>",q.getElementsByClassName&&q.getElementsByClassName("e").length!==0){if(q.lastChild.className="e",q.getElementsByClassName("e").length===1)return;Ce.order.splice(1,0,"CLASS"),Ce.find.CLASS=function(ee,be,xe){if(typeof be.getElementsByClassName!="undefined"&&!xe)return be.getElementsByClassName(ee[1])},q=null}})(),ce.documentElement.contains?he.contains=function(q,ee){return q!==ee&&(q.contains?q.contains(ee):!0)}:ce.documentElement.compareDocumentPosition?he.contains=function(q,ee){return!!(q.compareDocumentPosition(ee)&16)}:he.contains=function(){return!1},he.isXML=function(q){var ee=(q?q.ownerDocument||q:0).documentElement;return ee?ee.nodeName!=="HTML":!1};var bt=function(q,ee,be){for(var xe,De=[],Ae="",Ve=ee.nodeType?[ee]:ee;xe=Ce.match.PSEUDO.exec(q);)Ae+=xe[0],q=q.replace(Ce.match.PSEUDO,"");q=Ce.relative[q]?q+"*":q;for(var Je=0,Ke=Ve.length;Je<Ke;Je++)he(q,Ve[Je],De,be);return he.filter(Ae,De)};he.attr=h.attr,he.selectors.attrMap={},h.find=he,h.expr=he.selectors,h.expr[":"]=h.expr.filters,h.unique=he.uniqueSort,h.text=he.getText,h.isXMLDoc=he.isXML,h.contains=he.contains})();var Xt=/Until$/,ue=/^(?:parents|prevUntil|prevAll)/,se=/,/,Ne=/^.[^:#\[\.,]*$/,Me=Array.prototype.slice,it=h.expr.match.globalPOS,vt={children:!0,contents:!0,next:!0,prev:!0};h.fn.extend({find:function(a){var u=this,y,_;if(typeof a!="string")return h(a).filter(function(){for(y=0,_=u.length;y<_;y++)if(h.contains(u[y],this))return!0});var P=this.pushStack("","find",a),U,X,K;for(y=0,_=this.length;y<_;y++)if(U=P.length,h.find(a,this[y],P),y>0){for(X=U;X<P.length;X++)for(K=0;K<U;K++)if(P[K]===P[X]){P.splice(X--,1);break}}return P},has:function(a){var u=h(a);return this.filter(function(){for(var y=0,_=u.length;y<_;y++)if(h.contains(this,u[y]))return!0})},not:function(a){return this.pushStack(ie(this,a,!1),"not",a)},filter:function(a){return this.pushStack(ie(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?it.test(a)?h(a,this.context).index(this[0])>=0:h.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,u){var y=[],_,P,U=this[0];if(h.isArray(a)){for(var X=1;U&&U.ownerDocument&&U!==u;){for(_=0;_<a.length;_++)h(U).is(a[_])&&y.push({selector:a[_],elem:U,level:X});U=U.parentNode,X++}return y}var K=it.test(a)||typeof a!="string"?h(a,u||this.context):0;for(_=0,P=this.length;_<P;_++)for(U=this[_];U;){if(K?K.index(U)>-1:h.find.matchesSelector(U,a)){y.push(U);break}if(U=U.parentNode,!U||!U.ownerDocument||U===u||U.nodeType===11)break}return y=y.length>1?h.unique(y):y,this.pushStack(y,"closest",a)},index:function(a){return a?typeof a=="string"?h.inArray(this[0],h(a)):h.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,u){var y=typeof a=="string"?h(a,u):h.makeArray(a&&a.nodeType?[a]:a),_=h.merge(this.get(),y);return this.pushStack(R(y[0])||R(_[0])?_:h.unique(_))},andSelf:function(){return this.add(this.prevObject)}}),h.each({parent:function(a){var u=a.parentNode;return u&&u.nodeType!==11?u:null},parents:function(a){return h.dir(a,"parentNode")},parentsUntil:function(a,u,y){return h.dir(a,"parentNode",y)},next:function(a){return h.nth(a,2,"nextSibling")},prev:function(a){return h.nth(a,2,"previousSibling")},nextAll:function(a){return h.dir(a,"nextSibling")},prevAll:function(a){return h.dir(a,"previousSibling")},nextUntil:function(a,u,y){return h.dir(a,"nextSibling",y)},prevUntil:function(a,u,y){return h.dir(a,"previousSibling",y)},siblings:function(a){return h.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return h.sibling(a.firstChild)},contents:function(a){return h.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:h.makeArray(a.childNodes)}},function(a,u){h.fn[a]=function(y,_){var P=h.map(this,u,y);return Xt.test(a)||(_=y),_&&typeof _=="string"&&(P=h.filter(_,P)),P=this.length>1&&!vt[a]?h.unique(P):P,(this.length>1||se.test(_))&&ue.test(a)&&(P=P.reverse()),this.pushStack(P,a,Me.call(arguments).join(","))}}),h.extend({filter:function(a,u,y){return y&&(a=":not("+a+")"),u.length===1?h.find.matchesSelector(u[0],a)?[u[0]]:[]:h.find.matches(a,u)},dir:function(a,u,y){for(var _=[],P=a[u];P&&P.nodeType!==9&&(y===n||P.nodeType!==1||!h(P).is(y));)P.nodeType===1&&_.push(P),P=P[u];return _},nth:function(a,u,y,_){u=u||1;for(var P=0;a&&!(a.nodeType===1&&++P===u);a=a[y]);return a},sibling:function(a,u){for(var y=[];a;a=a.nextSibling)a.nodeType===1&&a!==u&&y.push(a);return y}});var at="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",_t=/ jQuery\d+="(?:\d+|null)"/g,kt=/^\s+/,Nt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Gt=/<([\w:]+)/,Bt=/<tbody/i,Jt=/<|&#?\w+;/,un=/<(?:script|style)/i,mn=/<(?:script|object|embed|option|style)/i,Ut=new RegExp("<(?:"+at+")[\\s/>]","i"),vn=/checked\s*(?:[^=]|=\s*.checked.)/i,dn=/\/(java|ecma)script/i,Bn=/^\s*<!(?:\[CDATA\[|\-\-)/,tn={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},wn=V(ce);tn.optgroup=tn.option,tn.tbody=tn.tfoot=tn.colgroup=tn.caption=tn.thead,tn.th=tn.td,h.support.htmlSerialize||(tn._default=[1,"div<div>","</div>"]),h.fn.extend({text:function(a){return h.access(this,function(u){return u===n?h.text(this):this.empty().append((this[0]&&this[0].ownerDocument||ce).createTextNode(u))},null,a,arguments.length)},wrapAll:function(a){if(h.isFunction(a))return this.each(function(y){h(this).wrapAll(a.call(this,y))});if(this[0]){var u=h(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&u.insertBefore(this[0]),u.map(function(){for(var y=this;y.firstChild&&y.firstChild.nodeType===1;)y=y.firstChild;return y}).append(this)}return this},wrapInner:function(a){return h.isFunction(a)?this.each(function(u){h(this).wrapInner(a.call(this,u))}):this.each(function(){var u=h(this),y=u.contents();y.length?y.wrapAll(a):u.append(a)})},wrap:function(a){var u=h.isFunction(a);return this.each(function(y){h(this).wrapAll(u?a.call(this,y):a)})},unwrap:function(){return this.parent().each(function(){h.nodeName(this,"body")||h(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(u){this.parentNode.insertBefore(u,this)});if(arguments.length){var a=h.clean(arguments);return a.push.apply(a,this.toArray()),this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(u){this.parentNode.insertBefore(u,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);return a.push.apply(a,h.clean(arguments)),a}},remove:function(a,u){for(var y=0,_;(_=this[y])!=null;y++)(!a||h.filter(a,[_]).length)&&(!u&&_.nodeType===1&&(h.cleanData(_.getElementsByTagName("*")),h.cleanData([_])),_.parentNode&&_.parentNode.removeChild(_));return this},empty:function(){for(var a=0,u;(u=this[a])!=null;a++)for(u.nodeType===1&&h.cleanData(u.getElementsByTagName("*"));u.firstChild;)u.removeChild(u.firstChild);return this},clone:function(a,u){return a=a==null?!1:a,u=u==null?a:u,this.map(function(){return h.clone(this,a,u)})},html:function(a){return h.access(this,function(u){var y=this[0]||{},_=0,P=this.length;if(u===n)return y.nodeType===1?y.innerHTML.replace(_t,""):null;if(typeof u=="string"&&!un.test(u)&&(h.support.leadingWhitespace||!kt.test(u))&&!tn[(Gt.exec(u)||["",""])[1].toLowerCase()]){u=u.replace(Nt,"<$1></$2>");try{for(;_<P;_++)y=this[_]||{},y.nodeType===1&&(h.cleanData(y.getElementsByTagName("*")),y.innerHTML=u);y=0}catch(U){}}y&&this.empty().append(u)},null,a,arguments.length)},replaceWith:function(a){return this[0]&&this[0].parentNode?h.isFunction(a)?this.each(function(u){var y=h(this),_=y.html();y.replaceWith(a.call(this,u,_))}):(typeof a!="string"&&(a=h(a).detach()),this.each(function(){var u=this.nextSibling,y=this.parentNode;h(this).remove(),u?h(u).before(a):h(y).append(a)})):this.length?this.pushStack(h(h.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,u,y){var _,P,U,X,K=a[0],fe=[];if(!h.support.checkClone&&arguments.length===3&&typeof K=="string"&&vn.test(K))return this.each(function(){h(this).domManip(a,u,y,!0)});if(h.isFunction(K))return this.each(function(ye){var Ce=h(this);a[0]=K.call(this,ye,u?Ce.html():n),Ce.domManip(a,u,y)});if(this[0]){if(X=K&&K.parentNode,h.support.parentNode&&X&&X.nodeType===11&&X.childNodes.length===this.length?_={fragment:X}:_=h.buildFragment(a,this,fe),U=_.fragment,U.childNodes.length===1?P=U=U.firstChild:P=U.firstChild,P){u=u&&h.nodeName(P,"tr");for(var ae=0,_e=this.length,he=_e-1;ae<_e;ae++)y.call(u?M(this[ae],P):this[ae],_.cacheable||_e>1&&ae<he?h.clone(U,!0,!0):U)}fe.length&&h.each(fe,function(ye,Ce){Ce.src?h.ajax({type:"GET",global:!1,url:Ce.src,async:!1,dataType:"script"}):h.globalEval((Ce.text||Ce.textContent||Ce.innerHTML||"").replace(Bn,"/*$0*/")),Ce.parentNode&&Ce.parentNode.removeChild(Ce)})}return this}}),h.buildFragment=function(a,u,y){var _,P,U,X,K=a[0];return u&&u[0]&&(X=u[0].ownerDocument||u[0]),X.createDocumentFragment||(X=ce),a.length===1&&typeof K=="string"&&K.length<512&&X===ce&&K.charAt(0)==="<"&&!mn.test(K)&&(h.support.checkClone||!vn.test(K))&&(h.support.html5Clone||!Ut.test(K))&&(P=!0,U=h.fragments[K],U&&U!==1&&(_=U)),_||(_=X.createDocumentFragment(),h.clean(a,X,_,y)),P&&(h.fragments[K]=U?_:1),{fragment:_,cacheable:P}},h.fragments={},h.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,u){h.fn[a]=function(y){var _=[],P=h(y),U=this.length===1&&this[0].parentNode;if(U&&U.nodeType===11&&U.childNodes.length===1&&P.length===1)return P[u](this[0]),this;for(var X=0,K=P.length;X<K;X++){var fe=(X>0?this.clone(!0):this).get();h(P[X])[u](fe),_=_.concat(fe)}return this.pushStack(_,a,P.selector)}}),h.extend({clone:function(a,u,y){var _,P,U,X=h.support.html5Clone||h.isXMLDoc(a)||!Ut.test("<"+a.nodeName+">")?a.cloneNode(!0):S(a);if((!h.support.noCloneEvent||!h.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!h.isXMLDoc(a))for(Z(a,X),_=G(a),P=G(X),U=0;_[U];++U)P[U]&&Z(_[U],P[U]);if(u&&(te(a,X),y))for(_=G(a),P=G(X),U=0;_[U];++U)te(_[U],P[U]);return _=P=null,X},clean:function(a,u,y,_){var P,U,X,K=[];u=u||ce,typeof u.createElement=="undefined"&&(u=u.ownerDocument||u[0]&&u[0].ownerDocument||ce);for(var fe=0,ae;(ae=a[fe])!=null;fe++)if(typeof ae=="number"&&(ae+=""),!!ae){if(typeof ae=="string")if(!Jt.test(ae))ae=u.createTextNode(ae);else{ae=ae.replace(Nt,"<$1></$2>");var _e=(Gt.exec(ae)||["",""])[1].toLowerCase(),he=tn[_e]||tn._default,ye=he[0],Ce=u.createElement("div"),lt=wn.childNodes,$e;for(u===ce?wn.appendChild(Ce):V(u).appendChild(Ce),Ce.innerHTML=he[1]+ae+he[2];ye--;)Ce=Ce.lastChild;if(!h.support.tbody){var ct=Bt.test(ae),pt=_e==="table"&&!ct?Ce.firstChild&&Ce.firstChild.childNodes:he[1]==="<table>"&&!ct?Ce.childNodes:[];for(X=pt.length-1;X>=0;--X)h.nodeName(pt[X],"tbody")&&!pt[X].childNodes.length&&pt[X].parentNode.removeChild(pt[X])}!h.support.leadingWhitespace&&kt.test(ae)&&Ce.insertBefore(u.createTextNode(kt.exec(ae)[0]),Ce.firstChild),ae=Ce.childNodes,Ce&&(Ce.parentNode.removeChild(Ce),lt.length>0&&($e=lt[lt.length-1],$e&&$e.parentNode&&$e.parentNode.removeChild($e)))}var Mt;if(!h.support.appendChecked)if(ae[0]&&typeof(Mt=ae.length)=="number")for(X=0;X<Mt;X++)k(ae[X]);else k(ae);ae.nodeType?K.push(ae):K=h.merge(K,ae)}if(y)for(P=function(bt){return!bt.type||dn.test(bt.type)},fe=0;K[fe];fe++)if(U=K[fe],_&&h.nodeName(U,"script")&&(!U.type||dn.test(U.type)))_.push(U.parentNode?U.parentNode.removeChild(U):U);else{if(U.nodeType===1){var Yt=h.grep(U.getElementsByTagName("script"),P);K.splice.apply(K,[fe+1,0].concat(Yt))}y.appendChild(U)}return K},cleanData:function(a){for(var u,y,_=h.cache,P=h.event.special,U=h.support.deleteExpando,X=0,K;(K=a[X])!=null;X++)if(!(K.nodeName&&h.noData[K.nodeName.toLowerCase()])&&(y=K[h.expando],y)){if(u=_[y],u&&u.events){for(var fe in u.events)P[fe]?h.event.remove(K,fe):h.removeEvent(K,fe,u.handle);u.handle&&(u.handle.elem=null)}U?delete K[h.expando]:K.removeAttribute&&K.removeAttribute(h.expando),delete _[y]}}});var Zn=/alpha\([^)]*\)/i,Ii=/opacity=([^)]*)/,Pi=/([A-Z]|^ms)/g,On=/^[\-+]?(?:\d*\.)?\d+$/i,fn=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,li=/^([\-+])=([\-+.\de]+)/,Di=/^margin/,Oi={position:"absolute",visibility:"hidden",display:"block"},_n=["Top","Right","Bottom","Left"],Sn,Ln,Jn;h.fn.css=function(a,u){return h.access(this,function(y,_,P){return P!==n?h.style(y,_,P):h.css(y,_)},a,u,arguments.length>1)},h.extend({cssHooks:{opacity:{get:function(a,u){if(u){var y=Sn(a,"opacity");return y===""?"1":y}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:h.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,u,y,_){if(a&&a.nodeType!==3&&a.nodeType!==8&&a.style){var P,U,X=h.camelCase(u),K=a.style,fe=h.cssHooks[X];if(u=h.cssProps[X]||X,y===n)return fe&&"get"in fe&&(P=fe.get(a,!1,_))!==n?P:K[u];if(U=typeof y,U==="string"&&(P=li.exec(y))&&(y=+(P[1]+1)*+P[2]+parseFloat(h.css(a,u)),U="number"),y==null||U==="number"&&isNaN(y))return;if(U==="number"&&!h.cssNumber[X]&&(y+="px"),!fe||!("set"in fe)||(y=fe.set(a,y))!==n)try{K[u]=y}catch(ae){}}},css:function(a,u,y){var _,P;if(u=h.camelCase(u),P=h.cssHooks[u],u=h.cssProps[u]||u,u==="cssFloat"&&(u="float"),P&&"get"in P&&(_=P.get(a,!0,y))!==n)return _;if(Sn)return Sn(a,u)},swap:function(a,u,y){var _={},P,U;for(U in u)_[U]=a.style[U],a.style[U]=u[U];P=y.call(a);for(U in u)a.style[U]=_[U];return P}}),h.curCSS=h.css,ce.defaultView&&ce.defaultView.getComputedStyle&&(Ln=function(a,u){var y,_,P,U,X=a.style;return u=u.replace(Pi,"-$1").toLowerCase(),(_=a.ownerDocument.defaultView)&&(P=_.getComputedStyle(a,null))&&(y=P.getPropertyValue(u),y===""&&!h.contains(a.ownerDocument.documentElement,a)&&(y=h.style(a,u))),!h.support.pixelMargin&&P&&Di.test(u)&&fn.test(y)&&(U=X.width,X.width=y,y=P.width,X.width=U),y}),ce.documentElement.currentStyle&&(Jn=function(a,u){var y,_,P,U=a.currentStyle&&a.currentStyle[u],X=a.style;return U==null&&X&&(P=X[u])&&(U=P),fn.test(U)&&(y=X.left,_=a.runtimeStyle&&a.runtimeStyle.left,_&&(a.runtimeStyle.left=a.currentStyle.left),X.left=u==="fontSize"?"1em":U,U=X.pixelLeft+"px",X.left=y,_&&(a.runtimeStyle.left=_)),U===""?"auto":U}),Sn=Ln||Jn,h.each(["height","width"],function(a,u){h.cssHooks[u]={get:function(y,_,P){if(_)return y.offsetWidth!==0?p(y,u,P):h.swap(y,Oi,function(){return p(y,u,P)})},set:function(y,_){return On.test(_)?_+"px":_}}}),h.support.opacity||(h.cssHooks.opacity={get:function(a,u){return Ii.test((u&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":u?"1":""},set:function(a,u){var y=a.style,_=a.currentStyle,P=h.isNumeric(u)?"alpha(opacity="+u*100+")":"",U=_&&_.filter||y.filter||"";y.zoom=1,!(u>=1&&h.trim(U.replace(Zn,""))===""&&(y.removeAttribute("filter"),_&&!_.filter))&&(y.filter=Zn.test(U)?U.replace(Zn,P):U+" "+P)}}),h(function(){h.support.reliableMarginRight||(h.cssHooks.marginRight={get:function(a,u){return h.swap(a,{display:"inline-block"},function(){return u?Sn(a,"margin-right"):a.style.marginRight})}})}),h.expr&&h.expr.filters&&(h.expr.filters.hidden=function(a){var u=a.offsetWidth,y=a.offsetHeight;return u===0&&y===0||!h.support.reliableHiddenOffsets&&(a.style&&a.style.display||h.css(a,"display"))==="none"},h.expr.filters.visible=function(a){return!h.expr.filters.hidden(a)}),h.each({margin:"",padding:"",border:"Width"},function(a,u){h.cssHooks[a+u]={expand:function(y){var _,P=typeof y=="string"?y.split(" "):[y],U={};for(_=0;_<4;_++)U[a+_n[_]+u]=P[_]||P[_-2]||P[0];return U}}});var Li=/%20/g,ci=/\[\]$/,Gn=/\r?\n/g,ui=/#.*$/,Nn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,Fn=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,di=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,fi=/^(?:GET|HEAD)$/,hi=/^\/\//,$n=/\?/,Ni=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Yn=/^(?:select|textarea)/i,pi=/\s+/,Fi=/([?&])_=[^&]*/,gi=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,ei=h.fn.load,ti={},mi={},En,xn,vi="*/*";try{En=me.href}catch(a){En=ce.createElement("a"),En.href="",En=En.href}xn=gi.exec(En.toLowerCase())||[],h.fn.extend({load:function(a,u,y){if(typeof a!="string"&&ei)return ei.apply(this,arguments);if(!this.length)return this;var _=a.indexOf(" ");if(_>=0){var P=a.slice(_,a.length);a=a.slice(0,_)}var U="GET";u&&(h.isFunction(u)?(y=u,u=n):typeof u=="object"&&(u=h.param(u,h.ajaxSettings.traditional),U="POST"));var X=this;return h.ajax({url:a,type:U,dataType:"html",data:u,complete:function(K,fe,ae){ae=K.responseText,K.isResolved()&&(K.done(function(_e){ae=_e}),X.html(P?h("<div>").append(ae.replace(Ni,"")).find(P):ae)),y&&X.each(y,[ae,fe,K])}}),this},serialize:function(){return h.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?h.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Yn.test(this.nodeName)||Fn.test(this.type))}).map(function(a,u){var y=h(this).val();return y==null?null:h.isArray(y)?h.map(y,function(_,P){return{name:u.name,value:_.replace(Gn,`\r
`)}}):{name:u.name,value:y.replace(Gn,`\r
`)}}).get()}}),h.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,u){h.fn[u]=function(y){return this.on(u,y)}}),h.each(["get","post"],function(a,u){h[u]=function(y,_,P,U){return h.isFunction(_)&&(U=U||P,P=_,_=n),h.ajax({type:u,url:y,data:_,success:P,dataType:U})}}),h.extend({getScript:function(a,u){return h.get(a,n,u,"script")},getJSON:function(a,u,y){return h.get(a,u,y,"json")},ajaxSetup:function(a,u){return u?E(a,h.ajaxSettings):(u=a,a=h.ajaxSettings),E(a,u),a},ajaxSettings:{url:En,isLocal:di.test(xn[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":vi},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":h.parseJSON,"text xml":h.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:v(ti),ajaxTransport:v(mi),ajax:function(a,u){function y(be,xe,De,Ae){if(pt!==2){pt=2,$e&&clearTimeout($e),lt=n,ye=Ae||"",bt.readyState=be>0?4:0;var Ve,Je,Ke,mt=xe,Ft=De?z(_,bt,De):n,re,ke;if(be>=200&&be<300||be===304)if(_.ifModified&&((re=bt.getResponseHeader("Last-Modified"))&&(h.lastModified[ae]=re),(ke=bt.getResponseHeader("Etag"))&&(h.etag[ae]=ke)),be===304)mt="notmodified",Ve=!0;else try{Je=D(_,Ft),mt="success",Ve=!0}catch(Ze){mt="parsererror",Ke=Ze}else Ke=mt,(!mt||be)&&(mt="error",be<0&&(be=0));bt.status=be,bt.statusText=""+(xe||mt),Ve?X.resolveWith(P,[Je,mt,bt]):X.rejectWith(P,[bt,mt,Ke]),bt.statusCode(fe),fe=n,Mt&&U.trigger("ajax"+(Ve?"Success":"Error"),[bt,_,Ve?Je:Ke]),K.fireWith(P,[bt,mt]),Mt&&(U.trigger("ajaxComplete",[bt,_]),--h.active||h.event.trigger("ajaxStop"))}}typeof a=="object"&&(u=a,a=n),u=u||{};var _=h.ajaxSetup({},u),P=_.context||_,U=P!==_&&(P.nodeType||P instanceof h)?h(P):h.event,X=h.Deferred(),K=h.Callbacks("once memory"),fe=_.statusCode||{},ae,_e={},he={},ye,Ce,lt,$e,ct,pt=0,Mt,Yt,bt={readyState:0,setRequestHeader:function(be,xe){if(!pt){var De=be.toLowerCase();be=he[De]=he[De]||be,_e[be]=xe}return this},getAllResponseHeaders:function(){return pt===2?ye:null},getResponseHeader:function(be){var xe;if(pt===2){if(!Ce)for(Ce={};xe=Nn.exec(ye);)Ce[xe[1].toLowerCase()]=xe[2];xe=Ce[be.toLowerCase()]}return xe===n?null:xe},overrideMimeType:function(be){return pt||(_.mimeType=be),this},abort:function(be){return be=be||"abort",lt&&lt.abort(be),y(0,be),this}};if(X.promise(bt),bt.success=bt.done,bt.error=bt.fail,bt.complete=K.add,bt.statusCode=function(be){if(be){var xe;if(pt<2)for(xe in be)fe[xe]=[fe[xe],be[xe]];else xe=be[bt.status],bt.then(xe,xe)}return this},_.url=((a||_.url)+"").replace(ui,"").replace(hi,xn[1]+"//"),_.dataTypes=h.trim(_.dataType||"*").toLowerCase().split(pi),_.crossDomain==null&&(ct=gi.exec(_.url.toLowerCase()),_.crossDomain=!(!ct||ct[1]==xn[1]&&ct[2]==xn[2]&&(ct[3]||(ct[1]==="http:"?80:443))==(xn[3]||(xn[1]==="http:"?80:443)))),_.data&&_.processData&&typeof _.data!="string"&&(_.data=h.param(_.data,_.traditional)),L(ti,_,u,bt),pt===2)return!1;if(Mt=_.global,_.type=_.type.toUpperCase(),_.hasContent=!fi.test(_.type),Mt&&h.active++===0&&h.event.trigger("ajaxStart"),!_.hasContent&&(_.data&&(_.url+=($n.test(_.url)?"&":"?")+_.data,delete _.data),ae=_.url,_.cache===!1)){var q=h.now(),ee=_.url.replace(Fi,"$1_="+q);_.url=ee+(ee===_.url?($n.test(_.url)?"&":"?")+"_="+q:"")}(_.data&&_.hasContent&&_.contentType!==!1||u.contentType)&&bt.setRequestHeader("Content-Type",_.contentType),_.ifModified&&(ae=ae||_.url,h.lastModified[ae]&&bt.setRequestHeader("If-Modified-Since",h.lastModified[ae]),h.etag[ae]&&bt.setRequestHeader("If-None-Match",h.etag[ae])),bt.setRequestHeader("Accept",_.dataTypes[0]&&_.accepts[_.dataTypes[0]]?_.accepts[_.dataTypes[0]]+(_.dataTypes[0]!=="*"?", "+vi+"; q=0.01":""):_.accepts["*"]);for(Yt in _.headers)bt.setRequestHeader(Yt,_.headers[Yt]);if(_.beforeSend&&(_.beforeSend.call(P,bt,_)===!1||pt===2))return bt.abort(),!1;for(Yt in{success:1,error:1,complete:1})bt[Yt](_[Yt]);if(lt=L(mi,_,u,bt),!lt)y(-1,"No Transport");else{bt.readyState=1,Mt&&U.trigger("ajaxSend",[bt,_]),_.async&&_.timeout>0&&($e=setTimeout(function(){bt.abort("timeout")},_.timeout));try{pt=1,lt.send(_e,y)}catch(be){if(pt<2)y(-1,be);else throw be}}return bt},param:function(a,u){var y=[],_=function(U,X){X=h.isFunction(X)?X():X,y[y.length]=encodeURIComponent(U)+"="+encodeURIComponent(X)};if(u===n&&(u=h.ajaxSettings.traditional),h.isArray(a)||a.jquery&&!h.isPlainObject(a))h.each(a,function(){_(this.name,this.value)});else for(var P in a)O(P,a[P],u,_);return y.join("&").replace(Li,"+")}}),h.extend({active:0,lastModified:{},etag:{}});var yi=h.now(),Xn=/(\=)\?(&|$)|\?\?/i;h.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return h.expando+"_"+yi++}}),h.ajaxPrefilter("json jsonp",function(a,u,y){var _=typeof a.data=="string"&&/^application\/x\-www\-form\-urlencoded/.test(a.contentType);if(a.dataTypes[0]==="jsonp"||a.jsonp!==!1&&(Xn.test(a.url)||_&&Xn.test(a.data))){var P,U=a.jsonpCallback=h.isFunction(a.jsonpCallback)?a.jsonpCallback():a.jsonpCallback,X=e[U],K=a.url,fe=a.data,ae="$1"+U+"$2";return a.jsonp!==!1&&(K=K.replace(Xn,ae),a.url===K&&(_&&(fe=fe.replace(Xn,ae)),a.data===fe&&(K+=(/\?/.test(K)?"&":"?")+a.jsonp+"="+U))),a.url=K,a.data=fe,e[U]=function(_e){P=[_e]},y.always(function(){e[U]=X,P&&h.isFunction(X)&&e[U](P[0])}),a.converters["script json"]=function(){return P||h.error(U+" was not called"),P[0]},a.dataTypes[0]="json","script"}}),h.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return h.globalEval(a),a}}}),h.ajaxPrefilter("script",function(a){a.cache===n&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),h.ajaxTransport("script",function(a){if(a.crossDomain){var u,y=ce.head||ce.getElementsByTagName("head")[0]||ce.documentElement;return{send:function(_,P){u=ce.createElement("script"),u.async="async",a.scriptCharset&&(u.charset=a.scriptCharset),u.src=a.url,u.onload=u.onreadystatechange=function(U,X){(X||!u.readyState||/loaded|complete/.test(u.readyState))&&(u.onload=u.onreadystatechange=null,y&&u.parentNode&&y.removeChild(u),u=n,X||P(200,"success"))},y.insertBefore(u,y.firstChild)},abort:function(){u&&u.onload(0,1)}}}});var Mn=e.ActiveXObject?function(){for(var a in An)An[a](0,1)}:!1,on=0,An;h.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&A()||T()}:A,(function(a){h.extend(h.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})})(h.ajaxSettings.xhr()),h.support.ajax&&h.ajaxTransport(function(a){if(!a.crossDomain||h.support.cors){var u;return{send:function(y,_){var P=a.xhr(),U,X;if(a.username?P.open(a.type,a.url,a.async,a.username,a.password):P.open(a.type,a.url,a.async),a.xhrFields)for(X in a.xhrFields)P[X]=a.xhrFields[X];a.mimeType&&P.overrideMimeType&&P.overrideMimeType(a.mimeType),!a.crossDomain&&!y["X-Requested-With"]&&(y["X-Requested-With"]="XMLHttpRequest");try{for(X in y)P.setRequestHeader(X,y[X])}catch(K){}P.send(a.hasContent&&a.data||null),u=function(K,fe){var ae,_e,he,ye,Ce;try{if(u&&(fe||P.readyState===4))if(u=n,U&&(P.onreadystatechange=h.noop,Mn&&delete An[U]),fe)P.readyState!==4&&P.abort();else{ae=P.status,he=P.getAllResponseHeaders(),ye={},Ce=P.responseXML,Ce&&Ce.documentElement&&(ye.xml=Ce);try{ye.text=P.responseText}catch(lt){}try{_e=P.statusText}catch(lt){_e=""}!ae&&a.isLocal&&!a.crossDomain?ae=ye.text?200:404:ae===1223&&(ae=204)}}catch(lt){fe||_(-1,lt)}ye&&_(ae,_e,ye,he)},!a.async||P.readyState===4?u():(U=++on,Mn&&(An||(An={},h(e).unload(Mn)),An[U]=u),P.onreadystatechange=u)},abort:function(){u&&u(0,1)}}}});var Hn={},pn,kn,bi=/^(?:toggle|show|hide)$/,Hi=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,Rn,Vn=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],hn;h.fn.extend({show:function(a,u,y){var _,P;if(a||a===0)return this.animate(c("show",3),a,u,y);for(var U=0,X=this.length;U<X;U++)_=this[U],_.style&&(P=_.style.display,!h._data(_,"olddisplay")&&P==="none"&&(P=_.style.display=""),(P===""&&h.css(_,"display")==="none"||!h.contains(_.ownerDocument.documentElement,_))&&h._data(_,"olddisplay",l(_.nodeName)));for(U=0;U<X;U++)_=this[U],_.style&&(P=_.style.display,(P===""||P==="none")&&(_.style.display=h._data(_,"olddisplay")||""));return this},hide:function(a,u,y){if(a||a===0)return this.animate(c("hide",3),a,u,y);for(var _,P,U=0,X=this.length;U<X;U++)_=this[U],_.style&&(P=h.css(_,"display"),P!=="none"&&!h._data(_,"olddisplay")&&h._data(_,"olddisplay",P));for(U=0;U<X;U++)this[U].style&&(this[U].style.display="none");return this},_toggle:h.fn.toggle,toggle:function(a,u,y){var _=typeof a=="boolean";return h.isFunction(a)&&h.isFunction(u)?this._toggle.apply(this,arguments):a==null||_?this.each(function(){var P=_?a:h(this).is(":hidden");h(this)[P?"show":"hide"]()}):this.animate(c("toggle",3),a,u,y),this},fadeTo:function(a,u,y,_){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:u},a,y,_)},animate:function(a,u,y,_){function P(){U.queue===!1&&h._mark(this);var X=h.extend({},U),K=this.nodeType===1,fe=K&&h(this).is(":hidden"),ae,_e,he,ye,Ce,lt,$e,ct,pt,Mt,Yt;X.animatedProperties={};for(he in a)if(ae=h.camelCase(he),he!==ae&&(a[ae]=a[he],delete a[he]),(Ce=h.cssHooks[ae])&&"expand"in Ce){lt=Ce.expand(a[ae]),delete a[ae];for(he in lt)he in a||(a[he]=lt[he])}for(ae in a){if(_e=a[ae],h.isArray(_e)?(X.animatedProperties[ae]=_e[1],_e=a[ae]=_e[0]):X.animatedProperties[ae]=X.specialEasing&&X.specialEasing[ae]||X.easing||"swing",_e==="hide"&&fe||_e==="show"&&!fe)return X.complete.call(this);K&&(ae==="height"||ae==="width")&&(X.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],h.css(this,"display")==="inline"&&h.css(this,"float")==="none"&&(!h.support.inlineBlockNeedsLayout||l(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1))}X.overflow!=null&&(this.style.overflow="hidden");for(he in a)ye=new h.fx(this,X,he),_e=a[he],bi.test(_e)?(Yt=h._data(this,"toggle"+he)||(_e==="toggle"?fe?"show":"hide":0),Yt?(h._data(this,"toggle"+he,Yt==="show"?"hide":"show"),ye[Yt]()):ye[_e]()):($e=Hi.exec(_e),ct=ye.cur(),$e?(pt=parseFloat($e[2]),Mt=$e[3]||(h.cssNumber[he]?"":"px"),Mt!=="px"&&(h.style(this,he,(pt||1)+Mt),ct=(pt||1)/ye.cur()*ct,h.style(this,he,ct+Mt)),$e[1]&&(pt=($e[1]==="-="?-1:1)*pt+ct),ye.custom(ct,pt,Mt)):ye.custom(ct,_e,""));return!0}var U=h.speed(u,y,_);return h.isEmptyObject(a)?this.each(U.complete,[!1]):(a=h.extend({},a),U.queue===!1?this.each(P):this.queue(U.queue,P))},stop:function(a,u,y){return typeof a!="string"&&(y=u,u=a,a=n),u&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){function _(fe,ae,_e){var he=ae[_e];h.removeData(fe,_e,!0),he.stop(y)}var P,U=!1,X=h.timers,K=h._data(this);if(y||h._unmark(!0,this),a==null)for(P in K)K[P]&&K[P].stop&&P.indexOf(".run")===P.length-4&&_(this,K,P);else K[P=a+".run"]&&K[P].stop&&_(this,K,P);for(P=X.length;P--;)X[P].elem===this&&(a==null||X[P].queue===a)&&(y?X[P](!0):X[P].saveState(),U=!0,X.splice(P,1));(!y||!U)&&h.dequeue(this,a)})}}),h.each({slideDown:c("show",1),slideUp:c("hide",1),slideToggle:c("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,u){h.fn[a]=function(y,_,P){return this.animate(u,y,_,P)}}),h.extend({speed:function(a,u,y){var _=a&&typeof a=="object"?h.extend({},a):{complete:y||!y&&u||h.isFunction(a)&&a,duration:a,easing:y&&u||u&&!h.isFunction(u)&&u};return _.duration=h.fx.off?0:typeof _.duration=="number"?_.duration:_.duration in h.fx.speeds?h.fx.speeds[_.duration]:h.fx.speeds._default,(_.queue==null||_.queue===!0)&&(_.queue="fx"),_.old=_.complete,_.complete=function(P){h.isFunction(_.old)&&_.old.call(this),_.queue?h.dequeue(this,_.queue):P!==!1&&h._unmark(this)},_},easing:{linear:function(a){return a},swing:function(a){return-Math.cos(a*Math.PI)/2+.5}},timers:[],fx:function(a,u,y){this.options=u,this.elem=a,this.prop=y,u.orig=u.orig||{}}}),h.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(h.fx.step[this.prop]||h.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,u=h.css(this.elem,this.prop);return isNaN(a=parseFloat(u))?!u||u==="auto"?0:u:a},custom:function(a,u,y){function _(X){return P.step(X)}var P=this,U=h.fx;this.startTime=hn||f(),this.end=u,this.now=this.start=a,this.pos=this.state=0,this.unit=y||this.unit||(h.cssNumber[this.prop]?"":"px"),_.queue=this.options.queue,_.elem=this.elem,_.saveState=function(){h._data(P.elem,"fxshow"+P.prop)===n&&(P.options.hide?h._data(P.elem,"fxshow"+P.prop,P.start):P.options.show&&h._data(P.elem,"fxshow"+P.prop,P.end))},_()&&h.timers.push(_)&&!Rn&&(Rn=setInterval(U.tick,U.interval))},show:function(){var a=h._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||h.style(this.elem,this.prop),this.options.show=!0,a!==n?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),h(this.elem).show()},hide:function(){this.options.orig[this.prop]=h._data(this.elem,"fxshow"+this.prop)||h.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var u,y,_,P=hn||f(),U=!0,X=this.elem,K=this.options;if(a||P>=K.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),K.animatedProperties[this.prop]=!0;for(u in K.animatedProperties)K.animatedProperties[u]!==!0&&(U=!1);if(U){if(K.overflow!=null&&!h.support.shrinkWrapBlocks&&h.each(["","X","Y"],function(fe,ae){X.style["overflow"+ae]=K.overflow[fe]}),K.hide&&h(X).hide(),K.hide||K.show)for(u in K.animatedProperties)h.style(X,u,K.orig[u]),h.removeData(X,"fxshow"+u,!0),h.removeData(X,"toggle"+u,!0);_=K.complete,_&&(K.complete=!1,_.call(X))}return!1}return K.duration==1/0?this.now=P:(y=P-this.startTime,this.state=y/K.duration,this.pos=h.easing[K.animatedProperties[this.prop]](this.state,y,0,1,K.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}},h.extend(h.fx,{tick:function(){for(var a,u=h.timers,y=0;y<u.length;y++)a=u[y],!a()&&u[y]===a&&u.splice(y--,1);u.length||h.fx.stop()},interval:13,stop:function(){clearInterval(Rn),Rn=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){h.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),h.each(Vn.concat.apply([],Vn),function(a,u){u.indexOf("margin")&&(h.fx.step[u]=function(y){h.style(y.elem,u,Math.max(0,y.now)+y.unit)})}),h.expr&&h.expr.filters&&(h.expr.filters.animated=function(a){return h.grep(h.timers,function(u){return a===u.elem}).length});var Un,Ri=/^t(?:able|d|h)$/i,Cn=/^(?:body|html)$/i;"getBoundingClientRect"in ce.documentElement?Un=function(a,u,y,_){try{_=a.getBoundingClientRect()}catch(ye){}if(!_||!h.contains(y,a))return _?{top:_.top,left:_.left}:{top:0,left:0};var P=u.body,U=w(u),X=y.clientTop||P.clientTop||0,K=y.clientLeft||P.clientLeft||0,fe=U.pageYOffset||h.support.boxModel&&y.scrollTop||P.scrollTop,ae=U.pageXOffset||h.support.boxModel&&y.scrollLeft||P.scrollLeft,_e=_.top+fe-X,he=_.left+ae-K;return{top:_e,left:he}}:Un=function(a,u,y){for(var _,P=a.offsetParent,U=a,X=u.body,K=u.defaultView,fe=K?K.getComputedStyle(a,null):a.currentStyle,ae=a.offsetTop,_e=a.offsetLeft;(a=a.parentNode)&&a!==X&&a!==y&&!(h.support.fixedPosition&&fe.position==="fixed");)_=K?K.getComputedStyle(a,null):a.currentStyle,ae-=a.scrollTop,_e-=a.scrollLeft,a===P&&(ae+=a.offsetTop,_e+=a.offsetLeft,h.support.doesNotAddBorder&&(!h.support.doesAddBorderForTableAndCells||!Ri.test(a.nodeName))&&(ae+=parseFloat(_.borderTopWidth)||0,_e+=parseFloat(_.borderLeftWidth)||0),U=P,P=a.offsetParent),h.support.subtractsBorderForOverflowNotVisible&&_.overflow!=="visible"&&(ae+=parseFloat(_.borderTopWidth)||0,_e+=parseFloat(_.borderLeftWidth)||0),fe=_;return(fe.position==="relative"||fe.position==="static")&&(ae+=X.offsetTop,_e+=X.offsetLeft),h.support.fixedPosition&&fe.position==="fixed"&&(ae+=Math.max(y.scrollTop,X.scrollTop),_e+=Math.max(y.scrollLeft,X.scrollLeft)),{top:ae,left:_e}},h.fn.offset=function(a){if(arguments.length)return a===n?this:this.each(function(_){h.offset.setOffset(this,a,_)});var u=this[0],y=u&&u.ownerDocument;return y?u===y.body?h.offset.bodyOffset(u):Un(u,y,y.documentElement):null},h.offset={bodyOffset:function(a){var u=a.offsetTop,y=a.offsetLeft;return h.support.doesNotIncludeMarginInBodyOffset&&(u+=parseFloat(h.css(a,"marginTop"))||0,y+=parseFloat(h.css(a,"marginLeft"))||0),{top:u,left:y}},setOffset:function(a,u,y){var _=h.css(a,"position");_==="static"&&(a.style.position="relative");var P=h(a),U=P.offset(),X=h.css(a,"top"),K=h.css(a,"left"),fe=(_==="absolute"||_==="fixed")&&h.inArray("auto",[X,K])>-1,ae={},_e={},he,ye;fe?(_e=P.position(),he=_e.top,ye=_e.left):(he=parseFloat(X)||0,ye=parseFloat(K)||0),h.isFunction(u)&&(u=u.call(a,y,U)),u.top!=null&&(ae.top=u.top-U.top+he),u.left!=null&&(ae.left=u.left-U.left+ye),"using"in u?u.using.call(a,ae):P.css(ae)}},h.fn.extend({position:function(){if(!this[0])return null;var a=this[0],u=this.offsetParent(),y=this.offset(),_=Cn.test(u[0].nodeName)?{top:0,left:0}:u.offset();return y.top-=parseFloat(h.css(a,"marginTop"))||0,y.left-=parseFloat(h.css(a,"marginLeft"))||0,_.top+=parseFloat(h.css(u[0],"borderTopWidth"))||0,_.left+=parseFloat(h.css(u[0],"borderLeftWidth"))||0,{top:y.top-_.top,left:y.left-_.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||ce.body;a&&!Cn.test(a.nodeName)&&h.css(a,"position")==="static";)a=a.offsetParent;return a})}}),h.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,u){var y=/Y/.test(u);h.fn[a]=function(_){return h.access(this,function(P,U,X){var K=w(P);if(X===n)return K?u in K?K[u]:h.support.boxModel&&K.document.documentElement[U]||K.document.body[U]:P[U];K?K.scrollTo(y?h(K).scrollLeft():X,y?X:h(K).scrollTop()):P[U]=X},a,_,arguments.length,null)}}),h.each({Height:"height",Width:"width"},function(a,u){var y="client"+a,_="scroll"+a,P="offset"+a;h.fn["inner"+a]=function(){var U=this[0];return U?U.style?parseFloat(h.css(U,u,"padding")):this[u]():null},h.fn["outer"+a]=function(U){var X=this[0];return X?X.style?parseFloat(h.css(X,u,U?"margin":"border")):this[u]():null},h.fn[u]=function(U){return h.access(this,function(X,K,fe){var ae,_e,he,ye;if(h.isWindow(X))return ae=X.document,_e=ae.documentElement[y],h.support.boxModel&&_e||ae.body&&ae.body[y]||_e;if(X.nodeType===9)return ae=X.documentElement,ae[y]>=ae[_]?ae[y]:Math.max(X.body[_],ae[_],X.body[P],ae[P]);if(fe===n)return he=h.css(X,K),ye=parseFloat(he),h.isNumeric(ye)?ye:he;h(X).css(K,fe)},u,U,arguments.length,null)}}),e.jQuery=e.$=h,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return h})})(window);/*! jQuery UI - v1.9.2 - 2012-12-10
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.position.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.sortable.js, jquery.ui.autocomplete.js, jquery.ui.menu.js, jquery.ui.slider.js
* Copyright (c) 2012 jQuery Foundation and other contributors Licensed MIT */(function(e,n){function w(f,T){var A,D,z,O=f.nodeName.toLowerCase();return O==="area"?(A=f.parentNode,D=A.name,!f.href||!D||A.nodeName.toLowerCase()!=="map"?!1:(z=e("img[usemap=#"+D+"]")[0],!!z&&l(z))):(/input|select|textarea|button|object/.test(O)?!f.disabled:O==="a"&&f.href||T)&&l(f)}function l(f){return e.expr.filters.visible(f)&&!e(f).parents().andSelf().filter(function(){return e.css(this,"visibility")==="hidden"}).length}var c=0,m=/^ui-id-\d+$/;e.ui=e.ui||{},!e.ui.version&&(e.extend(e.ui,{version:"1.9.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({_focus:e.fn.focus,focus:function(f,T){return typeof f=="number"?this.each(function(){var A=this;setTimeout(function(){e(A).focus(),T&&T.call(A)},f)}):this._focus.apply(this,arguments)},scrollParent:function(){var f;return e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?f=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):f=this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!f.length?e(document):f},zIndex:function(f){if(f!==n)return this.css("zIndex",f);if(this.length)for(var T=e(this[0]),A,D;T.length&&T[0]!==document;){if(A=T.css("position"),(A==="absolute"||A==="relative"||A==="fixed")&&(D=parseInt(T.css("zIndex"),10),!isNaN(D)&&D!==0))return D;T=T.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++c)})},removeUniqueId:function(){return this.each(function(){m.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(f){return function(T){return!!e.data(T,f)}}):function(f,T,A){return!!e.data(f,A[3])},focusable:function(f){return w(f,!isNaN(e.attr(f,"tabindex")))},tabbable:function(f){var T=e.attr(f,"tabindex"),A=isNaN(T);return(A||T>=0)&&w(f,!A)}}),e(function(){var f=document.body,T=f.appendChild(T=document.createElement("div"));T.offsetHeight,e.extend(T.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),e.support.minHeight=T.offsetHeight===100,e.support.selectstart="onselectstart"in T,f.removeChild(T).style.display="none"}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(f,T){function A(E,L,v,p){return e.each(D,function(){L-=parseFloat(e.css(E,"padding"+this))||0,v&&(L-=parseFloat(e.css(E,"border"+this+"Width"))||0),p&&(L-=parseFloat(e.css(E,"margin"+this))||0)}),L}var D=T==="Width"?["Left","Right"]:["Top","Bottom"],z=T.toLowerCase(),O={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+T]=function(E){return E===n?O["inner"+T].call(this):this.each(function(){e(this).css(z,A(this,E)+"px")})},e.fn["outer"+T]=function(E,L){return typeof E!="number"?O["outer"+T].call(this,E):this.each(function(){e(this).css(z,A(this,E,!0,L)+"px")})}}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=(function(f){return function(T){return arguments.length?f.call(this,e.camelCase(T)):f.call(this)}})(e.fn.removeData)),(function(){var f=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];e.ui.ie=!!f.length,e.ui.ie6=parseFloat(f[1],10)===6})(),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(f){f.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(f,T,A){var D,z=e.ui[f].prototype;for(D in A)z.plugins[D]=z.plugins[D]||[],z.plugins[D].push([T,A[D]])},call:function(f,T,A){var D,z=f.plugins[T];if(!(!z||!f.element[0].parentNode||f.element[0].parentNode.nodeType===11))for(D=0;D<z.length;D++)f.options[z[D][0]]&&z[D][1].apply(f.element,A)}},contains:e.contains,hasScroll:function(f,T){if(e(f).css("overflow")==="hidden")return!1;var A=T&&T==="left"?"scrollLeft":"scrollTop",D=!1;return f[A]>0?!0:(f[A]=1,D=f[A]>0,f[A]=0,D)},isOverAxis:function(f,T,A){return f>T&&f<T+A},isOver:function(f,T,A,D,z,O){return e.ui.isOverAxis(f,A,z)&&e.ui.isOverAxis(T,D,O)}}))})(jQuery),(function(e,n){var w=0,l=Array.prototype.slice,c=e.cleanData;e.cleanData=function(m){for(var f=0,T;(T=m[f])!=null;f++)try{e(T).triggerHandler("remove")}catch(A){}c(m)},e.widget=function(m,f,T){var A,D,z,O,E=m.split(".")[0];m=m.split(".")[1],A=E+"-"+m,T||(T=f,f=e.Widget),e.expr[":"][A.toLowerCase()]=function(L){return!!e.data(L,A)},e[E]=e[E]||{},D=e[E][m],z=e[E][m]=function(L,v){if(!this._createWidget)return new z(L,v);arguments.length&&this._createWidget(L,v)},e.extend(z,D,{version:T.version,_proto:e.extend({},T),_childConstructors:[]}),O=new f,O.options=e.widget.extend({},O.options),e.each(T,function(L,v){e.isFunction(v)&&(T[L]=(function(){var p=function(){return f.prototype[L].apply(this,arguments)},S=function(k){return f.prototype[L].apply(this,k)};return function(){var k=this._super,F=this._superApply,G;return this._super=p,this._superApply=S,G=v.apply(this,arguments),this._super=k,this._superApply=F,G}})())}),z.prototype=e.widget.extend(O,{widgetEventPrefix:D?O.widgetEventPrefix:m},T,{constructor:z,namespace:E,widgetName:m,widgetBaseClass:A,widgetFullName:A}),D?(e.each(D._childConstructors,function(L,v){var p=v.prototype;e.widget(p.namespace+"."+p.widgetName,z,v._proto)}),delete D._childConstructors):f._childConstructors.push(z),e.widget.bridge(m,z)},e.widget.extend=function(m){for(var f=l.call(arguments,1),T=0,A=f.length,D,z;T<A;T++)for(D in f[T])z=f[T][D],f[T].hasOwnProperty(D)&&z!==n&&(e.isPlainObject(z)?m[D]=e.isPlainObject(m[D])?e.widget.extend({},m[D],z):e.widget.extend({},z):m[D]=z);return m},e.widget.bridge=function(m,f){var T=f.prototype.widgetFullName||m;e.fn[m]=function(A){var D=typeof A=="string",z=l.call(arguments,1),O=this;return A=!D&&z.length?e.widget.extend.apply(null,[A].concat(z)):A,D?this.each(function(){var E,L=e.data(this,T);if(!L)return e.error("cannot call methods on "+m+" prior to initialization; attempted to call method '"+A+"'");if(!e.isFunction(L[A])||A.charAt(0)==="_")return e.error("no such method '"+A+"' for "+m+" widget instance");if(E=L[A].apply(L,z),E!==L&&E!==n)return O=E&&E.jquery?O.pushStack(E.get()):E,!1}):this.each(function(){var E=e.data(this,T);E?E.option(A||{})._init():e.data(this,T,new f(A,this))}),O}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(m,f){f=e(f||this.defaultElement||this)[0],this.element=e(f),this.uuid=w++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),m),this.bindings=e(),this.hoverable=e(),this.focusable=e(),f!==this&&(e.data(f,this.widgetName,this),e.data(f,this.widgetFullName,this),this._on(!0,this.element,{remove:function(T){T.target===f&&this.destroy()}}),this.document=e(f.style?f.ownerDocument:f.document||f),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(m,f){var T=m,A,D,z;if(arguments.length===0)return e.widget.extend({},this.options);if(typeof m=="string")if(T={},A=m.split("."),m=A.shift(),A.length){for(D=T[m]=e.widget.extend({},this.options[m]),z=0;z<A.length-1;z++)D[A[z]]=D[A[z]]||{},D=D[A[z]];if(m=A.pop(),f===n)return D[m]===n?null:D[m];D[m]=f}else{if(f===n)return this.options[m]===n?null:this.options[m];T[m]=f}return this._setOptions(T),this},_setOptions:function(m){var f;for(f in m)this._setOption(f,m[f]);return this},_setOption:function(m,f){return this.options[m]=f,m==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!f).attr("aria-disabled",f),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(m,f,T){var A,D=this;typeof m!="boolean"&&(T=f,f=m,m=!1),T?(f=A=e(f),this.bindings=this.bindings.add(f)):(T=f,f=this.element,A=this.widget()),e.each(T,function(z,O){function E(){if(!(!m&&(D.options.disabled===!0||e(this).hasClass("ui-state-disabled"))))return(typeof O=="string"?D[O]:O).apply(D,arguments)}typeof O!="string"&&(E.guid=O.guid=O.guid||E.guid||e.guid++);var L=z.match(/^(\w+)\s*(.*)$/),v=L[1]+D.eventNamespace,p=L[2];p?A.delegate(p,v,E):f.bind(v,E)})},_off:function(m,f){f=(f||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,m.unbind(f).undelegate(f)},_delay:function(m,f){function T(){return(typeof m=="string"?A[m]:m).apply(A,arguments)}var A=this;return setTimeout(T,f||0)},_hoverable:function(m){this.hoverable=this.hoverable.add(m),this._on(m,{mouseenter:function(f){e(f.currentTarget).addClass("ui-state-hover")},mouseleave:function(f){e(f.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(m){this.focusable=this.focusable.add(m),this._on(m,{focusin:function(f){e(f.currentTarget).addClass("ui-state-focus")},focusout:function(f){e(f.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(m,f,T){var A,D,z=this.options[m];if(T=T||{},f=e.Event(f),f.type=(m===this.widgetEventPrefix?m:this.widgetEventPrefix+m).toLowerCase(),f.target=this.element[0],D=f.originalEvent,D)for(A in D)A in f||(f[A]=D[A]);return this.element.trigger(f,T),!(e.isFunction(z)&&z.apply(this.element[0],[f].concat(T))===!1||f.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(m,f){e.Widget.prototype["_"+m]=function(T,A,D){typeof A=="string"&&(A={effect:A});var z,O=A?A===!0||typeof A=="number"?f:A.effect||f:m;A=A||{},typeof A=="number"&&(A={duration:A}),z=!e.isEmptyObject(A),A.complete=D,A.delay&&T.delay(A.delay),z&&e.effects&&(e.effects.effect[O]||e.uiBackCompat!==!1&&e.effects[O])?T[m](A):O!==m&&T[O]?T[O](A.duration,A.easing,D):T.queue(function(E){e(this)[m](),D&&D.call(T[0]),E()})}}),e.uiBackCompat!==!1&&(e.Widget.prototype._getCreateOptions=function(){return e.metadata&&e.metadata.get(this.element[0])[this.widgetName]})})(jQuery),(function(e,n){var w=!1;e(document).mouseup(function(l){w=!1}),e.widget("ui.mouse",{version:"1.9.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var l=this;this.element.bind("mousedown."+this.widgetName,function(c){return l._mouseDown(c)}).bind("click."+this.widgetName,function(c){if(e.data(c.target,l.widgetName+".preventClickEvent")===!0)return e.removeData(c.target,l.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(l){if(!w){this._mouseStarted&&this._mouseUp(l),this._mouseDownEvent=l;var c=this,m=l.which===1,f=typeof this.options.cancel=="string"&&l.target.nodeName?e(l.target).closest(this.options.cancel).length:!1;return!m||f||!this._mouseCapture(l)?!0:(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(l)&&this._mouseDelayMet(l)&&(this._mouseStarted=this._mouseStart(l)!==!1,!this._mouseStarted)?(l.preventDefault(),!0):(e.data(l.target,this.widgetName+".preventClickEvent")===!0&&e.removeData(l.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(T){return c._mouseMove(T)},this._mouseUpDelegate=function(T){return c._mouseUp(T)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),l.preventDefault(),w=!0,!0))}},_mouseMove:function(l){return!e.ui.ie||document.documentMode>=9||l.button?this._mouseStarted?(this._mouseDrag(l),l.preventDefault()):(this._mouseDistanceMet(l)&&this._mouseDelayMet(l)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,l)!==!1,this._mouseStarted?this._mouseDrag(l):this._mouseUp(l)),!this._mouseStarted):this._mouseUp(l)},_mouseUp:function(l){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,l.target===this._mouseDownEvent.target&&e.data(l.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(l)),!1},_mouseDistanceMet:function(l){return Math.max(Math.abs(this._mouseDownEvent.pageX-l.pageX),Math.abs(this._mouseDownEvent.pageY-l.pageY))>=this.options.distance},_mouseDelayMet:function(l){return this.mouseDelayMet},_mouseStart:function(l){},_mouseDrag:function(l){},_mouseStop:function(l){},_mouseCapture:function(l){return!0}})})(jQuery),(function(e,n){function w(v,p,S){return[parseInt(v[0],10)*(E.test(v[0])?p/100:1),parseInt(v[1],10)*(E.test(v[1])?S/100:1)]}function l(v,p){return parseInt(e.css(v,p),10)||0}e.ui=e.ui||{};var c,m=Math.max,f=Math.abs,T=Math.round,A=/left|center|right/,D=/top|center|bottom/,z=/[\+\-]\d+%?/,O=/^\w+/,E=/%$/,L=e.fn.position;e.position={scrollbarWidth:function(){if(c!==n)return c;var v,p,S=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),k=S.children()[0];return e("body").append(S),v=k.offsetWidth,S.css("overflow","scroll"),p=k.offsetWidth,v===p&&(p=S[0].clientWidth),S.remove(),c=v-p},getScrollInfo:function(v){var p=v.isWindow?"":v.element.css("overflow-x"),S=v.isWindow?"":v.element.css("overflow-y"),k=p==="scroll"||p==="auto"&&v.width<v.element[0].scrollWidth,F=S==="scroll"||S==="auto"&&v.height<v.element[0].scrollHeight;return{width:k?e.position.scrollbarWidth():0,height:F?e.position.scrollbarWidth():0}},getWithinInfo:function(v){var p=e(v||window),S=e.isWindow(p[0]);return{element:p,isWindow:S,offset:p.offset()||{left:0,top:0},scrollLeft:p.scrollLeft(),scrollTop:p.scrollTop(),width:S?p.width():p.outerWidth(),height:S?p.height():p.outerHeight()}}},e.fn.position=function(v){if(!v||!v.of)return L.apply(this,arguments);v=e.extend({},v);var p,S,k,F,G,Z=e(v.of),te=e.position.getWithinInfo(v.within),M=e.position.getScrollInfo(te),V=Z[0],ie=(v.collision||"flip").split(" "),R={};return V.nodeType===9?(S=Z.width(),k=Z.height(),F={top:0,left:0}):e.isWindow(V)?(S=Z.width(),k=Z.height(),F={top:Z.scrollTop(),left:Z.scrollLeft()}):V.preventDefault?(v.at="left top",S=k=0,F={top:V.pageY,left:V.pageX}):(S=Z.outerWidth(),k=Z.outerHeight(),F=Z.offset()),G=e.extend({},F),e.each(["my","at"],function(){var Y=(v[this]||"").split(" "),N,Q;Y.length===1&&(Y=A.test(Y[0])?Y.concat(["center"]):D.test(Y[0])?["center"].concat(Y):["center","center"]),Y[0]=A.test(Y[0])?Y[0]:"center",Y[1]=D.test(Y[1])?Y[1]:"center",N=z.exec(Y[0]),Q=z.exec(Y[1]),R[this]=[N?N[0]:0,Q?Q[0]:0],v[this]=[O.exec(Y[0])[0],O.exec(Y[1])[0]]}),ie.length===1&&(ie[1]=ie[0]),v.at[0]==="right"?G.left+=S:v.at[0]==="center"&&(G.left+=S/2),v.at[1]==="bottom"?G.top+=k:v.at[1]==="center"&&(G.top+=k/2),p=w(R.at,S,k),G.left+=p[0],G.top+=p[1],this.each(function(){var Y,N,Q=e(this),oe=Q.outerWidth(),b=Q.outerHeight(),Le=l(this,"marginLeft"),ce=l(this,"marginTop"),J=oe+Le+l(this,"marginRight")+M.width,me=b+ce+l(this,"marginBottom")+M.height,h=e.extend({},G),Re=w(R.my,Q.outerWidth(),Q.outerHeight());v.my[0]==="right"?h.left-=oe:v.my[0]==="center"&&(h.left-=oe/2),v.my[1]==="bottom"?h.top-=b:v.my[1]==="center"&&(h.top-=b/2),h.left+=Re[0],h.top+=Re[1],e.support.offsetFractions||(h.left=T(h.left),h.top=T(h.top)),Y={marginLeft:Le,marginTop:ce},e.each(["left","top"],function(Ue,Xe){e.ui.position[ie[Ue]]&&e.ui.position[ie[Ue]][Xe](h,{targetWidth:S,targetHeight:k,elemWidth:oe,elemHeight:b,collisionPosition:Y,collisionWidth:J,collisionHeight:me,offset:[p[0]+Re[0],p[1]+Re[1]],my:v.my,at:v.at,within:te,elem:Q})}),e.fn.bgiframe&&Q.bgiframe(),v.using&&(N=function(Ue){var Xe=F.left-h.left,ot=Xe+S-oe,Tt=F.top-h.top,ze=Tt+k-b,et={target:{element:Z,left:F.left,top:F.top,width:S,height:k},element:{element:Q,left:h.left,top:h.top,width:oe,height:b},horizontal:ot<0?"left":Xe>0?"right":"center",vertical:ze<0?"top":Tt>0?"bottom":"middle"};S<oe&&f(Xe+ot)<S&&(et.horizontal="center"),k<b&&f(Tt+ze)<k&&(et.vertical="middle"),m(f(Xe),f(ot))>m(f(Tt),f(ze))?et.important="horizontal":et.important="vertical",v.using.call(this,Ue,et)}),Q.offset(e.extend(h,{using:N}))})},e.ui.position={fit:{left:function(v,p){var S=p.within,k=S.isWindow?S.scrollLeft:S.offset.left,F=S.width,G=v.left-p.collisionPosition.marginLeft,Z=k-G,te=G+p.collisionWidth-F-k,M;p.collisionWidth>F?Z>0&&te<=0?(M=v.left+Z+p.collisionWidth-F-k,v.left+=Z-M):te>0&&Z<=0?v.left=k:Z>te?v.left=k+F-p.collisionWidth:v.left=k:Z>0?v.left+=Z:te>0?v.left-=te:v.left=m(v.left-G,v.left)},top:function(v,p){var S=p.within,k=S.isWindow?S.scrollTop:S.offset.top,F=p.within.height,G=v.top-p.collisionPosition.marginTop,Z=k-G,te=G+p.collisionHeight-F-k,M;p.collisionHeight>F?Z>0&&te<=0?(M=v.top+Z+p.collisionHeight-F-k,v.top+=Z-M):te>0&&Z<=0?v.top=k:Z>te?v.top=k+F-p.collisionHeight:v.top=k:Z>0?v.top+=Z:te>0?v.top-=te:v.top=m(v.top-G,v.top)}},flip:{left:function(v,p){var S=p.within,k=S.offset.left+S.scrollLeft,F=S.width,G=S.isWindow?S.scrollLeft:S.offset.left,Z=v.left-p.collisionPosition.marginLeft,te=Z-G,M=Z+p.collisionWidth-F-G,V=p.my[0]==="left"?-p.elemWidth:p.my[0]==="right"?p.elemWidth:0,ie=p.at[0]==="left"?p.targetWidth:p.at[0]==="right"?-p.targetWidth:0,R=-2*p.offset[0],Y,N;te<0?(Y=v.left+V+ie+R+p.collisionWidth-F-k,(Y<0||Y<f(te))&&(v.left+=V+ie+R)):M>0&&(N=v.left-p.collisionPosition.marginLeft+V+ie+R-G,(N>0||f(N)<M)&&(v.left+=V+ie+R))},top:function(v,p){var S=p.within,k=S.offset.top+S.scrollTop,F=S.height,G=S.isWindow?S.scrollTop:S.offset.top,Z=v.top-p.collisionPosition.marginTop,te=Z-G,M=Z+p.collisionHeight-F-G,V=p.my[1]==="top",ie=V?-p.elemHeight:p.my[1]==="bottom"?p.elemHeight:0,R=p.at[1]==="top"?p.targetHeight:p.at[1]==="bottom"?-p.targetHeight:0,Y=-2*p.offset[1],N,Q;te<0?(Q=v.top+ie+R+Y+p.collisionHeight-F-k,v.top+ie+R+Y>te&&(Q<0||Q<f(te))&&(v.top+=ie+R+Y)):M>0&&(N=v.top-p.collisionPosition.marginTop+ie+R+Y-G,v.top+ie+R+Y>M&&(N>0||f(N)<M)&&(v.top+=ie+R+Y))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},(function(){var v,p,S,k,F,G=document.getElementsByTagName("body")[0],Z=document.createElement("div");v=document.createElement(G?"div":"body"),S={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},G&&e.extend(S,{position:"absolute",left:"-1000px",top:"-1000px"});for(F in S)v.style[F]=S[F];v.appendChild(Z),p=G||document.documentElement,p.insertBefore(v,p.firstChild),Z.style.cssText="position: absolute; left: 10.7432222px;",k=e(Z).offset().left,e.support.offsetFractions=k>10&&k<11,v.innerHTML="",p.removeChild(v)})(),e.uiBackCompat!==!1&&(function(v){var p=v.fn.position;v.fn.position=function(S){if(!S||!S.offset)return p.call(this,S);var k=S.offset.split(" "),F=S.at.split(" ");return k.length===1&&(k[1]=k[0]),/^\d/.test(k[0])&&(k[0]="+"+k[0]),/^\d/.test(k[1])&&(k[1]="+"+k[1]),F.length===1&&(/left|center|right/.test(F[0])?F[1]="center":(F[1]=F[0],F[0]="center")),p.call(this,v.extend(S,{at:F[0]+k[0]+" "+F[1]+k[1],offset:n}))}})(jQuery)})(jQuery),(function(e,n){e.widget("ui.draggable",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(w){var l=this.options;return this.helper||l.disabled||e(w.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(w),this.handle?(e(l.iframeFix===!0?"iframe":l.iframeFix).each(function(){e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(w){var l=this.options;return this.helper=this._createHelper(w),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:w.pageX-this.offset.left,top:w.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(w),this.originalPageX=w.pageX,this.originalPageY=w.pageY,l.cursorAt&&this._adjustOffsetFromHelper(l.cursorAt),l.containment&&this._setContainment(),this._trigger("start",w)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!l.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,w),this._mouseDrag(w,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,w),!0)},_mouseDrag:function(w,l){if(this.position=this._generatePosition(w),this.positionAbs=this._convertPositionTo("absolute"),!l){var c=this._uiHash();if(this._trigger("drag",w,c)===!1)return this._mouseUp({}),!1;this.position=c.position}return(!this.options.axis||this.options.axis!="y")&&(this.helper[0].style.left=this.position.left+"px"),(!this.options.axis||this.options.axis!="x")&&(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,w),!1},_mouseStop:function(w){var l=!1;e.ui.ddmanager&&!this.options.dropBehaviour&&(l=e.ui.ddmanager.drop(this,w)),this.dropped&&(l=this.dropped,this.dropped=!1);for(var c=this.element[0],m=!1;c&&(c=c.parentNode);)c==document&&(m=!0);if(!m&&this.options.helper==="original")return!1;if(this.options.revert=="invalid"&&!l||this.options.revert=="valid"&&l||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,l)){var f=this;e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){f._trigger("stop",w)!==!1&&f._clear()})}else this._trigger("stop",w)!==!1&&this._clear();return!1},_mouseUp:function(w){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,w),e.ui.mouse.prototype._mouseUp.call(this,w)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(w){var l=!this.options.handle||!e(this.options.handle,this.element).length;return e(this.options.handle,this.element).find("*").andSelf().each(function(){this==w.target&&(l=!0)}),l},_createHelper:function(w){var l=this.options,c=e.isFunction(l.helper)?e(l.helper.apply(this.element[0],[w])):l.helper=="clone"?this.element.clone().removeAttr("id"):this.element;return c.parents("body").length||c.appendTo(l.appendTo=="parent"?this.element[0].parentNode:l.appendTo),c[0]!=this.element[0]&&!/(fixed|absolute)/.test(c.css("position"))&&c.css("position","absolute"),c},_adjustOffsetFromHelper:function(w){typeof w=="string"&&(w=w.split(" ")),e.isArray(w)&&(w={left:+w[0],top:+w[1]||0}),"left"in w&&(this.offset.click.left=w.left+this.margins.left),"right"in w&&(this.offset.click.left=this.helperProportions.width-w.right+this.margins.left),"top"in w&&(this.offset.click.top=w.top+this.margins.top),"bottom"in w&&(this.offset.click.top=this.helperProportions.height-w.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var w=this.offsetParent.offset();return this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(w.left+=this.scrollParent.scrollLeft(),w.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.ui.ie)&&(w={top:0,left:0}),{top:w.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:w.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var w=this.element.position();return{top:w.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:w.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var w=this.options;if(w.containment=="parent"&&(w.containment=this.helper[0].parentNode),(w.containment=="document"||w.containment=="window")&&(this.containment=[w.containment=="document"?0:e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,w.containment=="document"?0:e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(w.containment=="document"?0:e(window).scrollLeft())+e(w.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(w.containment=="document"?0:e(window).scrollTop())+(e(w.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),!/^(document|window|parent)$/.test(w.containment)&&w.containment.constructor!=Array){var l=e(w.containment),c=l[0];if(!c)return;var m=l.offset(),f=e(c).css("overflow")!="hidden";this.containment=[(parseInt(e(c).css("borderLeftWidth"),10)||0)+(parseInt(e(c).css("paddingLeft"),10)||0),(parseInt(e(c).css("borderTopWidth"),10)||0)+(parseInt(e(c).css("paddingTop"),10)||0),(f?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(e(c).css("borderLeftWidth"),10)||0)-(parseInt(e(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(f?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(e(c).css("borderTopWidth"),10)||0)-(parseInt(e(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=l}else w.containment.constructor==Array&&(this.containment=w.containment)},_convertPositionTo:function(w,l){l||(l=this.position);var c=w=="absolute"?1:-1,m=this.options,f=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,T=/(html|body)/i.test(f[0].tagName);return{top:l.top+this.offset.relative.top*c+this.offset.parent.top*c-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():T?0:f.scrollTop())*c,left:l.left+this.offset.relative.left*c+this.offset.parent.left*c-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():T?0:f.scrollLeft())*c}},_generatePosition:function(w){var l=this.options,c=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,m=/(html|body)/i.test(c[0].tagName),f=w.pageX,T=w.pageY;if(this.originalPosition){var A;if(this.containment){if(this.relative_container){var D=this.relative_container.offset();A=[this.containment[0]+D.left,this.containment[1]+D.top,this.containment[2]+D.left,this.containment[3]+D.top]}else A=this.containment;w.pageX-this.offset.click.left<A[0]&&(f=A[0]+this.offset.click.left),w.pageY-this.offset.click.top<A[1]&&(T=A[1]+this.offset.click.top),w.pageX-this.offset.click.left>A[2]&&(f=A[2]+this.offset.click.left),w.pageY-this.offset.click.top>A[3]&&(T=A[3]+this.offset.click.top)}if(l.grid){var z=l.grid[1]?this.originalPageY+Math.round((T-this.originalPageY)/l.grid[1])*l.grid[1]:this.originalPageY;T=A&&(z-this.offset.click.top<A[1]||z-this.offset.click.top>A[3])?z-this.offset.click.top<A[1]?z+l.grid[1]:z-l.grid[1]:z;var O=l.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/l.grid[0])*l.grid[0]:this.originalPageX;f=A&&(O-this.offset.click.left<A[0]||O-this.offset.click.left>A[2])?O-this.offset.click.left<A[0]?O+l.grid[0]:O-l.grid[0]:O}}return{top:T-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():m?0:c.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():m?0:c.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(w,l,c){return c=c||this._uiHash(),e.ui.plugin.call(this,w,[l,c]),w=="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,w,l,c)},plugins:{},_uiHash:function(w){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(w,l){var c=e(this).data("draggable"),m=c.options,f=e.extend({},l,{item:c.element});c.sortables=[],e(m.connectToSortable).each(function(){var T=e.data(this,"sortable");T&&!T.options.disabled&&(c.sortables.push({instance:T,shouldRevert:T.options.revert}),T.refreshPositions(),T._trigger("activate",w,f))})},stop:function(w,l){var c=e(this).data("draggable"),m=e.extend({},l,{item:c.element});e.each(c.sortables,function(){this.instance.isOver?(this.instance.isOver=0,c.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(w),this.instance.options.helper=this.instance.options._helper,c.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",w,m))})},drag:function(w,l){var c=e(this).data("draggable"),m=this,f=function(T){var A=this.offset.click.top,D=this.offset.click.left,z=this.positionAbs.top,O=this.positionAbs.left,E=T.height,L=T.width,v=T.top,p=T.left;return e.ui.isOver(z+A,O+D,v,p,E,L)};e.each(c.sortables,function(T){var A=!1,D=this;this.instance.positionAbs=c.positionAbs,this.instance.helperProportions=c.helperProportions,this.instance.offset.click=c.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(A=!0,e.each(c.sortables,function(){return this.instance.positionAbs=c.positionAbs,this.instance.helperProportions=c.helperProportions,this.instance.offset.click=c.offset.click,this!=D&&this.instance._intersectsWith(this.instance.containerCache)&&e.ui.contains(D.instance.element[0],this.instance.element[0])&&(A=!1),A})),A?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(m).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return l.helper[0]},w.target=this.instance.currentItem[0],this.instance._mouseCapture(w,!0),this.instance._mouseStart(w,!0,!0),this.instance.offset.click.top=c.offset.click.top,this.instance.offset.click.left=c.offset.click.left,this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top,c._trigger("toSortable",w),c.dropped=this.instance.element,c.currentItem=c.element,this.instance.fromOutside=c),this.instance.currentItem&&this.instance._mouseDrag(w)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",w,this.instance._uiHash(this.instance)),this.instance._mouseStop(w,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),c._trigger("fromSortable",w),c.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(w,l){var c=e("body"),m=e(this).data("draggable").options;c.css("cursor")&&(m._cursor=c.css("cursor")),c.css("cursor",m.cursor)},stop:function(w,l){var c=e(this).data("draggable").options;c._cursor&&e("body").css("cursor",c._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(w,l){var c=e(l.helper),m=e(this).data("draggable").options;c.css("opacity")&&(m._opacity=c.css("opacity")),c.css("opacity",m.opacity)},stop:function(w,l){var c=e(this).data("draggable").options;c._opacity&&e(l.helper).css("opacity",c._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(w,l){var c=e(this).data("draggable");c.scrollParent[0]!=document&&c.scrollParent[0].tagName!="HTML"&&(c.overflowOffset=c.scrollParent.offset())},drag:function(w,l){var c=e(this).data("draggable"),m=c.options,f=!1;c.scrollParent[0]!=document&&c.scrollParent[0].tagName!="HTML"?((!m.axis||m.axis!="x")&&(c.overflowOffset.top+c.scrollParent[0].offsetHeight-w.pageY<m.scrollSensitivity?c.scrollParent[0].scrollTop=f=c.scrollParent[0].scrollTop+m.scrollSpeed:w.pageY-c.overflowOffset.top<m.scrollSensitivity&&(c.scrollParent[0].scrollTop=f=c.scrollParent[0].scrollTop-m.scrollSpeed)),(!m.axis||m.axis!="y")&&(c.overflowOffset.left+c.scrollParent[0].offsetWidth-w.pageX<m.scrollSensitivity?c.scrollParent[0].scrollLeft=f=c.scrollParent[0].scrollLeft+m.scrollSpeed:w.pageX-c.overflowOffset.left<m.scrollSensitivity&&(c.scrollParent[0].scrollLeft=f=c.scrollParent[0].scrollLeft-m.scrollSpeed))):((!m.axis||m.axis!="x")&&(w.pageY-e(document).scrollTop()<m.scrollSensitivity?f=e(document).scrollTop(e(document).scrollTop()-m.scrollSpeed):e(window).height()-(w.pageY-e(document).scrollTop())<m.scrollSensitivity&&(f=e(document).scrollTop(e(document).scrollTop()+m.scrollSpeed))),(!m.axis||m.axis!="y")&&(w.pageX-e(document).scrollLeft()<m.scrollSensitivity?f=e(document).scrollLeft(e(document).scrollLeft()-m.scrollSpeed):e(window).width()-(w.pageX-e(document).scrollLeft())<m.scrollSensitivity&&(f=e(document).scrollLeft(e(document).scrollLeft()+m.scrollSpeed)))),f!==!1&&e.ui.ddmanager&&!m.dropBehaviour&&e.ui.ddmanager.prepareOffsets(c,w)}}),e.ui.plugin.add("draggable","snap",{start:function(w,l){var c=e(this).data("draggable"),m=c.options;c.snapElements=[],e(m.snap.constructor!=String?m.snap.items||":data(draggable)":m.snap).each(function(){var f=e(this),T=f.offset();this!=c.element[0]&&c.snapElements.push({item:this,width:f.outerWidth(),height:f.outerHeight(),top:T.top,left:T.left})})},drag:function(w,l){for(var c=e(this).data("draggable"),m=c.options,f=m.snapTolerance,T=l.offset.left,A=T+c.helperProportions.width,D=l.offset.top,z=D+c.helperProportions.height,O=c.snapElements.length-1;O>=0;O--){var E=c.snapElements[O].left,L=E+c.snapElements[O].width,v=c.snapElements[O].top,p=v+c.snapElements[O].height;if(!(E-f<T&&T<L+f&&v-f<D&&D<p+f||E-f<T&&T<L+f&&v-f<z&&z<p+f||E-f<A&&A<L+f&&v-f<D&&D<p+f||E-f<A&&A<L+f&&v-f<z&&z<p+f)){c.snapElements[O].snapping&&c.options.snap.release&&c.options.snap.release.call(c.element,w,e.extend(c._uiHash(),{snapItem:c.snapElements[O].item})),c.snapElements[O].snapping=!1;continue}if(m.snapMode!="inner"){var S=Math.abs(v-z)<=f,k=Math.abs(p-D)<=f,F=Math.abs(E-A)<=f,G=Math.abs(L-T)<=f;S&&(l.position.top=c._convertPositionTo("relative",{top:v-c.helperProportions.height,left:0}).top-c.margins.top),k&&(l.position.top=c._convertPositionTo("relative",{top:p,left:0}).top-c.margins.top),F&&(l.position.left=c._convertPositionTo("relative",{top:0,left:E-c.helperProportions.width}).left-c.margins.left),G&&(l.position.left=c._convertPositionTo("relative",{top:0,left:L}).left-c.margins.left)}var Z=S||k||F||G;if(m.snapMode!="outer"){var S=Math.abs(v-D)<=f,k=Math.abs(p-z)<=f,F=Math.abs(E-T)<=f,G=Math.abs(L-A)<=f;S&&(l.position.top=c._convertPositionTo("relative",{top:v,left:0}).top-c.margins.top),k&&(l.position.top=c._convertPositionTo("relative",{top:p-c.helperProportions.height,left:0}).top-c.margins.top),F&&(l.position.left=c._convertPositionTo("relative",{top:0,left:E}).left-c.margins.left),G&&(l.position.left=c._convertPositionTo("relative",{top:0,left:L-c.helperProportions.width}).left-c.margins.left)}!c.snapElements[O].snapping&&(S||k||F||G||Z)&&c.options.snap.snap&&c.options.snap.snap.call(c.element,w,e.extend(c._uiHash(),{snapItem:c.snapElements[O].item})),c.snapElements[O].snapping=S||k||F||G||Z}}}),e.ui.plugin.add("draggable","stack",{start:function(w,l){var c=e(this).data("draggable").options,m=e.makeArray(e(c.stack)).sort(function(T,A){return(parseInt(e(T).css("zIndex"),10)||0)-(parseInt(e(A).css("zIndex"),10)||0)});if(m.length){var f=parseInt(m[0].style.zIndex)||0;e(m).each(function(T){this.style.zIndex=f+T}),this[0].style.zIndex=f+m.length}}}),e.ui.plugin.add("draggable","zIndex",{start:function(w,l){var c=e(l.helper),m=e(this).data("draggable").options;c.css("zIndex")&&(m._zIndex=c.css("zIndex")),c.css("zIndex",m.zIndex)},stop:function(w,l){var c=e(this).data("draggable").options;c._zIndex&&e(l.helper).css("zIndex",c._zIndex)}})})(jQuery),(function(e,n){e.widget("ui.droppable",{version:"1.9.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var w=this.options,l=w.accept;this.isover=0,this.isout=1,this.accept=e.isFunction(l)?l:function(c){return c.is(l)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},e.ui.ddmanager.droppables[w.scope]=e.ui.ddmanager.droppables[w.scope]||[],e.ui.ddmanager.droppables[w.scope].push(this),w.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var w=e.ui.ddmanager.droppables[this.options.scope],l=0;l<w.length;l++)w[l]==this&&w.splice(l,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(w,l){w=="accept"&&(this.accept=e.isFunction(l)?l:function(c){return c.is(l)}),e.Widget.prototype._setOption.apply(this,arguments)},_activate:function(w){var l=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),l&&this._trigger("activate",w,this.ui(l))},_deactivate:function(w){var l=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),l&&this._trigger("deactivate",w,this.ui(l))},_over:function(w){var l=e.ui.ddmanager.current;!l||(l.currentItem||l.element)[0]==this.element[0]||this.accept.call(this.element[0],l.currentItem||l.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",w,this.ui(l)))},_out:function(w){var l=e.ui.ddmanager.current;!l||(l.currentItem||l.element)[0]==this.element[0]||this.accept.call(this.element[0],l.currentItem||l.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",w,this.ui(l)))},_drop:function(w,l){var c=l||e.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return!1;var m=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var f=e.data(this,"droppable");if(f.options.greedy&&!f.options.disabled&&f.options.scope==c.options.scope&&f.accept.call(f.element[0],c.currentItem||c.element)&&e.ui.intersect(c,e.extend(f,{offset:f.element.offset()}),f.options.tolerance))return m=!0,!1}),m?!1:this.accept.call(this.element[0],c.currentItem||c.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",w,this.ui(c)),this.element):!1},ui:function(w){return{draggable:w.currentItem||w.element,helper:w.helper,position:w.position,offset:w.positionAbs}}}),e.ui.intersect=function(w,l,c){if(!l.offset)return!1;var m=(w.positionAbs||w.position.absolute).left,f=m+w.helperProportions.width,T=(w.positionAbs||w.position.absolute).top,A=T+w.helperProportions.height,D=l.offset.left,z=D+l.proportions.width,O=l.offset.top,E=O+l.proportions.height;switch(c){case"fit":return D<=m&&f<=z&&O<=T&&A<=E;case"intersect":return D<m+w.helperProportions.width/2&&f-w.helperProportions.width/2<z&&O<T+w.helperProportions.height/2&&A-w.helperProportions.height/2<E;case"pointer":var L=(w.positionAbs||w.position.absolute).left+(w.clickOffset||w.offset.click).left,v=(w.positionAbs||w.position.absolute).top+(w.clickOffset||w.offset.click).top,p=e.ui.isOver(v,L,O,D,l.proportions.height,l.proportions.width);return p;case"touch":return(T>=O&&T<=E||A>=O&&A<=E||T<O&&A>E)&&(m>=D&&m<=z||f>=D&&f<=z||m<D&&f>z);default:return!1}},e.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(w,l){var c=e.ui.ddmanager.droppables[w.options.scope]||[],m=l?l.type:null,f=(w.currentItem||w.element).find(":data(droppable)").andSelf();e:for(var T=0;T<c.length;T++)if(!(c[T].options.disabled||w&&!c[T].accept.call(c[T].element[0],w.currentItem||w.element))){for(var A=0;A<f.length;A++)if(f[A]==c[T].element[0]){c[T].proportions.height=0;continue e}c[T].visible=c[T].element.css("display")!="none",c[T].visible&&(m=="mousedown"&&c[T]._activate.call(c[T],l),c[T].offset=c[T].element.offset(),c[T].proportions={width:c[T].element[0].offsetWidth,height:c[T].element[0].offsetHeight})}},drop:function(w,l){var c=!1;return e.each(e.ui.ddmanager.droppables[w.options.scope]||[],function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(w,this,this.options.tolerance)&&(c=this._drop.call(this,l)||c),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],w.currentItem||w.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,l)))}),c},dragStart:function(w,l){w.element.parentsUntil("body").bind("scroll.droppable",function(){w.options.refreshPositions||e.ui.ddmanager.prepareOffsets(w,l)})},drag:function(w,l){w.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(w,l),e.each(e.ui.ddmanager.droppables[w.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var c=e.ui.intersect(w,this,this.options.tolerance),m=!c&&this.isover==1?"isout":c&&this.isover==0?"isover":null;if(m){var f;if(this.options.greedy){var T=this.options.scope,A=this.element.parents(":data(droppable)").filter(function(){return e.data(this,"droppable").options.scope===T});A.length&&(f=e.data(A[0],"droppable"),f.greedyChild=m=="isover"?1:0)}f&&m=="isover"&&(f.isover=0,f.isout=1,f._out.call(f,l)),this[m]=1,this[m=="isout"?"isover":"isout"]=0,this[m=="isover"?"_over":"_out"].call(this,l),f&&m=="isout"&&(f.isout=0,f.isover=1,f._over.call(f,l))}}})},dragStop:function(w,l){w.element.parentsUntil("body").unbind("scroll.droppable"),w.options.refreshPositions||e.ui.ddmanager.prepareOffsets(w,l)}}})(jQuery),(function(e,n){e.widget("ui.sortable",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var w=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?w.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var w=this.items.length-1;w>=0;w--)this.items[w].item.removeData(this.widgetName+"-item");return this},_setOption:function(w,l){w==="disabled"?(this.options[w]=l,this.widget().toggleClass("ui-sortable-disabled",!!l)):e.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(w,l){var c=this;if(this.reverting||this.options.disabled||this.options.type=="static")return!1;this._refreshItems(w);var m=null,f=e(w.target).parents().each(function(){if(e.data(this,c.widgetName+"-item")==c)return m=e(this),!1});if(e.data(w.target,c.widgetName+"-item")==c&&(m=e(w.target)),!m)return!1;if(this.options.handle&&!l){var T=!1;if(e(this.options.handle,m).find("*").andSelf().each(function(){this==w.target&&(T=!0)}),!T)return!1}return this.currentItem=m,this._removeCurrentsFromItems(),!0},_mouseStart:function(w,l,c){var m=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(w),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},e.extend(this.offset,{click:{left:w.pageX-this.offset.left,top:w.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(w),this.originalPageX=w.pageX,this.originalPageY=w.pageY,m.cursorAt&&this._adjustOffsetFromHelper(m.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),m.containment&&this._setContainment(),m.cursor&&(e("body").css("cursor")&&(this._storedCursor=e("body").css("cursor")),e("body").css("cursor",m.cursor)),m.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",m.opacity)),m.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",m.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",w,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!c)for(var f=this.containers.length-1;f>=0;f--)this.containers[f]._trigger("activate",w,this._uiHash(this));return e.ui.ddmanager&&(e.ui.ddmanager.current=this),e.ui.ddmanager&&!m.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,w),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(w),!0},_mouseDrag:function(w){if(this.position=this._generatePosition(w),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll){var l=this.options,c=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-w.pageY<l.scrollSensitivity?this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop+l.scrollSpeed:w.pageY-this.overflowOffset.top<l.scrollSensitivity&&(this.scrollParent[0].scrollTop=c=this.scrollParent[0].scrollTop-l.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-w.pageX<l.scrollSensitivity?this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft+l.scrollSpeed:w.pageX-this.overflowOffset.left<l.scrollSensitivity&&(this.scrollParent[0].scrollLeft=c=this.scrollParent[0].scrollLeft-l.scrollSpeed)):(w.pageY-e(document).scrollTop()<l.scrollSensitivity?c=e(document).scrollTop(e(document).scrollTop()-l.scrollSpeed):e(window).height()-(w.pageY-e(document).scrollTop())<l.scrollSensitivity&&(c=e(document).scrollTop(e(document).scrollTop()+l.scrollSpeed)),w.pageX-e(document).scrollLeft()<l.scrollSensitivity?c=e(document).scrollLeft(e(document).scrollLeft()-l.scrollSpeed):e(window).width()-(w.pageX-e(document).scrollLeft())<l.scrollSensitivity&&(c=e(document).scrollLeft(e(document).scrollLeft()+l.scrollSpeed))),c!==!1&&e.ui.ddmanager&&!l.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,w)}this.positionAbs=this._convertPositionTo("absolute"),(!this.options.axis||this.options.axis!="y")&&(this.helper[0].style.left=this.position.left+"px"),(!this.options.axis||this.options.axis!="x")&&(this.helper[0].style.top=this.position.top+"px");for(var m=this.items.length-1;m>=0;m--){var f=this.items[m],T=f.item[0],A=this._intersectsWithPointer(f);if(A&&f.instance===this.currentContainer&&T!=this.currentItem[0]&&this.placeholder[A==1?"next":"prev"]()[0]!=T&&!e.contains(this.placeholder[0],T)&&(this.options.type!="semi-dynamic"||!e.contains(this.element[0],T))){if(this.direction=A==1?"down":"up",this.options.tolerance!="pointer"&&!this._intersectsWithSides(f))break;this._rearrange(w,f),this._trigger("change",w,this._uiHash());break}}return this._contactContainers(w),e.ui.ddmanager&&e.ui.ddmanager.drag(this,w),this._trigger("sort",w,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(w,l){if(w){if(e.ui.ddmanager&&!this.options.dropBehaviour&&e.ui.ddmanager.drop(this,w),this.options.revert){var c=this,m=this.placeholder.offset();this.reverting=!0,e(this.helper).animate({left:m.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:m.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){c._clear(w)})}else this._clear(w,l);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var w=this.containers.length-1;w>=0;w--)this.containers[w]._trigger("deactivate",null,this._uiHash(this)),this.containers[w].containerCache.over&&(this.containers[w]._trigger("out",null,this._uiHash(this)),this.containers[w].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),e.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?e(this.domPosition.prev).after(this.currentItem):e(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(w){var l=this._getItemsAsjQuery(w&&w.connected),c=[];return w=w||{},e(l).each(function(){var m=(e(w.item||this).attr(w.attribute||"id")||"").match(w.expression||/(.+)[-=_](.+)/);m&&c.push((w.key||m[1]+"[]")+"="+(w.key&&w.expression?m[1]:m[2]))}),!c.length&&w.key&&c.push(w.key+"="),c.join("&")},toArray:function(w){var l=this._getItemsAsjQuery(w&&w.connected),c=[];return w=w||{},l.each(function(){c.push(e(w.item||this).attr(w.attribute||"id")||"")}),c},_intersectsWith:function(w){var l=this.positionAbs.left,c=l+this.helperProportions.width,m=this.positionAbs.top,f=m+this.helperProportions.height,T=w.left,A=T+w.width,D=w.top,z=D+w.height,O=this.offset.click.top,E=this.offset.click.left,L=m+O>D&&m+O<z&&l+E>T&&l+E<A;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>w[this.floating?"width":"height"]?L:T<l+this.helperProportions.width/2&&c-this.helperProportions.width/2<A&&D<m+this.helperProportions.height/2&&f-this.helperProportions.height/2<z},_intersectsWithPointer:function(w){var l=this.options.axis==="x"||e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,w.top,w.height),c=this.options.axis==="y"||e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,w.left,w.width),m=l&&c,f=this._getDragVerticalDirection(),T=this._getDragHorizontalDirection();return m?this.floating?T&&T=="right"||f=="down"?2:1:f&&(f=="down"?2:1):!1},_intersectsWithSides:function(w){var l=e.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,w.top+w.height/2,w.height),c=e.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,w.left+w.width/2,w.width),m=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?f=="right"&&c||f=="left"&&!c:m&&(m=="down"&&l||m=="up"&&!l)},_getDragVerticalDirection:function(){var w=this.positionAbs.top-this.lastPositionAbs.top;return w!=0&&(w>0?"down":"up")},_getDragHorizontalDirection:function(){var w=this.positionAbs.left-this.lastPositionAbs.left;return w!=0&&(w>0?"right":"left")},refresh:function(w){return this._refreshItems(w),this.refreshPositions(),this},_connectWith:function(){var w=this.options;return w.connectWith.constructor==String?[w.connectWith]:w.connectWith},_getItemsAsjQuery:function(w){var l=[],c=[],m=this._connectWith();if(m&&w)for(var f=m.length-1;f>=0;f--)for(var T=e(m[f]),A=T.length-1;A>=0;A--){var D=e.data(T[A],this.widgetName);D&&D!=this&&!D.options.disabled&&c.push([e.isFunction(D.options.items)?D.options.items.call(D.element):e(D.options.items,D.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),D])}c.push([e.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):e(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var f=c.length-1;f>=0;f--)c[f][0].each(function(){l.push(this)});return e(l)},_removeCurrentsFromItems:function(){var w=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=e.grep(this.items,function(l){for(var c=0;c<w.length;c++)if(w[c]==l.item[0])return!1;return!0})},_refreshItems:function(w){this.items=[],this.containers=[this];var l=this.items,c=[[e.isFunction(this.options.items)?this.options.items.call(this.element[0],w,{item:this.currentItem}):e(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(var f=m.length-1;f>=0;f--)for(var T=e(m[f]),A=T.length-1;A>=0;A--){var D=e.data(T[A],this.widgetName);D&&D!=this&&!D.options.disabled&&(c.push([e.isFunction(D.options.items)?D.options.items.call(D.element[0],w,{item:this.currentItem}):e(D.options.items,D.element),D]),this.containers.push(D))}for(var f=c.length-1;f>=0;f--)for(var z=c[f][1],O=c[f][0],A=0,E=O.length;A<E;A++){var L=e(O[A]);L.data(this.widgetName+"-item",z),l.push({item:L,instance:z,width:0,height:0,left:0,top:0})}},refreshPositions:function(w){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var l=this.items.length-1;l>=0;l--){var c=this.items[l];if(!(c.instance!=this.currentContainer&&this.currentContainer&&c.item[0]!=this.currentItem[0])){var m=this.options.toleranceElement?e(this.options.toleranceElement,c.item):c.item;w||(c.width=m.outerWidth(),c.height=m.outerHeight());var f=m.offset();c.left=f.left,c.top=f.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var l=this.containers.length-1;l>=0;l--){var f=this.containers[l].element.offset();this.containers[l].containerCache.left=f.left,this.containers[l].containerCache.top=f.top,this.containers[l].containerCache.width=this.containers[l].element.outerWidth(),this.containers[l].containerCache.height=this.containers[l].element.outerHeight()}return this},_createPlaceholder:function(w){w=w||this;var l=w.options;if(!l.placeholder||l.placeholder.constructor==String){var c=l.placeholder;l.placeholder={element:function(){var m=e(document.createElement(w.currentItem[0].nodeName)).addClass(c||w.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return c||(m.style.visibility="hidden"),m},update:function(m,f){c&&!l.forcePlaceholderSize||(f.height()||f.height(w.currentItem.innerHeight()-parseInt(w.currentItem.css("paddingTop")||0,10)-parseInt(w.currentItem.css("paddingBottom")||0,10)),f.width()||f.width(w.currentItem.innerWidth()-parseInt(w.currentItem.css("paddingLeft")||0,10)-parseInt(w.currentItem.css("paddingRight")||0,10)))}}}w.placeholder=e(l.placeholder.element.call(w.element,w.currentItem)),w.currentItem.after(w.placeholder),l.placeholder.update(w,w.placeholder)},_contactContainers:function(w){for(var l=null,c=null,m=this.containers.length-1;m>=0;m--)if(!e.contains(this.currentItem[0],this.containers[m].element[0]))if(this._intersectsWith(this.containers[m].containerCache)){if(l&&e.contains(this.containers[m].element[0],l.element[0]))continue;l=this.containers[m],c=m}else this.containers[m].containerCache.over&&(this.containers[m]._trigger("out",w,this._uiHash(this)),this.containers[m].containerCache.over=0);if(l)if(this.containers.length===1)this.containers[c]._trigger("over",w,this._uiHash(this)),this.containers[c].containerCache.over=1;else{for(var f=1e4,T=null,A=this.containers[c].floating?"left":"top",D=this.containers[c].floating?"width":"height",z=this.positionAbs[A]+this.offset.click[A],O=this.items.length-1;O>=0;O--)if(e.contains(this.containers[c].element[0],this.items[O].item[0])&&this.items[O].item[0]!=this.currentItem[0]){var E=this.items[O].item.offset()[A],L=!1;Math.abs(E-z)>Math.abs(E+this.items[O][D]-z)&&(L=!0,E+=this.items[O][D]),Math.abs(E-z)<f&&(f=Math.abs(E-z),T=this.items[O],this.direction=L?"up":"down")}if(!T&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[c],T?this._rearrange(w,T,null,!0):this._rearrange(w,null,this.containers[c].element,!0),this._trigger("change",w,this._uiHash()),this.containers[c]._trigger("change",w,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[c]._trigger("over",w,this._uiHash(this)),this.containers[c].containerCache.over=1}},_createHelper:function(w){var l=this.options,c=e.isFunction(l.helper)?e(l.helper.apply(this.element[0],[w,this.currentItem])):l.helper=="clone"?this.currentItem.clone():this.currentItem;return c.parents("body").length||e(l.appendTo!="parent"?l.appendTo:this.currentItem[0].parentNode)[0].appendChild(c[0]),c[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(c[0].style.width==""||l.forceHelperSize)&&c.width(this.currentItem.width()),(c[0].style.height==""||l.forceHelperSize)&&c.height(this.currentItem.height()),c},_adjustOffsetFromHelper:function(w){typeof w=="string"&&(w=w.split(" ")),e.isArray(w)&&(w={left:+w[0],top:+w[1]||0}),"left"in w&&(this.offset.click.left=w.left+this.margins.left),"right"in w&&(this.offset.click.left=this.helperProportions.width-w.right+this.margins.left),"top"in w&&(this.offset.click.top=w.top+this.margins.top),"bottom"in w&&(this.offset.click.top=this.helperProportions.height-w.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var w=this.offsetParent.offset();return this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(w.left+=this.scrollParent.scrollLeft(),w.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&e.ui.ie)&&(w={top:0,left:0}),{top:w.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:w.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var w=this.currentItem.position();return{top:w.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:w.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var w=this.options;if(w.containment=="parent"&&(w.containment=this.helper[0].parentNode),(w.containment=="document"||w.containment=="window")&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,e(w.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(e(w.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),!/^(document|window|parent)$/.test(w.containment)){var l=e(w.containment)[0],c=e(w.containment).offset(),m=e(l).css("overflow")!="hidden";this.containment=[c.left+(parseInt(e(l).css("borderLeftWidth"),10)||0)+(parseInt(e(l).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(e(l).css("borderTopWidth"),10)||0)+(parseInt(e(l).css("paddingTop"),10)||0)-this.margins.top,c.left+(m?Math.max(l.scrollWidth,l.offsetWidth):l.offsetWidth)-(parseInt(e(l).css("borderLeftWidth"),10)||0)-(parseInt(e(l).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(m?Math.max(l.scrollHeight,l.offsetHeight):l.offsetHeight)-(parseInt(e(l).css("borderTopWidth"),10)||0)-(parseInt(e(l).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(w,l){l||(l=this.position);var c=w=="absolute"?1:-1,m=this.options,f=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,T=/(html|body)/i.test(f[0].tagName);return{top:l.top+this.offset.relative.top*c+this.offset.parent.top*c-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():T?0:f.scrollTop())*c,left:l.left+this.offset.relative.left*c+this.offset.parent.left*c-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():T?0:f.scrollLeft())*c}},_generatePosition:function(w){var l=this.options,c=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,m=/(html|body)/i.test(c[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var f=w.pageX,T=w.pageY;if(this.originalPosition&&(this.containment&&(w.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),w.pageY-this.offset.click.top<this.containment[1]&&(T=this.containment[1]+this.offset.click.top),w.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),w.pageY-this.offset.click.top>this.containment[3]&&(T=this.containment[3]+this.offset.click.top)),l.grid)){var A=this.originalPageY+Math.round((T-this.originalPageY)/l.grid[1])*l.grid[1];T=this.containment&&(A-this.offset.click.top<this.containment[1]||A-this.offset.click.top>this.containment[3])?A-this.offset.click.top<this.containment[1]?A+l.grid[1]:A-l.grid[1]:A;var D=this.originalPageX+Math.round((f-this.originalPageX)/l.grid[0])*l.grid[0];f=this.containment&&(D-this.offset.click.left<this.containment[0]||D-this.offset.click.left>this.containment[2])?D-this.offset.click.left<this.containment[0]?D+l.grid[0]:D-l.grid[0]:D}return{top:T-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():m?0:c.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():m?0:c.scrollLeft())}},_rearrange:function(w,l,c,m){c?c[0].appendChild(this.placeholder[0]):l.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?l.item[0]:l.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var f=this.counter;this._delay(function(){f==this.counter&&this.refreshPositions(!m)})},_clear:function(w,l){this.reverting=!1;var c=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]==this.currentItem[0]){for(var m in this._storedCSS)(this._storedCSS[m]=="auto"||this._storedCSS[m]=="static")&&(this._storedCSS[m]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!l&&c.push(function(f){this._trigger("receive",f,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!l&&c.push(function(f){this._trigger("update",f,this._uiHash())}),this!==this.currentContainer&&(l||(c.push(function(f){this._trigger("remove",f,this._uiHash())}),c.push(function(f){return function(T){f._trigger("receive",T,this._uiHash(this))}}.call(this,this.currentContainer)),c.push(function(f){return function(T){f._trigger("update",T,this._uiHash(this))}}.call(this,this.currentContainer))));for(var m=this.containers.length-1;m>=0;m--)l||c.push(function(T){return function(A){T._trigger("deactivate",A,this._uiHash(this))}}.call(this,this.containers[m])),this.containers[m].containerCache.over&&(c.push(function(T){return function(A){T._trigger("out",A,this._uiHash(this))}}.call(this,this.containers[m])),this.containers[m].containerCache.over=0);if(this._storedCursor&&e("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!l){this._trigger("beforeStop",w,this._uiHash());for(var m=0;m<c.length;m++)c[m].call(this,w);this._trigger("stop",w,this._uiHash())}return this.fromOutside=!1,!1}if(l||this._trigger("beforeStop",w,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null,!l){for(var m=0;m<c.length;m++)c[m].call(this,w);this._trigger("stop",w,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){e.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(w){var l=w||this;return{helper:l.helper,placeholder:l.placeholder||e([]),position:l.position,originalPosition:l.originalPosition,offset:l.positionAbs,item:l.currentItem,sender:w?w.element:null}}})})(jQuery),(function(e,n){var w=0;e.widget("ui.autocomplete",{version:"1.9.2",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var l,c,m;this.isMultiLine=this._isMultiLine(),this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(f){if(this.element.prop("readOnly")){l=!0,m=!0,c=!0;return}l=!1,m=!1,c=!1;var T=e.ui.keyCode;switch(f.keyCode){case T.PAGE_UP:l=!0,this._move("previousPage",f);break;case T.PAGE_DOWN:l=!0,this._move("nextPage",f);break;case T.UP:l=!0,this._keyEvent("previous",f);break;case T.DOWN:l=!0,this._keyEvent("next",f);break;case T.ENTER:case T.NUMPAD_ENTER:this.menu.active&&(l=!0,f.preventDefault(),this.menu.select(f));break;case T.TAB:this.menu.active&&this.menu.select(f);break;case T.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(f),f.preventDefault());break;default:c=!0,this._searchTimeout(f)}},keypress:function(f){if(l){l=!1,f.preventDefault();return}if(!c){var T=e.ui.keyCode;switch(f.keyCode){case T.PAGE_UP:this._move("previousPage",f);break;case T.PAGE_DOWN:this._move("nextPage",f);break;case T.UP:this._keyEvent("previous",f);break;case T.DOWN:this._keyEvent("next",f)}}},input:function(f){if(m){m=!1,f.preventDefault();return}this._searchTimeout(f)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(f){if(this.cancelBlur){delete this.cancelBlur;return}clearTimeout(this.searching),this.close(f),this._change(f)}}),this._initSource(),this.menu=e("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo||"body")[0]).menu({input:e(),role:null}).zIndex(this.element.zIndex()+1).hide().data("menu"),this._on(this.menu.element,{mousedown:function(f){f.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var T=this.menu.element[0];e(f.target).closest(".ui-menu-item").length||this._delay(function(){var A=this;this.document.one("mousedown",function(D){D.target!==A.element[0]&&D.target!==T&&!e.contains(T,D.target)&&A.close()})})},menufocus:function(f,T){if(this.isNewMenu&&(this.isNewMenu=!1,f.originalEvent&&/^mouse/.test(f.originalEvent.type))){this.menu.blur(),this.document.one("mousemove",function(){e(f.target).trigger(f.originalEvent)});return}var A=T.item.data("ui-autocomplete-item")||T.item.data("item.autocomplete");this._trigger("focus",f,{item:A})!==!1?f.originalEvent&&/^key/.test(f.originalEvent.type)&&this._value(A.value):this.liveRegion.text(A.value)},menuselect:function(f,T){var A=T.item.data("ui-autocomplete-item")||T.item.data("item.autocomplete"),D=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=D,this._delay(function(){this.previous=D,this.selectedItem=A})),this._trigger("select",f,{item:A})!==!1&&this._value(A.value),this.term=this._value(),this.close(f),this.selectedItem=A}}),this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element),e.fn.bgiframe&&this.menu.element.bgiframe(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(l,c){this._super(l,c),l==="source"&&this._initSource(),l==="appendTo"&&this.menu.element.appendTo(this.document.find(c||"body")[0]),l==="disabled"&&c&&this.xhr&&this.xhr.abort()},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var l,c,m=this;e.isArray(this.options.source)?(l=this.options.source,this.source=function(f,T){T(e.ui.autocomplete.filter(l,f.term))}):typeof this.options.source=="string"?(c=this.options.source,this.source=function(f,T){m.xhr&&m.xhr.abort(),m.xhr=e.ajax({url:c,data:f,dataType:"json",success:function(A){T(A)},error:function(){T([])}})}):this.source=this.options.source},_searchTimeout:function(l){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,l))},this.options.delay)},search:function(l,c){if(l=l!=null?l:this._value(),this.term=this._value(),l.length<this.options.minLength)return this.close(c);if(this._trigger("search",c)!==!1)return this._search(l)},_search:function(l){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:l},this._response())},_response:function(){var l=this,c=++w;return function(m){c===w&&l.__response(m),l.pending--,l.pending||l.element.removeClass("ui-autocomplete-loading")}},__response:function(l){l&&(l=this._normalize(l)),this._trigger("response",null,{content:l}),!this.options.disabled&&l&&l.length&&!this.cancelSearch?(this._suggest(l),this._trigger("open")):this._close()},close:function(l){this.cancelSearch=!0,this._close(l)},_close:function(l){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",l))},_change:function(l){this.previous!==this._value()&&this._trigger("change",l,{item:this.selectedItem})},_normalize:function(l){return l.length&&l[0].label&&l[0].value?l:e.map(l,function(c){return typeof c=="string"?{label:c,value:c}:e.extend({label:c.label||c.value,value:c.value||c.label},c)})},_suggest:function(l){var c=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(c,l),this.menu.refresh(),c.show(),this._resizeMenu(),c.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var l=this.menu.element;l.outerWidth(Math.max(l.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(l,c){var m=this;e.each(c,function(f,T){m._renderItemData(l,T)})},_renderItemData:function(l,c){return this._renderItem(l,c).data("ui-autocomplete-item",c)},_renderItem:function(l,c){return e("<li>").append(e("<a>").text(c.label)).appendTo(l)},_move:function(l,c){if(!this.menu.element.is(":visible")){this.search(null,c);return}if(this.menu.isFirstItem()&&/^previous/.test(l)||this.menu.isLastItem()&&/^next/.test(l)){this._value(this.term),this.menu.blur();return}this.menu[l](c)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(l,c){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(l,c),c.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(l){return l.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(l,c){var m=new RegExp(e.ui.autocomplete.escapeRegex(c),"i");return e.grep(l,function(f){return m.test(f.label||f.value||f)})}}),e.widget("ui.autocomplete",e.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(l){return l+(l>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(l){var c;this._superApply(arguments),!(this.options.disabled||this.cancelSearch)&&(l&&l.length?c=this.options.messages.results(l.length):c=this.options.messages.noResults,this.liveRegion.text(c))}})})(jQuery),(function(e,n){var w=!1;e.widget("ui.menu",{version:"1.9.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,e.proxy(function(l){this.options.disabled&&l.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(l){l.preventDefault()},"click .ui-state-disabled > a":function(l){l.preventDefault()},"click .ui-menu-item:has(a)":function(l){var c=e(l.target).closest(".ui-menu-item");!w&&c.not(".ui-state-disabled").length&&(w=!0,this.select(l),c.has(".ui-menu").length?this.expand(l):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&this.active.parents(".ui-menu").length===1&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(l){var c=e(l.currentTarget);c.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(l,c)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(l,c){var m=this.active||this.element.children(".ui-menu-item").eq(0);c||this.focus(l,m)},blur:function(l){this._delay(function(){e.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(l)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(l){e(l.target).closest(".ui-menu").length||this.collapseAll(l),w=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var l=e(this);l.data("ui-menu-submenu-carat")&&l.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(l){function c(O){return O.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var m,f,T,A,D,z=!0;switch(l.keyCode){case e.ui.keyCode.PAGE_UP:this.previousPage(l);break;case e.ui.keyCode.PAGE_DOWN:this.nextPage(l);break;case e.ui.keyCode.HOME:this._move("first","first",l);break;case e.ui.keyCode.END:this._move("last","last",l);break;case e.ui.keyCode.UP:this.previous(l);break;case e.ui.keyCode.DOWN:this.next(l);break;case e.ui.keyCode.LEFT:this.collapse(l);break;case e.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(l);break;case e.ui.keyCode.ENTER:case e.ui.keyCode.SPACE:this._activate(l);break;case e.ui.keyCode.ESCAPE:this.collapse(l);break;default:z=!1,f=this.previousFilter||"",T=String.fromCharCode(l.keyCode),A=!1,clearTimeout(this.filterTimer),T===f?A=!0:T=f+T,D=new RegExp("^"+c(T),"i"),m=this.activeMenu.children(".ui-menu-item").filter(function(){return D.test(e(this).children("a").text())}),m=A&&m.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):m,m.length||(T=String.fromCharCode(l.keyCode),D=new RegExp("^"+c(T),"i"),m=this.activeMenu.children(".ui-menu-item").filter(function(){return D.test(e(this).children("a").text())})),m.length?(this.focus(l,m),m.length>1?(this.previousFilter=T,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}z&&l.preventDefault()},_activate:function(l){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(l):this.select(l))},refresh:function(){var l,c=this.options.icons.submenu,m=this.element.find(this.options.menus);m.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var f=e(this),T=f.prev("a"),A=e("<span>").addClass("ui-menu-icon ui-icon "+c).data("ui-menu-submenu-carat",!0);T.attr("aria-haspopup","true").prepend(A),f.attr("aria-labelledby",T.attr("id"))}),l=m.add(this.element),l.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),l.children(":not(.ui-menu-item)").each(function(){var f=e(this);/[^\-\s]/.test(f.text())||f.addClass("ui-widget-content ui-menu-divider")}),l.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!e.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(l,c){var m,f;this.blur(l,l&&l.type==="focus"),this._scrollIntoView(c),this.active=c.first(),f=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",f.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),l&&l.type==="keydown"?this._close():this.timer=this._delay(function(){this._close()},this.delay),m=c.children(".ui-menu"),m.length&&/^mouse/.test(l.type)&&this._startOpening(m),this.activeMenu=c.parent(),this._trigger("focus",l,{item:c})},_scrollIntoView:function(l){var c,m,f,T,A,D;this._hasScroll()&&(c=parseFloat(e.css(this.activeMenu[0],"borderTopWidth"))||0,m=parseFloat(e.css(this.activeMenu[0],"paddingTop"))||0,f=l.offset().top-this.activeMenu.offset().top-c-m,T=this.activeMenu.scrollTop(),A=this.activeMenu.height(),D=l.height(),f<0?this.activeMenu.scrollTop(T+f):f+D>A&&this.activeMenu.scrollTop(T+f-A+D))},blur:function(l,c){c||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",l,{item:this.active}))},_startOpening:function(l){clearTimeout(this.timer),l.attr("aria-hidden")==="true"&&(this.timer=this._delay(function(){this._close(),this._open(l)},this.delay))},_open:function(l){var c=e.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(l.parents(".ui-menu")).hide().attr("aria-hidden","true"),l.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(l,c){clearTimeout(this.timer),this.timer=this._delay(function(){var m=c?this.element:e(l&&l.target).closest(this.element.find(".ui-menu"));m.length||(m=this.element),this._close(m),this.blur(l),this.activeMenu=m},this.delay)},_close:function(l){l||(l=this.active?this.active.parent():this.element),l.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(l){var c=this.active&&this.active.parent().closest(".ui-menu-item",this.element);c&&c.length&&(this._close(),this.focus(l,c))},expand:function(l){var c=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();c&&c.length&&(this._open(c.parent()),this._delay(function(){this.focus(l,c)}))},next:function(l){this._move("next","first",l)},previous:function(l){this._move("prev","last",l)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(l,c,m){var f;this.active&&(l==="first"||l==="last"?f=this.active[l==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):f=this.active[l+"All"](".ui-menu-item").eq(0)),(!f||!f.length||!this.active)&&(f=this.activeMenu.children(".ui-menu-item")[c]()),this.focus(m,f)},nextPage:function(l){var c,m,f;if(!this.active){this.next(l);return}this.isLastItem()||(this._hasScroll()?(m=this.active.offset().top,f=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return c=e(this),c.offset().top-m-f<0}),this.focus(l,c)):this.focus(l,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))},previousPage:function(l){var c,m,f;if(!this.active){this.next(l);return}this.isFirstItem()||(this._hasScroll()?(m=this.active.offset().top,f=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return c=e(this),c.offset().top-m+f>0}),this.focus(l,c)):this.focus(l,this.activeMenu.children(".ui-menu-item").first()))},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(l){this.active=this.active||e(l.target).closest(".ui-menu-item");var c={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(l,!0),this._trigger("select",l,c)}})})(jQuery),(function(e,n){var w=5;e.widget("ui.slider",e.ui.mouse,{version:"1.9.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var l,c,m=this.options,f=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),T="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",A=[];for(this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(m.disabled?" ui-slider-disabled ui-disabled":"")),this.range=e([]),m.range&&(m.range===!0&&(m.values||(m.values=[this._valueMin(),this._valueMin()]),m.values.length&&m.values.length!==2&&(m.values=[m.values[0],m.values[0]])),this.range=e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(m.range==="min"||m.range==="max"?" ui-slider-range-"+m.range:""))),c=m.values&&m.values.length||1,l=f.length;l<c;l++)A.push(T);this.handles=f.add(e(A.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(D){D.preventDefault()}).mouseenter(function(){m.disabled||e(this).addClass("ui-state-hover")}).mouseleave(function(){e(this).removeClass("ui-state-hover")}).focus(function(){m.disabled?e(this).blur():(e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),e(this).addClass("ui-state-focus"))}).blur(function(){e(this).removeClass("ui-state-focus")}),this.handles.each(function(D){e(this).data("ui-slider-handle-index",D)}),this._on(this.handles,{keydown:function(D){var z,O,E,L,v=e(D.target).data("ui-slider-handle-index");switch(D.keyCode){case e.ui.keyCode.HOME:case e.ui.keyCode.END:case e.ui.keyCode.PAGE_UP:case e.ui.keyCode.PAGE_DOWN:case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(D.preventDefault(),!this._keySliding&&(this._keySliding=!0,e(D.target).addClass("ui-state-active"),z=this._start(D,v),z===!1))return}switch(L=this.options.step,this.options.values&&this.options.values.length?O=E=this.values(v):O=E=this.value(),D.keyCode){case e.ui.keyCode.HOME:E=this._valueMin();break;case e.ui.keyCode.END:E=this._valueMax();break;case e.ui.keyCode.PAGE_UP:E=this._trimAlignValue(O+(this._valueMax()-this._valueMin())/w);break;case e.ui.keyCode.PAGE_DOWN:E=this._trimAlignValue(O-(this._valueMax()-this._valueMin())/w);break;case e.ui.keyCode.UP:case e.ui.keyCode.RIGHT:if(O===this._valueMax())return;E=this._trimAlignValue(O+L);break;case e.ui.keyCode.DOWN:case e.ui.keyCode.LEFT:if(O===this._valueMin())return;E=this._trimAlignValue(O-L)}this._slide(D,v,E)},keyup:function(D){var z=e(D.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(D,z),this._change(D,z),e(D.target).removeClass("ui-state-active"))}}),this._refreshValue(),this._animateOff=!1},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(l){var c,m,f,T,A,D,z,O,E=this,L=this.options;return L.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:l.pageX,y:l.pageY},m=this._normValueFromMouse(c),f=this._valueMax()-this._valueMin()+1,this.handles.each(function(v){var p=Math.abs(m-E.values(v));f>p&&(f=p,T=e(this),A=v)}),L.range===!0&&this.values(1)===L.min&&(A+=1,T=e(this.handles[A])),D=this._start(l,A),D===!1?!1:(this._mouseSliding=!0,this._handleIndex=A,T.addClass("ui-state-active").focus(),z=T.offset(),O=!e(l.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=O?{left:0,top:0}:{left:l.pageX-z.left-T.width()/2,top:l.pageY-z.top-T.height()/2-(parseInt(T.css("borderTopWidth"),10)||0)-(parseInt(T.css("borderBottomWidth"),10)||0)+(parseInt(T.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(l,A,m),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(l){var c={x:l.pageX,y:l.pageY},m=this._normValueFromMouse(c);return this._slide(l,this._handleIndex,m),!1},_mouseStop:function(l){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(l,this._handleIndex),this._change(l,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(l){var c,m,f,T,A;return this.orientation==="horizontal"?(c=this.elementSize.width,m=l.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(c=this.elementSize.height,m=l.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),f=m/c,f>1&&(f=1),f<0&&(f=0),this.orientation==="vertical"&&(f=1-f),T=this._valueMax()-this._valueMin(),A=this._valueMin()+f*T,this._trimAlignValue(A)},_start:function(l,c){var m={handle:this.handles[c],value:this.value()};return this.options.values&&this.options.values.length&&(m.value=this.values(c),m.values=this.values()),this._trigger("start",l,m)},_slide:function(l,c,m){var f,T,A;this.options.values&&this.options.values.length?(f=this.values(c?0:1),this.options.values.length===2&&this.options.range===!0&&(c===0&&m>f||c===1&&m<f)&&(m=f),m!==this.values(c)&&(T=this.values(),T[c]=m,A=this._trigger("slide",l,{handle:this.handles[c],value:m,values:T}),f=this.values(c?0:1),A!==!1&&this.values(c,m,!0))):m!==this.value()&&(A=this._trigger("slide",l,{handle:this.handles[c],value:m}),A!==!1&&this.value(m))},_stop:function(l,c){var m={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(m.value=this.values(c),m.values=this.values()),this._trigger("stop",l,m)},_change:function(l,c){if(!this._keySliding&&!this._mouseSliding){var m={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(m.value=this.values(c),m.values=this.values()),this._trigger("change",l,m)}},value:function(l){if(arguments.length){this.options.value=this._trimAlignValue(l),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(l,c){var m,f,T;if(arguments.length>1){this.options.values[l]=this._trimAlignValue(c),this._refreshValue(),this._change(null,l);return}if(!arguments.length)return this._values();if(!e.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(l):this.value();for(m=this.options.values,f=arguments[0],T=0;T<m.length;T+=1)m[T]=this._trimAlignValue(f[T]),this._change(null,T);this._refreshValue()},_setOption:function(l,c){var m,f=0;switch(e.isArray(this.options.values)&&(f=this.options.values.length),e.Widget.prototype._setOption.apply(this,arguments),l){case"disabled":c?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),m=0;m<f;m+=1)this._change(null,m);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var l=this.options.value;return l=this._trimAlignValue(l),l},_values:function(l){var c,m,f;if(arguments.length)return c=this.options.values[l],c=this._trimAlignValue(c),c;for(m=this.options.values.slice(),f=0;f<m.length;f+=1)m[f]=this._trimAlignValue(m[f]);return m},_trimAlignValue:function(l){if(l<=this._valueMin())return this._valueMin();if(l>=this._valueMax())return this._valueMax();var c=this.options.step>0?this.options.step:1,m=(l-this._valueMin())%c,f=l-m;return Math.abs(m)*2>=c&&(f+=m>0?c:-c),parseFloat(f.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var l,c,m,f,T,A=this.options.range,D=this.options,z=this,O=this._animateOff?!1:D.animate,E={};this.options.values&&this.options.values.length?this.handles.each(function(L){c=(z.values(L)-z._valueMin())/(z._valueMax()-z._valueMin())*100,E[z.orientation==="horizontal"?"left":"bottom"]=c+"%",e(this).stop(1,1)[O?"animate":"css"](E,D.animate),z.options.range===!0&&(z.orientation==="horizontal"?(L===0&&z.range.stop(1,1)[O?"animate":"css"]({left:c+"%"},D.animate),L===1&&z.range[O?"animate":"css"]({width:c-l+"%"},{queue:!1,duration:D.animate})):(L===0&&z.range.stop(1,1)[O?"animate":"css"]({bottom:c+"%"},D.animate),L===1&&z.range[O?"animate":"css"]({height:c-l+"%"},{queue:!1,duration:D.animate}))),l=c}):(m=this.value(),f=this._valueMin(),T=this._valueMax(),c=T!==f?(m-f)/(T-f)*100:0,E[this.orientation==="horizontal"?"left":"bottom"]=c+"%",this.handle.stop(1,1)[O?"animate":"css"](E,D.animate),A==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[O?"animate":"css"]({width:c+"%"},D.animate),A==="max"&&this.orientation==="horizontal"&&this.range[O?"animate":"css"]({width:100-c+"%"},{queue:!1,duration:D.animate}),A==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[O?"animate":"css"]({height:c+"%"},D.animate),A==="max"&&this.orientation==="vertical"&&this.range[O?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:D.animate}))}})})(jQuery);/*! Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
* Licensed under the MIT License.
*
* Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
* Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
* Thanks to: Seamus Leahy for adding deltaX and deltaY
*
* Version: 3.0.4
*
* Requires: 1.2.2+
*/(function(e){function n(l){var c=l||window.event,m=[].slice.call(arguments,1),f=0,T=0,A=0;return l=e.event.fix(c),l.type="mousewheel",l.wheelDelta&&(f=l.wheelDelta/120),l.detail&&(f=-l.detail/3),A=f,c.axis!==void 0&&c.axis===c.HORIZONTAL_AXIS&&(A=0,T=-1*f),c.wheelDeltaY!==void 0&&(A=c.wheelDeltaY/120),c.wheelDeltaX!==void 0&&(T=-1*c.wheelDeltaX/120),m.unshift(l,f,T,A),e.event.handle.apply(this,m)}var w=["DOMMouseScroll","mousewheel"];e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var l=w.length;l;)this.addEventListener(w[--l],n,!1);else this.onmousewheel=n},teardown:function(){if(this.removeEventListener)for(var l=w.length;l;)this.removeEventListener(w[--l],n,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(l){return l?this.bind("mousewheel",l):this.trigger("mousewheel")},unmousewheel:function(l){return this.unbind("mousewheel",l)}})})(jQuery),eval((function(e,n,w,l,c,m){if(c=function(f){return(f<n?"":c(parseInt(f/n)))+((f=f%n)>35?String.fromCharCode(f+29):f.toString(36))},!"".replace(/^/,String)){for(;w--;)m[c(w)]=l[w]||c(w);l=[function(f){return m[f]}],c=function(){return"\\w+"},w=1}for(;w--;)l[w]&&(e=e.replace(new RegExp("\\b"+c(w)+"\\b","g"),l[w]));return e})(`(D($){8($.1s.1v){H}$.1s.6i=$.1s.1v=D(u,w){8(1l.S==0){18(J,'6j 55 6k 1j "'+1l.4o+'".');H 1l}8(1l.S>1){H 1l.1W(D(){$(1l).1v(u,w)})}F y=1l,$12=1l[0],56=L;8(y.1q('57')){56=y.1P('3o','4p');y.T('3o',['4q',J])}F z={};z.59=D(o,a,b){o=3S($12,o);o.E=6l($12,o.E);o.1K=6m($12,o.1K);o.N=6n($12,o.N);o.14=5a($12,o.14);o.16=5a($12,o.16);o.1b=6o($12,o.1b);o.1r=6p($12,o.1r);o.1Q=6q($12,o.1Q);8(a){31=$.1L(J,{},$.1s.1v.5b,o)}7=$.1L(J,{},$.1s.1v.5b,o);7.d=6r(7);A.2l=(7.2l=='5c'||7.2l=='1m')?'16':'14';F c=y.13(),2m=5d($1n,7,'P');8(3p(7.25)){7.25='7Q'+G.3T}7.3U=5e(7,2m);7.E=6s(7.E,7,c,b);7[7.d['P']]=6t(7[7.d['P']],7,c);7[7.d['1e']]=6u(7[7.d['1e']],7,c);8(7.2H){8(!3V(7[7.d['P']])){7[7.d['P']]='2I%'}}8(3V(7[7.d['P']])){A.6v=J;A.4r=7[7.d['P']];7[7.d['P']]=4s(2m,A.4r);8(!7.E.M){7.E.U.1d=J}}8(7.2H){7.1R=L;7.1i=[0,0,0,0];7.1B=L;7.E.U.1d=L}O{8(!7.E.M){7=6w(7,2m)}8(!7[7.d['P']]){8(!7.E.U.1d&&Y(7.E[7.d['P']])&&7.E.1t=='*'){7[7.d['P']]=7.E.M*7.E[7.d['P']];7.1B=L}O{7[7.d['P']]='1d'}}8(1z(7.1B)){7.1B=(Y(7[7.d['P']]))?'5f':L}8(7.E.U.1d){7.E.M=32(c,7,0)}}8(7.E.1t!='*'&&!7.E.U.1d){7.E.U.4t=7.E.M;7.E.M=3W(c,7,0)}7.E.M=2x(7.E.M,7,7.E.U.2c,$12);7.E.U.20=7.E.M;8(7.2H){8(!7.E.U.34){7.E.U.34=7.E.M}8(!7.E.U.1X){7.E.U.1X=7.E.M}7=5g(7,c,2m)}O{7.1i=6x(7.1i);8(7.1B=='3q'){7.1B='1m'}O 8(7.1B=='5h'){7.1B='35'}1F(7.1B){R'5f':R'1m':R'35':8(7[7.d['P']]!='1d'){7=5i(7,c);7.1R=J}17;2J:7.1B=L;7.1R=(7.1i[0]==0&&7.1i[1]==0&&7.1i[2]==0&&7.1i[3]==0)?L:J;17}}8(!Y(7.1K.1M)){7.1K.1M=6y}8(1z(7.1K.E)){7.1K.E=(7.2H||7.E.U.1d||7.E.1t!='*')?'M':7.E.M}7.N=$.1L(J,{},7.1K,7.N);7.14=$.1L(J,{},7.1K,7.14);7.16=$.1L(J,{},7.1K,7.16);7.1b=$.1L(J,{},7.1K,7.1b);7.N=6z($12,7.N);7.14=5j($12,7.14);7.16=5j($12,7.16);7.1b=6A($12,7.1b);7.1r=6B($12,7.1r);7.1Q=6C($12,7.1Q);8(7.2n){7.2n=5k(7.2n)}8(7.N.5l){7.N.4u=7.N.5l;3X('N.5l','N.4u')}8(7.N.5m){7.N.4v=7.N.5m;3X('N.5m','N.4v')}8(7.N.5n){7.N.4w=7.N.5n;3X('N.5n','N.4w')}8(7.N.5o){7.N.2K=7.N.5o;3X('N.5o','N.2K')}};z.6D=D(){y.1q('57',J);F a=y.13(),3Y=6E(y,['6F','6G','3r','3q','35','5h','1m','3Z','P','1e','6H','1S','5p','6I']),5q='7R';1F(3Y.3r){R'6J':R'7S':5q=3Y.3r;17}8(G.3s=='36'){41($1n)}O{$1n.Z(3Y)}$1n.Z({'7T':'3t','3r':5q});41(y);y.1q('6K',3Y.3Z);y.Z({'6F':'1m','6G':'42','3r':'6J','3q':0,'35':'N','5h':'N','1m':0,'6H':0,'1S':0,'5p':0,'6I':0});4x(a,7);41(a);8(7.2H){5r(7,a)}};z.6L=D(){z.5s();y.11(I('6M',G),D(e,a){e.1g();8(!A.2d){8(7.N.W){7.N.W.3a(2y('4y',G))}}A.2d=J;8(7.N.1G){7.N.1G=L;y.T(I('3b',G),a)}H J});y.11(I('5t',G),D(e){e.1g();8(A.26){43(V)}H J});y.11(I('3b',G),D(e,a,b){e.1g();1u=3u(1u);8(a&&A.26){V.2d=J;F c=2o()-V.2L;V.1M-=c;8(V.4z){V.4z.1M-=c}8(V.4A){V.4A.1M-=c}43(V,L)}8(!A.27&&!A.26){8(b){1u.3v+=2o()-1u.2L}}8(!A.27){8(7.N.W){7.N.W.3a(2y('6N',G))}}A.27=J;8(7.N.4v){F d=7.N.2K-1u.3v,3c=2I-1H.2z(d*2I/7.N.2K);7.N.4v.1h($12,3c,d)}H J});y.11(I('1G',G),D(e,b,c,d){e.1g();1u=3u(1u);F v=[b,c,d],t=['2M','28','3d'],a=3e(v,t);b=a[0];c=a[1];d=a[2];8(b!='14'&&b!='16'){b=A.2l}8(!Y(c)){c=0}8(!1k(d)){d=L}8(d){A.2d=L;7.N.1G=J}8(!7.N.1G){e.2e();H 18(G,'3w 4y: 2p 3f.')}8(A.27){8(7.N.W){7.N.W.2N(2y('4y',G));7.N.W.2N(2y('6N',G))}}A.27=L;1u.2L=2o();F f=7.N.2K+c;44=f-1u.3v;3c=2I-1H.2z(44*2I/f);8(7.N.1f){1u.1f=7U(D(){F a=2o()-1u.2L+1u.3v,3c=1H.2z(a*2I/f);7.N.1f.4B.1h(7.N.1f.2q[0],3c)},7.N.1f.5u)}1u.N=7V(D(){8(7.N.1f){7.N.1f.4B.1h(7.N.1f.2q[0],2I)}8(7.N.4w){7.N.4w.1h($12,3c,44)}8(A.26){y.T(I('1G',G),b)}O{y.T(I(b,G),7.N)}},44);8(7.N.4u){7.N.4u.1h($12,3c,44)}H J});y.11(I('3g',G),D(e){e.1g();8(V.2d){V.2d=L;A.27=L;A.26=J;V.2L=2o();3x(V,G)}O{y.T(I('1G',G))}H J});y.11(I('14',G)+' '+I('16',G),D(e,b,f,g,h){e.1g();8(A.2d||y.2f(':3t')){e.2e();H 18(G,'3w 4y 7W 3t: 2p 3f.')}F i=(Y(7.E.4C))?7.E.4C:7.E.M+1;8(i>K.Q){e.2e();H 18(G,'2p 6O E ('+K.Q+' Q, '+i+' 6P): 2p 3f.')}F v=[b,f,g,h],t=['2A','28/2M','D','3d'],a=3e(v,t);b=a[0];f=a[1];g=a[2];h=a[3];F k=e.5v.19(G.3y.45.S);8(!1T(b)){b={}}8(1o(g)){b.3h=g}8(1k(h)){b.2O=h}b=$.1L(J,{},7[k],b);8(b.5w&&!b.5w.1h($12,k)){e.2e();H 18(G,'7X "5w" 7Y L.')}8(!Y(f)){8(7.E.1t!='*'){f='M'}O{F m=[f,b.E,7[k].E];1j(F a=0,l=m.S;a<l;a++){8(Y(m[a])||m[a]=='6Q'||m[a]=='M'){f=m[a];17}}}1F(f){R'6Q':e.2e();H y.1P(I(k+'7Z',G),[b,g]);17;R'M':8(!7.E.U.1d&&7.E.1t=='*'){f=7.E.M}17}}8(V.2d){y.T(I('3g',G));y.T(I('2O',G),[k,[b,f,g]]);e.2e();H 18(G,'3w 80 3f.')}8(b.1M>0){8(A.26){8(b.2O){8(b.2O=='2P'){2g=[]}8(b.2O!='X'||2g.S==0){y.T(I('2O',G),[k,[b,f,g]])}}e.2e();H 18(G,'3w 81 3f.')}}1u.3v=0;y.T(I('6R'+k,G),[b,f]);8(7.2n){F s=7.2n,c=[b,f];1j(F j=0,l=s.S;j<l;j++){F d=k;8(!s[j][2]){d=(d=='14')?'16':'14'}8(!s[j][1]){c[0]=s[j][0].1P('3o',['6S',d])}c[1]=f+s[j][3];s[j][0].T('3o',['6R'+d,c])}}H J});y.11(I('82',G),D(e,b,c){e.1g();F d=y.13();8(!7.1U){8(K.X==0){8(7.3z){y.T(I('16',G),K.Q-1)}H e.2e()}}1Y(d,7);8(!Y(c)){8(7.E.U.1d){c=4D(d,7,K.Q-1)}O 8(7.E.1t!='*'){F f=(Y(b.E))?b.E:5x(y,7);c=6T(d,7,K.Q-1,f)}O{c=7.E.M}c=4E(c,7,b.E,$12)}8(!7.1U){8(K.Q-c<K.X){c=K.Q-K.X}}7.E.U.20=7.E.M;8(7.E.U.1d){F g=2x(32(d,7,K.Q-c),7,7.E.U.2c,$12);8(7.E.M+c<=g&&c<K.Q){c++;g=2x(32(d,7,K.Q-c),7,7.E.U.2c,$12)}7.E.M=g}O 8(7.E.1t!='*'){F g=3W(d,7,K.Q-c);7.E.M=2x(g,7,7.E.U.2c,$12)}1Y(d,7,J);8(c==0){e.2e();H 18(G,'0 E 46 1K: 2p 3f.')}18(G,'6U '+c+' E 5y.');K.X+=c;2h(K.X>=K.Q){K.X-=K.Q}8(!7.1U){8(K.X==0&&b.4F){b.4F.1h($12,'14')}8(!7.3z){3A(7,K.X,G)}}y.13().19(K.Q-c,K.Q).83(y);8(K.Q<7.E.M+c){y.13().19(0,(7.E.M+c)-K.Q).4G(J).47(y)}F d=y.13(),3i=6V(d,7,c),2i=6W(d,7),1Z=d.1N(c-1),21=3i.2P(),2r=2i.2P();1Y(d,7);F h=0,2B=0;8(7.1B){F p=4H(2i,7);h=p[0];2B=p[1]}F i=(h<0)?7.1i[7.d[3]]:0;F j=L,2Q=$();8(7.E.M<c){2Q=d.19(7.E.U.20,c);8(b.1V=='6X'){F k=7.E[7.d['P']];j=2Q;1Z=2r;5z(j);7.E[7.d['P']]='1d'}}F l=L,3B=2R(d.19(0,c),7,'P'),2j=4I(4J(2i,7,J),7,!7.1R),3C=0,29={},4K={},2s={},2S={},4L={},2T={},5A={},2U=5B(b,7,c,3B);1F(b.1V){R'1I':R'1I-1w':3C=2R(d.19(0,7.E.M),7,'P');17}8(j){7.E[7.d['P']]=k}1Y(d,7,J);8(2B>=0){1Y(21,7,7.1i[7.d[1]])}8(h>=0){1Y(1Z,7,7.1i[7.d[3]])}8(7.1B){7.1i[7.d[1]]=2B;7.1i[7.d[3]]=h}2T[7.d['1m']]=-(3B-i);5A[7.d['1m']]=-(3C-i);4K[7.d['1m']]=2j[7.d['P']];F m=D(){},1O=D(){},1C=D(){},3D=D(){},2C=D(){},5C=D(){},1D=D(){},3E=D(){},1x=D(){},1y=D(){},1J=D(){};1F(b.1V){R'3j':R'1I':R'1I-1w':R'22':R'22-1w':l=y.4G(J).47($1n);17}1F(b.1V){R'3j':R'22':R'22-1w':l.13().19(0,c).2t();l.13().19(7.E.U.20).2t();17;R'1I':R'1I-1w':l.13().19(7.E.M).2t();l.Z(5A);17}y.Z(2T);V=48(2U,b.2u,G);29[7.d['1m']]=(7.1R)?7.1i[7.d[3]]:0;8(7[7.d['P']]=='1d'||7[7.d['1e']]=='1d'){m=D(){$1n.Z(2j)};1O=D(){V.1a.1c([$1n,2j])}}8(7.1R){8(2r.4M(1Z).S){2s[7.d['1S']]=1Z.1q('2a');8(h<0){1Z.Z(2s)}O{1D=D(){1Z.Z(2s)};3E=D(){V.1a.1c([1Z,2s])}}}1F(b.1V){R'1I':R'1I-1w':l.13().1N(c-1).Z(2s);17}8(2r.4M(21).S){2S[7.d['1S']]=21.1q('2a');1C=D(){21.Z(2S)};3D=D(){V.1a.1c([21,2S])}}8(2B>=0){4L[7.d['1S']]=2r.1q('2a')+7.1i[7.d[1]];2C=D(){2r.Z(4L)};5C=D(){V.1a.1c([2r,4L])}}}1J=D(){y.Z(29)};F n=7.E.M+c-K.Q;1y=D(){8(n>0){y.13().19(K.Q).2t();3i=$(y.13().19(K.Q-(7.E.M-n)).3F().6Y(y.13().19(0,n).3F()))}5D(j);8(7.1R){F a=y.13().1N(7.E.M+c-1);a.Z(7.d['1S'],a.1q('2a'))}};F o=5E(3i,2Q,2i,c,'14',2U,2j);1x=D(){5F(y,l,b);A.26=L;2b.3h=4a($12,b,'3h',o,2b);2g=5G(y,2g,G);8(!A.27){y.T(I('1G',G))}};A.26=J;1u=3u(1u);2b.3G=4a($12,b,'3G',o,2b);1F(b.1V){R'42':y.Z(29);m();1C();2C();1D();1J();1y();1x();17;R'1w':V.1a.1c([y,{'1E':0},D(){m();1C();2C();1D();1J();1y();V=48(2U,b.2u,G);V.1a.1c([y,{'1E':1},1x]);3x(V,G)}]);17;R'3j':y.Z({'1E':0});V.1a.1c([l,{'1E':0}]);V.1a.1c([y,{'1E':1},1x]);1O();1C();2C();1D();1J();1y();17;R'1I':V.1a.1c([l,29,D(){1C();2C();1D();1J();1y();1x()}]);1O();17;R'1I-1w':V.1a.1c([y,{'1E':0}]);V.1a.1c([l,29,D(){y.Z({'1E':1});1C();2C();1D();1J();1y();1x()}]);1O();17;R'22':V.1a.1c([l,4K,1x]);1O();1C();2C();1D();1J();1y();17;R'22-1w':y.Z({'1E':0});V.1a.1c([y,{'1E':1}]);V.1a.1c([l,4K,1x]);1O();1C();2C();1D();1J();1y();17;2J:V.1a.1c([y,29,D(){1y();1x()}]);1O();3D();5C();3E();17}3x(V,G);5H(7.25,y,G);y.T(I('3H',G),[L,2j]);H J});y.11(I('84',G),D(e,c,d){e.1g();F f=y.13();8(!7.1U){8(K.X==7.E.M){8(7.3z){y.T(I('14',G),K.Q-1)}H e.2e()}}1Y(f,7);8(!Y(d)){8(7.E.1t!='*'){F g=(Y(c.E))?c.E:5x(y,7);d=6Z(f,7,0,g)}O{d=7.E.M}d=4E(d,7,c.E,$12)}F h=(K.X==0)?K.Q:K.X;8(!7.1U){8(7.E.U.1d){F i=32(f,7,d),g=4D(f,7,h-1)}O{F i=7.E.M,g=7.E.M}8(d+i>h){d=h-g}}7.E.U.20=7.E.M;8(7.E.U.1d){F i=2x(5I(f,7,d,h),7,7.E.U.2c,$12);2h(7.E.M-d>=i&&d<K.Q){d++;i=2x(5I(f,7,d,h),7,7.E.U.2c,$12)}7.E.M=i}O 8(7.E.1t!='*'){F i=3W(f,7,d);7.E.M=2x(i,7,7.E.U.2c,$12)}1Y(f,7,J);8(d==0){e.2e();H 18(G,'0 E 46 1K: 2p 3f.')}18(G,'6U '+d+' E 70.');K.X-=d;2h(K.X<0){K.X+=K.Q}8(!7.1U){8(K.X==7.E.M&&c.4F){c.4F.1h($12,'16')}8(!7.3z){3A(7,K.X,G)}}8(K.Q<7.E.M+d){y.13().19(0,(7.E.M+d)-K.Q).4G(J).47(y)}F f=y.13(),3i=71(f,7),2i=72(f,7,d),1Z=f.1N(d-1),21=3i.2P(),2r=2i.2P();1Y(f,7);F j=0,2B=0;8(7.1B){F p=4H(2i,7);j=p[0];2B=p[1]}F k=L,2Q=$();8(7.E.U.20<d){2Q=f.19(7.E.U.20,d);8(c.1V=='6X'){F l=7.E[7.d['P']];k=2Q;1Z=21;5z(k);7.E[7.d['P']]='1d'}}F m=L,3B=2R(f.19(0,d),7,'P'),2j=4I(4J(2i,7,J),7,!7.1R),3C=0,29={},4N={},2s={},2S={},2T={},2U=5B(c,7,d,3B);1F(c.1V){R'22':R'22-1w':3C=2R(f.19(0,7.E.U.20),7,'P');17}8(k){7.E[7.d['P']]=l}8(7.1B){8(7.1i[7.d[1]]<0){7.1i[7.d[1]]=0}}1Y(f,7,J);1Y(21,7,7.1i[7.d[1]]);8(7.1B){7.1i[7.d[1]]=2B;7.1i[7.d[3]]=j}2T[7.d['1m']]=(7.1R)?7.1i[7.d[3]]:0;F n=D(){},1O=D(){},1C=D(){},3D=D(){},1D=D(){},3E=D(){},1x=D(){},1y=D(){},1J=D(){};1F(c.1V){R'3j':R'1I':R'1I-1w':R'22':R'22-1w':m=y.4G(J).47($1n);m.13().19(7.E.U.20).2t();17}1F(c.1V){R'3j':R'1I':R'1I-1w':y.Z('3Z',1);m.Z('3Z',0);17}V=48(2U,c.2u,G);29[7.d['1m']]=-3B;4N[7.d['1m']]=-3C;8(j<0){29[7.d['1m']]+=j}8(7[7.d['P']]=='1d'||7[7.d['1e']]=='1d'){n=D(){$1n.Z(2j)};1O=D(){V.1a.1c([$1n,2j])}}8(7.1R){F o=2r.1q('2a');8(2B>=0){o+=7.1i[7.d[1]]}2r.Z(7.d['1S'],o);8(1Z.4M(21).S){2S[7.d['1S']]=21.1q('2a')}1C=D(){21.Z(2S)};3D=D(){V.1a.1c([21,2S])};F q=1Z.1q('2a');8(j>0){q+=7.1i[7.d[3]]}2s[7.d['1S']]=q;1D=D(){1Z.Z(2s)};3E=D(){V.1a.1c([1Z,2s])}}1J=D(){y.Z(2T)};F r=7.E.M+d-K.Q;1y=D(){8(r>0){y.13().19(K.Q).2t()}F a=y.13().19(0,d).47(y).2P();8(r>0){2i=3I(f,7)}5D(k);8(7.1R){8(K.Q<7.E.M+d){F b=y.13().1N(7.E.M-1);b.Z(7.d['1S'],b.1q('2a')+7.1i[7.d[1]])}a.Z(7.d['1S'],a.1q('2a'))}};F s=5E(3i,2Q,2i,d,'16',2U,2j);1x=D(){y.Z('3Z',y.1q('6K'));5F(y,m,c);A.26=L;2b.3h=4a($12,c,'3h',s,2b);2g=5G(y,2g,G);8(!A.27){y.T(I('1G',G))}};A.26=J;1u=3u(1u);2b.3G=4a($12,c,'3G',s,2b);1F(c.1V){R'42':y.Z(29);n();1C();1D();1J();1y();1x();17;R'1w':V.1a.1c([y,{'1E':0},D(){n();1C();1D();1J();1y();V=48(2U,c.2u,G);V.1a.1c([y,{'1E':1},1x]);3x(V,G)}]);17;R'3j':y.Z({'1E':0});V.1a.1c([m,{'1E':0}]);V.1a.1c([y,{'1E':1},1x]);1O();1C();1D();1J();1y();17;R'1I':y.Z(7.d['1m'],$1n[7.d['P']]());V.1a.1c([y,2T,1x]);1O();1C();1D();1y();17;R'1I-1w':y.Z(7.d['1m'],$1n[7.d['P']]());V.1a.1c([m,{'1E':0}]);V.1a.1c([y,2T,1x]);1O();1C();1D();1y();17;R'22':V.1a.1c([m,4N,1x]);1O();1C();1D();1J();1y();17;R'22-1w':y.Z({'1E':0});V.1a.1c([y,{'1E':1}]);V.1a.1c([m,4N,1x]);1O();1C();1D();1J();1y();17;2J:V.1a.1c([y,29,D(){1J();1y();1x()}]);1O();3D();3E();17}3x(V,G);5H(7.25,y,G);y.T(I('3H',G),[L,2j]);H J});y.11(I('3k',G),D(e,b,c,d,f,g,h){e.1g();F v=[b,c,d,f,g,h],t=['2M/28/2A','28','3d','2A','2M','D'],a=3e(v,t);f=a[3];g=a[4];h=a[5];b=3J(a[0],a[1],a[2],K,y);8(b==0){H L}8(!1T(f)){f=L}8(g!='14'&&g!='16'){8(7.1U){g=(b<=K.Q/2)?'16':'14'}O{g=(K.X==0||K.X>b)?'16':'14'}}8(g=='14'){b=K.Q-b}y.T(I(g,G),[f,b,h]);H J});y.11(I('85',G),D(e,a,b){e.1g();F c=y.1P(I('4b',G));H y.1P(I('5J',G),[c-1,a,'14',b])});y.11(I('86',G),D(e,a,b){e.1g();F c=y.1P(I('4b',G));H y.1P(I('5J',G),[c+1,a,'16',b])});y.11(I('5J',G),D(e,a,b,c,d){e.1g();8(!Y(a)){a=y.1P(I('4b',G))}F f=7.1b.E||7.E.M,1X=1H.2z(K.Q/f)-1;8(a<0){a=1X}8(a>1X){a=0}H y.1P(I('3k',G),[a*f,0,J,b,c,d])});y.11(I('73',G),D(e,s){e.1g();8(s){s=3J(s,0,J,K,y)}O{s=0}s+=K.X;8(s!=0){8(K.Q>0){2h(s>K.Q){s-=K.Q}}y.87(y.13().19(s,K.Q))}H J});y.11(I('2n',G),D(e,s){e.1g();8(s){s=5k(s)}O 8(7.2n){s=7.2n}O{H 18(G,'6j 88 46 2n.')}F n=y.1P(I('4p',G)),x=J;1j(F j=0,l=s.S;j<l;j++){8(!s[j][0].1P(I('3k',G),[n,s[j][3],J])){x=L}}H x});y.11(I('2O',G),D(e,a,b){e.1g();8(1o(a)){a.1h($12,2g)}O 8(2V(a)){2g=a}O 8(!1z(a)){2g.1c([a,b])}H 2g});y.11(I('89',G),D(e,b,c,d,f){e.1g();F v=[b,c,d,f],t=['2M/2A','2M/28/2A','3d','28'],a=3e(v,t);b=a[0];c=a[1];d=a[2];f=a[3];8(1T(b)&&!2v(b)){b=$(b)}O 8(1p(b)){b=$(b)}8(!2v(b)||b.S==0){H 18(G,'2p a 5K 2A.')}8(1z(c)){c='4c'}4x(b,7);41(b);F g=c,4d='4d';8(c=='4c'){8(d){8(K.X==0){c=K.Q-1;4d='74'}O{c=K.X;K.X+=b.S}8(c<0){c=0}}O{c=K.Q-1;4d='74'}}O{c=3J(c,f,d,K,y)}F h=y.13().1N(c);8(h.S){h[4d](b)}O{18(G,'8a 8b-3r 4M 6k! 8c 8d 46 75 4c.');y.76(b)}8(g!='4c'&&!d){8(c<K.X){K.X+=b.S}}K.Q=y.13().S;8(K.X>=K.Q){K.X-=K.Q}y.T(I('4O',G));y.T(I('5L',G));H J});y.11(I('77',G),D(e,c,d,f){e.1g();F v=[c,d,f],t=['2M/28/2A','3d','28'],a=3e(v,t);c=a[0];d=a[1];f=a[2];F g=L;8(c 2W $&&c.S>1){h=$();c.1W(D(i,a){F b=y.T(I('77',G),[$(1l),d,f]);8(b){h=h.8e(b)}});H h}8(1z(c)||c=='4c'){h=y.13().2P()}O{c=3J(c,f,d,K,y);F h=y.13().1N(c);8(h.S){8(c<K.X){K.X-=h.S}}}8(h&&h.S){h.8f();K.Q=y.13().S;y.T(I('4O',G))}H h});y.11(I('3G',G)+' '+I('3h',G),D(e,a){e.1g();F b=e.5v.19(G.3y.45.S);8(2V(a)){2b[b]=a}8(1o(a)){2b[b].1c(a)}H 2b[b]});y.11(I('4p',G),D(e,a){e.1g();8(K.X==0){F b=0}O{F b=K.Q-K.X}8(1o(a)){a.1h($12,b)}H b});y.11(I('4b',G),D(e,a){e.1g();F b=7.1b.E||7.E.M,1X=1H.2z(K.Q/b-1),2k;8(K.X==0){2k=0}O 8(K.X<K.Q%b){2k=0}O 8(K.X==b&&!7.1U){2k=1X}O{2k=1H.78((K.Q-K.X)/b)}8(2k<0){2k=0}8(2k>1X){2k=1X}8(1o(a)){a.1h($12,2k)}H 2k});y.11(I('8g',G),D(e,a){e.1g();F b=3I(y.13(),7);8(1o(a)){a.1h($12,b)}H b});y.11(I('19',G),D(e,f,l,b){e.1g();8(K.Q==0){H L}F v=[f,l,b],t=['28','28','D'],a=3e(v,t);f=(Y(a[0]))?a[0]:0;l=(Y(a[1]))?a[1]:K.Q;b=a[2];f+=K.X;l+=K.X;8(E.Q>0){2h(f>K.Q){f-=K.Q}2h(l>K.Q){l-=K.Q}2h(f<0){f+=K.Q}2h(l<0){l+=K.Q}}F c=y.13(),$i;8(l>f){$i=c.19(f,l)}O{$i=$(c.19(f,K.Q).3F().6Y(c.19(0,l).3F()))}8(1o(b)){b.1h($12,$i)}H $i});y.11(I('27',G)+' '+I('2d',G)+' '+I('26',G),D(e,a){e.1g();F b=e.5v.19(G.3y.45.S),5M=A[b];8(1o(a)){a.1h($12,5M)}H 5M});y.11(I('6S',G),D(e,a,b,c){e.1g();F d=L;8(1o(a)){a.1h($12,7)}O 8(1T(a)){31=$.1L(J,{},31,a);8(b!==L)d=J;O 7=$.1L(J,{},7,a)}O 8(!1z(a)){8(1o(b)){F f=4P('7.'+a);8(1z(f)){f=''}b.1h($12,f)}O 8(!1z(b)){8(2X c!=='3d')c=J;4P('31.'+a+' = b');8(c!==L)d=J;O 4P('7.'+a+' = b')}O{H 4P('7.'+a)}}8(d){1Y(y.13(),7);z.59(31);z.5N();F g=4Q(y,7);y.T(I('3H',G),[J,g])}H 7});y.11(I('5L',G),D(e,a,b){e.1g();8(1z(a)){a=$('8h')}O 8(1p(a)){a=$(a)}8(!2v(a)||a.S==0){H 18(G,'2p a 5K 2A.')}8(!1p(b)){b='a.6i'}a.8i(b).1W(D(){F h=1l.79||'';8(h.S>0&&y.13().7a($(h))!=-1){$(1l).23('5O').5O(D(e){e.2D();y.T(I('3k',G),h)})}});H J});y.11(I('3H',G),D(e,b,c){e.1g();8(!7.1b.1A){H}F d=7.1b.E||7.E.M,4R=1H.2z(K.Q/d);8(b){8(7.1b.3K){7.1b.1A.13().2t();7.1b.1A.1W(D(){1j(F a=0;a<4R;a++){F i=y.13().1N(3J(a*d,0,J,K,y));$(1l).76(7.1b.3K.1h(i[0],a+1))}})}7.1b.1A.1W(D(){$(1l).13().23(7.1b.3L).1W(D(a){$(1l).11(7.1b.3L,D(e){e.2D();y.T(I('3k',G),[a*d,-7.1b.4S,J,7.1b])})})})}F f=y.1P(I('4b',G))+7.1b.4S;8(f>=4R){f=0}8(f<0){f=4R-1}7.1b.1A.1W(D(){$(1l).13().2N(2y('7b',G)).1N(f).3a(2y('7b',G))});H J});y.11(I('4O',G),D(e){F a=7.E.M,2E=y.13(),2m=5d($1n,7,'P');K.Q=2E.S;8(A.4r){7.3U=2m;7[7.d['P']]=4s(2m,A.4r)}O{7.3U=5e(7,2m)}8(7.2H){7.E.P=7.E.3M.P;7.E.1e=7.E.3M.1e;7=5g(7,2E,2m);a=7.E.M;5r(7,2E)}O 8(7.E.U.1d){a=32(2E,7,0)}O 8(7.E.1t!='*'){a=3W(2E,7,0)}8(!7.1U&&K.X!=0&&a>K.X){8(7.E.U.1d){F b=4D(2E,7,K.X)-K.X}O 8(7.E.1t!='*'){F b=7c(2E,7,K.X)-K.X}O{F b=7.E.M-K.X}18(G,'8j 8k-1U: 8l '+b+' E 5y.');y.T(I('14',G),b)}7.E.M=2x(a,7,7.E.U.2c,$12);7.E.U.20=7.E.M;7=5i(7,2E);F c=4Q(y,7);y.T(I('3H',G),[J,c]);4T(7,K.Q,G);3A(7,K.X,G);H c});y.11(I('4q',G),D(e,a){e.1g();1u=3u(1u);y.1q('57',L);y.T(I('5t',G));8(a){y.T(I('73',G))}4U(y.13());4U(y);z.5s();z.5P();8(G.3s=='36'){4U($1n)}O{$1n.8m(y)}H J});y.11(I('18',G),D(e){18(G,'3w P: '+7.P);18(G,'3w 1e: '+7.1e);18(G,'7d 8n: '+7.E.P);18(G,'7d 8o: '+7.E.1e);18(G,'4e 4f E M: '+7.E.M);8(7.N.1G){18(G,'4e 4f E 5Q 8p: '+7.N.E)}8(7.14.W){18(G,'4e 4f E 5Q 5y: '+7.14.E)}8(7.16.W){18(G,'4e 4f E 5Q 70: '+7.16.E)}H G.18});y.11('3o',D(e,n,o){e.1g();H y.1P(I(n,G),o)})};z.5s=D(){y.23(I('',G));y.23(I('',G,L));y.23('3o')};z.5N=D(){z.5P();4T(7,K.Q,G);3A(7,K.X,G);8(7.N.2F){F b=3N(7.N.2F);$1n.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}8(7.N.W){7.N.W.11(I(7.N.3L,G,L),D(e){e.2D();F a=L,b=3O;8(A.27){a='1G'}O 8(7.N.4X){a='3b';b=3N(7.N.4X)}8(a){y.T(I(a,G),b)}})}8(7.14.W){7.14.W.11(I(7.14.3L,G,L),D(e){e.2D();y.T(I('14',G))});8(7.14.2F){F b=3N(7.14.2F);7.14.W.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}}8(7.16.W){7.16.W.11(I(7.16.3L,G,L),D(e){e.2D();y.T(I('16',G))});8(7.16.2F){F b=3N(7.16.2F);7.16.W.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}}8(7.1b.1A){8(7.1b.2F){F b=3N(7.1b.2F);7.1b.1A.11(I('4V',G,L),D(){y.T(I('3b',G),b)}).11(I('4W',G,L),D(){y.T(I('3g',G))})}}8(7.14.2Y||7.16.2Y){$(4g).11(I('7e',G,L,J,J),D(e){F k=e.7f;8(k==7.16.2Y){e.2D();y.T(I('16',G))}8(k==7.14.2Y){e.2D();y.T(I('14',G))}})}8(7.1b.4Y){$(4g).11(I('7e',G,L,J,J),D(e){F k=e.7f;8(k>=49&&k<58){k=(k-49)*7.E.M;8(k<=K.Q){e.2D();y.T(I('3k',G),[k,0,J,7.1b])}}})}8($.1s.1r){F c='8q'8r 3l;8((c&&7.1r.4h)||(!c&&7.1r.5R)){F d=$.1L(J,{},7.14,7.1r),7g=$.1L(J,{},7.16,7.1r),5S=D(){y.T(I('14',G),[d])},5T=D(){y.T(I('16',G),[7g])};1F(7.2l){R'5c':R'7h':7.1r.2G.8s=5T;7.1r.2G.8t=5S;17;2J:7.1r.2G.8u=5T;7.1r.2G.8v=5S}8(A.1r){y.1r('4q')}$1n.1r(7.1r.2G);$1n.Z('7i','8w');A.1r=J}}8($.1s.1Q){8(7.1Q){F f=$.1L(J,{},7.14,7.1Q),7j=$.1L(J,{},7.16,7.1Q);8(A.1Q){$1n.23(I('1Q',G,L))}$1n.11(I('1Q',G,L),D(e,a){e.2D();8(a>0){y.T(I('14',G),[f])}O{y.T(I('16',G),[7j])}});A.1Q=J}}8(7.N.1G){y.T(I('1G',G),7.N.5U)}8(A.6v){F g=D(e){y.T(I('5t',G));8(7.N.5V&&!A.27){y.T(I('1G',G))}1Y(y.13(),7);y.T(I('4O',G))};F h=$(3l),4i=3O;8($.5W&&G.5X=='5W'){4i=$.5W(8x,g)}O 8($.4Z&&G.5X=='4Z'){4i=$.4Z(8y,g)}O{F i=0,5Y=0;4i=D(){F a=h.P(),5Z=h.1e();8(a!=i||5Z!=5Y){g();i=a;5Y=5Z}}}h.11(I('8z',G,L,J,J),4i)}};z.5P=D(){F a=I('',G),3P=I('',G,L);61=I('',G,L,J,J);$(4g).23(61);$(3l).23(61);$1n.23(3P);8(7.N.W){7.N.W.23(3P)}8(7.14.W){7.14.W.23(3P)}8(7.16.W){7.16.W.23(3P)}8(7.1b.1A){7.1b.1A.23(3P);8(7.1b.3K){7.1b.1A.13().2t()}}8(A.1r){y.1r('4q');$1n.Z('7i','2J');A.1r=L}8(A.1Q){A.1Q=L}4T(7,'4j',G);3A(7,'2N',G)};8(1k(w)){w={'18':w}}F A={'2l':'16','27':J,'26':L,'2d':L,'1Q':L,'1r':L},K={'Q':y.13().S,'X':0},1u={'N':3O,'1f':3O,'2L':2o(),'3v':0},V={'2d':L,'1M':0,'2L':0,'2u':'','1a':[]},2b={'3G':[],'3h':[]},2g=[],G=$.1L(J,{},$.1s.1v.7k,w),7={},31=$.1L(J,{},u),$1n=(G.3s=='36')?y.36():y.8A('<'+G.3s.55+' 8B="'+G.3s.7l+'" />').36();G.4o=y.4o;G.3T=$.1s.1v.3T++;G.2Z=(G.2Z&&$.1s.2Z)?'2Z':'8C';z.59(31,J,56);z.6D();z.6L();z.5N();8(2V(7.E.3m)){F B=7.E.3m}O{F B=[];8(7.E.3m!=0){B.1c(7.E.3m)}}8(7.25){B.8D(4k(7m(7.25),10))}8(B.S>0){1j(F a=0,l=B.S;a<l;a++){F s=B[a];8(s==0){62}8(s===J){s=3l.8E.79;8(s.S<1){62}}O 8(s==='7n'){s=1H.4l(1H.7n()*K.Q)}8(y.1P(I('3k',G),[s,0,J,{1V:'42'}])){17}}}F C=4Q(y,7),7o=3I(y.13(),7);8(7.7p){7.7p.1h($12,{'P':C.P,'1e':C.1e,'E':7o})}y.T(I('3H',G),[J,C]);y.T(I('5L',G));8(G.18){y.T(I('18',G))}H y};$.1s.1v.3T=1;$.1s.1v.5b={'2n':L,'3z':J,'1U':J,'2H':L,'2l':'1m','E':{'3m':0},'1K':{'2u':'7q','1M':6y,'2F':L,'3L':'5O','2O':L}};$.1s.1v.7k={'18':L,'2Z':L,'5X':'4Z','3y':{'45':'','7r':'8F'},'3s':{'55':'8G','7l':'8H'},'63':{}};$.1s.1v.7s=D(a){H'<a 8I="#"><7t>'+a+'</7t></a>'};$.1s.1v.7u=D(a){$(1l).Z('P',a+'%')};$.1s.1v.25={3F:D(n){n+='=';F b=4g.25.3Q(';');1j(F a=0,l=b.S;a<l;a++){F c=b[a];2h(c.8J(0)==' '){c=c.19(1)}8(c.3R(n)==0){H c.19(n.S)}}H 0},64:D(n,v,d){F e="";8(d){F a=7v 7w();a.8K(a.2o()+(d*24*60*60*8L));e="; 8M="+a.8N()}4g.25=n+'='+v+e+'; 8O=/'},2t:D(n){$.1s.1v.25.64(n,"",-1)}};D 48(d,e,c){8(c.2Z=='2Z'){8(e=='7q'){e='8P'}}H{1a:[],1M:d,8Q:d,2u:e,2L:2o()}}D 3x(s,c){1j(F a=0,l=s.1a.S;a<l;a++){F b=s.1a[a];8(!b){62}b[0][c.2Z](b[1],s.1M,s.2u,b[2])}}D 43(s,c){8(!1k(c)){c=J}8(1T(s.4z)){43(s.4z,c)}1j(F a=0,l=s.1a.S;a<l;a++){F b=s.1a[a];b[0].6M(J);8(c){b[0].Z(b[1]);8(1o(b[2])){b[2]()}}}8(1T(s.4A)){43(s.4A,c)}}D 5F(a,b,o){8(b){b.2t()}1F(o.1V){R'1w':R'3j':R'1I-1w':R'22-1w':a.Z('1t','');a.Z('1E',1);17}}D 4a(d,o,b,a,c){8(o[b]){o[b].1h(d,a)}8(c[b].S){1j(F i=0,l=c[b].S;i<l;i++){c[b][i].1h(d,a)}}H[]}D 5G(a,q,c){8(q.S){a.T(I(q[0][0],c),q[0][1]);q.8R()}H q}D 5z(b){b.1W(D(){F a=$(1l);a.1q('7x',a.2f(':3t')).4j()})}D 5D(b){8(b){b.1W(D(){F a=$(1l);8(!a.1q('7x')){a.4m()}})}}D 3u(t){8(t.N){8S(t.N)}8(t.1f){8T(t.1f)}H t}D 5E(a,b,c,d,e,f,g){H{'P':g.P,'1e':g.1e,'E':{'20':a,'8U':b,'M':c},'1K':{'E':d,'2l':e,'1M':f}}}D 5B(a,o,b,c){F d=a.1M;8(a.1V=='42'){H 0}8(d=='N'){d=o.1K.1M/o.1K.E*b}O 8(d<10){d=c/d}8(d<1){H 0}8(a.1V=='1w'){d=d/2}H 1H.78(d)}D 4T(o,t,c){F a=(Y(o.E.4C))?o.E.4C:o.E.M+1;8(t=='4m'||t=='4j'){F f=t}O 8(a>t){18(c,'2p 6O E ('+t+' Q, '+a+' 6P): 8V 8W.');F f='4j'}O{F f='4m'}F s=(f=='4m')?'2N':'3a',h=2y('3t',c);8(o.N.W){o.N.W[f]()[s](h)}8(o.14.W){o.14.W[f]()[s](h)}8(o.16.W){o.16.W[f]()[s](h)}8(o.1b.1A){o.1b.1A[f]()[s](h)}}D 3A(o,f,c){8(o.1U||o.3z)H;F a=(f=='2N'||f=='3a')?f:L,51=2y('8X',c);8(o.N.W&&a){o.N.W[a](51)}8(o.14.W){F b=a||(f==0)?'3a':'2N';o.14.W[b](51)}8(o.16.W){F b=a||(f==o.E.M)?'3a':'2N';o.16.W[b](51)}}D 3S(a,b){8(1o(b)){b=b.1h(a)}O 8(1z(b)){b={}}H b}D 6l(a,b){b=3S(a,b);8(Y(b)){b={'M':b}}O 8(b=='1d'){b={'M':b,'P':b,'1e':b}}O 8(!1T(b)){b={}}H b}D 6m(a,b){b=3S(a,b);8(Y(b)){8(b<=50){b={'E':b}}O{b={'1M':b}}}O 8(1p(b)){b={'2u':b}}O 8(!1T(b)){b={}}H b}D 52(a,b){b=3S(a,b);8(1p(b)){F c=65(b);8(c==-1){b=$(b)}O{b=c}}H b}D 6n(a,b){b=52(a,b);8(2v(b)){b={'W':b}}O 8(1k(b)){b={'1G':b}}O 8(Y(b)){b={'2K':b}}8(b.1f){8(1p(b.1f)||2v(b.1f)){b.1f={'2q':b.1f}}}H b}D 6z(a,b){8(1o(b.W)){b.W=b.W.1h(a)}8(1p(b.W)){b.W=$(b.W)}8(!1k(b.1G)){b.1G=J}8(!Y(b.5U)){b.5U=0}8(1z(b.4X)){b.4X=J}8(!1k(b.5V)){b.5V=J}8(!Y(b.2K)){b.2K=(b.1M<10)?8Y:b.1M*5}8(b.1f){8(1o(b.1f.2q)){b.1f.2q=b.1f.2q.1h(a)}8(1p(b.1f.2q)){b.1f.2q=$(b.1f.2q)}8(b.1f.2q){8(!1o(b.1f.4B)){b.1f.4B=$.1s.1v.7u}8(!Y(b.1f.5u)){b.1f.5u=50}}O{b.1f=L}}H b}D 5a(a,b){b=52(a,b);8(2v(b)){b={'W':b}}O 8(Y(b)){b={'2Y':b}}H b}D 5j(a,b){8(1o(b.W)){b.W=b.W.1h(a)}8(1p(b.W)){b.W=$(b.W)}8(1p(b.2Y)){b.2Y=65(b.2Y)}H b}D 6o(a,b){b=52(a,b);8(2v(b)){b={'1A':b}}O 8(1k(b)){b={'4Y':b}}H b}D 6A(a,b){8(1o(b.1A)){b.1A=b.1A.1h(a)}8(1p(b.1A)){b.1A=$(b.1A)}8(!Y(b.E)){b.E=L}8(!1k(b.4Y)){b.4Y=L}8(!1o(b.3K)&&!53(b.3K)){b.3K=$.1s.1v.7s}8(!Y(b.4S)){b.4S=0}H b}D 6p(a,b){8(1o(b)){b=b.1h(a)}8(1z(b)){b={'4h':L}}8(3p(b)){b={'4h':b}}O 8(Y(b)){b={'E':b}}H b}D 6B(a,b){8(!1k(b.4h)){b.4h=J}8(!1k(b.5R)){b.5R=L}8(!1T(b.2G)){b.2G={}}8(!1k(b.2G.7y)){b.2G.7y=L}H b}D 6q(a,b){8(1o(b)){b=b.1h(a)}8(3p(b)){b={}}O 8(Y(b)){b={'E':b}}O 8(1z(b)){b=L}H b}D 6C(a,b){H b}D 3J(a,b,c,d,e){8(1p(a)){a=$(a,e)}8(1T(a)){a=$(a,e)}8(2v(a)){a=e.13().7a(a);8(!1k(c)){c=L}}O{8(!1k(c)){c=J}}8(!Y(a)){a=0}8(!Y(b)){b=0}8(c){a+=d.X}a+=b;8(d.Q>0){2h(a>=d.Q){a-=d.Q}2h(a<0){a+=d.Q}}H a}D 4D(i,o,s){F t=0,x=0;1j(F a=s;a>=0;a--){F j=i.1N(a);t+=(j.2f(':M'))?j[o.d['2w']](J):0;8(t>o.3U){H x}8(a==0){a=i.S}x++}}D 7c(i,o,s){H 66(i,o.E.1t,o.E.U.4t,s)}D 6T(i,o,s,m){H 66(i,o.E.1t,m,s)}D 66(i,f,m,s){F t=0,x=0;1j(F a=s,l=i.S;a>=0;a--){x++;8(x==l){H x}F j=i.1N(a);8(j.2f(f)){t++;8(t==m){H x}}8(a==0){a=l}}}D 5x(a,o){H o.E.U.4t||a.13().19(0,o.E.M).1t(o.E.1t).S}D 32(i,o,s){F t=0,x=0;1j(F a=s,l=i.S-1;a<=l;a++){F j=i.1N(a);t+=(j.2f(':M'))?j[o.d['2w']](J):0;8(t>o.3U){H x}x++;8(x==l+1){H x}8(a==l){a=-1}}}D 5I(i,o,s,l){F v=32(i,o,s);8(!o.1U){8(s+v>l){v=l-s}}H v}D 3W(i,o,s){H 68(i,o.E.1t,o.E.U.4t,s,o.1U)}D 6Z(i,o,s,m){H 68(i,o.E.1t,m+1,s,o.1U)-1}D 68(i,f,m,s,c){F t=0,x=0;1j(F a=s,l=i.S-1;a<=l;a++){x++;8(x>=l){H x}F j=i.1N(a);8(j.2f(f)){t++;8(t==m){H x}}8(a==l){a=-1}}}D 3I(i,o){H i.19(0,o.E.M)}D 6V(i,o,n){H i.19(n,o.E.U.20+n)}D 6W(i,o){H i.19(0,o.E.M)}D 71(i,o){H i.19(0,o.E.U.20)}D 72(i,o,n){H i.19(n,o.E.M+n)}D 4x(i,o,d){8(o.1R){8(!1p(d)){d='2a'}i.1W(D(){F j=$(1l),m=4k(j.Z(o.d['1S']),10);8(!Y(m)){m=0}j.1q(d,m)})}}D 1Y(i,o,m){8(o.1R){F x=(1k(m))?m:L;8(!Y(m)){m=0}4x(i,o,'7z');i.1W(D(){F j=$(1l);j.Z(o.d['1S'],((x)?j.1q('7z'):m+j.1q('2a')))})}}D 41(i){i.1W(D(){F j=$(1l);j.1q('7A',j.7B('7C')||'')})}D 4U(i){i.1W(D(){F j=$(1l);j.7B('7C',j.1q('7A')||'')})}D 5r(o,b){F c=o.E.M,7D=o.E[o.d['P']],69=o[o.d['1e']],7E=3V(69);b.1W(D(){F a=$(1l),6a=7D-7F(a,o,'8Z');a[o.d['P']](6a);8(7E){a[o.d['1e']](4s(6a,69))}})}D 4Q(a,o){F b=a.36(),$i=a.13(),$v=3I($i,o),54=4I(4J($v,o,J),o,L);b.Z(54);8(o.1R){F p=o.1i,r=p[o.d[1]];8(o.1B&&r<0){r=0}F c=$v.2P();c.Z(o.d['1S'],c.1q('2a')+r);a.Z(o.d['3q'],p[o.d[0]]);a.Z(o.d['1m'],p[o.d[3]])}a.Z(o.d['P'],54[o.d['P']]+(2R($i,o,'P')*2));a.Z(o.d['1e'],6b($i,o,'1e'));H 54}D 4J(i,o,a){H[2R(i,o,'P',a),6b(i,o,'1e',a)]}D 6b(i,o,a,b){8(!1k(b)){b=L}8(Y(o[o.d[a]])&&b){H o[o.d[a]]}8(Y(o.E[o.d[a]])){H o.E[o.d[a]]}a=(a.6c().3R('P')>-1)?'2w':'3n';H 4n(i,o,a)}D 4n(i,o,b){F s=0;1j(F a=0,l=i.S;a<l;a++){F j=i.1N(a);F m=(j.2f(':M'))?j[o.d[b]](J):0;8(s<m){s=m}}H s}D 2R(i,o,b,c){8(!1k(c)){c=L}8(Y(o[o.d[b]])&&c){H o[o.d[b]]}8(Y(o.E[o.d[b]])){H o.E[o.d[b]]*i.S}F d=(b.6c().3R('P')>-1)?'2w':'3n',s=0;1j(F a=0,l=i.S;a<l;a++){F j=i.1N(a);s+=(j.2f(':M'))?j[o.d[d]](J):0}H s}D 5d(a,o,d){F b=a.2f(':M');8(b){a.4j()}F s=a.36()[o.d[d]]();8(b){a.4m()}H s}D 5e(o,a){H(Y(o[o.d['P']]))?o[o.d['P']]:a}D 6d(i,o,b){F s=L,v=L;1j(F a=0,l=i.S;a<l;a++){F j=i.1N(a);F c=(j.2f(':M'))?j[o.d[b]](J):0;8(s===L){s=c}O 8(s!=c){v=J}8(s==0){v=J}}H v}D 7F(i,o,d){H i[o.d['90'+d]](J)-i[o.d[d.6c()]]()}D 4s(s,o){8(3V(o)){o=4k(o.19(0,-1),10);8(!Y(o)){H s}s*=o/2I}H s}D I(n,c,a,b,d){8(!1k(a)){a=J}8(!1k(b)){b=J}8(!1k(d)){d=L}8(a){n=c.3y.45+n}8(b){n=n+'.'+c.3y.7r}8(b&&d){n+=c.3T}H n}D 2y(n,c){H(1p(c.63[n]))?c.63[n]:n}D 4I(a,o,p){8(!1k(p)){p=J}F b=(o.1R&&p)?o.1i:[0,0,0,0];F c={};c[o.d['P']]=a[0]+b[1]+b[3];c[o.d['1e']]=a[1]+b[0]+b[2];H c}D 3e(c,d){F e=[];1j(F a=0,7G=c.S;a<7G;a++){1j(F b=0,7H=d.S;b<7H;b++){8(d[b].3R(2X c[a])>-1&&1z(e[b])){e[b]=c[a];17}}}H e}D 6x(p){8(1z(p)){H[0,0,0,0]}8(Y(p)){H[p,p,p,p]}8(1p(p)){p=p.3Q('91').7I('').3Q('92').7I('').3Q(' ')}8(!2V(p)){H[0,0,0,0]}1j(F i=0;i<4;i++){p[i]=4k(p[i],10)}1F(p.S){R 0:H[0,0,0,0];R 1:H[p[0],p[0],p[0],p[0]];R 2:H[p[0],p[1],p[0],p[1]];R 3:H[p[0],p[1],p[2],p[1]];2J:H[p[0],p[1],p[2],p[3]]}}D 4H(a,o){F x=(Y(o[o.d['P']]))?1H.2z(o[o.d['P']]-2R(a,o,'P')):0;1F(o.1B){R'1m':H[0,x];R'35':H[x,0];R'5f':2J:H[1H.2z(x/2),1H.4l(x/2)]}}D 6r(o){F a=[['P','7J','2w','1e','7K','3n','1m','3q','1S',0,1,2,3],['1e','7K','3n','P','7J','2w','3q','1m','5p',3,2,1,0]];F b=a[0].S,7L=(o.2l=='35'||o.2l=='1m')?0:1;F c={};1j(F d=0;d<b;d++){c[a[0][d]]=a[7L][d]}H c}D 4E(x,o,a,b){F v=x;8(1o(a)){v=a.1h(b,v)}O 8(1p(a)){F p=a.3Q('+'),m=a.3Q('-');8(m.S>p.S){F c=J,6e=m[0],30=m[1]}O{F c=L,6e=p[0],30=p[1]}1F(6e){R'93':v=(x%2==1)?x-1:x;17;R'94':v=(x%2==0)?x-1:x;17;2J:v=x;17}30=4k(30,10);8(Y(30)){8(c){30=-30}v+=30}}8(!Y(v)||v<1){v=1}H v}D 2x(x,o,a,b){H 6f(4E(x,o,a,b),o.E.U)}D 6f(v,i){8(Y(i.34)&&v<i.34){v=i.34}8(Y(i.1X)&&v>i.1X){v=i.1X}8(v<1){v=1}H v}D 5k(s){8(!2V(s)){s=[[s]]}8(!2V(s[0])){s=[s]}1j(F j=0,l=s.S;j<l;j++){8(1p(s[j][0])){s[j][0]=$(s[j][0])}8(!1k(s[j][1])){s[j][1]=J}8(!1k(s[j][2])){s[j][2]=J}8(!Y(s[j][3])){s[j][3]=0}}H s}D 65(k){8(k=='35'){H 39}8(k=='1m'){H 37}8(k=='5c'){H 38}8(k=='7h'){H 40}H-1}D 5H(n,a,c){8(n){F v=a.1P(I('4p',c));$.1s.1v.25.64(n,v)}}D 7m(n){F c=$.1s.1v.25.3F(n);H(c=='')?0:c}D 6E(a,b){F c={};1j(F p=0,l=b.S;p<l;p++){c[b[p]]=a.Z(b[p])}H c}D 6s(a,b,c,d){8(!1T(a.U)){a.U={}}8(!1T(a.3M)){a.3M={}}8(a.3m==0&&Y(d)){a.3m=d}8(1T(a.M)){a.U.34=a.M.34;a.U.1X=a.M.1X;a.M=L}O 8(1p(a.M)){8(a.M=='1d'){a.U.1d=J}O{a.U.2c=a.M}a.M=L}O 8(1o(a.M)){a.U.2c=a.M;a.M=L}8(!1p(a.1t)){a.1t=(c.1t(':3t').S>0)?':M':'*'}8(!a[b.d['P']]){8(b.2H){18(J,'7M a '+b.d['P']+' 1j 75 E!');a[b.d['P']]=4n(c,b,'2w')}O{a[b.d['P']]=(6d(c,b,'2w'))?'1d':c[b.d['2w']](J)}}8(!a[b.d['1e']]){a[b.d['1e']]=(6d(c,b,'3n'))?'1d':c[b.d['3n']](J)}a.3M.P=a.P;a.3M.1e=a.1e;H a}D 6w(a,b){8(a.E[a.d['P']]=='1d'){a.E.U.1d=J}8(!a.E.U.1d){8(Y(a[a.d['P']])){a.E.M=1H.4l(a[a.d['P']]/a.E[a.d['P']])}O{a.E.M=1H.4l(b/a.E[a.d['P']]);a[a.d['P']]=a.E.M*a.E[a.d['P']];8(!a.E.U.2c){a.1B=L}}8(a.E.M=='95'||a.E.M<1){18(J,'2p a 5K 28 4f M E: 7M 46 "1d".');a.E.U.1d=J}}H a}D 6t(a,b,c){8(a=='N'){a=4n(c,b,'2w')}H a}D 6u(a,b,c){8(a=='N'){a=4n(c,b,'3n')}8(!a){a=b.E[b.d['1e']]}H a}D 5i(o,a){F p=4H(3I(a,o),o);o.1i[o.d[1]]=p[1];o.1i[o.d[3]]=p[0];H o}D 5g(o,a,b){F c=6f(1H.2z(o[o.d['P']]/o.E[o.d['P']]),o.E.U);8(c>a.S){c=a.S}F d=1H.4l(o[o.d['P']]/c);o.E.M=c;o.E[o.d['P']]=d;o[o.d['P']]=c*d;H o}D 3N(p){8(1p(p)){F i=(p.3R('96')>-1)?J:L,r=(p.3R('3g')>-1)?J:L}O{F i=r=L}H[i,r]}D 97(a){H(Y(a))?a:3O}D 6g(a){H(a===3O)}D 1z(a){H(6g(a)||2X a=='7N'||a===''||a==='7N')}D 2V(a){H(a 2W 98)}D 2v(a){H(a 2W 7O)}D 1T(a){H((a 2W 99||2X a=='2A')&&!6g(a)&&!2v(a)&&!2V(a))}D Y(a){H((a 2W 4e||2X a=='28')&&!9a(a))}D 1p(a){H((a 2W 9b||2X a=='2M')&&!1z(a)&&!3p(a)&&!53(a))}D 1o(a){H(a 2W 9c||2X a=='D')}D 1k(a){H(a 2W 9d||2X a=='3d'||3p(a)||53(a))}D 3p(a){H(a===J||a==='J')}D 53(a){H(a===L||a==='L')}D 3V(x){H(1p(x)&&x.19(-1)=='%')}D 2o(){H 7v 7w().2o()}D 3X(o,n){18(J,o+' 2f 9e, 9f 1j 9g 9h 9i 9j. 9k '+n+' 9l.')}D 18(d,m){8(!1z(3l.6h)&&!1z(3l.6h.7P)){8(1T(d)){F s=' ('+d.4o+')';d=d.18}O{F s=''}8(!d){H L}8(1p(m)){m='1v'+s+': '+m}O{m=['1v'+s+':',m]}3l.6h.7P(m)}H L}$.1L($.2u,{'9m':D(t){F a=t*t;H t*(-a*t+4*a-6*t+4)},'9n':D(t){H t*(4*t*t-9*t+6)},'9o':D(t){F a=t*t;H t*(33*a*a-9p*a*t+9q*a-67*t+15)}})})(7O);`,62,585,"|||||||opts|if|||||||||||||||||||||||||||||||function|items|var|conf|return|cf_e|true|itms|false|visible|auto|else|width|total|case|length|trigger|visibleConf|scrl|button|first|is_number|css||bind|tt0|children|prev||next|break|debug|slice|anims|pagination|push|variable|height|progress|stopPropagation|call|padding|for|is_boolean|this|left|wrp|is_function|is_string|data|swipe|fn|filter|tmrs|carouFredSel|fade|_onafter|_moveitems|is_undefined|container|align|_s_paddingold|_s_paddingcur|opacity|switch|play|Math|cover|_position|scroll|extend|duration|eq|_a_wrapper|triggerHandler|mousewheel|usePadding|marginRight|is_object|circular|fx|each|max|sz_resetMargin|i_cur_l|old|i_old_l|uncover|unbind||cookie|isScrolling|isPaused|number|a_cfs|_cfs_origCssMargin|clbk|adjust|isStopped|stopImmediatePropagation|is|queu|while|i_new|w_siz|nr|direction|avail_primary|synchronise|getTime|Not|bar|i_new_l|a_cur|remove|easing|is_jquery|outerWidth|cf_getItemsAdjust|cf_c|ceil|object|pR|_s_paddingnew|preventDefault|a_itm|pauseOnHover|options|responsive|100|default|timeoutDuration|startTime|string|removeClass|queue|last|i_skp|ms_getTotalSize|a_old|a_lef|a_dur|is_array|instanceof|typeof|key|transition|adj|opts_orig|gn_getVisibleItemsNext||min|right|parent||||addClass|pause|perc|boolean|cf_sortParams|scrolling|resume|onAfter|i_old|crossfade|slideTo|window|start|outerHeight|_cfs_triggerEvent|is_true|top|position|wrapper|hidden|sc_clearTimers|timePassed|Carousel|sc_startScroll|events|infinite|nv_enableNavi|i_siz|i_siz_vis|_a_paddingold|_a_paddingcur|get|onBefore|updatePageStatus|gi_getCurrentItems|gn_getItemIndex|anchorBuilder|event|sizesConf|bt_pauseOnHoverConfig|null|ns2|split|indexOf|go_getObject|serialNumber|maxDimension|is_percentage|gn_getVisibleItemsNextFilter|deprecated|orgCSS|zIndex||sz_storeOrigCss|none|sc_stopScroll|dur2|prefix|to|appendTo|sc_setScroll||sc_fireCallbacks|currentPage|end|before|Number|of|document|onTouch|onResize|hide|parseInt|floor|show|ms_getTrueLargestSize|selector|currentPosition|destroy|primarySizePercentage|ms_getPercentage|org|onTimeoutStart|onTimeoutPause|onTimeoutEnd|sz_storeMargin|stopped|pre|post|updater|minimum|gn_getVisibleItemsPrev|cf_getAdjust|onEnd|clone|cf_getAlignPadding|cf_mapWrapperSizes|ms_getSizes|a_wsz|a_new|not|a_cfs_vis|updateSizes|eval|sz_setSizes|pgs|deviation|nv_showNavi|sz_restoreOrigCss|mouseenter|mouseleave|pauseOnEvent|keys|throttle||di|go_getNaviObject|is_false|sz|element|starting_position|_cfs_isCarousel||_cfs_init|go_getPrevNextObject|defaults|up|ms_getParentSize|ms_getMaxDimension|center|in_getResponsiveValues|bottom|in_getAlignPadding|go_complementPrevNextObject|cf_getSynchArr|onPauseStart|onPausePause|onPauseEnd|pauseDuration|marginBottom|newPosition|sz_setResponsiveSizes|_cfs_unbind_events|finish|interval|type|conditions|gn_getVisibleOrg|backward|sc_hideHiddenItems|a_lef_vis|sc_getDuration|_a_paddingnew|sc_showHiddenItems|sc_mapCallbackArguments|sc_afterScroll|sc_fireQueue|cf_setCookie|gn_getVisibleItemsNextTestCircular|slideToPage|valid|linkAnchors|value|_cfs_bind_buttons|click|_cfs_unbind_buttons|scrolled|onMouse|swP|swN|delay|pauseOnResize|debounce|onWindowResize|_windowHeight|nh||ns3|continue|classnames|set|cf_getKeyCode|gn_getItemsPrevFilter||gn_getItemsNextFilter|seco|nw|ms_getLargestSize|toLowerCase|ms_hasVariableSizes|sta|cf_getItemAdjustMinMax|is_null|console|caroufredsel|No|found|go_getItemsObject|go_getScrollObject|go_getAutoObject|go_getPaginationObject|go_getSwipeObject|go_getMousewheelObject|cf_getDimensions|in_complementItems|in_complementPrimarySize|in_complementSecondarySize|upDateOnWindowResize|in_complementVisibleItems|cf_getPadding|500|go_complementAutoObject|go_complementPaginationObject|go_complementSwipeObject|go_complementMousewheelObject|_cfs_build|in_mapCss|textAlign|float|marginTop|marginLeft|absolute|_cfs_origCssZindex|_cfs_bind_events|stop|paused|enough|needed|page|slide_|configuration|gn_getScrollItemsPrevFilter|Scrolling|gi_getOldItemsPrev|gi_getNewItemsPrev|directscroll|concat|gn_getScrollItemsNextFilter|forward|gi_getOldItemsNext|gi_getNewItemsNext|jumpToStart|after|the|append|removeItem|round|hash|index|selected|gn_getVisibleItemsPrevFilter|Item|keyup|keyCode|scN|down|cursor|mcN|configs|classname|cf_getCookie|random|itm|onCreate|swing|namespace|pageAnchorBuilder|span|progressbarUpdater|new|Date|_cfs_isHidden|triggerOnTouchEnd|_cfs_tempCssMargin|_cfs_origCss|attr|style|newS|secp|ms_getPaddingBorderMargin|l1|l2|join|innerWidth|innerHeight|dx|Set|undefined|jQuery|log|caroufredsel_cookie_|relative|fixed|overflow|setInterval|setTimeout|or|Callback|returned|Page|resumed|currently|slide_prev|prependTo|slide_next|prevPage|nextPage|prepend|carousel|insertItem|Correct|insert|Appending|item|add|detach|currentVisible|body|find|Preventing|non|sliding|replaceWith|widths|heights|automatically|ontouchstart|in|swipeUp|swipeDown|swipeLeft|swipeRight|move|200|300|resize|wrap|class|animate|unshift|location|cfs|div|caroufredsel_wrapper|href|charAt|setTime|1000|expires|toGMTString|path|ease|orgDuration|shift|clearTimeout|clearInterval|skipped|Hiding|navigation|disabled|2500|Width|outer|px|em|even|odd|Infinity|immediate|bt_mousesheelNumber|Array|Object|isNaN|String|Function|Boolean|DEPRECATED|support|it|will|be|removed|Use|instead|quadratic|cubic|elastic|106|126".split("|"),0,{})),(function(e){var n,w,l,c,m,f,T,A,D,z,O=0,E={},L=[],v=0,p={},S=[],k=null,F=new Image,G=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,Z=/[^\.]\.(swf)\s*$/i,te,M=1,V=0,ie="",R,Y,N=!1,Q=e.extend(e("<div/>")[0],{prop:0}),oe=e.browser.msie&&e.browser.version<7&&!window.XMLHttpRequest,b=function(){w.hide(),F.onerror=F.onload=null,k&&k.abort(),n.empty()},Le=function(){if(E.onError(L,O,E)===!1){w.hide(),N=!1;return}E.titleShow=!1,E.width="auto",E.height="auto",n.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),J()},ce=function(){var le=L[O],Oe,ft,Ct,Rt,Wt,nn;if(b(),E=e.extend({},e.fn.fancybox.defaults,typeof e(le).data("fancybox")=="undefined"?E:e(le).data("fancybox")),nn=E.onStart(L,O,E),nn===!1){N=!1;return}else typeof nn=="object"&&(E=e.extend(E,nn));if(Ct=E.title||(le.nodeName?e(le).attr("title"):le.title)||"",le.nodeName&&!E.orig&&(E.orig=e(le).children("img:first").length?e(le).children("img:first"):e(le)),Ct===""&&E.orig&&E.titleFromAlt&&(Ct=E.orig.attr("alt")),Oe=E.href||(le.nodeName?e(le).attr("href"):le.href)||null,(/^(?:javascript)/i.test(Oe)||Oe=="#")&&(Oe=null),E.type?(ft=E.type,Oe||(Oe=E.content)):E.content?ft="html":Oe&&(Oe.match(G)?ft="image":Oe.match(Z)?ft="swf":e(le).hasClass("iframe")?ft="iframe":Oe.indexOf("#")===0?ft="inline":ft="ajax"),!ft){Le();return}switch(ft=="inline"&&(le=Oe.substr(Oe.indexOf("#")),ft=e(le).length>0?"inline":"ajax"),E.type=ft,E.href=Oe,E.title=Ct,E.autoDimensions&&(E.type=="html"||E.type=="inline"||E.type=="ajax"?(E.width="auto",E.height="auto"):E.autoDimensions=!1),E.modal&&(E.overlayShow=!0,E.hideOnOverlayClick=!1,E.hideOnContentClick=!1,E.enableEscapeButton=!1,E.showCloseButton=!1),E.padding=parseInt(E.padding,10),E.margin=parseInt(E.margin,10),n.css("padding",E.padding+E.margin),e(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){e(this).replaceWith(f.children())}),ft){case"html":n.html(E.content),J();break;case"inline":if(e(le).parent().is("#fancybox-content")===!0){N=!1;return}e('<div class="fancybox-inline-tmp" />').hide().insertBefore(e(le)).bind("fancybox-cleanup",function(){e(this).replaceWith(f.children())}).bind("fancybox-cancel",function(){e(this).replaceWith(n.children())}),e(le).appendTo(n),J();break;case"image":N=!1,e.fancybox.showActivity(),F=new Image,F.onerror=function(){Le()},F.onload=function(){N=!0,F.onerror=F.onload=null,me()},F.src=Oe;break;case"swf":E.scrolling="no",Rt='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+E.width+'" height="'+E.height+'"><param name="movie" value="'+Oe+'"></param>',Wt="",e.each(E.swf,function(rn,Zt){Rt+='<param name="'+rn+'" value="'+Zt+'"></param>',Wt+=" "+rn+'="'+Zt+'"'}),Rt+='<embed src="'+Oe+'" type="application/x-shockwave-flash" width="'+E.width+'" height="'+E.height+'"'+Wt+"></embed></object>",n.html(Rt),J();break;case"ajax":N=!1,e.fancybox.showActivity(),E.ajax.win=E.ajax.success,k=e.ajax(e.extend({},E.ajax,{url:Oe,data:E.ajax.data||{},error:function(rn,Zt,Vt){rn.status>0&&Le()},success:function(rn,Zt,Vt){var Qt=typeof Vt=="object"?Vt:k;if(Qt.status==200){if(typeof E.ajax.win=="function")if(nn=E.ajax.win(Oe,rn,Zt,Vt),nn===!1){w.hide();return}else(typeof nn=="string"||typeof nn=="object")&&(rn=nn);n.html(rn),J()}}}));break;case"iframe":h();break}},J=function(){var le=E.width,Oe=E.height;le.toString().indexOf("%")>-1?le=parseInt((e(window).width()-E.margin*2)*parseFloat(le)/100,10)+"px":le=le=="auto"?"auto":le+"px",Oe.toString().indexOf("%")>-1?Oe=parseInt((e(window).height()-E.margin*2)*parseFloat(Oe)/100,10)+"px":Oe=Oe=="auto"?"auto":Oe+"px",n.wrapInner('<div style="width:'+le+";height:"+Oe+";overflow: "+(E.scrolling=="auto"?"auto":E.scrolling=="yes"?"scroll":"hidden")+';position:relative;"></div>'),E.width=n.width(),E.height=n.height(),h()},me=function(){E.width=F.width,E.height=F.height,e("<img />").attr({id:"fancybox-img",src:F.src,alt:E.title}).appendTo(n),h()},h=function(){e("#fancybox-outer").css("background","white");var le,Oe;if(w.hide(),c.is(":visible")&&p.onCleanup(S,v,p)===!1){e.event.trigger("fancybox-cancel"),N=!1;return}if(N=!0,e(f.add(l)).unbind(),e(window).unbind("resize.fb scroll.fb"),e(document).unbind("keydown.fb"),c.is(":visible")&&p.titlePosition!=="outside"&&c.css("height",c.height()),S=L,v=O,p=E,p.overlayShow?(l.css({"background-color":p.overlayColor,opacity:p.overlayOpacity,cursor:p.hideOnOverlayClick?"pointer":"auto",height:e(document).height()}),l.is(":visible")||(oe&&e("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"}),l.show())):l.hide(),Y=Pe(),Ue(),c.is(":visible")){e(T.add(D).add(z)).hide(),le=c.position(),R={top:le.top,left:le.left,width:c.width(),height:c.height()},Oe=R.width==Y.width&&R.height==Y.height,f.fadeTo(p.changeFade,.3,function(){var ft=function(){f.html(n.contents()).fadeTo(p.changeFade,1,ot)};e.event.trigger("fancybox-change"),f.empty().removeAttr("filter").css({"border-width":p.padding,width:Y.width-p.padding*2,height:E.autoDimensions?"auto":Y.height-V-p.padding*2}),Oe?ft():(Q.prop=0,e(Q).animate({prop:1},{duration:p.changeSpeed,easing:p.easingChange,step:ze,complete:ft}))});return}if(c.removeAttr("style"),f.css("border-width",p.padding),p.transitionIn=="elastic"){R=xt(),f.html(n.contents()),c.show(),p.opacity&&(Y.opacity=0),Q.prop=0,e(Q).animate({prop:1},{duration:p.speedIn,easing:p.easingIn,step:ze,complete:ot});return}p.titlePosition=="inside"&&V>0&&A.show(),f.css({width:Y.width-p.padding*2,height:E.autoDimensions?"auto":Y.height-V-p.padding*2}).html(n.contents()),c.css(Y).fadeIn(p.transitionIn=="none"?0:p.speedIn,ot)},Re=function(le){return le&&le.length?p.titlePosition=="float"?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+le+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+p.titlePosition+'">'+le+"</div>":!1},Ue=function(){if(ie=p.title||"",V=0,A.empty().removeAttr("style").removeClass(),p.titleShow===!1){A.hide();return}if(ie=e.isFunction(p.titleFormat)?p.titleFormat(ie,S,v,p):Re(ie),!ie||ie===""){A.hide();return}switch(A.addClass("fancybox-title-"+p.titlePosition).html(ie).appendTo("body").show(),p.titlePosition){case"inside":A.css({width:Y.width-p.padding*2,marginLeft:p.padding,marginRight:p.padding}),V=A.outerHeight(!0),A.appendTo(m),Y.height+=V;break;case"over":A.css({marginLeft:p.padding,width:Y.width-p.padding*2,bottom:p.padding}).appendTo(m);break;case"float":A.css("left",parseInt((A.width()-Y.width-40)/2,10)*-1).appendTo(c);break;default:A.css({width:Y.width-p.padding*2,paddingLeft:p.padding,paddingRight:p.padding}).appendTo(c);break}A.hide()},Xe=function(){if((p.enableEscapeButton||p.enableKeyboardNav)&&e(document).bind("keydown.fb",function(le){le.keyCode==27&&p.enableEscapeButton?(le.preventDefault(),e.fancybox.close()):(le.keyCode==37||le.keyCode==39)&&p.enableKeyboardNav&&le.target.tagName!=="INPUT"&&le.target.tagName!=="TEXTAREA"&&le.target.tagName!=="SELECT"&&(le.preventDefault(),e.fancybox[le.keyCode==37?"prev":"next"]())}),!p.showNavArrows){D.hide(),z.hide();return}(p.cyclic&&S.length>1||v!==0)&&D.show(),(p.cyclic&&S.length>1||v!=S.length-1)&&z.show()},ot=function(){e.support.opacity||(f.get(0).style.removeAttribute("filter"),c.get(0).style.removeAttribute("filter")),E.autoDimensions&&f.css("height","auto"),c.css("height","auto"),ie&&ie.length&&A.show(),p.showCloseButton&&T.show(),Xe(),p.hideOnContentClick&&f.bind("click",e.fancybox.close),p.hideOnOverlayClick&&l.bind("click",e.fancybox.close),e(window).bind("resize.fb",e.fancybox.resize),p.centerOnScroll&&e(window).bind("scroll.fb",e.fancybox.center),p.type=="iframe"&&e('<iframe id="fancybox-frame" name="fancybox-frame'+new Date().getTime()+'" frameborder="0" hspace="0" '+(e.browser.msie?'allowtransparency="true""':"")+' scrolling="'+E.scrolling+'" src="'+p.href+'"></iframe>').appendTo(f),c.show(),N=!1,e.fancybox.center(),p.onComplete(S,v,p),Tt()},Tt=function(){var le,Oe;S.length-1>v&&(le=S[v+1].href,typeof le!="undefined"&&le.match(G)&&(Oe=new Image,Oe.src=le)),v>0&&(le=S[v-1].href,typeof le!="undefined"&&le.match(G)&&(Oe=new Image,Oe.src=le))},ze=function(le){var Oe={width:parseInt(R.width+(Y.width-R.width)*le,10),height:parseInt(R.height+(Y.height-R.height)*le,10),top:parseInt(R.top+(Y.top-R.top)*le,10),left:parseInt(R.left+(Y.left-R.left)*le,10)};typeof Y.opacity!="undefined"&&(Oe.opacity=le<.5?.5:le),c.css(Oe),f.css({width:Oe.width-p.padding*2,height:Oe.height-V*le-p.padding*2})},et=function(){return[e(window).width()-p.margin*2,e(window).height()-p.margin*2,e(document).scrollLeft()+p.margin,e(document).scrollTop()+p.margin]},Pe=function(){var le=et(),Oe={},ft=p.autoScale,Ct=p.padding*2,Rt;return p.width.toString().indexOf("%")>-1?Oe.width=parseInt(le[0]*parseFloat(p.width)/100,10):Oe.width=p.width+Ct,p.height.toString().indexOf("%")>-1?Oe.height=parseInt(le[1]*parseFloat(p.height)/100,10):Oe.height=p.height+Ct,ft&&(Oe.width>le[0]||Oe.height>le[1])&&(E.type=="image"||E.type=="swf"?(Rt=p.width/p.height,Oe.width>le[0]&&(Oe.width=le[0],Oe.height=parseInt((Oe.width-Ct)/Rt+Ct,10)),Oe.height>le[1]&&(Oe.height=le[1],Oe.width=parseInt((Oe.height-Ct)*Rt+Ct,10))):(Oe.width=Math.min(Oe.width,le[0]),Oe.height=Math.min(Oe.height,le[1]))),Oe.top=parseInt(Math.max(le[3]-20,le[3]+(le[1]-Oe.height-40)*.5),10),Oe.left=parseInt(Math.max(le[2]-20,le[2]+(le[0]-Oe.width-40)*.5),10),Oe},We=function(le){var Oe=le.offset();return Oe.top+=parseInt(le.css("paddingTop"),10)||0,Oe.left+=parseInt(le.css("paddingLeft"),10)||0,Oe.top+=parseInt(le.css("border-top-width"),10)||0,Oe.left+=parseInt(le.css("border-left-width"),10)||0,Oe.width=le.width(),Oe.height=le.height(),Oe},xt=function(){var le=E.orig?e(E.orig):!1,Oe={},ft,Ct;return le&&le.length?(ft=We(le),Oe={width:ft.width+p.padding*2,height:ft.height+p.padding*2,top:ft.top-p.padding-20,left:ft.left-p.padding-20}):(Ct=et(),Oe={width:p.padding*2,height:p.padding*2,top:parseInt(Ct[3]+Ct[1]*.5,10),left:parseInt(Ct[2]+Ct[0]*.5,10)}),Oe},Et=function(){if(!w.is(":visible")){clearInterval(te);return}e("div",w).css("top",M*-40+"px"),M=(M+1)%12};e.fn.fancybox=function(le){return e(this).length?(e(this).data("fancybox",e.extend({},le,e.metadata?e(this).metadata():{})).unbind("click.fb").bind("click.fb",function(Oe){if(Oe.preventDefault(),!N){N=!0,e(this).blur(),L=[],O=0;var ft=e(this).attr("rel")||"";!ft||ft==""||ft==="nofollow"?L.push(this):(L=e("a[rel="+ft+"], area[rel="+ft+"]"),O=L.index(this)),ce()}}),this):this},e.fancybox=function(le){var Oe;if(!N){if(N=!0,Oe=typeof arguments[1]!="undefined"?arguments[1]:{},L=[],O=parseInt(Oe.index,10)||0,e.isArray(le)){for(var ft=0,Ct=le.length;ft<Ct;ft++)typeof le[ft]=="object"?e(le[ft]).data("fancybox",e.extend({},Oe,le[ft])):le[ft]=e({}).data("fancybox",e.extend({content:le[ft]},Oe));L=jQuery.merge(L,le)}else typeof le=="object"?e(le).data("fancybox",e.extend({},Oe,le)):le=e({}).data("fancybox",e.extend({content:le},Oe)),L.push(le);(O>L.length||O<0)&&(O=0),ce()}},e.fancybox.showActivity=function(){clearInterval(te),w.show(),te=setInterval(Et,66)},e.fancybox.hideActivity=function(){w.hide()},e.fancybox.next=function(){return e.fancybox.pos(v+1)},e.fancybox.prev=function(){return e.fancybox.pos(v-1)},e.fancybox.pos=function(le){N||(le=parseInt(le),L=S,le>-1&&le<S.length?(O=le,ce()):p.cyclic&&S.length>1&&(O=le>=S.length?0:S.length-1,ce()))},e.fancybox.cancel=function(){N||(N=!0,e.event.trigger("fancybox-cancel"),b(),E.onCancel(L,O,E),N=!1)},e.fancybox.close=function(){if(N||c.is(":hidden"))return;if(N=!0,p&&(typeof p.onCleanup!="function"||p.onCleanup(S,v,p)===!1)){N=!1;return}b(),e(T.add(D).add(z)).hide(),e(f.add(l)).unbind(),e(window).unbind("resize.fb scroll.fb"),e(document).unbind("keydown.fb"),f.find("iframe").attr("src",oe&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank"),p.titlePosition!=="inside"&&A.empty(),c.stop();function le(){l.fadeOut("fast"),A.empty().hide(),c.hide(),e.event.trigger("fancybox-cleanup"),f.empty(),p.onClosed(S,v,p),S=E=[],v=O=0,p=E={},N=!1}if(p.transitionOut=="elastic"){R=xt();var Oe=c.position();Y={top:Oe.top,left:Oe.left,width:c.width(),height:c.height()},p.opacity&&(Y.opacity=1),A.empty().hide(),Q.prop=1,e(Q).animate({prop:0},{duration:p.speedOut,easing:p.easingOut,step:ze,complete:le})}else c.fadeOut(p.transitionOut=="none"?0:p.speedOut,le)},e.fancybox.resize=function(){l.is(":visible")&&l.css("height",e(document).height()),e.fancybox.center(!0)},e.fancybox.center=function(){if(!(p&&p.center===!1)){var le,Oe;N||(Oe=arguments[0]===!0?1:0,le=et(),!(!Oe&&(c.width()>le[0]||c.height()>le[1]))&&c.stop().animate({top:parseInt(Math.max(le[3]-20,le[3]+(le[1]-f.height()-40)*.5-p.padding)),left:parseInt(Math.max(le[2]-20,le[2]+(le[0]-f.width()-40)*.5-p.padding))},typeof arguments[0]=="number"?arguments[0]:200))}},e.fancybox.init=function(){e("#fancybox-wrap").length||(e("body").append(n=e('<div id="fancybox-tmp"></div>'),w=e('<div id="fancybox-loading"><div></div></div>'),l=e('<div id="fancybox-overlay"></div>'),c=e('<div id="fancybox-wrap"></div>')),m=e('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(c),m.append(f=e('<div id="fancybox-content"></div>'),T=e('<a id="fancybox-close"></a>'),A=e('<div id="fancybox-title"></div>'),D=e('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),z=e('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>')),T.click(e.fancybox.close),w.click(e.fancybox.cancel),D.click(function(le){le.preventDefault(),e.fancybox.prev()}),z.click(function(le){le.preventDefault(),e.fancybox.next()}),e.fn.mousewheel&&c.bind("mousewheel.fb",function(le,Oe){N?le.preventDefault():(e(le.target).get(0).clientHeight==0||e(le.target).get(0).scrollHeight===e(le.target).get(0).clientHeight)&&(le.preventDefault(),e.fancybox[Oe>0?"prev":"next"]())}),e.support.opacity||c.addClass("fancybox-ie"),oe&&(w.addClass("fancybox-ie6"),c.addClass("fancybox-ie6"),e('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(m)))},e.fn.fancybox.defaults={padding:10,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,center:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}},e(document).ready(function(){e.fancybox.init()})})(jQuery),(function(e){function n(c){var m=c||window.event,f=[].slice.call(arguments,1),T=0,A=!0,D=0,z=0;return c=e.event.fix(m),c.type="mousewheel",m.wheelDelta&&(T=m.wheelDelta/120),m.detail&&(T=-m.detail/3),z=T,m.axis!==void 0&&m.axis===m.HORIZONTAL_AXIS&&(z=0,D=-1*T),m.wheelDeltaY!==void 0&&(z=m.wheelDeltaY/120),m.wheelDeltaX!==void 0&&(D=-1*m.wheelDeltaX/120),f.unshift(c,T,D,z),(e.event.dispatch||e.event.handle).apply(this,f)}var w=["DOMMouseScroll","mousewheel"];if(e.event.fixHooks)for(var l=w.length;l;)e.event.fixHooks[w[--l]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var c=w.length;c;)this.addEventListener(w[--c],n,!1);else this.onmousewheel=n},teardown:function(){if(this.removeEventListener)for(var c=w.length;c;)this.removeEventListener(w[--c],n,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(c){return c?this.bind("mousewheel",c):this.trigger("mousewheel")},unmousewheel:function(c){return this.unbind("mousewheel",c)}})})(jQuery),(function(e){var n={init:function(f){var m={set_width:!1,set_height:!1,horizontalScroll:!1,scrollInertia:950,mouseWheel:!0,mouseWheelPixels:"auto",autoDraggerLength:!0,autoHideScrollbar:!1,snapAmount:null,snapOffset:0,scrollButtons:{enable:!1,scrollType:"continuous",scrollSpeed:"auto",scrollAmount:40},advanced:{updateOnBrowserResize:!0,updateOnContentResize:!1,autoExpandHorizontalScroll:!1,autoScrollOnFocus:!0,normalizeMouseWheelDelta:!1},contentTouchScroll:!0,callbacks:{onScrollStart:function(){},onScroll:function(){},onTotalScroll:function(){},onTotalScrollBack:function(){},onTotalScrollOffset:0,onTotalScrollBackOffset:0,whileScrolling:function(){}},theme:"light"},f=e.extend(!0,m,f);return this.each(function(){var T=e(this);if(f.set_width&&T.css("width",f.set_width),f.set_height&&T.css("height",f.set_height),!e(document).data("mCustomScrollbar-index"))e(document).data("mCustomScrollbar-index","1");else{var A=parseInt(e(document).data("mCustomScrollbar-index"));e(document).data("mCustomScrollbar-index",A+1)}T.wrapInner("<div class='mCustomScrollBox mCS-"+f.theme+"' id='mCSB_"+e(document).data("mCustomScrollbar-index")+"' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_"+e(document).data("mCustomScrollbar-index"));var D=T.children(".mCustomScrollBox");if(f.horizontalScroll){D.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />");var z=D.children(".mCSB_h_wrapper");z.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({width:z.children().outerWidth(),position:"relative"}).unwrap()}else D.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />");var O=D.children(".mCSB_container");e.support.touch&&O.addClass("mCS_touch"),O.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");var E=D.children(".mCSB_scrollTools"),L=E.children(".mCSB_draggerContainer"),v=L.children(".mCSB_dragger");if(f.horizontalScroll?v.data("minDraggerWidth",v.width()):v.data("minDraggerHeight",v.height()),f.scrollButtons.enable&&(f.horizontalScroll?E.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>"):E.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>")),D.bind("scroll",function(){T.is(".mCS_disabled")||D.scrollTop(0).scrollLeft(0)}),T.data({mCS_Init:!0,mCustomScrollbarIndex:e(document).data("mCustomScrollbar-index"),horizontalScroll:f.horizontalScroll,scrollInertia:f.scrollInertia,scrollEasing:"mcsEaseOut",mouseWheel:f.mouseWheel,mouseWheelPixels:f.mouseWheelPixels,autoDraggerLength:f.autoDraggerLength,autoHideScrollbar:f.autoHideScrollbar,snapAmount:f.snapAmount,snapOffset:f.snapOffset,scrollButtons_enable:f.scrollButtons.enable,scrollButtons_scrollType:f.scrollButtons.scrollType,scrollButtons_scrollSpeed:f.scrollButtons.scrollSpeed,scrollButtons_scrollAmount:f.scrollButtons.scrollAmount,autoExpandHorizontalScroll:f.advanced.autoExpandHorizontalScroll,autoScrollOnFocus:f.advanced.autoScrollOnFocus,normalizeMouseWheelDelta:f.advanced.normalizeMouseWheelDelta,contentTouchScroll:f.contentTouchScroll,onScrollStart_Callback:f.callbacks.onScrollStart,onScroll_Callback:f.callbacks.onScroll,onTotalScroll_Callback:f.callbacks.onTotalScroll,onTotalScrollBack_Callback:f.callbacks.onTotalScrollBack,onTotalScroll_Offset:f.callbacks.onTotalScrollOffset,onTotalScrollBack_Offset:f.callbacks.onTotalScrollBackOffset,whileScrolling_Callback:f.callbacks.whileScrolling,bindEvent_scrollbar_drag:!1,bindEvent_content_touch:!1,bindEvent_scrollbar_click:!1,bindEvent_mousewheel:!1,bindEvent_buttonsContinuous_y:!1,bindEvent_buttonsContinuous_x:!1,bindEvent_buttonsPixels_y:!1,bindEvent_buttonsPixels_x:!1,bindEvent_focusin:!1,bindEvent_autoHideScrollbar:!1,mCSB_buttonScrollRight:!1,mCSB_buttonScrollLeft:!1,mCSB_buttonScrollDown:!1,mCSB_buttonScrollUp:!1}),f.horizontalScroll)T.css("max-width")!=="none"&&(f.advanced.updateOnContentResize||(f.advanced.updateOnContentResize=!0));else if(T.css("max-height")!=="none"){var p=!1,S=parseInt(T.css("max-height"));T.css("max-height").indexOf("%")>=0&&(p=S,S=T.parent().height()*p/100),T.css("overflow","hidden"),D.css("max-height",S)}if(T.mCustomScrollbar("update"),f.advanced.updateOnBrowserResize){var k,F=e(window).width(),G=e(window).height();e(window).bind("resize."+T.data("mCustomScrollbarIndex"),function(){k&&clearTimeout(k),k=setTimeout(function(){if(!T.is(".mCS_disabled")&&!T.is(".mCS_destroyed")){var M=e(window).width(),V=e(window).height();(F!==M||G!==V)&&(T.css("max-height")!=="none"&&p&&D.css("max-height",T.parent().height()*p/100),T.mCustomScrollbar("update"),F=M,G=V)}},150)})}if(f.advanced.updateOnContentResize){var Z;if(f.horizontalScroll)var te=O.outerWidth();else var te=O.outerHeight();Z=setInterval(function(){if(f.horizontalScroll){f.advanced.autoExpandHorizontalScroll&&O.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:O.outerWidth(),position:"relative"}).unwrap();var M=O.outerWidth()}else var M=O.outerHeight();M!=te&&(T.mCustomScrollbar("update"),te=M)},300)}})},update:function(){var c=e(this),m=c.children(".mCustomScrollBox"),f=m.children(".mCSB_container");f.removeClass("mCS_no_scrollbar"),c.removeClass("mCS_disabled mCS_destroyed"),m.scrollTop(0).scrollLeft(0);var T=m.children(".mCSB_scrollTools"),A=T.children(".mCSB_draggerContainer"),D=A.children(".mCSB_dragger");if(c.data("horizontalScroll")){var z=T.children(".mCSB_buttonLeft"),O=T.children(".mCSB_buttonRight"),E=m.width();c.data("autoExpandHorizontalScroll")&&f.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:f.outerWidth(),position:"relative"}).unwrap();var L=f.outerWidth()}else var v=T.children(".mCSB_buttonUp"),p=T.children(".mCSB_buttonDown"),S=m.height(),k=f.outerHeight();if(k>S&&!c.data("horizontalScroll")){T.css("display","block");var F=A.height();if(c.data("autoDraggerLength")){var G=Math.round(S/k*F),Z=D.data("minDraggerHeight");if(G<=Z)D.css({height:Z});else if(G>=F-10){var te=F-10;D.css({height:te})}else D.css({height:G});D.children(".mCSB_dragger_bar").css({"line-height":D.height()+"px"})}var M=D.height(),V=(k-S)/(F-M);c.data("scrollAmount",V).mCustomScrollbar("scrolling",m,f,A,D,v,p,z,O);var ie=Math.abs(f.position().top);c.mCustomScrollbar("scrollTo",ie,{scrollInertia:0,trigger:"internal"})}else if(L>E&&c.data("horizontalScroll")){T.css("display","block");var R=A.width();if(c.data("autoDraggerLength")){var Y=Math.round(E/L*R),N=D.data("minDraggerWidth");if(Y<=N)D.css({width:N});else if(Y>=R-10){var Q=R-10;D.css({width:Q})}else D.css({width:Y})}var oe=D.width(),V=(L-E)/(R-oe);c.data("scrollAmount",V).mCustomScrollbar("scrolling",m,f,A,D,v,p,z,O);var ie=Math.abs(f.position().left);c.mCustomScrollbar("scrollTo",ie,{scrollInertia:0,trigger:"internal"})}else m.unbind("mousewheel focusin"),c.data("horizontalScroll")?D.add(f).css("left",0):D.add(f).css("top",0),T.css("display","none"),f.addClass("mCS_no_scrollbar"),c.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1})},scrolling:function(c,m,f,T,A,D,z,O){var E=e(this);if(!E.data("bindEvent_scrollbar_drag")){var L,v;e.support.msPointer?(T.bind("MSPointerDown",function(N){N.preventDefault(),E.data({on_drag:!0}),T.addClass("mCSB_dragger_onDrag");var Q=e(this),oe=Q.offset(),b=N.originalEvent.pageX-oe.left,Le=N.originalEvent.pageY-oe.top;b<Q.width()&&b>0&&Le<Q.height()&&Le>0&&(L=Le,v=b)}),e(document).bind("MSPointerMove."+E.data("mCustomScrollbarIndex"),function(N){if(N.preventDefault(),E.data("on_drag")){var Q=T,oe=Q.offset(),b=N.originalEvent.pageX-oe.left,Le=N.originalEvent.pageY-oe.top;p(L,v,Le,b)}}).bind("MSPointerUp."+E.data("mCustomScrollbarIndex"),function(N){E.data({on_drag:!1}),T.removeClass("mCSB_dragger_onDrag")})):(T.bind("mousedown touchstart",function(N){N.preventDefault(),N.stopImmediatePropagation();var Q=e(this),oe=Q.offset(),b,Le;if(N.type==="touchstart"){var ce=N.originalEvent.touches[0]||N.originalEvent.changedTouches[0];b=ce.pageX-oe.left,Le=ce.pageY-oe.top}else E.data({on_drag:!0}),T.addClass("mCSB_dragger_onDrag"),b=N.pageX-oe.left,Le=N.pageY-oe.top;b<Q.width()&&b>0&&Le<Q.height()&&Le>0&&(L=Le,v=b)}).bind("touchmove",function(N){N.preventDefault(),N.stopImmediatePropagation();var Q=N.originalEvent.touches[0]||N.originalEvent.changedTouches[0],oe=e(this),b=oe.offset(),Le=Q.pageX-b.left,ce=Q.pageY-b.top;p(L,v,ce,Le)}),e(document).bind("mousemove."+E.data("mCustomScrollbarIndex"),function(N){if(E.data("on_drag")){var Q=T,oe=Q.offset(),b=N.pageX-oe.left,Le=N.pageY-oe.top;p(L,v,Le,b)}}).bind("mouseup."+E.data("mCustomScrollbarIndex"),function(N){E.data({on_drag:!1}),T.removeClass("mCSB_dragger_onDrag")})),E.data({bindEvent_scrollbar_drag:!0})}function p(N,Q,oe,b){E.data("horizontalScroll")?E.mCustomScrollbar("scrollTo",T.position().left-Q+b,{moveDragger:!0,trigger:"internal"}):E.mCustomScrollbar("scrollTo",T.position().top-N+oe,{moveDragger:!0,trigger:"internal"})}if(e.support.touch&&E.data("contentTouchScroll")&&!E.data("bindEvent_content_touch")){var S,k,F,G,Z,te,M;m.bind("touchstart",function(N){N.stopImmediatePropagation(),S=N.originalEvent.touches[0]||N.originalEvent.changedTouches[0],k=e(this),F=k.offset(),Z=S.pageX-F.left,G=S.pageY-F.top,te=G,M=Z}),m.bind("touchmove",function(N){N.preventDefault(),N.stopImmediatePropagation(),S=N.originalEvent.touches[0]||N.originalEvent.changedTouches[0],k=e(this).parent(),F=k.offset(),Z=S.pageX-F.left,G=S.pageY-F.top,E.data("horizontalScroll")?E.mCustomScrollbar("scrollTo",M-Z,{trigger:"internal"}):E.mCustomScrollbar("scrollTo",te-G,{trigger:"internal"})})}if(E.data("bindEvent_scrollbar_click")||(f.bind("click",function(N){var Q=(N.pageY-f.offset().top)*E.data("scrollAmount"),oe=e(N.target);E.data("horizontalScroll")&&(Q=(N.pageX-f.offset().left)*E.data("scrollAmount")),(oe.hasClass("mCSB_draggerContainer")||oe.hasClass("mCSB_draggerRail"))&&E.mCustomScrollbar("scrollTo",Q,{trigger:"internal",scrollEasing:"draggerRailEase"})}),E.data({bindEvent_scrollbar_click:!0})),E.data("mouseWheel")&&(E.data("bindEvent_mousewheel")||(c.bind("mousewheel",function(N,Q){var oe,b=E.data("mouseWheelPixels"),Le=Math.abs(m.position().top),ce=T.position().top,J=f.height()-T.height();E.data("normalizeMouseWheelDelta")&&(Q<0?Q=-1:Q=1),b==="auto"&&(b=100+Math.round(E.data("scrollAmount")/2)),E.data("horizontalScroll")&&(ce=T.position().left,J=f.width()-T.width(),Le=Math.abs(m.position().left)),(Q>0&&ce!==0||Q<0&&ce!==J)&&(N.preventDefault(),N.stopImmediatePropagation()),oe=Le-Q*b,E.mCustomScrollbar("scrollTo",oe,{trigger:"internal"})}),E.data({bindEvent_mousewheel:!0}))),E.data("scrollButtons_enable"))if(E.data("scrollButtons_scrollType")==="pixels"){let N=function(Q){T.data("preventAction")||(T.data("preventAction",!0),E.mCustomScrollbar("scrollTo",Q,{trigger:"internal"}))};E.data("horizontalScroll")?(O.add(z).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend",V,ie),E.data({bindEvent_buttonsContinuous_x:!1}),E.data("bindEvent_buttonsPixels_x")||(O.bind("click",function(Q){Q.preventDefault(),N(Math.abs(m.position().left)+E.data("scrollButtons_scrollAmount"))}),z.bind("click",function(Q){Q.preventDefault(),N(Math.abs(m.position().left)-E.data("scrollButtons_scrollAmount"))}),E.data({bindEvent_buttonsPixels_x:!0}))):(D.add(A).unbind("mousedown touchstart MSPointerDown mouseup MSPointerUp mouseout MSPointerOut touchend",V,ie),E.data({bindEvent_buttonsContinuous_y:!1}),E.data("bindEvent_buttonsPixels_y")||(D.bind("click",function(Q){Q.preventDefault(),N(Math.abs(m.position().top)+E.data("scrollButtons_scrollAmount"))}),A.bind("click",function(Q){Q.preventDefault(),N(Math.abs(m.position().top)-E.data("scrollButtons_scrollAmount"))}),E.data({bindEvent_buttonsPixels_y:!0})))}else{let N=function(){var Q=E.data("scrollButtons_scrollSpeed");return E.data("scrollButtons_scrollSpeed")==="auto"&&(Q=Math.round((E.data("scrollInertia")+100)/40)),Q};if(E.data("horizontalScroll")){if(O.add(z).unbind("click"),E.data({bindEvent_buttonsPixels_x:!1}),!E.data("bindEvent_buttonsContinuous_x")){O.bind("mousedown touchstart MSPointerDown",function(Q){Q.preventDefault();var oe=N();E.data({mCSB_buttonScrollRight:setInterval(function(){E.mCustomScrollbar("scrollTo",Math.abs(m.position().left)+oe,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var V=function(Q){Q.preventDefault(),clearInterval(E.data("mCSB_buttonScrollRight"))};O.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",V),z.bind("mousedown touchstart MSPointerDown",function(Q){Q.preventDefault();var oe=N();E.data({mCSB_buttonScrollLeft:setInterval(function(){E.mCustomScrollbar("scrollTo",Math.abs(m.position().left)-oe,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var ie=function(Q){Q.preventDefault(),clearInterval(E.data("mCSB_buttonScrollLeft"))};z.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",ie),E.data({bindEvent_buttonsContinuous_x:!0})}}else if(D.add(A).unbind("click"),E.data({bindEvent_buttonsPixels_y:!1}),!E.data("bindEvent_buttonsContinuous_y")){D.bind("mousedown touchstart MSPointerDown",function(Q){Q.preventDefault();var oe=N();E.data({mCSB_buttonScrollDown:setInterval(function(){E.mCustomScrollbar("scrollTo",Math.abs(m.position().top)+oe,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var R=function(Q){Q.preventDefault(),clearInterval(E.data("mCSB_buttonScrollDown"))};D.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",R),A.bind("mousedown touchstart MSPointerDown",function(Q){Q.preventDefault();var oe=N();E.data({mCSB_buttonScrollUp:setInterval(function(){E.mCustomScrollbar("scrollTo",Math.abs(m.position().top)-oe,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var Y=function(Q){Q.preventDefault(),clearInterval(E.data("mCSB_buttonScrollUp"))};A.bind("mouseup touchend MSPointerUp mouseout MSPointerOut",Y),E.data({bindEvent_buttonsContinuous_y:!0})}}E.data("autoScrollOnFocus")&&(E.data("bindEvent_focusin")||(c.bind("focusin",function(){c.scrollTop(0).scrollLeft(0);var N=e(document.activeElement);if(N.is("input,textarea,select,button,a[tabindex],area,object")){var Q=m.position().top,oe=N.position().top,b=c.height()-N.outerHeight();E.data("horizontalScroll")&&(Q=m.position().left,oe=N.position().left,b=c.width()-N.outerWidth()),(Q+oe<0||Q+oe>b)&&E.mCustomScrollbar("scrollTo",oe,{trigger:"internal"})}}),E.data({bindEvent_focusin:!0}))),E.data("autoHideScrollbar")&&(E.data("bindEvent_autoHideScrollbar")||(c.bind("mouseenter",function(N){c.addClass("mCS-mouse-over"),w.showScrollbar.call(c.children(".mCSB_scrollTools"))}).bind("mouseleave touchend",function(N){c.removeClass("mCS-mouse-over"),N.type==="mouseleave"&&w.hideScrollbar.call(c.children(".mCSB_scrollTools"))}),E.data({bindEvent_autoHideScrollbar:!0})))},scrollTo:function(c,A){var f=e(this),T={moveDragger:!1,trigger:"external",callbacks:!0,scrollInertia:f.data("scrollInertia"),scrollEasing:f.data("scrollEasing")},A=e.extend(T,A),D,z=f.children(".mCustomScrollBox"),O=z.children(".mCSB_container"),E=z.children(".mCSB_scrollTools"),L=E.children(".mCSB_draggerContainer"),v=L.children(".mCSB_dragger"),p=draggerSpeed=A.scrollInertia,S,k,F,G;if(!O.hasClass("mCS_no_scrollbar")&&(f.data({mCS_trigger:A.trigger}),f.data("mCS_Init")&&(A.callbacks=!1),c||c===0)){if(typeof c=="number")A.moveDragger?(D=c,f.data("horizontalScroll")?c=v.position().left*f.data("scrollAmount"):c=v.position().top*f.data("scrollAmount"),draggerSpeed=0):D=c/f.data("scrollAmount");else if(typeof c=="string"){var Z;c==="top"?Z=0:c==="bottom"&&!f.data("horizontalScroll")?Z=O.outerHeight()-z.height():c==="left"?Z=0:c==="right"&&f.data("horizontalScroll")?Z=O.outerWidth()-z.width():c==="first"?Z=f.find(".mCSB_container").find(":first"):c==="last"?Z=f.find(".mCSB_container").find(":last"):Z=f.find(c),Z.length===1?(f.data("horizontalScroll")?c=Z.position().left:c=Z.position().top,D=c/f.data("scrollAmount")):D=c=Z}if(f.data("horizontalScroll")){f.data("onTotalScrollBack_Offset")&&(k=-f.data("onTotalScrollBack_Offset")),f.data("onTotalScroll_Offset")&&(G=z.width()-O.outerWidth()+f.data("onTotalScroll_Offset")),D<0?(D=c=0,clearInterval(f.data("mCSB_buttonScrollLeft")),k||(S=!0)):D>=L.width()-v.width()?(D=L.width()-v.width(),c=z.width()-O.outerWidth(),clearInterval(f.data("mCSB_buttonScrollRight")),G||(F=!0)):c=-c;var te=f.data("snapAmount");te&&(c=Math.round(c/te)*te-f.data("snapOffset")),w.mTweenAxis.call(this,v[0],"left",Math.round(D),draggerSpeed,A.scrollEasing),w.mTweenAxis.call(this,O[0],"left",Math.round(c),p,A.scrollEasing,{onStart:function(){A.callbacks&&!f.data("mCS_tweenRunning")&&M("onScrollStart"),f.data("autoHideScrollbar")&&w.showScrollbar.call(E)},onUpdate:function(){A.callbacks&&M("whileScrolling")},onComplete:function(){A.callbacks&&(M("onScroll"),(S||k&&O.position().left>=k)&&M("onTotalScrollBack"),(F||G&&O.position().left<=G)&&M("onTotalScroll")),v.data("preventAction",!1),f.data("mCS_tweenRunning",!1),f.data("autoHideScrollbar")&&(z.hasClass("mCS-mouse-over")||w.hideScrollbar.call(E))}})}else{f.data("onTotalScrollBack_Offset")&&(k=-f.data("onTotalScrollBack_Offset")),f.data("onTotalScroll_Offset")&&(G=z.height()-O.outerHeight()+f.data("onTotalScroll_Offset")),D<0?(D=c=0,clearInterval(f.data("mCSB_buttonScrollUp")),k||(S=!0)):D>=L.height()-v.height()?(D=L.height()-v.height(),c=z.height()-O.outerHeight(),clearInterval(f.data("mCSB_buttonScrollDown")),G||(F=!0)):c=-c;var te=f.data("snapAmount");te&&(c=Math.round(c/te)*te-f.data("snapOffset")),w.mTweenAxis.call(this,v[0],"top",Math.round(D),draggerSpeed,A.scrollEasing),w.mTweenAxis.call(this,O[0],"top",Math.round(c),p,A.scrollEasing,{onStart:function(){A.callbacks&&!f.data("mCS_tweenRunning")&&M("onScrollStart"),f.data("autoHideScrollbar")&&w.showScrollbar.call(E)},onUpdate:function(){A.callbacks&&M("whileScrolling")},onComplete:function(){A.callbacks&&(M("onScroll"),(S||k&&O.position().top>=k)&&M("onTotalScrollBack"),(F||G&&O.position().top<=G)&&M("onTotalScroll")),v.data("preventAction",!1),f.data("mCS_tweenRunning",!1),f.data("autoHideScrollbar")&&(z.hasClass("mCS-mouse-over")||w.hideScrollbar.call(E))}})}f.data("mCS_Init")&&f.data({mCS_Init:!1})}function M(V){switch(this.mcs={top:O.position().top,left:O.position().left,draggerTop:v.position().top,draggerLeft:v.position().left,topPct:Math.round(100*Math.abs(O.position().top)/Math.abs(O.outerHeight()-z.height())),leftPct:Math.round(100*Math.abs(O.position().left)/Math.abs(O.outerWidth()-z.width()))},V){case"onScrollStart":f.data("mCS_tweenRunning",!0).data("onScrollStart_Callback").call(f,this.mcs);break;case"whileScrolling":f.data("whileScrolling_Callback").call(f,this.mcs);break;case"onScroll":f.data("onScroll_Callback").call(f,this.mcs);break;case"onTotalScrollBack":f.data("onTotalScrollBack_Callback").call(f,this.mcs);break;case"onTotalScroll":f.data("onTotalScroll_Callback").call(f,this.mcs);break}}},stop:function(){var c=e(this),m=c.children().children(".mCSB_container"),f=c.children().children().children().children(".mCSB_dragger");w.mTweenAxisStop.call(this,m[0]),w.mTweenAxisStop.call(this,f[0])},disable:function(c){var m=e(this),f=m.children(".mCustomScrollBox"),T=f.children(".mCSB_container"),A=f.children(".mCSB_scrollTools"),D=A.children().children(".mCSB_dragger");f.unbind("mousewheel focusin mouseenter mouseleave touchend"),T.unbind("touchstart touchmove"),c&&(m.data("horizontalScroll")?D.add(T).css("left",0):D.add(T).css("top",0)),A.css("display","none"),T.addClass("mCS_no_scrollbar"),m.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1,bindEvent_content_touch:!1,bindEvent_autoHideScrollbar:!1}).addClass("mCS_disabled")},destroy:function(){var c=e(this);c.removeClass("mCustomScrollbar _mCS_"+c.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove(),e(document).unbind("mousemove."+c.data("mCustomScrollbarIndex")+" mouseup."+c.data("mCustomScrollbarIndex")+" MSPointerMove."+c.data("mCustomScrollbarIndex")+" MSPointerUp."+c.data("mCustomScrollbarIndex")),e(window).unbind("resize."+c.data("mCustomScrollbarIndex"))}},w={showScrollbar:function(){this.stop().animate({opacity:1},"fast")},hideScrollbar:function(){this.stop().animate({opacity:0},"fast")},mTweenAxis:function(c,m,f,T,A,z){var z=z||{},O=z.onStart||function(){},E=z.onUpdate||function(){},L=z.onComplete||function(){},v=Z(),p,S=0,k=c.offsetTop,F=c.style;m==="left"&&(k=c.offsetLeft);var G=f-k;ie(),V();function Z(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():new Date().getTime()}function te(){S||O.call(),S=Z()-v,M(),S>=c._time&&(c._time=S>c._time?S+p-(S-c._time):S+p-1,c._time<S+1&&(c._time=S+1)),c._time<T?c._id=_request(te):L.call()}function M(){T>0?(c.currVal=R(c._time,k,G,T,A),F[m]=Math.round(c.currVal)+"px"):F[m]=f+"px",E.call()}function V(){p=1e3/60,c._time=S+p,_request=window.requestAnimationFrame?window.requestAnimationFrame:function(Y){return M(),setTimeout(Y,.01)},c._id=_request(te)}function ie(){c._id!=null&&(window.requestAnimationFrame?window.cancelAnimationFrame(c._id):clearTimeout(c._id),c._id=null)}function R(Y,N,Q,oe,b){switch(b){case"linear":return Q*Y/oe+N;case"easeOutQuad":return Y/=oe,-Q*Y*(Y-2)+N;break;case"easeInOutQuad":if(Y/=oe/2,Y<1)return Q/2*Y*Y+N;return Y--,-Q/2*(Y*(Y-2)-1)+N;break;case"easeOutCubic":return Y/=oe,Y--,Q*(Y*Y*Y+1)+N;break;case"easeOutQuart":return Y/=oe,Y--,-Q*(Y*Y*Y*Y-1)+N;break;case"easeOutQuint":return Y/=oe,Y--,Q*(Y*Y*Y*Y*Y+1)+N;break;case"easeOutCirc":return Y/=oe,Y--,Q*Math.sqrt(1-Y*Y)+N;break;case"easeOutSine":return Q*Math.sin(Y/oe*(Math.PI/2))+N;case"easeOutExpo":return Q*(-Math.pow(2,-10*Y/oe)+1)+N;case"mcsEaseOut":var Le=(Y/=oe)*Y,ce=Le*Y;return N+Q*(.499999999999997*ce*Le+-2.5*Le*Le+5.5*ce+-6.5*Le+4*Y);case"draggerRailEase":if(Y/=oe/2,Y<1)return Q/2*Y*Y*Y+N;return Y-=2,Q/2*(Y*Y*Y+2)+N;break}}},mTweenAxisStop:function(c){c._id!=null&&(window.requestAnimationFrame?window.cancelAnimationFrame(c._id):clearTimeout(c._id),c._id=null)},rafPolyfill:function(){for(var c=["ms","moz","webkit","o"],m=c.length;--m>-1&&!window.requestAnimationFrame;)window.requestAnimationFrame=window[c[m]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[m]+"CancelAnimationFrame"]||window[c[m]+"CancelRequestAnimationFrame"]}};w.rafPolyfill.call(),e.support.touch="ontouchstart"in window,e.support.msPointer=window.navigator.msPointerEnabled;var l=document.location.protocol=="https:"?"https:":"http:";e.event.special.mousewheel||document.write('<script src="'+l+'//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js"><\/script>'),e.fn.mCustomScrollbar=function(c){if(n[c])return n[c].apply(this,Array.prototype.slice.call(arguments,1));if(typeof c=="object"||!c)return n.init.apply(this,arguments);e.error("Method "+c+" does not exist")}})(jQuery);/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 20112014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */(function(e){if(e.support.touch="ontouchend"in document,!e.support.touch)return;var n=e.ui.mouse.prototype,w=n._mouseInit,l=n._mouseDestroy,c;function m(f,T){if(!(f.originalEvent.touches.length>1)){f.preventDefault();var A=f.originalEvent.changedTouches[0],D=document.createEvent("MouseEvents");D.initMouseEvent(T,!0,!0,window,1,A.screenX,A.screenY,A.clientX,A.clientY,!1,!1,!1,!1,0,null),console.log("dispatch simulated event: "+T),f.target.dispatchEvent(D)}}n._touchStart=function(f){console.log("mouseProto._touchStart");var T=this;c||!T._mouseCapture(f.originalEvent.changedTouches[0])||(c=!0,T._touchMoved=!1,m(f,"mouseover"),m(f,"mousemove"),m(f,"mousedown"))},n._touchMove=function(f){console.log("mouseProto._touchMove"),c&&(this._touchMoved=!0,m(f,"mousemove"))},n._touchEnd=function(f){c&&(m(f,"mouseup"),m(f,"mouseout"),this._touchMoved||m(f,"click"),c=!1)},n._mouseInit=function(){var f=this;f.element.bind({touchstart:e.proxy(f,"_touchStart"),touchmove:e.proxy(f,"_touchMove"),touchend:e.proxy(f,"_touchEnd")}),w.call(f)},n._mouseDestroy=function(){var f=this;f.element.unbind({touchstart:e.proxy(f,"_touchStart"),touchmove:e.proxy(f,"_touchMove"),touchend:e.proxy(f,"_touchEnd")}),l.call(f)}})(jQuery),(function(e,n){typeof exports=="object"&&typeof module<"u"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(e=typeof globalThis<"u"?globalThis:e||self,n(e.Annotorious={}))})(void 0,function(e){"use strict";var n=Object.defineProperty,w=(t,r,o)=>r in t?n(t,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[r]=o,l=(t,r,o)=>w(t,typeof r!="symbol"?r+"":r,o);function c(){}function m(t,r){for(const o in r)t[o]=r[o];return t}function f(t){return t()}function T(){return Object.create(null)}function A(t){t.forEach(f)}function D(t){return typeof t=="function"}function z(t,r){return t!=t?r==r:t!==r||t&&typeof t=="object"||typeof t=="function"}function O(t){return Object.keys(t).length===0}function E(t,...r){if(t==null){for(const s of r)s(void 0);return c}const o=t.subscribe(...r);return o.unsubscribe?()=>o.unsubscribe():o}function L(t,r,o){t.$$.on_destroy.push(E(r,o))}function v(t,r,o,s){if(t){const d=p(t,r,o,s);return t[0](d)}}function p(t,r,o,s){return t[1]&&s?m(o.ctx.slice(),t[1](s(r))):o.ctx}function S(t,r,o,s){if(t[2]&&s){const d=t[2](s(o));if(r.dirty===void 0)return d;if(typeof d=="object"){const g=[],x=Math.max(r.dirty.length,d.length);for(let C=0;C<x;C+=1)g[C]=r.dirty[C]|d[C];return g}return r.dirty|d}return r.dirty}function k(t,r,o,s,d,g){if(d){const x=p(r,o,s,g);t.p(x,d)}}function F(t){if(t.ctx.length>32){const r=[],o=t.ctx.length/32;for(let s=0;s<o;s++)r[s]=-1;return r}return-1}function G(t){const r={};for(const o in t)o[0]!=="$"&&(r[o]=t[o]);return r}function Z(t){return t!=null?t:""}function te(t,r){t.appendChild(r)}function M(t,r,o){t.insertBefore(r,o||null)}function V(t){t.parentNode&&t.parentNode.removeChild(t)}function ie(t,r){for(let o=0;o<t.length;o+=1)t[o]&&t[o].d(r)}function R(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Y(t){return document.createTextNode(t)}function N(){return Y(" ")}function Q(){return Y("")}function oe(t,r,o,s){return t.addEventListener(r,o,s),()=>t.removeEventListener(r,o,s)}function b(t,r,o){o==null?t.removeAttribute(r):t.getAttribute(r)!==o&&t.setAttribute(r,o)}function Le(t){return Array.from(t.childNodes)}function ce(t,r,o){t.classList.toggle(r,!!o)}function J(t,r,{bubbles:o=!1,cancelable:s=!1}={}){return new CustomEvent(t,{detail:r,bubbles:o,cancelable:s})}let me;function h(t){me=t}function Re(){if(!me)throw new Error("Function called outside component initialization");return me}function Ue(t){Re().$$.on_mount.push(t)}function Xe(){const t=Re();return(r,o,{cancelable:s=!1}={})=>{const d=t.$$.callbacks[r];if(d){const g=J(r,o,{cancelable:s});return d.slice().forEach(x=>{x.call(t,g)}),!g.defaultPrevented}return!0}}function ot(t,r){const o=t.$$.callbacks[r.type];o&&o.slice().forEach(s=>s.call(this,r))}const Tt=[],ze=[];let et=[];const Pe=[],We=Promise.resolve();let xt=!1;function Et(){xt||(xt=!0,We.then(Rt))}function le(){return Et(),We}function Oe(t){et.push(t)}const ft=new Set;let Ct=0;function Rt(){if(Ct!==0)return;const t=me;do{try{for(;Ct<Tt.length;){const r=Tt[Ct];Ct++,h(r),Wt(r.$$)}}catch(r){throw Tt.length=0,Ct=0,r}for(h(null),Tt.length=0,Ct=0;ze.length;)ze.pop()();for(let r=0;r<et.length;r+=1){const o=et[r];ft.has(o)||(ft.add(o),o())}et.length=0}while(Tt.length);for(;Pe.length;)Pe.pop()();xt=!1,ft.clear(),h(t)}function Wt(t){if(t.fragment!==null){t.update(),A(t.before_update);const r=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,r),t.after_update.forEach(Oe)}}function nn(t){const r=[],o=[];et.forEach(s=>t.indexOf(s)===-1?r.push(s):o.push(s)),o.forEach(s=>s()),et=r}const rn=new Set;let Zt;function Vt(){Zt={r:0,c:[],p:Zt}}function Qt(){Zt.r||A(Zt.c),Zt=Zt.p}function st(t,r){t&&t.i&&(rn.delete(t),t.i(r))}function ht(t,r,o,s){if(t&&t.o){if(rn.has(t))return;rn.add(t),Zt.c.push(()=>{rn.delete(t),s&&(o&&t.d(1),s())}),t.o(r)}else s&&s()}function qt(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Xt(t){t&&t.c()}function ue(t,r,o){const{fragment:s,after_update:d}=t.$$;s&&s.m(r,o),Oe(()=>{const g=t.$$.on_mount.map(f).filter(D);t.$$.on_destroy?t.$$.on_destroy.push(...g):A(g),t.$$.on_mount=[]}),d.forEach(Oe)}function se(t,r){const o=t.$$;o.fragment!==null&&(nn(o.after_update),A(o.on_destroy),o.fragment&&o.fragment.d(r),o.on_destroy=o.fragment=null,o.ctx=[])}function Ne(t,r){t.$$.dirty[0]===-1&&(Tt.push(t),Et(),t.$$.dirty.fill(0)),t.$$.dirty[r/31|0]|=1<<r%31}function Me(t,r,o,s,d,g,x=null,C=[-1]){const I=me;h(t);const H=t.$$={fragment:null,ctx:[],props:g,update:c,not_equal:d,bound:T(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(r.context||(I?I.$$.context:[])),callbacks:T(),dirty:C,skip_bound:!1,root:r.target||I.$$.root};x&&x(H.root);let W=!1;if(H.ctx=o?o(t,r.props||{},(B,ne,...we)=>{const ge=we.length?we[0]:ne;return H.ctx&&d(H.ctx[B],H.ctx[B]=ge)&&(!H.skip_bound&&H.bound[B]&&H.bound[B](ge),W&&Ne(t,B)),ne}):[],H.update(),W=!0,A(H.before_update),H.fragment=s?s(H.ctx):!1,r.target){if(r.hydrate){const B=Le(r.target);H.fragment&&H.fragment.l(B),B.forEach(V)}else H.fragment&&H.fragment.c();r.intro&&st(t.$$.fragment),ue(t,r.target,r.anchor),Rt()}h(I)}class it{constructor(){l(this,"$$"),l(this,"$$set")}$destroy(){se(this,1),this.$destroy=c}$on(r,o){if(!D(o))return c;const s=this.$$.callbacks[r]||(this.$$.callbacks[r]=[]);return s.push(o),()=>{const d=s.indexOf(o);d!==-1&&s.splice(d,1)}}$set(r){this.$$set&&!O(r)&&(this.$$.skip_bound=!0,this.$$set(r),this.$$.skip_bound=!1)}}const vt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(vt);var at=(t=>(t.ELLIPSE="ELLIPSE",t.MULTIPOLYGON="MULTIPOLYGON",t.POLYGON="POLYGON",t.POLYLINE="POLYLINE",t.RECTANGLE="RECTANGLE",t.LINE="LINE",t))(at||{});function _t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var kt={exports:{}};(function(t){(function(){function r(C,I){var H=C.x-I.x,W=C.y-I.y;return H*H+W*W}function o(C,I,H){var W=I.x,B=I.y,ne=H.x-W,we=H.y-B;if(ne!==0||we!==0){var ge=((C.x-W)*ne+(C.y-B)*we)/(ne*ne+we*we);ge>1?(W=H.x,B=H.y):ge>0&&(W+=ne*ge,B+=we*ge)}return ne=C.x-W,we=C.y-B,ne*ne+we*we}function s(C,I){for(var H=C[0],W=[H],B,ne=1,we=C.length;ne<we;ne++)B=C[ne],r(B,H)>I&&(W.push(B),H=B);return H!==B&&W.push(B),W}function d(C,I,H,W,B){for(var ne=W,we,ge=I+1;ge<H;ge++){var de=o(C[ge],C[I],C[H]);de>ne&&(we=ge,ne=de)}ne>W&&(we-I>1&&d(C,I,we,W,B),B.push(C[we]),H-we>1&&d(C,we,H,W,B))}function g(C,I){var H=C.length-1,W=[C[0]];return d(C,0,H,I,W),W.push(C[H]),W}function x(C,I,H){if(C.length<=2)return C;var W=I!==void 0?I*I:1;return C=H?C:s(C,W),C=g(C,W),C}t.exports=x,t.exports.default=x})()})(kt);var Nt=kt.exports;const Gt=_t(Nt),Bt={},Jt=(t,r)=>Bt[t]=r,un=t=>Bt[t.type].area(t),mn=(t,r,o,s)=>Bt[t.type].intersects(t,r,o,s),Ut=t=>{let r=1/0,o=1/0,s=-1/0,d=-1/0;return t.forEach(([g,x])=>{r=Math.min(r,g),o=Math.min(o,x),s=Math.max(s,g),d=Math.max(d,x)}),{minX:r,minY:o,maxX:s,maxY:d}},vn=t=>{let r=0,o=t.length-1;for(let s=0;s<t.length;s++)r+=(t[o][0]+t[s][0])*(t[o][1]-t[s][1]),o=s;return Math.abs(.5*r)},dn=(t,r,o)=>{let s=!1;for(let d=0,g=t.length-1;d<t.length;g=d++){const x=t[d][0],C=t[d][1],I=t[g][0],H=t[g][1];C>o!=H>o&&r<(I-x)*(o-C)/(H-C)+x&&(s=!s)}return s},Bn=(t,r=!0)=>{let o="M ";return t.forEach(([s,d],g)=>{g===0?o+=`${s},${d}`:o+=` L ${s},${d}`}),r&&(o+=" Z"),o},tn=(t,r=1)=>{const o=t.map(([s,d])=>({x:s,y:d}));return Gt(o,r,!0).map(s=>[s.x,s.y])},wn=(t,r)=>{const o=Math.abs(r[0]-t[0]),s=Math.abs(r[1]-t[1]);return Math.sqrt(Math.pow(o,2)+Math.pow(s,2))},Zn={area:t=>Math.PI*t.geometry.rx*t.geometry.ry,intersects:(t,r,o)=>{const{cx:s,cy:d,rx:g,ry:x}=t.geometry,C=0,I=Math.cos(C),H=Math.sin(C),W=r-s,B=o-d,ne=I*W+H*B,we=H*W-I*B;return ne*ne/(g*g)+we*we/(x*x)<=1}};Jt(at.ELLIPSE,Zn);const Ii={area:t=>0,intersects:(t,r,o,s=2)=>{const[[d,g],[x,C]]=t.geometry.points,I=Math.abs((C-g)*r-(x-d)*o+x*g-C*d),H=wn([d,g],[x,C]);return I/H<=s}};Jt(at.LINE,Ii);const Pi={area:t=>{const{polygons:r}=t.geometry;return r.reduce((o,s)=>{const[d,...g]=s.rings,x=vn(d.points),C=g.reduce((I,H)=>I+vn(H.points),0);return o+x-C},0)},intersects:(t,r,o)=>{const{polygons:s}=t.geometry;for(const d of s){const[g,...x]=d.rings;if(dn(g.points,r,o)){let C=!1;for(const I of x)if(dn(I.points,r,o)){C=!0;break}if(!C)return!0}}return!1}},On=t=>{const r=t.reduce((o,s)=>[...o,...s.rings[0].points],[]);return Ut(r)},fn=t=>t.rings.map(r=>Bn(r.points)).join(" "),li=t=>t.polygons.reduce((r,o)=>[...r,...o.rings.reduce((s,d)=>[...s,...d.points],[])],[]),Di=(t,r=1)=>{const o=t.geometry.polygons.map(d=>{const g=d.rings.map(C=>{const I=tn(C.points,r);return{...C,points:I}}),x=Ut(g[0].points);return{...d,rings:g,bounds:x}}),s=On(o);return{...t,geometry:{...t.geometry,polygons:o,bounds:s}}};Jt(at.MULTIPOLYGON,Pi);const Oi={area:t=>{const r=t.geometry.points;return vn(r)},intersects:(t,r,o)=>{const s=t.geometry.points;return dn(s,r,o)}},_n=(t,r=1)=>{const o=tn(t.geometry.points,r),s=Ut(o);return{...t,geometry:{...t.geometry,bounds:s,points:o}}};Jt(at.POLYGON,Oi);const Sn={area:t=>{const r=t.geometry;if(!r.closed||r.points.length<3)return 0;const o=Ln(r.points,r.closed);return vn(o)},intersects:(t,r,o,s=2)=>{const d=t.geometry;if(d.closed){const g=Ln(d.points,d.closed);return dn(g,r,o)}else return Li(d,[r,o],s)}},Ln=(t,r=!1)=>{const o=[];for(let s=0;s<t.length;s++){const d=t[s],g=t[(s+1)%t.length];if(o.push(d.point),(s<t.length-1||r)&&(d.type==="CURVE"||g.type=="CURVE")){const x=Jn(d.point,d.type==="CURVE"&&d.outHandle||d.point,g.type==="CURVE"&&g.inHandle||g.point,g.point,10);o.push(...x.slice(1))}}return o},Jn=(t,r,o,s,d=10)=>{const g=[];for(let x=0;x<=d;x++){const C=x/d,I=Math.pow(1-C,3)*t[0]+3*Math.pow(1-C,2)*C*r[0]+3*(1-C)*Math.pow(C,2)*o[0]+Math.pow(C,3)*s[0],H=Math.pow(1-C,3)*t[1]+3*Math.pow(1-C,2)*C*r[1]+3*(1-C)*Math.pow(C,2)*o[1]+Math.pow(C,3)*s[1];g.push([I,H])}return g},Li=(t,r,o)=>{for(let s=0;s<t.points.length-1;s++){const d=t.points[s],g=t.points[s+1];if(d.type==="CURVE"||g.type==="CURVE"){const x=Jn(d.point,d.type==="CURVE"&&d.outHandle||d.point,g.type==="CURVE"&&g.inHandle||g.point,g.point,20);for(let C=0;C<x.length-1;C++)if(ci(r,x[C],x[C+1])<=o)return!0}else if(ci(r,d.point,g.point)<=o)return!0}return!1},ci=(t,r,o)=>{const[s,d]=t,[g,x]=r,[C,I]=o,H=C-g,W=I-x,B=Math.sqrt(H*H+W*W);if(B===0)return Math.sqrt((s-g)*(s-g)+(d-x)*(d-x));const ne=((s-g)*H+(d-x)*W)/(B*B);return ne<=0?Math.sqrt((s-g)*(s-g)+(d-x)*(d-x)):ne>=1?Math.sqrt((s-C)*(s-C)+(d-I)*(d-I)):Math.abs((I-x)*s-(C-g)*d+C*x-I*g)/B},Gn=t=>{if(!t.points||t.points.length===0)return"";const r=[],o=t.points[0];r.push(`M ${o.point[0]} ${o.point[1]}`);for(let s=1;s<t.points.length;s++){const d=t.points[s],g=t.points[s-1];if(d.type==="CURVE"||g.type==="CURVE"){const x=g.type==="CURVE"&&g.outHandle||g.point,C=d.type==="CURVE"&&d.inHandle||d.point,I=d.point;r.push(`C ${x[0]} ${x[1]} ${C[0]} ${C[1]} ${I[0]} ${I[1]}`)}else r.push(`L ${d.point[0]} ${d.point[1]}`)}if(t.closed){const s=t.points[t.points.length-1],d=t.points[0];if(s.type==="CURVE"||d.type==="CURVE"){const g=s.outHandle||s.point,x=d.inHandle||d.point,C=d.point;r.push(`C ${g[0]} ${g[1]} ${x[0]} ${x[1]} ${C[0]} ${C[1]}`)}r.push("Z")}return r.join(" ")};Jt(at.POLYLINE,Sn);const ui={area:t=>t.geometry.w*t.geometry.h,intersects:(t,r,o)=>r>=t.geometry.x&&r<=t.geometry.x+t.geometry.w&&o>=t.geometry.y&&o<=t.geometry.y+t.geometry.h};Jt(at.RECTANGLE,ui);const Nn=t=>Fn(t.target),Fn=t=>{var r,o;return(t==null?void 0:t.annotation)!==void 0&&((o=(r=t==null?void 0:t.selector)==null?void 0:r.geometry)==null?void 0:o.bounds)!==void 0},di=(t,r=!1)=>{const o=typeof t=="string"?t:t.value,s=/(xywh)=(pixel|percent)?:?(.+?),(.+?),(.+?),(.+)*/g,d=[...o.matchAll(s)][0],[g,x,C,I,H,W,B]=d;if(x!=="xywh")throw new Error("Unsupported MediaFragment: "+o);if(C&&C!=="pixel")throw new Error(`Unsupported MediaFragment unit: ${C}`);const[ne,we,ge,de]=[I,H,W,B].map(parseFloat);return{type:at.RECTANGLE,geometry:{x:ne,y:we,w:ge,h:de,bounds:{minX:ne,minY:r?we-de:we,maxX:ne+ge,maxY:r?we:we+de}}}},fi=t=>{const{x:r,y:o,w:s,h:d}=t;return{type:"FragmentSelector",conformsTo:"http://www.w3.org/TR/media-frags/",value:`xywh=pixel:${r},${o},${s},${d}`}},hi="http://www.w3.org/2000/svg",$n=t=>{const r=s=>{Array.from(s.attributes).forEach(d=>{d.name.startsWith("on")&&s.removeAttribute(d.name)})},o=t.getElementsByTagName("script");return Array.from(o).reverse().forEach(s=>s.parentNode.removeChild(s)),Array.from(t.querySelectorAll("*")).forEach(r),t},Ni=t=>{const r=new XMLSerializer().serializeToString(t.documentElement).replace("<svg>",`<svg xmlns="${hi}">`);return new DOMParser().parseFromString(r,"image/svg+xml").documentElement},Yn=t=>{const r=new DOMParser().parseFromString(t,"image/svg+xml"),o=r.lookupPrefix(hi),s=r.lookupNamespaceURI(null);return o||s?$n(r).firstChild:$n(Ni(r)).firstChild},pi=t=>{const r=ei(t),o=[];let s=[],d=[0,0];for(const g of r)switch(g.type.toUpperCase()){case"M":s.length>0&&(o.push({points:s}),s=[]),d=[g.args[0],g.args[1]],s.push([...d]);break;case"L":d=[g.args[0],g.args[1]],s.push([...d]);break;case"H":d=[g.args[0],d[1]],s.push([...d]);break;case"V":d=[d[0],g.args[0]],s.push([...d]);break;case"C":d=[g.args[4],g.args[5]],s.push([...d]);break;case"Z":break;default:console.warn(`Unsupported SVG path command: ${g.type}`);break}if(s.length>2&&o.push({points:s}),o.length>0){const g=Ut(o[0].points);return{rings:o,bounds:g}}},Fi=t=>{const{point:r,inHandle:o,outHandle:s}=t;if(!o||!s)return!1;const d=o[0]-r[0],g=o[1]-r[1],x=s[0]-r[0],C=s[1]-r[1],I=d*C-g*x;return Math.abs(I)<.01},gi=t=>{const r=ei(t);let o=[],s=[0,0],d=!1;for(let x=0;x<r.length;x++){const C=r[x];switch(C.type.toUpperCase()){case"M":s=[C.args[0],C.args[1]],o.push({type:"CORNER",point:[...s]});break;case"L":s=[C.args[0],C.args[1]],o.push({type:"CORNER",point:[...s]});break;case"C":const I=[C.args[0],C.args[1]],H=[C.args[2],C.args[3]],W=[C.args[4],C.args[5]];if(o.length>0){const ne=o[o.length-1];(I[0]!==ne.point[0]||I[1]!==ne.point[1])&&(ne.type="CURVE",ne.outHandle=I)}const B={type:H[0]!==W[0]||H[1]!==W[1]?"CURVE":"CORNER",point:W};B.type==="CURVE"&&(B.inHandle=H),o.push(B),s=W;break;case"Z":d=!0;break;default:console.warn(`Unsupported SVG path command: ${C.type}`);break}}o=o.map(x=>Fi(x)?{...x,locked:!0}:x);const g=Ut(Ln(o,d));return{points:o,closed:d,bounds:g}},ei=t=>{const r=[],o=t.replace(/,/g," ").trim(),s=/([MmLlHhVvCcZz])\s*([^MmLlHhVvCcZz]*)/g;let d;for(;(d=s.exec(o))!==null;){const[,g,x]=d,C=x.trim()===""?[]:x.trim().split(/\s+/).map(Number).filter(I=>!isNaN(I));r.push({type:g,args:C})}return r},ti=t=>{const[r,o,s]=t.match(/(<polygon points=["|'])([^("|')]*)/)||[],d=s.split(" ").map(g=>g.split(",").map(parseFloat));return{type:at.POLYGON,geometry:{points:d,bounds:Ut(d)}}},mi=t=>{const r=Yn(t),o=parseFloat(r.getAttribute("cx")),s=parseFloat(r.getAttribute("cy")),d=parseFloat(r.getAttribute("rx")),g=parseFloat(r.getAttribute("ry")),x={minX:o-d,minY:s-g,maxX:o+d,maxY:s+g};return{type:at.ELLIPSE,geometry:{cx:o,cy:s,rx:d,ry:g,bounds:x}}},En=t=>{const r=Yn(t),o=parseFloat(r.getAttribute("x1")),s=parseFloat(r.getAttribute("x2")),d=parseFloat(r.getAttribute("y1")),g=parseFloat(r.getAttribute("y2")),x={minX:Math.min(o,s),minY:Math.min(d,g),maxX:Math.max(o,s),maxY:Math.max(d,g)};return{type:at.LINE,geometry:{points:[[o,d],[s,g]],bounds:x}}},xn=t=>{const r=Yn(t),o=r.nodeName==="path"?r:Array.from(r.querySelectorAll("path"))[0],s=o==null?void 0:o.getAttribute("d");if(!s)throw new Error("Could not parse SVG path");const d=gi(s);if(!d)throw new Error("Could not parse SVG path");return{type:at.POLYLINE,geometry:d}},vi=t=>{const r=Yn(t),o=(r.nodeName==="path"?[r]:Array.from(r.querySelectorAll("path"))).map(g=>g.getAttribute("d")||"").map(g=>pi(g)).filter(Boolean),s=o.reduce((g,x)=>[...g,...x.rings[0].points],[]),d=Ut(s);return o.length===1&&o[0].rings.length===1?{type:at.POLYGON,geometry:{points:s,bounds:d}}:{type:at.MULTIPOLYGON,geometry:{polygons:o,bounds:d}}},yi=t=>{const r=typeof t=="string"?t:t.value;if(r.includes("<polygon points="))return ti(r);if(r.includes("<path ")&&(r.includes(" C ")||!r.includes("Z")))return xn(r);if(r.includes("<path "))return vi(r);if(r.includes("<ellipse "))return mi(r);if(r.includes("<line "))return En(r);throw"Unsupported SVG shape: "+r},Xn=t=>`<g>${t.polygons.map(r=>`<path fill-rule="evenodd" d="${fn(r)}" />`).join("")}</g>`,Mn=t=>{let r;switch(t.type){case at.POLYGON:{const o=t.geometry,{points:s}=o;r=`<svg><polygon points="${s.map(d=>d.join(",")).join(" ")}" /></svg>`;break}case at.ELLIPSE:{const o=t.geometry;r=`<svg><ellipse cx="${o.cx}" cy="${o.cy}" rx="${o.rx}" ry="${o.ry}" /></svg>`;break}case at.MULTIPOLYGON:{const o=t.geometry;r=`<svg>${Xn(o)}</svg>`;break}case at.LINE:{const o=t.geometry,[[s,d],[g,x]]=o.points;r=`<svg><line x1="${s}" y1="${d}" x2="${g}" y2="${x}" /></svg>`;break}case at.POLYLINE:r=`<svg><path d="${Gn(t.geometry)}" /></svg>`}if(r)return{type:"SvgSelector",value:r};throw`Unsupported shape type: ${t.type}`},on=[];for(let t=0;t<256;++t)on.push((t+256).toString(16).slice(1));function An(t,r=0){return(on[t[r+0]]+on[t[r+1]]+on[t[r+2]]+on[t[r+3]]+"-"+on[t[r+4]]+on[t[r+5]]+"-"+on[t[r+6]]+on[t[r+7]]+"-"+on[t[r+8]]+on[t[r+9]]+"-"+on[t[r+10]]+on[t[r+11]]+on[t[r+12]]+on[t[r+13]]+on[t[r+14]]+on[t[r+15]]).toLowerCase()}let Hn;const pn=new Uint8Array(16);function kn(){if(!Hn){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Hn=crypto.getRandomValues.bind(crypto)}return Hn(pn)}const bi={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Hi(t,r,o){var g,x;var s;t=t||{};const d=(x=(g=t.random)!=null?g:(s=t.rng)==null?void 0:s.call(t))!=null?x:kn();if(d.length<16)throw new Error("Random bytes length must be >= 16");return d[6]=d[6]&15|64,d[8]=d[8]&63|128,An(d)}function Rn(t,r,o){return bi.randomUUID&&!t?bi.randomUUID():Hi(t)}var Vn=Object.prototype.hasOwnProperty;function hn(t,r){var o,s;if(t===r)return!0;if(t&&r&&(o=t.constructor)===r.constructor){if(o===Date)return t.getTime()===r.getTime();if(o===RegExp)return t.toString()===r.toString();if(o===Array){if((s=t.length)===r.length)for(;s--&&hn(t[s],r[s]););return s===-1}if(!o||typeof t=="object"){s=0;for(o in t)if(Vn.call(t,o)&&++s&&!Vn.call(r,o)||!(o in r)||!hn(t[o],r[o]))return!1;return Object.keys(r).length===s}}return t!==t&&r!==r}function Un(){}function Ri(t,r){return t!=t?r==r:t!==r||t&&typeof t=="object"||typeof t=="function"}const Cn=[];function a(t,r=Un){let o;const s=new Set;function d(C){if(Ri(t,C)&&(t=C,o)){const I=!Cn.length;for(const H of s)H[1](),Cn.push(H,t);if(I){for(let H=0;H<Cn.length;H+=2)Cn[H][0](Cn[H+1]);Cn.length=0}}}function g(C){d(C(t))}function x(C,I=Un){const H=[C,I];return s.add(H),s.size===1&&(o=r(d,g)||Un),C(t),()=>{s.delete(H),s.size===0&&o&&(o(),o=null)}}return{set:d,update:g,subscribe:x}}const u=t=>{const{subscribe:r,set:o}=a();let s;return r(d=>s=d),t.observe(({changes:d})=>{if(s){(d.deleted||[]).some(x=>x.id===s)&&o(void 0);const g=(d.updated||[]).find(({oldValue:x})=>x.id===s);g&&o(g.newValue.id)}}),{get current(){return s},subscribe:r,set:o}};var y=(t=>(t.EDIT="EDIT",t.SELECT="SELECT",t.NONE="NONE",t))(y||{});const _={selected:[]},P=(t,r,o)=>{const{subscribe:s,set:d}=a(_);let g=r,x=_;s(de=>x=de);const C=()=>{hn(x,_)||d(_)},I=()=>{var de;return((de=x.selected)==null?void 0:de.length)===0},H=de=>{if(I())return!1;const je=typeof de=="string"?de:de.id;return x.selected.some(Se=>Se.id===je)},W=(de,je)=>{let Se;if(Array.isArray(de)){if(Se=de.map(ve=>t.getAnnotation(ve)).filter(Boolean),Se.length<de.length){console.warn("Invalid selection: "+de.filter(ve=>!Se.some(He=>He.id===ve)));return}}else{const ve=t.getAnnotation(de);if(!ve){console.warn("Invalid selection: "+de);return}Se=[ve]}const Fe=Se.reduce((ve,He)=>{const Ge=ge(He);return Ge==="EDIT"?[...ve,{id:He.id,editable:!0}]:Ge==="SELECT"?[...ve,{id:He.id}]:ve},[]);d({selected:Fe,event:je})},B=(de,je)=>{const Se=Array.isArray(de)?de:[de],Fe=Se.map(ve=>t.getAnnotation(ve)).filter(ve=>!!ve);d({selected:Fe.map(ve=>{const He=je===void 0?ge(ve)==="EDIT":je;return{id:ve.id,editable:He}})}),Fe.length!==Se.length&&console.warn("Invalid selection",de)},ne=de=>{if(I())return!1;const{selected:je}=x;je.some(({id:Se})=>de.includes(Se))&&d({selected:je.filter(({id:Se})=>!de.includes(Se))})},we=de=>{g=de,B(x.selected.map(({id:je})=>je))},ge=de=>U(de,g,o);return t.observe(({changes:de})=>ne((de.deleted||[]).map(je=>je.id))),{get event(){return x?x.event:null},get selected(){return x?[...x.selected]:null},get userSelectAction(){return g},clear:C,evalSelectAction:ge,isEmpty:I,isSelected:H,setSelected:B,setUserSelectAction:we,subscribe:s,userSelect:W}},U=(t,r,o)=>{const s=o?o.serialize(t):t;return typeof r=="function"?r(s):r||"EDIT"},X=[];for(let t=0;t<256;++t)X.push((t+256).toString(16).slice(1));function K(t,r=0){return(X[t[r+0]]+X[t[r+1]]+X[t[r+2]]+X[t[r+3]]+"-"+X[t[r+4]]+X[t[r+5]]+"-"+X[t[r+6]]+X[t[r+7]]+"-"+X[t[r+8]]+X[t[r+9]]+"-"+X[t[r+10]]+X[t[r+11]]+X[t[r+12]]+X[t[r+13]]+X[t[r+14]]+X[t[r+15]]).toLowerCase()}let fe;const ae=new Uint8Array(16);function _e(){if(!fe){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");fe=crypto.getRandomValues.bind(crypto)}return fe(ae)}const he=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ye={randomUUID:he};function Ce(t,r,o){var g,x;var s;t=t||{};const d=(x=(g=t.random)!=null?g:(s=t.rng)==null?void 0:s.call(t))!=null?x:_e();if(d.length<16)throw new Error("Random bytes length must be >= 16");return d[6]=d[6]&15|64,d[8]=d[8]&63|128,K(d)}function lt(t,r,o){return ye.randomUUID&&!t?ye.randomUUID():Ce(t)}const $e=t=>{const r=o=>{const s={...o};return o.created&&typeof o.created=="string"&&(s.created=new Date(o.created)),o.updated&&typeof o.updated=="string"&&(s.updated=new Date(o.updated)),s};return{...t,bodies:(t.bodies||[]).map(r),target:r(t.target)}},ct=(t,r,o,s)=>({id:lt(),annotation:typeof t=="string"?t:t.id,created:o||new Date,creator:s,...r}),pt=(t,r)=>{const o=new Set(t.bodies.map(s=>s.id));return r.bodies.filter(s=>!o.has(s.id))},Mt=(t,r)=>{const o=new Set(r.bodies.map(s=>s.id));return t.bodies.filter(s=>!o.has(s.id))},Yt=(t,r)=>r.bodies.map(o=>{const s=t.bodies.find(d=>d.id===o.id);return{newBody:o,oldBody:s&&!hn(s,o)?s:void 0}}).filter(({oldBody:o})=>o).map(({oldBody:o,newBody:s})=>({oldBody:o,newBody:s})),bt=(t,r)=>!hn(t.target,r.target),q=(t,r)=>{const o=pt(t,r),s=Mt(t,r),d=Yt(t,r);return{oldValue:t,newValue:r,bodiesCreated:o.length>0?o:void 0,bodiesDeleted:s.length>0?s:void 0,bodiesUpdated:d.length>0?d:void 0,targetUpdated:bt(t,r)?{oldTarget:t.target,newTarget:r.target}:void 0}};var ee=(t=>(t.LOCAL="LOCAL",t.REMOTE="REMOTE",t.SILENT="SILENT",t))(ee||{});const be=(t,r)=>{var o,s;const{changes:d,origin:g}=r;if(!(t.options.origin?t.options.origin===g:g!=="SILENT"))return!1;if(t.options.ignore){const{ignore:x}=t.options,C=I=>I&&I.length>0;if(!(C(d.created)||C(d.deleted))){const I=(o=d.updated)==null?void 0:o.some(W=>C(W.bodiesCreated)||C(W.bodiesDeleted)||C(W.bodiesUpdated)),H=(s=d.updated)==null?void 0:s.some(W=>W.targetUpdated);if(x==="BODY_ONLY"&&I&&!H||x==="TARGET_ONLY"&&H&&!I)return!1}}if(t.options.annotations){const x=new Set([...(d.created||[]).map(C=>C.id),...(d.deleted||[]).map(C=>C.id),...(d.updated||[]).map(({oldValue:C})=>C.id)]);return!!(Array.isArray(t.options.annotations)?t.options.annotations:[t.options.annotations]).find(C=>x.has(C))}else return!0},xe=(t,r)=>{const o=new Set((t.created||[]).map(B=>B.id)),s=new Set((t.updated||[]).map(({newValue:B})=>B.id)),d=new Set((r.created||[]).map(B=>B.id)),g=new Set((r.deleted||[]).map(B=>B.id)),x=new Set((r.updated||[]).map(({oldValue:B})=>B.id)),C=new Set((r.updated||[]).filter(({oldValue:B})=>o.has(B.id)||s.has(B.id)).map(({oldValue:B})=>B.id)),I=[...(t.created||[]).filter(B=>!g.has(B.id)).map(B=>x.has(B.id)?r.updated.find(({oldValue:ne})=>ne.id===B.id).newValue:B),...r.created||[]],H=[...(t.deleted||[]).filter(B=>!d.has(B.id)),...(r.deleted||[]).filter(B=>!o.has(B.id))],W=[...(t.updated||[]).filter(({newValue:B})=>!g.has(B.id)).map(B=>{const{oldValue:ne,newValue:we}=B;if(x.has(we.id)){const ge=r.updated.find(de=>de.oldValue.id===we.id).newValue;return q(ne,ge)}else return B}),...(r.updated||[]).filter(({oldValue:B})=>!C.has(B.id))];return{created:I,deleted:H,updated:W}},De=t=>{const r=t.id===void 0?lt():t.id;return{...t,id:r,bodies:t.bodies===void 0?[]:t.bodies.map(o=>({...o,annotation:r})),target:{...t.target,annotation:r}}},Ae=t=>t.id!==void 0,Ve=()=>{const t=new Map,r=new Map,o=[],s=(Ee,Ie={})=>{o.push({onChange:Ee,options:Ie})},d=Ee=>{const Ie=o.findIndex(pe=>pe.onChange==Ee);Ie>-1&&o.splice(Ie,1)},g=(Ee,Ie)=>{const pe={origin:Ee,changes:{created:Ie.created||[],updated:Ie.updated||[],deleted:Ie.deleted||[]},state:[...t.values()]};o.forEach(Te=>{be(Te,pe)&&Te.onChange(pe)})},x=(Ee,Ie=ee.LOCAL)=>{if(Ee.id&&t.get(Ee.id))throw Error(`Cannot add annotation ${Ee.id} - exists already`);{const pe=De(Ee);t.set(pe.id,pe),pe.bodies.forEach(Te=>r.set(Te.id,pe.id)),g(Ie,{created:[pe]})}},C=(Ee,Ie)=>{const pe=De(typeof Ee=="string"?Ie:Ee),Te=typeof Ee=="string"?Ee:Ee.id,Qe=Te&&t.get(Te);if(Qe){const qe=q(Qe,pe);return Te===pe.id?t.set(Te,pe):(t.delete(Te),t.set(pe.id,pe)),Qe.bodies.forEach(nt=>r.delete(nt.id)),pe.bodies.forEach(nt=>r.set(nt.id,pe.id)),qe}else console.warn(`Cannot update annotation ${Te} - does not exist`)},I=(Ee,Ie=ee.LOCAL,pe=ee.LOCAL)=>{const Te=Ae(Ie)?pe:Ie,Qe=C(Ee,Ie);Qe&&g(Te,{updated:[Qe]})},H=(Ee,Ie=ee.LOCAL)=>{t.get(Ee.id)?I(Ee,Ie):x(Ee,Ie)},W=(Ee,Ie=ee.LOCAL)=>{const pe=Ee.reduce((Te,Qe)=>{const qe=C(Qe);return qe?[...Te,qe]:Te},[]);pe.length>0&&g(Ie,{updated:pe})},B=(Ee,Ie=ee.LOCAL)=>{const pe=Ee.map(De),{toAdd:Te,toUpdate:Qe}=pe.reduce((nt,At)=>t.get(At.id)?{...nt,toUpdate:[...nt.toUpdate,At]}:{...nt,toAdd:[...nt.toAdd,At]},{toAdd:[],toUpdate:[]}),qe=Qe.map(nt=>C(nt,Ie)).filter(Boolean);Te.forEach(nt=>{t.set(nt.id,nt),nt.bodies.forEach(At=>r.set(At.id,nt.id))}),g(Ie,{created:Te,updated:qe})},ne=(Ee,Ie=ee.LOCAL)=>{const pe=t.get(Ee.annotation);if(pe){const Te={...pe,bodies:[...pe.bodies,Ee]};t.set(pe.id,Te),r.set(Ee.id,Te.id),g(Ie,{updated:[{oldValue:pe,newValue:Te,bodiesCreated:[Ee]}]})}else console.warn(`Attempt to add body to missing annotation: ${Ee.annotation}`)},we=()=>[...t.values()],ge=(Ee=ee.LOCAL)=>{const Ie=[...t.values()];t.clear(),r.clear(),g(Ee,{deleted:Ie})},de=(Ee,Ie=!0,pe=ee.LOCAL)=>{const Te=Ee.map(De);if(Ie){const Qe=[...t.values()];t.clear(),r.clear(),Te.forEach(qe=>{t.set(qe.id,qe),qe.bodies.forEach(nt=>r.set(nt.id,qe.id))}),g(pe,{created:Te,deleted:Qe})}else{const Qe=Ee.reduce((qe,nt)=>{const At=nt.id&&t.get(nt.id);return At?[...qe,At]:qe},[]);if(Qe.length>0)throw Error(`Bulk insert would overwrite the following annotations: ${Qe.map(qe=>qe.id).join(", ")}`);Te.forEach(qe=>{t.set(qe.id,qe),qe.bodies.forEach(nt=>r.set(nt.id,qe.id))}),g(pe,{created:Te})}},je=Ee=>{const Ie=typeof Ee=="string"?Ee:Ee.id,pe=t.get(Ie);if(pe)return t.delete(Ie),pe.bodies.forEach(Te=>r.delete(Te.id)),pe;console.warn(`Attempt to delete missing annotation: ${Ie}`)},Se=(Ee,Ie=ee.LOCAL)=>{const pe=je(Ee);pe&&g(Ie,{deleted:[pe]})},Fe=(Ee,Ie=ee.LOCAL)=>{const pe=Ee.reduce((Te,Qe)=>{const qe=je(Qe);return qe?[...Te,qe]:Te},[]);pe.length>0&&g(Ie,{deleted:pe})},ve=Ee=>{const Ie=t.get(Ee.annotation);if(Ie){const pe=Ie.bodies.find(Te=>Te.id===Ee.id);if(pe){r.delete(pe.id);const Te={...Ie,bodies:Ie.bodies.filter(Qe=>Qe.id!==Ee.id)};return t.set(Ie.id,Te),{oldValue:Ie,newValue:Te,bodiesDeleted:[pe]}}else console.warn(`Attempt to delete missing body ${Ee.id} from annotation ${Ee.annotation}`)}else console.warn(`Attempt to delete body from missing annotation ${Ee.annotation}`)},He=(Ee,Ie=ee.LOCAL)=>{const pe=ve(Ee);pe&&g(Ie,{updated:[pe]})},Ge=(Ee,Ie=ee.LOCAL)=>{const pe=Ee.map(Te=>ve(Te)).filter(Boolean);pe.length>0&&g(Ie,{updated:pe})},tt=Ee=>{const Ie=t.get(Ee);return Ie?{...Ie}:void 0},Ye=Ee=>{const Ie=r.get(Ee);if(Ie){const pe=tt(Ie).bodies.find(Te=>Te.id===Ee);if(pe)return pe;console.error(`Store integrity error: body ${Ee} in index, but not in annotation`)}else console.warn(`Attempt to retrieve missing body: ${Ee}`)},gt=(Ee,Ie)=>{if(Ee.annotation!==Ie.annotation)throw"Annotation integrity violation: annotation ID must be the same when updating bodies";const pe=t.get(Ee.annotation);if(pe){const Te=pe.bodies.find(qe=>qe.id===Ee.id),Qe={...pe,bodies:pe.bodies.map(qe=>qe.id===Te.id?Ie:qe)};return t.set(pe.id,Qe),Te.id!==Ie.id&&(r.delete(Te.id),r.set(Ie.id,Qe.id)),{oldValue:pe,newValue:Qe,bodiesUpdated:[{oldBody:Te,newBody:Ie}]}}else console.warn(`Attempt to add body to missing annotation ${Ee.annotation}`)},ut=(Ee,Ie,pe=ee.LOCAL)=>{const Te=gt(Ee,Ie);Te&&g(pe,{updated:[Te]})},Lt=(Ee,Ie=ee.LOCAL)=>{const pe=Ee.map(Te=>gt({id:Te.id,annotation:Te.annotation},Te)).filter(Boolean);g(Ie,{updated:pe})},It=Ee=>{const Ie=t.get(Ee.annotation);if(Ie){const pe={...Ie,target:{...Ie.target,...Ee}};return t.set(Ie.id,pe),{oldValue:Ie,newValue:pe,targetUpdated:{oldTarget:Ie.target,newTarget:Ee}}}else console.warn(`Attempt to update target on missing annotation: ${Ee.annotation}`)};return{addAnnotation:x,addBody:ne,all:we,bulkAddAnnotations:de,bulkDeleteAnnotations:Fe,bulkDeleteBodies:Ge,bulkUpdateAnnotations:W,bulkUpdateBodies:Lt,bulkUpdateTargets:(Ee,Ie=ee.LOCAL)=>{const pe=Ee.map(Te=>It(Te)).filter(Boolean);pe.length>0&&g(Ie,{updated:pe})},bulkUpsertAnnotations:B,clear:ge,deleteAnnotation:Se,deleteBody:He,getAnnotation:tt,getBody:Ye,observe:s,unobserve:d,updateAnnotation:I,updateBody:ut,updateTarget:(Ee,Ie=ee.LOCAL)=>{const pe=It(Ee);pe&&g(Ie,{updated:[pe]})},upsertAnnotation:H}},Je=t=>({...t,subscribe:r=>{const o=s=>r(s.state);return t.observe(o),r(t.all()),()=>t.unobserve(o)}});let Ke=()=>({emit(t,...r){for(let o=this.events[t]||[],s=0,d=o.length;s<d;s++)o[s](...r)},events:{},on(t,r){var o;return((o=this.events)[t]||(o[t]=[])).push(r),()=>{var s;this.events[t]=(s=this.events[t])==null?void 0:s.filter(d=>r!==d)}}});const mt=250,Ft=(t,r)=>{const o=Ke(),s=(r==null?void 0:r.changes)||[];let d=r?r.pointer:-1,g=!1,x=0;const C=ge=>{if(!g){const{changes:de}=ge,je=performance.now();if(je-x>mt)s.splice(d+1),s.push(de),d=s.length-1;else{const Se=s.length-1;s[Se]=xe(s[Se],de)}x=je}g=!1};t.observe(C,{origin:ee.LOCAL});const I=ge=>ge&&ge.length>0&&t.bulkDeleteAnnotations(ge),H=ge=>ge&&ge.length>0&&t.bulkAddAnnotations(ge,!1),W=ge=>ge&&ge.length>0&&t.bulkUpdateAnnotations(ge.map(({oldValue:de})=>de)),B=ge=>ge&&ge.length>0&&t.bulkUpdateAnnotations(ge.map(({newValue:de})=>de)),ne=ge=>ge&&ge.length>0&&t.bulkAddAnnotations(ge,!1),we=ge=>ge&&ge.length>0&&t.bulkDeleteAnnotations(ge);return{canRedo:()=>s.length-1>d,canUndo:()=>d>-1,destroy:()=>t.unobserve(C),getHistory:()=>({changes:[...s],pointer:d}),on:(ge,de)=>o.on(ge,de),redo:()=>{if(s.length-1>d){g=!0;const{created:ge,updated:de,deleted:je}=s[d+1];H(ge),B(de),we(je),o.emit("redo",s[d+1]),d+=1}},undo:()=>{if(d>-1){g=!0;const{created:ge,updated:de,deleted:je}=s[d];I(ge),W(de),ne(je),o.emit("undo",s[d]),d-=1}}}},re=()=>{const{subscribe:t,set:r}=a([]);return{subscribe:t,set:r}},ke=(t,r,o,s)=>{const{hover:d,selection:g,store:x,viewport:C}=t,I=new Map;let H=[],W,B;const ne=(Se,Fe)=>{I.has(Se)?I.get(Se).push(Fe):I.set(Se,[Fe])},we=(Se,Fe)=>{const ve=I.get(Se);if(ve){const He=ve.indexOf(Fe);He!==-1&&ve.splice(He,1)}},ge=(Se,Fe,ve)=>{I.has(Se)&&setTimeout(()=>{I.get(Se).forEach(He=>{if(o){const Ge=Array.isArray(Fe)?Fe.map(Ye=>o.serialize(Ye)):o.serialize(Fe),tt=ve?ve instanceof PointerEvent?ve:o.serialize(ve):void 0;He(Ge,tt)}else He(Fe,ve)})},1)},de=()=>{const{selected:Se}=g,Fe=(Se||[]).map(({id:ve})=>x.getAnnotation(ve));Fe.forEach(ve=>{const He=H.find(Ge=>Ge.id===ve.id);(!He||!hn(He,ve))&&ge("updateAnnotation",ve,He)}),H=H.map(ve=>Fe.find(({id:He})=>He===ve.id)||ve)};g.subscribe(({selected:Se})=>{if(!(H.length===0&&Se.length===0)){if(H.length===0&&Se.length>0)H=Se.map(({id:Fe})=>x.getAnnotation(Fe));else if(H.length>0&&Se.length===0)H.forEach(Fe=>{const ve=x.getAnnotation(Fe.id);ve&&!hn(ve,Fe)&&ge("updateAnnotation",ve,Fe)}),H=[];else{const Fe=new Set(H.map(He=>He.id)),ve=new Set(Se.map(({id:He})=>He));H.filter(He=>!ve.has(He.id)).forEach(He=>{const Ge=x.getAnnotation(He.id);Ge&&!hn(Ge,He)&&ge("updateAnnotation",Ge,He)}),H=[...H.filter(He=>ve.has(He.id)),...Se.filter(({id:He})=>!Fe.has(He)).map(({id:He})=>x.getAnnotation(He))]}ge("selectionChanged",H)}}),d.subscribe(Se=>{!W&&Se?ge("mouseEnterAnnotation",x.getAnnotation(Se)):W&&!Se?ge("mouseLeaveAnnotation",x.getAnnotation(W)):W&&Se&&(ge("mouseLeaveAnnotation",x.getAnnotation(W)),ge("mouseEnterAnnotation",x.getAnnotation(Se))),W=Se}),C==null||C.subscribe(Se=>ge("viewportIntersect",Se.map(Fe=>x.getAnnotation(Fe)))),x.observe(Se=>{s&&(B&&clearTimeout(B),B=setTimeout(de,1e3));const{created:Fe,deleted:ve}=Se.changes;(Fe||[]).forEach(He=>ge("createAnnotation",He)),(ve||[]).forEach(He=>ge("deleteAnnotation",He)),(Se.changes.updated||[]).filter(He=>[...He.bodiesCreated||[],...He.bodiesDeleted||[],...He.bodiesUpdated||[]].length>0).forEach(({oldValue:He,newValue:Ge})=>{const tt=H.find(Ye=>Ye.id===He.id)||He;H=H.map(Ye=>Ye.id===He.id?Ge:Ye),ge("updateAnnotation",Ge,tt)})},{origin:ee.LOCAL}),x.observe(Se=>{if(H){const Fe=new Set(H.map(He=>He.id)),ve=(Se.changes.updated||[]).filter(({newValue:He})=>Fe.has(He.id)).map(({newValue:He})=>He);ve.length>0&&(H=H.map(He=>ve.find(Ge=>Ge.id===He.id)||He))}},{origin:ee.REMOTE});const je=Se=>Fe=>{const{updated:ve}=Fe;Se?(ve||[]).forEach(He=>ge("updateAnnotation",He.oldValue,He.newValue)):(ve||[]).forEach(He=>ge("updateAnnotation",He.newValue,He.oldValue))};return r.on("undo",je(!0)),r.on("redo",je(!1)),{on:ne,off:we,emit:ge}},Ze=t=>r=>r.reduce((o,s)=>{const{parsed:d,error:g}=t.parse(s);return g?{parsed:o.parsed,failed:[...o.failed,s]}:d?{parsed:[...o.parsed,d],failed:o.failed}:{...o}},{parsed:[],failed:[]}),Be=(t,r,o)=>{const{store:s,selection:d}=t,g=Se=>{if(o){const{parsed:Fe,error:ve}=o.parse(Se);Fe?s.addAnnotation(Fe,ee.REMOTE):console.error(ve)}else s.addAnnotation($e(Se),ee.REMOTE)},x=()=>d.clear(),C=()=>s.clear(),I=Se=>{const Fe=s.getAnnotation(Se);return o&&Fe?o.serialize(Fe):Fe},H=()=>o?s.all().map(o.serialize):s.all(),W=()=>{var Se;const Fe=(((Se=d.selected)==null?void 0:Se.map(ve=>ve.id))||[]).map(ve=>s.getAnnotation(ve)).filter(Boolean);return o?Fe.map(o.serialize):Fe},B=(Se,Fe=!0)=>fetch(Se).then(ve=>ve.json()).then(ve=>(we(ve,Fe),ve)),ne=Se=>{if(typeof Se=="string"){const Fe=s.getAnnotation(Se);if(s.deleteAnnotation(Se),Fe)return o?o.serialize(Fe):Fe}else{const Fe=o?o.parse(Se).parsed:Se;if(Fe)return s.deleteAnnotation(Fe),Se}},we=(Se,Fe=!0)=>{if(o){const ve=o.parseAll||Ze(o),{parsed:He,failed:Ge}=ve(Se);Ge.length>0&&console.warn(`Discarded ${Ge.length} invalid annotations`,Ge),s.bulkAddAnnotations(He,Fe,ee.REMOTE)}else s.bulkAddAnnotations(Se.map($e),Fe,ee.REMOTE)},ge=(Se,Fe)=>{Se?d.setSelected(Se,Fe):d.clear()},de=Se=>{d.clear(),d.setUserSelectAction(Se)},je=Se=>{if(o){const Fe=o.parse(Se).parsed,ve=o.serialize(s.getAnnotation(Fe.id));return s.updateAnnotation(Fe),ve}else{const Fe=s.getAnnotation(Se.id);return s.updateAnnotation($e(Se)),Fe}};return{addAnnotation:g,cancelSelected:x,canRedo:r.canRedo,canUndo:r.canUndo,clearAnnotations:C,getAnnotationById:I,getAnnotations:H,getHistory:r.getHistory,getSelected:W,loadAnnotations:B,redo:r.redo,removeAnnotation:ne,setAnnotations:we,setSelected:ge,setUserSelectAction:de,undo:r.undo,updateAnnotation:je}},rt=(t,r,o)=>typeof r=="function"?r(t,o):r,Dt=(t,r)=>typeof t!="function"&&typeof r!="function"?{...t||{},...r||{}}:(o,s)=>{const d=typeof t=="function"?t(o,s):t,g=typeof r=="function"?r(o,s):r;return{...d||{},...g||{}}},jt="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let en=t=>crypto.getRandomValues(new Uint8Array(t)),Tn=(t,r,o)=>{let s=(2<<Math.log2(t.length-1))-1,d=-~(1.6*s*r/t.length);return(g=r)=>{let x="";for(;;){let C=o(d),I=d|0;for(;I--;)if(x+=t[C[I]&s]||"",x.length>=g)return x}}},cn=(t,r=21)=>Tn(t,r|0,en),wi=(t=21)=>{let r="",o=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)r+=jt[o[t]&63];return r};const Vi=()=>({isGuest:!0,id:cn("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_",20)()}),or=t=>{const r=JSON.stringify(t);let o=0;for(let s=0,d=r.length;s<d;s++){let g=r.charCodeAt(s);o=(o<<5)-o+g,o|=0}return`${o}`},_i=t=>t?typeof t=="object"?{...t}:t:void 0,uo=(t,r)=>(Array.isArray(t)?t:[t]).map(o=>{const{id:s,type:d,purpose:g,value:x,created:C,modified:I,creator:H,...W}=o;return{id:s||`temp-${or(o)}`,annotation:r,type:d,purpose:g,value:x,creator:_i(H),created:C?new Date(C):void 0,updated:I?new Date(I):void 0,...W}}),fo=t=>t.map(r=>{var o;const{annotation:s,created:d,updated:g,...x}=r,C={...x,created:d==null?void 0:d.toISOString(),modified:g==null?void 0:g.toISOString()};return(o=C.id)!=null&&o.startsWith("temp-")&&delete C.id,C}),ho=["#ff7c00","#1ac938","#e8000b","#8b2be2","#9f4800","#f14cc1","#ffc400","#00d7ff","#023eff"],po=()=>{const t=[...ho];return{assignRandomColor:()=>{const r=Math.floor(Math.random()*t.length),o=t[r];return t.splice(r,1),o},releaseColor:r=>t.push(r)}};wi();const go=(t,r={strict:!0,invertY:!1})=>({parse:o=>ar(o,r),serialize:o=>sr(o,t,r)}),ar=(t,r={strict:!0,invertY:!1})=>{const o=t.id||Rn(),{creator:s,created:d,modified:g,body:x,...C}=t,I=uo(x||[],o),H=Array.isArray(t.target)?t.target[0]:t.target,W=typeof H=="string"?H:Array.isArray(H.selector)?H.selector[0]:H.selector,B=typeof W=="string"||(W==null?void 0:W.type)==="FragmentSelector"?di(W,r.invertY):(W==null?void 0:W.type)==="SvgSelector"?yi(W):void 0,ne=Array.isArray(C.target)?C.target[0]:C.targret;return B||!r.strict?{parsed:{...C,id:o,bodies:I,target:{created:d?new Date(d):void 0,creator:_i(s),updated:g?new Date(g):void 0,...typeof ne=="string"?{}:ne,annotation:o,selector:B||W}}}:{error:Error(`Invalid selector: ${JSON.stringify(W)}`)}},sr=(t,r,o={strict:!0,invertY:!1})=>{const{selector:s,creator:d,created:g,updated:x,updatedBy:C,...I}=t.target;let H;try{H=s.type==at.RECTANGLE?fi(s.geometry):Mn(s)}catch(B){if(o.strict)throw B;H=s}const W={...t,"@context":"http://www.w3.org/ns/anno.jsonld",id:t.id,type:"Annotation",body:fo(t.bodies),created:g==null?void 0:g.toISOString(),creator:d,modified:x==null?void 0:x.toISOString(),target:{...I,source:r,type:"SpecificResource",selector:H}};return delete W.bodies,"annotation"in W.target&&delete W.target.annotation,W},qn=[];function mo(t,r=c){let o;const s=new Set;function d(C){if(z(t,C)&&(t=C,o)){const I=!qn.length;for(const H of s)H[1](),qn.push(H,t);if(I){for(let H=0;H<qn.length;H+=2)qn[H][0](qn[H+1]);qn.length=0}}}function g(C){d(C(t))}function x(C,I=c){const H=[C,I];return s.add(H),s.size===1&&(o=r(d,g)||c),C(t),()=>{s.delete(H),s.size===0&&o&&(o(),o=null)}}return{set:d,update:g,subscribe:x}}const vo=(t,r)=>{const{naturalWidth:o,naturalHeight:s}=t;if(!o&&!s){const{width:d,height:g}=t;r.setAttribute("viewBox",`0 0 ${d} ${g}`),t.addEventListener("load",x=>{const C=x.target;r.setAttribute("viewBox",`0 0 ${C.naturalWidth} ${C.naturalHeight}`)})}else r.setAttribute("viewBox",`0 0 ${o} ${s}`)},lr=(t,r)=>{vo(t,r);const{subscribe:o,set:s}=mo(1);let d;return window.ResizeObserver&&(d=new ResizeObserver(()=>{const g=r.getBoundingClientRect(),{width:x,height:C}=r.viewBox.baseVal,I=Math.max(g.width/x,g.height/C);s(I)}),d.observe(r.parentElement)),{destroy:()=>{d&&d.disconnect()},subscribe:o}},jn=(t,r)=>{const o=typeof r=="function"?r(t):r;if(o){const{fill:s,fillOpacity:d,stroke:g,strokeWidth:x,strokeOpacity:C}=o;let I="";return s&&(I+=`fill:${s};`),d||d===0?I+=`fill-opacity:${d};`:s&&(I+="fill-opacity:0.25;"),g&&(I+=`stroke:${g};`,I+=`stroke-width:${x||"1"};`,I+=`stroke-opacity:${C||"1"};`),I}},ni=(t,r=0)=>{const{minX:o,minY:s,maxX:d,maxY:g}=t;return{x:o-r,y:s-r,w:d-o+2*r,h:g-s+2*r}},yn=typeof window>"u"||typeof navigator>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,yo=t=>({}),cr=t=>({grab:t[0]});function bo(t){let r,o,s,d;const g=t[8].default,x=v(g,t,t[7],cr);return{c(){r=R("g"),x&&x.c(),b(r,"class","a9s-annotation selected")},m(C,I){M(C,r,I),x&&x.m(r,null),o=!0,s||(d=[oe(r,"pointerup",t[2]),oe(r,"pointermove",t[1])],s=!0)},p(C,[I]){x&&x.p&&(!o||I&128)&&k(x,g,C,C[7],o?S(g,C[7],I,yo):F(C[7]),cr)},i(C){o||(st(x,C),o=!0)},o(C){ht(x,C),o=!1},d(C){C&&V(r),x&&x.d(C),s=!1,A(d)}}}function wo(t,r,o){let{$$slots:s={},$$scope:d}=r;const g=Xe();let{shape:x}=r,{editor:C}=r,{transform:I}=r,{svgEl:H}=r,W,B,ne;const we=je=>Se=>{if(W=je,H){const{left:Fe,top:ve}=H.getBoundingClientRect(),He=Se.clientX-Fe,Ge=Se.clientY-ve;B=I.elementToImage(He,Ge)}else{const{offsetX:Fe,offsetY:ve}=Se;B=I.elementToImage(Fe,ve)}ne=x,Se.target.setPointerCapture(Se.pointerId),g("grab",Se)},ge=je=>{if(W){const[Se,Fe]=I.elementToImage(je.offsetX,je.offsetY),ve=[Se-B[0],Fe-B[1]];o(3,x=C(ne,W,ve)),g("change",x)}},de=je=>{je.target.releasePointerCapture(je.pointerId),W=void 0,ne=x,g("release",je)};return t.$$set=je=>{"shape"in je&&o(3,x=je.shape),"editor"in je&&o(4,C=je.editor),"transform"in je&&o(5,I=je.transform),"svgEl"in je&&o(6,H=je.svgEl),"$$scope"in je&&o(7,d=je.$$scope)},[we,ge,de,x,C,I,H,d,s]}class Ei extends it{constructor(r){super(),Me(this,r,wo,bo,z,{shape:3,editor:4,transform:5,svgEl:6})}}function _o(t){let r,o,s,d,g,x,C,I,H=t[3]&&ur(t);return{c(){r=R("g"),o=R("circle"),H&&H.c(),d=R("circle"),b(o,"class","a9s-handle-buffer svelte-qtyc7s"),b(o,"cx",t[0]),b(o,"cy",t[1]),b(o,"r",s=t[5]+6/t[2]),b(o,"role","button"),b(o,"tabindex","0"),b(d,"class",g=Z(`a9s-handle-dot${t[3]?" selected":""}`)+" svelte-qtyc7s"),b(d,"cx",t[0]),b(d,"cy",t[1]),b(d,"r",t[5]),b(r,"class",x=`a9s-handle ${t[8].class||""}`.trim())},m(W,B){M(W,r,B),te(r,o),H&&H.m(r,null),te(r,d),C||(I=[oe(o,"dblclick",t[12]),oe(o,"pointerenter",t[13]),oe(o,"pointerleave",t[14]),oe(o,"pointerdown",t[15]),oe(o,"pointerdown",t[6]),oe(o,"pointerup",t[16]),oe(o,"pointerup",t[7])],C=!0)},p(W,B){B&1&&b(o,"cx",W[0]),B&2&&b(o,"cy",W[1]),B&36&&s!==(s=W[5]+6/W[2])&&b(o,"r",s),W[3]?H?H.p(W,B):(H=ur(W),H.c(),H.m(r,d)):H&&(H.d(1),H=null),B&8&&g!==(g=Z(`a9s-handle-dot${W[3]?" selected":""}`)+" svelte-qtyc7s")&&b(d,"class",g),B&1&&b(d,"cx",W[0]),B&2&&b(d,"cy",W[1]),B&32&&b(d,"r",W[5]),B&256&&x!==(x=`a9s-handle ${W[8].class||""}`.trim())&&b(r,"class",x)},d(W){W&&V(r),H&&H.d(),C=!1,A(I)}}}function Eo(t){let r,o,s,d,g,x,C,I,H;return{c(){r=R("g"),o=R("circle"),d=R("circle"),x=R("circle"),b(o,"cx",t[0]),b(o,"cy",t[1]),b(o,"r",s=t[5]*10),b(o,"class","a9s-touch-halo"),ce(o,"touched",t[4]),b(d,"cx",t[0]),b(d,"cy",t[1]),b(d,"r",g=t[5]+10/t[2]),b(d,"class","a9s-handle-buffer svelte-qtyc7s"),b(d,"role","button"),b(d,"tabindex","0"),b(x,"class","a9s-handle-dot"),b(x,"cx",t[0]),b(x,"cy",t[1]),b(x,"r",C=t[5]+2/t[2]),b(r,"class","a9s-touch-handle")},m(W,B){M(W,r,B),te(r,o),te(r,d),te(r,x),I||(H=[oe(d,"dblclick",t[9]),oe(d,"pointerdown",t[10]),oe(d,"pointerdown",t[6]),oe(d,"pointerup",t[11]),oe(d,"pointerup",t[7])],I=!0)},p(W,B){B&1&&b(o,"cx",W[0]),B&2&&b(o,"cy",W[1]),B&32&&s!==(s=W[5]*10)&&b(o,"r",s),B&16&&ce(o,"touched",W[4]),B&1&&b(d,"cx",W[0]),B&2&&b(d,"cy",W[1]),B&36&&g!==(g=W[5]+10/W[2])&&b(d,"r",g),B&1&&b(x,"cx",W[0]),B&2&&b(x,"cy",W[1]),B&36&&C!==(C=W[5]+2/W[2])&&b(x,"r",C)},d(W){W&&V(r),I=!1,A(H)}}}function ur(t){let r,o;return{c(){r=R("circle"),b(r,"class","a9s-handle-selected"),b(r,"cx",t[0]),b(r,"cy",t[1]),b(r,"r",o=t[5]+8/t[2])},m(s,d){M(s,r,d)},p(s,d){d&1&&b(r,"cx",s[0]),d&2&&b(r,"cy",s[1]),d&36&&o!==(o=s[5]+8/s[2])&&b(r,"r",o)},d(s){s&&V(r)}}}function xo(t){let r;function o(d,g){return yn?Eo:_o}let s=o()(t);return{c(){s.c(),r=Q()},m(d,g){s.m(d,g),M(d,r,g)},p(d,[g]){s.p(d,g)},i:c,o:c,d(d){d&&V(r),s.d(d)}}}function Co(t,r,o){let s,{x:d}=r,{y:g}=r,{scale:x}=r,{selected:C=void 0}=r,I=!1;const H=ve=>{ve.pointerType==="touch"&&o(4,I=!0)},W=()=>o(4,I=!1);function B(ve){ot.call(this,t,ve)}function ne(ve){ot.call(this,t,ve)}function we(ve){ot.call(this,t,ve)}function ge(ve){ot.call(this,t,ve)}function de(ve){ot.call(this,t,ve)}function je(ve){ot.call(this,t,ve)}function Se(ve){ot.call(this,t,ve)}function Fe(ve){ot.call(this,t,ve)}return t.$$set=ve=>{o(8,r=m(m({},r),G(ve))),"x"in ve&&o(0,d=ve.x),"y"in ve&&o(1,g=ve.y),"scale"in ve&&o(2,x=ve.scale),"selected"in ve&&o(3,C=ve.selected)},t.$$.update=()=>{t.$$.dirty&4&&o(5,s=4/x)},r=G(r),[d,g,x,C,I,s,H,W,r,B,ne,we,ge,de,je,Se,Fe]}class zn extends it{constructor(r){super(),Me(this,r,Co,xo,z,{x:0,y:1,scale:2,selected:3})}}function To(t){let r,o,s,d,g,x,C;return{c(){r=R("g"),o=R("circle"),d=R("circle"),g=R("circle"),b(o,"class","a9s-polygon-midpoint-buffer svelte-12ykj76"),b(o,"cx",t[0]),b(o,"cy",t[1]),b(o,"r",s=1.75*t[2]),b(d,"class","a9s-polygon-midpoint-outer svelte-12ykj76"),b(d,"cx",t[0]),b(d,"cy",t[1]),b(d,"r",t[2]),b(g,"class","a9s-polygon-midpoint-inner svelte-12ykj76"),b(g,"cx",t[0]),b(g,"cy",t[1]),b(g,"r",t[2]),b(r,"class","a9s-polygon-midpoint svelte-12ykj76")},m(I,H){M(I,r,H),te(r,o),te(r,d),te(r,g),x||(C=[oe(o,"pointerdown",t[5]),oe(o,"pointerdown",t[3])],x=!0)},p(I,H){H&1&&b(o,"cx",I[0]),H&2&&b(o,"cy",I[1]),H&4&&s!==(s=1.75*I[2])&&b(o,"r",s),H&1&&b(d,"cx",I[0]),H&2&&b(d,"cy",I[1]),H&4&&b(d,"r",I[2]),H&1&&b(g,"cx",I[0]),H&2&&b(g,"cy",I[1]),H&4&&b(g,"r",I[2])},d(I){I&&V(r),x=!1,A(C)}}}function So(t){let r;return{c(){r=R("circle"),b(r,"cx",t[0]),b(r,"cy",t[1]),b(r,"r",t[2])},m(o,s){M(o,r,s)},p(o,s){s&1&&b(r,"cx",o[0]),s&2&&b(r,"cy",o[1]),s&4&&b(r,"r",o[2])},d(o){o&&V(r)}}}function Ao(t){let r;function o(d,g){return yn?So:To}let s=o()(t);return{c(){s.c(),r=Q()},m(d,g){s.m(d,g),M(d,r,g)},p(d,[g]){s.p(d,g)},i:c,o:c,d(d){d&&V(r),s.d(d)}}}function ko(t,r,o){let s,{x:d}=r,{y:g}=r,{scale:x}=r;const C=H=>{H.pointerType};function I(H){ot.call(this,t,H)}return t.$$set=H=>{"x"in H&&o(0,d=H.x),"y"in H&&o(1,g=H.y),"scale"in H&&o(4,x=H.scale)},t.$$.update=()=>{t.$$.dirty&16&&o(2,s=4/x)},[d,g,s,C,x,I]}class Ui extends it{constructor(r){super(),Me(this,r,ko,Ao,z,{x:0,y:1,scale:4})}}function ji(t){const r=t.slice(),o=r[10][r[6]];return r[28]=o.point,r}function dr(t,r,o){const s=t.slice();return s[28]=r[o],s[30]=o,s}function zi(t){const r=t.slice(),o=r[10][r[6]];return r[28]=o.point,r}function Wi(t){const r=t.slice(),o=r[10][r[6]];return r[28]=o.point,r}function fr(t){let r,o,s,d;return{c(){r=R("circle"),b(r,"cx",o=t[28][0]),b(r,"cy",s=t[28][1]),b(r,"r",d=ii/t[3]),b(r,"class","svelte-1h2slbm")},m(g,x){M(g,r,x)},p(g,x){x[0]&1088&&o!==(o=g[28][0])&&b(r,"cx",o),x[0]&1088&&s!==(s=g[28][1])&&b(r,"cy",s),x[0]&8&&d!==(d=ii/g[3])&&b(r,"r",d)},d(g){g&&V(r)}}}function hr(t){let r,o,s,d,g,x,C,I,H,W;return{c(){r=R("mask"),o=R("rect"),C=R("circle"),b(o,"x",s=t[9].x),b(o,"y",d=t[9].y),b(o,"width",g=t[9].w),b(o,"height",x=t[9].h),b(o,"class","svelte-1h2slbm"),b(C,"cx",I=t[28][0]),b(C,"cy",H=t[28][1]),b(C,"r",W=ii/t[3]),b(C,"class","svelte-1h2slbm"),b(r,"id",`${t[19]}-inner`),b(r,"class","a9s-polygon-editor-mask svelte-1h2slbm")},m(B,ne){M(B,r,ne),te(r,o),te(r,C)},p(B,ne){ne[0]&512&&s!==(s=B[9].x)&&b(o,"x",s),ne[0]&512&&d!==(d=B[9].y)&&b(o,"y",d),ne[0]&512&&g!==(g=B[9].w)&&b(o,"width",g),ne[0]&512&&x!==(x=B[9].h)&&b(o,"height",x),ne[0]&1088&&I!==(I=B[28][0])&&b(C,"cx",I),ne[0]&1088&&H!==(H=B[28][1])&&b(C,"cy",H),ne[0]&8&&W!==(W=ii/B[3])&&b(C,"r",W)},d(B){B&&V(r)}}}function pr(t){let r,o;return r=new zn({props:{class:"a9s-corner-handle",x:t[28][0],y:t[28][1],scale:t[3],selected:t[8].includes(t[30])}}),r.$on("pointerenter",t[11]),r.$on("pointerleave",t[12]),r.$on("pointerdown",t[15]),r.$on("pointerdown",function(){D(t[27](`HANDLE-${t[30]}`))&&t[27](`HANDLE-${t[30]}`).apply(this,arguments)}),r.$on("pointerup",t[16](t[30])),{c(){Xt(r.$$.fragment)},m(s,d){ue(r,s,d),o=!0},p(s,d){t=s;const g={};d[0]&32&&(g.x=t[28][0]),d[0]&32&&(g.y=t[28][1]),d[0]&8&&(g.scale=t[3]),d[0]&256&&(g.selected=t[8].includes(t[30])),r.$set(g)},i(s){o||(st(r.$$.fragment,s),o=!0)},o(s){ht(r.$$.fragment,s),o=!1},d(s){se(r,s)}}}function gr(t){let r,o;return r=new Ui({props:{x:t[28][0],y:t[28][1],scale:t[3]}}),r.$on("pointerdown",function(){D(t[18](t[6]))&&t[18](t[6]).apply(this,arguments)}),{c(){Xt(r.$$.fragment)},m(s,d){ue(r,s,d),o=!0},p(s,d){t=s;const g={};d[0]&1088&&(g.x=t[28][0]),d[0]&1088&&(g.y=t[28][1]),d[0]&8&&(g.scale=t[3]),r.$set(g)},i(s){o||(st(r.$$.fragment,s),o=!0)},o(s){ht(r.$$.fragment,s),o=!1},d(s){se(r,s)}}}function Io(t){let r,o,s,d,g,x,C,I,H,W,B,ne,we,ge,de,je,Se,Fe,ve,He,Ge,tt=t[6]!==void 0&&!t[7]&&fr(Wi(t)),Ye=t[6]!==void 0&&!t[7]&&hr(zi(t)),gt=qt(t[5].points),ut=[];for(let Ee=0;Ee<gt.length;Ee+=1)ut[Ee]=pr(dr(t,gt,Ee));const Lt=Ee=>ht(ut[Ee],1,1,()=>{ut[Ee]=null});let It=t[6]!==void 0&&!t[7]&&gr(ji(t));return{c(){r=R("defs"),o=R("mask"),s=R("rect"),I=R("polygon"),tt&&tt.c(),Ye&&Ye.c(),W=N(),B=R("polygon"),we=N(),ge=R("polygon"),je=N();for(let Ee=0;Ee<ut.length;Ee+=1)ut[Ee].c();Se=N(),It&&It.c(),Fe=Q(),b(s,"x",d=t[9].x),b(s,"y",g=t[9].y),b(s,"width",x=t[9].w),b(s,"height",C=t[9].h),b(s,"class","svelte-1h2slbm"),b(I,"points",H=t[5].points.map(mr).join(" ")),b(I,"class","svelte-1h2slbm"),b(o,"id",`${t[19]}-outer`),b(o,"class","a9s-polygon-editor-mask svelte-1h2slbm"),b(B,"class","a9s-outer"),b(B,"mask",`url(#${t[19]}-outer)`),b(B,"points",ne=t[5].points.map(vr).join(" ")),b(ge,"class","a9s-inner a9s-shape-handle"),b(ge,"mask",`url(#${t[19]}-inner)`),b(ge,"style",t[1]),b(ge,"points",de=t[5].points.map(yr).join(" "))},m(Ee,Ie){M(Ee,r,Ie),te(r,o),te(o,s),te(o,I),tt&&tt.m(o,null),Ye&&Ye.m(r,null),M(Ee,W,Ie),M(Ee,B,Ie),M(Ee,we,Ie),M(Ee,ge,Ie),M(Ee,je,Ie);for(let pe=0;pe<ut.length;pe+=1)ut[pe]&&ut[pe].m(Ee,Ie);M(Ee,Se,Ie),It&&It.m(Ee,Ie),M(Ee,Fe,Ie),ve=!0,He||(Ge=[oe(B,"pointerup",t[14]),oe(B,"pointerdown",function(){D(t[27]("SHAPE"))&&t[27]("SHAPE").apply(this,arguments)}),oe(ge,"pointermove",t[13]),oe(ge,"pointerup",t[14]),oe(ge,"pointerdown",function(){D(t[27]("SHAPE"))&&t[27]("SHAPE").apply(this,arguments)})],He=!0)},p(Ee,Ie){if(t=Ee,(!ve||Ie[0]&512&&d!==(d=t[9].x))&&b(s,"x",d),(!ve||Ie[0]&512&&g!==(g=t[9].y))&&b(s,"y",g),(!ve||Ie[0]&512&&x!==(x=t[9].w))&&b(s,"width",x),(!ve||Ie[0]&512&&C!==(C=t[9].h))&&b(s,"height",C),(!ve||Ie[0]&32&&H!==(H=t[5].points.map(mr).join(" ")))&&b(I,"points",H),t[6]!==void 0&&!t[7]?tt?tt.p(Wi(t),Ie):(tt=fr(Wi(t)),tt.c(),tt.m(o,null)):tt&&(tt.d(1),tt=null),t[6]!==void 0&&!t[7]?Ye?Ye.p(zi(t),Ie):(Ye=hr(zi(t)),Ye.c(),Ye.m(r,null)):Ye&&(Ye.d(1),Ye=null),(!ve||Ie[0]&32&&ne!==(ne=t[5].points.map(vr).join(" ")))&&b(B,"points",ne),(!ve||Ie[0]&2)&&b(ge,"style",t[1]),(!ve||Ie[0]&32&&de!==(de=t[5].points.map(yr).join(" ")))&&b(ge,"points",de),Ie[0]&134322472){gt=qt(t[5].points);let pe;for(pe=0;pe<gt.length;pe+=1){const Te=dr(t,gt,pe);ut[pe]?(ut[pe].p(Te,Ie),st(ut[pe],1)):(ut[pe]=pr(Te),ut[pe].c(),st(ut[pe],1),ut[pe].m(Se.parentNode,Se))}for(Vt(),pe=gt.length;pe<ut.length;pe+=1)Lt(pe);Qt()}t[6]!==void 0&&!t[7]?It?(It.p(ji(t),Ie),Ie[0]&192&&st(It,1)):(It=gr(ji(t)),It.c(),st(It,1),It.m(Fe.parentNode,Fe)):It&&(Vt(),ht(It,1,1,()=>{It=null}),Qt())},i(Ee){if(!ve){for(let Ie=0;Ie<gt.length;Ie+=1)st(ut[Ie]);st(It),ve=!0}},o(Ee){ut=ut.filter(Boolean);for(let Ie=0;Ie<ut.length;Ie+=1)ht(ut[Ie]);ht(It),ve=!1},d(Ee){Ee&&(V(r),V(W),V(B),V(we),V(ge),V(je),V(Se),V(Fe)),tt&&tt.d(),Ye&&Ye.d(),ie(ut,Ee),It&&It.d(Ee),He=!1,A(Ge)}}}function Po(t){let r,o;return r=new Ei({props:{shape:t[0],transform:t[2],editor:t[17],svgEl:t[4],$$slots:{default:[Io,({grab:s})=>({27:s}),({grab:s})=>[s?134217728:0]]},$$scope:{ctx:t}}}),r.$on("change",t[20]),r.$on("grab",t[21]),r.$on("release",t[22]),{c(){Xt(r.$$.fragment)},m(s,d){ue(r,s,d),o=!0},p(s,d){const g={};d[0]&1&&(g.shape=s[0]),d[0]&4&&(g.transform=s[2]),d[0]&16&&(g.svgEl=s[4]),d[0]&134219754|d[1]&1&&(g.$$scope={dirty:d,ctx:s}),r.$set(g)},i(s){o||(st(r.$$.fragment,s),o=!0)},o(s){ht(r.$$.fragment,s),o=!1},d(s){se(r,s)}}}const Do=250,Oo=1e3,Lo=12,ii=4.5,mr=t=>t.join(","),vr=t=>t.join(","),yr=t=>t.join(",");function No(t,r,o){let s,d,g;const x=Xe();let{shape:C}=r,{computedStyle:I}=r,{transform:H}=r,{viewportScale:W=1}=r,{svgEl:B}=r,ne,we=!1,ge,de=[];const je=()=>o(7,we=!0),Se=()=>o(7,we=!1),Fe=pe=>{if(de.length>0||!d.some(St=>St.visible)){o(6,ne=void 0);return}const[Te,Qe]=H.elementToImage(pe.offsetX,pe.offsetY),qe=St=>Math.pow(St[0]-Te,2)+Math.pow(St[1]-Qe,2),nt=s.points.reduce((St,Pt)=>qe(Pt)<qe(St)?Pt:St),At=d.filter(St=>St.visible).reduce((St,Pt)=>qe(Pt.point)<qe(St.point)?Pt:St),wt=Math.pow(Oo/W,2);qe(nt)<wt||qe(At.point)<wt?o(6,ne=d.indexOf(At)):o(6,ne=void 0)},ve=()=>{document.activeElement!==B&&B.focus()},He=()=>{o(8,de=[]),ve()},Ge=pe=>{o(7,we=!0),pe.preventDefault(),pe.stopPropagation(),ge=performance.now()},tt=pe=>Te=>{if(!ge||yn||performance.now()-ge>Do)return;const Qe=de.includes(pe);Te.metaKey||Te.ctrlKey||Te.shiftKey?Qe?o(8,de=de.filter(qe=>qe!==pe)):o(8,de=[...de,pe]):Qe&&de.length>1?o(8,de=[pe]):Qe?o(8,de=[]):o(8,de=[pe]),ve()},Ye=(pe,Te,Qe)=>{ve();let qe;const nt=pe.geometry;de.length>1?qe=nt.points.map(([wt,St],Pt)=>de.includes(Pt)?[wt+Qe[0],St+Qe[1]]:[wt,St]):Te==="SHAPE"?qe=nt.points.map(([wt,St])=>[wt+Qe[0],St+Qe[1]]):qe=nt.points.map(([wt,St],Pt)=>Te===`HANDLE-${Pt}`?[wt+Qe[0],St+Qe[1]]:[wt,St]);const At=Ut(qe);return{...pe,geometry:{points:qe,bounds:At}}},gt=pe=>async Te=>{Te.stopPropagation();const Qe=[...s.points.slice(0,pe+1),d[pe].point,...s.points.slice(pe+1)],qe=Ut(Qe);x("change",{...C,geometry:{points:Qe,bounds:qe}}),await le();const nt=[...document.querySelectorAll(".a9s-handle")][pe+1];if(nt!=null&&nt.firstChild){const At=new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:Te.clientX,clientY:Te.clientY,pointerId:Te.pointerId,pointerType:Te.pointerType,isPrimary:Te.isPrimary,buttons:Te.buttons});nt.firstChild.dispatchEvent(At)}},ut=()=>{if(s.points.length-de.length<3)return;const pe=s.points.filter((Qe,qe)=>!de.includes(qe)),Te=Ut(pe);x("change",{...C,geometry:{points:pe,bounds:Te}}),o(8,de=[])};Ue(()=>{if(yn)return;const pe=Te=>{(Te.key==="Delete"||Te.key==="Backspace")&&(Te.preventDefault(),ut())};return B.addEventListener("pointermove",Fe),B.addEventListener("keydown",pe),()=>{B.removeEventListener("pointermove",Fe),B.removeEventListener("keydown",pe)}});const Lt=`polygon-mask-${Math.random().toString(36).substring(2,12)}`;function It(pe){ot.call(this,t,pe)}function Ee(pe){ot.call(this,t,pe)}function Ie(pe){ot.call(this,t,pe)}return t.$$set=pe=>{"shape"in pe&&o(0,C=pe.shape),"computedStyle"in pe&&o(1,I=pe.computedStyle),"transform"in pe&&o(2,H=pe.transform),"viewportScale"in pe&&o(3,W=pe.viewportScale),"svgEl"in pe&&o(4,B=pe.svgEl)},t.$$.update=()=>{t.$$.dirty[0]&1&&o(5,s=C.geometry),t.$$.dirty[0]&40&&o(10,d=yn?[]:s.points.map((pe,Te)=>{const Qe=Te===s.points.length-1?s.points[0]:s.points[Te+1],qe=(pe[0]+Qe[0])/2,nt=(pe[1]+Qe[1])/2,At=Math.sqrt(Math.pow(Qe[0]-qe,2)+Math.pow(Qe[1]-nt,2))>Lo/W;return{point:[qe,nt],visible:At}})),t.$$.dirty[0]&40&&o(9,g=ni(s.bounds,ii/W))},[C,I,H,W,B,s,ne,we,de,g,d,je,Se,Fe,He,Ge,tt,Ye,gt,Lt,It,Ee,Ie]}class br extends it{constructor(r){super(),Me(this,r,No,Po,z,{shape:0,computedStyle:1,transform:2,viewportScale:3,svgEl:4},null,[-1,-1])}}function Fo(t){let r,o,s,d,g,x,C,I,H,W,B,ne,we,ge,de,je,Se,Fe,ve,He,Ge,tt,Ye,gt,ut,Lt,It,Ee,Ie,pe,Te,Qe,qe,nt,At,wt,St,Pt,$t,ln,Kt,bn,In,yt,an,zt,sn,gn,Wn,Pn,ir,Dn,Ht,rr,co;return zt=new zn({props:{class:"a9s-corner-handle-topleft",x:t[5].x,y:t[5].y,scale:t[3]}}),zt.$on("pointerdown",function(){D(t[12]("TOP_LEFT"))&&t[12]("TOP_LEFT").apply(this,arguments)}),gn=new zn({props:{class:"a9s-corner-handle-topright",x:t[5].x+t[5].w,y:t[5].y,scale:t[3]}}),gn.$on("pointerdown",function(){D(t[12]("TOP_RIGHT"))&&t[12]("TOP_RIGHT").apply(this,arguments)}),Pn=new zn({props:{class:"a9s-corner-handle-bottomright",x:t[5].x+t[5].w,y:t[5].y+t[5].h,scale:t[3]}}),Pn.$on("pointerdown",function(){D(t[12]("BOTTOM_RIGHT"))&&t[12]("BOTTOM_RIGHT").apply(this,arguments)}),Dn=new zn({props:{class:"a9s-corner-handle-bottomleft",x:t[5].x,y:t[5].y+t[5].h,scale:t[3]}}),Dn.$on("pointerdown",function(){D(t[12]("BOTTOM_LEFT"))&&t[12]("BOTTOM_LEFT").apply(this,arguments)}),{c(){r=R("defs"),o=R("mask"),s=R("rect"),I=R("rect"),we=N(),ge=R("rect"),ve=N(),He=R("rect"),ut=N(),Lt=R("rect"),pe=N(),Te=R("rect"),At=N(),wt=R("rect"),ln=N(),Kt=R("rect"),an=N(),Xt(zt.$$.fragment),sn=N(),Xt(gn.$$.fragment),Wn=N(),Xt(Pn.$$.fragment),ir=N(),Xt(Dn.$$.fragment),b(s,"class","rect-mask-bg svelte-1njczvj"),b(s,"x",d=t[6].x),b(s,"y",g=t[6].y),b(s,"width",x=t[6].w),b(s,"height",C=t[6].h),b(I,"class","rect-mask-fg svelte-1njczvj"),b(I,"x",H=t[5].x),b(I,"y",W=t[5].y),b(I,"width",B=t[5].w),b(I,"height",ne=t[5].h),b(o,"id",t[8]),b(o,"class","a9s-rectangle-editor-mask svelte-1njczvj"),b(ge,"class","a9s-outer"),b(ge,"mask",`url(#${t[8]})`),b(ge,"x",de=t[5].x),b(ge,"y",je=t[5].y),b(ge,"width",Se=t[5].w),b(ge,"height",Fe=t[5].h),b(He,"class","a9s-inner a9s-shape-handle"),b(He,"style",t[1]),b(He,"x",Ge=t[5].x),b(He,"y",tt=t[5].y),b(He,"width",Ye=t[5].w),b(He,"height",gt=t[5].h),b(Lt,"class","a9s-edge-handle a9s-edge-handle-top"),b(Lt,"x",It=t[5].x),b(Lt,"y",Ee=t[5].y),b(Lt,"height",1),b(Lt,"width",Ie=t[5].w),b(Te,"class","a9s-edge-handle a9s-edge-handle-right"),b(Te,"x",Qe=t[5].x+t[5].w),b(Te,"y",qe=t[5].y),b(Te,"height",nt=t[5].h),b(Te,"width",1),b(wt,"class","a9s-edge-handle a9s-edge-handle-bottom"),b(wt,"x",St=t[5].x),b(wt,"y",Pt=t[5].y+t[5].h),b(wt,"height",1),b(wt,"width",$t=t[5].w),b(Kt,"class","a9s-edge-handle a9s-edge-handle-left"),b(Kt,"x",bn=t[5].x),b(Kt,"y",In=t[5].y),b(Kt,"height",yt=t[5].h),b(Kt,"width",1)},m(Ot,dt){M(Ot,r,dt),te(r,o),te(o,s),te(o,I),M(Ot,we,dt),M(Ot,ge,dt),M(Ot,ve,dt),M(Ot,He,dt),M(Ot,ut,dt),M(Ot,Lt,dt),M(Ot,pe,dt),M(Ot,Te,dt),M(Ot,At,dt),M(Ot,wt,dt),M(Ot,ln,dt),M(Ot,Kt,dt),M(Ot,an,dt),ue(zt,Ot,dt),M(Ot,sn,dt),ue(gn,Ot,dt),M(Ot,Wn,dt),ue(Pn,Ot,dt),M(Ot,ir,dt),ue(Dn,Ot,dt),Ht=!0,rr||(co=[oe(ge,"pointerdown",function(){D(t[12]("SHAPE"))&&t[12]("SHAPE").apply(this,arguments)}),oe(He,"pointerdown",function(){D(t[12]("SHAPE"))&&t[12]("SHAPE").apply(this,arguments)}),oe(Lt,"pointerdown",function(){D(t[12]("TOP"))&&t[12]("TOP").apply(this,arguments)}),oe(Te,"pointerdown",function(){D(t[12]("RIGHT"))&&t[12]("RIGHT").apply(this,arguments)}),oe(wt,"pointerdown",function(){D(t[12]("BOTTOM"))&&t[12]("BOTTOM").apply(this,arguments)}),oe(Kt,"pointerdown",function(){D(t[12]("LEFT"))&&t[12]("LEFT").apply(this,arguments)})],rr=!0)},p(Ot,dt){t=Ot,(!Ht||dt&64&&d!==(d=t[6].x))&&b(s,"x",d),(!Ht||dt&64&&g!==(g=t[6].y))&&b(s,"y",g),(!Ht||dt&64&&x!==(x=t[6].w))&&b(s,"width",x),(!Ht||dt&64&&C!==(C=t[6].h))&&b(s,"height",C),(!Ht||dt&32&&H!==(H=t[5].x))&&b(I,"x",H),(!Ht||dt&32&&W!==(W=t[5].y))&&b(I,"y",W),(!Ht||dt&32&&B!==(B=t[5].w))&&b(I,"width",B),(!Ht||dt&32&&ne!==(ne=t[5].h))&&b(I,"height",ne),(!Ht||dt&32&&de!==(de=t[5].x))&&b(ge,"x",de),(!Ht||dt&32&&je!==(je=t[5].y))&&b(ge,"y",je),(!Ht||dt&32&&Se!==(Se=t[5].w))&&b(ge,"width",Se),(!Ht||dt&32&&Fe!==(Fe=t[5].h))&&b(ge,"height",Fe),(!Ht||dt&2)&&b(He,"style",t[1]),(!Ht||dt&32&&Ge!==(Ge=t[5].x))&&b(He,"x",Ge),(!Ht||dt&32&&tt!==(tt=t[5].y))&&b(He,"y",tt),(!Ht||dt&32&&Ye!==(Ye=t[5].w))&&b(He,"width",Ye),(!Ht||dt&32&&gt!==(gt=t[5].h))&&b(He,"height",gt),(!Ht||dt&32&&It!==(It=t[5].x))&&b(Lt,"x",It),(!Ht||dt&32&&Ee!==(Ee=t[5].y))&&b(Lt,"y",Ee),(!Ht||dt&32&&Ie!==(Ie=t[5].w))&&b(Lt,"width",Ie),(!Ht||dt&32&&Qe!==(Qe=t[5].x+t[5].w))&&b(Te,"x",Qe),(!Ht||dt&32&&qe!==(qe=t[5].y))&&b(Te,"y",qe),(!Ht||dt&32&&nt!==(nt=t[5].h))&&b(Te,"height",nt),(!Ht||dt&32&&St!==(St=t[5].x))&&b(wt,"x",St),(!Ht||dt&32&&Pt!==(Pt=t[5].y+t[5].h))&&b(wt,"y",Pt),(!Ht||dt&32&&$t!==($t=t[5].w))&&b(wt,"width",$t),(!Ht||dt&32&&bn!==(bn=t[5].x))&&b(Kt,"x",bn),(!Ht||dt&32&&In!==(In=t[5].y))&&b(Kt,"y",In),(!Ht||dt&32&&yt!==(yt=t[5].h))&&b(Kt,"height",yt);const Ti={};dt&32&&(Ti.x=t[5].x),dt&32&&(Ti.y=t[5].y),dt&8&&(Ti.scale=t[3]),zt.$set(Ti);const Si={};dt&32&&(Si.x=t[5].x+t[5].w),dt&32&&(Si.y=t[5].y),dt&8&&(Si.scale=t[3]),gn.$set(Si);const Ai={};dt&32&&(Ai.x=t[5].x+t[5].w),dt&32&&(Ai.y=t[5].y+t[5].h),dt&8&&(Ai.scale=t[3]),Pn.$set(Ai);const ki={};dt&32&&(ki.x=t[5].x),dt&32&&(ki.y=t[5].y+t[5].h),dt&8&&(ki.scale=t[3]),Dn.$set(ki)},i(Ot){Ht||(st(zt.$$.fragment,Ot),st(gn.$$.fragment,Ot),st(Pn.$$.fragment,Ot),st(Dn.$$.fragment,Ot),Ht=!0)},o(Ot){ht(zt.$$.fragment,Ot),ht(gn.$$.fragment,Ot),ht(Pn.$$.fragment,Ot),ht(Dn.$$.fragment,Ot),Ht=!1},d(Ot){Ot&&(V(r),V(we),V(ge),V(ve),V(He),V(ut),V(Lt),V(pe),V(Te),V(At),V(wt),V(ln),V(Kt),V(an),V(sn),V(Wn),V(ir)),se(zt,Ot),se(gn,Ot),se(Pn,Ot),se(Dn,Ot),rr=!1,A(co)}}}function Ho(t){let r,o;return r=new Ei({props:{shape:t[0],transform:t[2],editor:t[7],svgEl:t[4],$$slots:{default:[Fo,({grab:s})=>({12:s}),({grab:s})=>s?4096:0]},$$scope:{ctx:t}}}),r.$on("grab",t[9]),r.$on("change",t[10]),r.$on("release",t[11]),{c(){Xt(r.$$.fragment)},m(s,d){ue(r,s,d),o=!0},p(s,[d]){const g={};d&1&&(g.shape=s[0]),d&4&&(g.transform=s[2]),d&16&&(g.svgEl=s[4]),d&12394&&(g.$$scope={dirty:d,ctx:s}),r.$set(g)},i(s){o||(st(r.$$.fragment,s),o=!0)},o(s){ht(r.$$.fragment,s),o=!1},d(s){se(r,s)}}}function Ro(t,r,o){let s,d,{shape:g}=r,{computedStyle:x}=r,{transform:C}=r,{viewportScale:I=1}=r,{svgEl:H}=r;const W=(de,je,Se)=>{const Fe=de.geometry.bounds;let[ve,He]=[Fe.minX,Fe.minY],[Ge,tt]=[Fe.maxX,Fe.maxY];const[Ye,gt]=Se;if(je==="SHAPE")ve+=Ye,Ge+=Ye,He+=gt,tt+=gt;else{switch(je){case"TOP":case"TOP_LEFT":case"TOP_RIGHT":{He+=gt;break}case"BOTTOM":case"BOTTOM_LEFT":case"BOTTOM_RIGHT":{tt+=gt;break}}switch(je){case"LEFT":case"TOP_LEFT":case"BOTTOM_LEFT":{ve+=Ye;break}case"RIGHT":case"TOP_RIGHT":case"BOTTOM_RIGHT":{Ge+=Ye;break}}}const ut=Math.min(ve,Ge),Lt=Math.min(He,tt),It=Math.abs(Ge-ve),Ee=Math.abs(tt-He);return{...de,geometry:{x:ut,y:Lt,w:It,h:Ee,bounds:{minX:ut,minY:Lt,maxX:ut+It,maxY:Lt+Ee}}}},B=`rect-mask-${Math.random().toString(36).substring(2,12)}`;function ne(de){ot.call(this,t,de)}function we(de){ot.call(this,t,de)}function ge(de){ot.call(this,t,de)}return t.$$set=de=>{"shape"in de&&o(0,g=de.shape),"computedStyle"in de&&o(1,x=de.computedStyle),"transform"in de&&o(2,C=de.transform),"viewportScale"in de&&o(3,I=de.viewportScale),"svgEl"in de&&o(4,H=de.svgEl)},t.$$.update=()=>{t.$$.dirty&1&&o(5,s=g.geometry),t.$$.dirty&40&&o(6,d=ni(s.bounds,2/I))},[g,x,C,I,H,s,d,W,B,ne,we,ge]}class wr extends it{constructor(r){super(),Me(this,r,Ro,Ho,z,{shape:0,computedStyle:1,transform:2,viewportScale:3,svgEl:4})}}var _r=Object.prototype.hasOwnProperty;function Bi(t,r){var o,s;if(t===r)return!0;if(t&&r&&(o=t.constructor)===r.constructor){if(o===Date)return t.getTime()===r.getTime();if(o===RegExp)return t.toString()===r.toString();if(o===Array){if((s=t.length)===r.length)for(;s--&&Bi(t[s],r[s]););return s===-1}if(!o||typeof t=="object"){s=0;for(o in t)if(_r.call(t,o)&&++s&&!_r.call(r,o)||!(o in r)||!Bi(t[o],r[o]))return!1;return Object.keys(r).length===s}}return t!==t&&r!==r}const Vo=12,Uo=(t,r)=>t.polygons.reduce((o,s,d)=>{const g=s.rings.reduce((x,C,I)=>{const H=C.points.map((W,B)=>{const ne=B===C.points.length-1?C.points[0]:C.points[B+1],we=(W[0]+ne[0])/2,ge=(W[1]+ne[1])/2,de=Math.sqrt(Math.pow(ne[0]-we,2)+Math.pow(ne[1]-ge,2))>Vo/r;return{point:[we,ge],visible:de,elementIdx:d,ringIdx:I,pointIdx:B}});return[...x,...H]},[]);return[...o,...g]},[]);function Gi(t){const r=t.slice(),o=r[10][r[6]];return r[29]=o.point,r}function Er(t,r,o){const s=t.slice();return s[30]=r[o],s[32]=o,s}function xr(t,r,o){const s=t.slice();return s[33]=r[o],s[35]=o,s}function Cr(t,r,o){const s=t.slice();return s[29]=r[o],s[37]=o,s}function Yi(t){const r=t.slice(),o=r[10][r[6]];return r[29]=o.point,r}function Xi(t){const r=t.slice(),o=r[10][r[6]];return r[29]=o.point,r}function Tr(t){let r,o,s,d;return{c(){r=R("circle"),b(r,"cx",o=t[29][0]),b(r,"cy",s=t[29][1]),b(r,"r",d=ri/t[3]),b(r,"class","svelte-1vxo6dc")},m(g,x){M(g,r,x)},p(g,x){x[0]&1088&&o!==(o=g[29][0])&&b(r,"cx",o),x[0]&1088&&s!==(s=g[29][1])&&b(r,"cy",s),x[0]&8&&d!==(d=ri/g[3])&&b(r,"r",d)},d(g){g&&V(r)}}}function Sr(t){let r,o,s,d,g,x,C,I,H,W;return{c(){r=R("mask"),o=R("rect"),C=R("circle"),b(o,"x",s=t[9].x),b(o,"y",d=t[9].y),b(o,"width",g=t[9].w),b(o,"height",x=t[9].h),b(o,"class","svelte-1vxo6dc"),b(C,"cx",I=t[29][0]),b(C,"cy",H=t[29][1]),b(C,"r",W=ri/t[3]),b(C,"class","svelte-1vxo6dc"),b(r,"id",`${t[18]}-${t[32]}-inner`),b(r,"class","a9s-multipolygon-editor-mask svelte-1vxo6dc")},m(B,ne){M(B,r,ne),te(r,o),te(r,C)},p(B,ne){ne[0]&512&&s!==(s=B[9].x)&&b(o,"x",s),ne[0]&512&&d!==(d=B[9].y)&&b(o,"y",d),ne[0]&512&&g!==(g=B[9].w)&&b(o,"width",g),ne[0]&512&&x!==(x=B[9].h)&&b(o,"height",x),ne[0]&1088&&I!==(I=B[29][0])&&b(C,"cx",I),ne[0]&1088&&H!==(H=B[29][1])&&b(C,"cy",H),ne[0]&8&&W!==(W=ri/B[3])&&b(C,"r",W)},d(B){B&&V(r)}}}function Ar(t){let r,o;function s(...d){return t[19](t[32],t[35],t[37],...d)}return r=new zn({props:{class:"a9s-corner-handle",x:t[29][0],y:t[29][1],scale:t[3],selected:t[8].some(s)}}),r.$on("pointerenter",t[11]),r.$on("pointerleave",t[12]),r.$on("pointerdown",t[14]),r.$on("pointerdown",function(){D(t[28](`HANDLE-${t[32]}-${t[35]}-${t[37]}`))&&t[28](`HANDLE-${t[32]}-${t[35]}-${t[37]}`).apply(this,arguments)}),r.$on("pointerup",t[15](t[32],t[35],t[37])),{c(){Xt(r.$$.fragment)},m(d,g){ue(r,d,g),o=!0},p(d,g){t=d;const x={};g[0]&32&&(x.x=t[29][0]),g[0]&32&&(x.y=t[29][1]),g[0]&8&&(x.scale=t[3]),g[0]&256&&(x.selected=t[8].some(s)),r.$set(x)},i(d){o||(st(r.$$.fragment,d),o=!0)},o(d){ht(r.$$.fragment,d),o=!1},d(d){se(r,d)}}}function kr(t){let r,o,s=qt(t[33].points),d=[];for(let x=0;x<s.length;x+=1)d[x]=Ar(Cr(t,s,x));const g=x=>ht(d[x],1,1,()=>{d[x]=null});return{c(){for(let x=0;x<d.length;x+=1)d[x].c();r=Q()},m(x,C){for(let I=0;I<d.length;I+=1)d[I]&&d[I].m(x,C);M(x,r,C),o=!0},p(x,C){if(C[0]&268491048){s=qt(x[33].points);let I;for(I=0;I<s.length;I+=1){const H=Cr(x,s,I);d[I]?(d[I].p(H,C),st(d[I],1)):(d[I]=Ar(H),d[I].c(),st(d[I],1),d[I].m(r.parentNode,r))}for(Vt(),I=s.length;I<d.length;I+=1)g(I);Qt()}},i(x){if(!o){for(let C=0;C<s.length;C+=1)st(d[C]);o=!0}},o(x){d=d.filter(Boolean);for(let C=0;C<d.length;C+=1)ht(d[C]);o=!1},d(x){x&&V(r),ie(d,x)}}}function Ir(t){let r,o,s,d,g,x,C,I,H,W,B,ne,we,ge,de,je,Se,Fe=t[6]!==void 0&&!t[7]&&Tr(Xi(t)),ve=t[6]!==void 0&&!t[7]&&Sr(Yi(t)),He=qt(t[30].rings),Ge=[];for(let Ye=0;Ye<He.length;Ye+=1)Ge[Ye]=kr(xr(t,He,Ye));const tt=Ye=>ht(Ge[Ye],1,1,()=>{Ge[Ye]=null});return{c(){r=R("g"),o=R("defs"),s=R("mask"),d=R("rect"),H=R("path"),Fe&&Fe.c(),ve&&ve.c(),B=R("path"),we=R("path");for(let Ye=0;Ye<Ge.length;Ye+=1)Ge[Ye].c();b(d,"x",g=t[9].x),b(d,"y",x=t[9].y),b(d,"width",C=t[9].w),b(d,"height",I=t[9].h),b(d,"class","svelte-1vxo6dc"),b(H,"d",W=fn(t[30])),b(H,"class","svelte-1vxo6dc"),b(s,"id",`${t[18]}-${t[32]}-outer`),b(s,"class","a9s-multipolygon-editor-mask svelte-1vxo6dc"),b(B,"class","a9s-outer"),b(B,"mask",`url(#${t[18]}-${t[32]}-outer)`),b(B,"fill-rule","evenodd"),b(B,"d",ne=fn(t[30])),b(we,"class","a9s-inner"),b(we,"mask",`url(#${t[18]}-${t[32]}-inner)`),b(we,"style",t[1]),b(we,"fill-rule","evenodd"),b(we,"d",ge=fn(t[30]))},m(Ye,gt){M(Ye,r,gt),te(r,o),te(o,s),te(s,d),te(s,H),Fe&&Fe.m(s,null),ve&&ve.m(o,null),te(r,B),te(r,we);for(let ut=0;ut<Ge.length;ut+=1)Ge[ut]&&Ge[ut].m(r,null);de=!0,je||(Se=[oe(B,"pointerup",t[13]),oe(B,"pointerdown",function(){D(t[28]("SHAPE"))&&t[28]("SHAPE").apply(this,arguments)}),oe(we,"pointerup",t[13]),oe(we,"pointerdown",function(){D(t[28]("SHAPE"))&&t[28]("SHAPE").apply(this,arguments)})],je=!0)},p(Ye,gt){if(t=Ye,(!de||gt[0]&512&&g!==(g=t[9].x))&&b(d,"x",g),(!de||gt[0]&512&&x!==(x=t[9].y))&&b(d,"y",x),(!de||gt[0]&512&&C!==(C=t[9].w))&&b(d,"width",C),(!de||gt[0]&512&&I!==(I=t[9].h))&&b(d,"height",I),(!de||gt[0]&32&&W!==(W=fn(t[30])))&&b(H,"d",W),t[6]!==void 0&&!t[7]?Fe?Fe.p(Xi(t),gt):(Fe=Tr(Xi(t)),Fe.c(),Fe.m(s,null)):Fe&&(Fe.d(1),Fe=null),t[6]!==void 0&&!t[7]?ve?ve.p(Yi(t),gt):(ve=Sr(Yi(t)),ve.c(),ve.m(o,null)):ve&&(ve.d(1),ve=null),(!de||gt[0]&32&&ne!==(ne=fn(t[30])))&&b(B,"d",ne),(!de||gt[0]&2)&&b(we,"style",t[1]),(!de||gt[0]&32&&ge!==(ge=fn(t[30])))&&b(we,"d",ge),gt[0]&268491048){He=qt(t[30].rings);let ut;for(ut=0;ut<He.length;ut+=1){const Lt=xr(t,He,ut);Ge[ut]?(Ge[ut].p(Lt,gt),st(Ge[ut],1)):(Ge[ut]=kr(Lt),Ge[ut].c(),st(Ge[ut],1),Ge[ut].m(r,null))}for(Vt(),ut=He.length;ut<Ge.length;ut+=1)tt(ut);Qt()}},i(Ye){if(!de){for(let gt=0;gt<He.length;gt+=1)st(Ge[gt]);de=!0}},o(Ye){Ge=Ge.filter(Boolean);for(let gt=0;gt<Ge.length;gt+=1)ht(Ge[gt]);de=!1},d(Ye){Ye&&V(r),Fe&&Fe.d(),ve&&ve.d(),ie(Ge,Ye),je=!1,A(Se)}}}function Pr(t){let r,o;return r=new Ui({props:{x:t[29][0],y:t[29][1],scale:t[3]}}),r.$on("pointerdown",function(){D(t[17](t[6]))&&t[17](t[6]).apply(this,arguments)}),{c(){Xt(r.$$.fragment)},m(s,d){ue(r,s,d),o=!0},p(s,d){t=s;const g={};d[0]&1088&&(g.x=t[29][0]),d[0]&1088&&(g.y=t[29][1]),d[0]&8&&(g.scale=t[3]),r.$set(g)},i(s){o||(st(r.$$.fragment,s),o=!0)},o(s){ht(r.$$.fragment,s),o=!1},d(s){se(r,s)}}}function jo(t){let r,o,s,d=qt(t[5].polygons),g=[];for(let I=0;I<d.length;I+=1)g[I]=Ir(Er(t,d,I));const x=I=>ht(g[I],1,1,()=>{g[I]=null});let C=t[6]!==void 0&&!t[7]&&Pr(Gi(t));return{c(){for(let I=0;I<g.length;I+=1)g[I].c();r=N(),C&&C.c(),o=Q()},m(I,H){for(let W=0;W<g.length;W+=1)g[W]&&g[W].m(I,H);M(I,r,H),C&&C.m(I,H),M(I,o,H),s=!0},p(I,H){if(H[0]&268763114){d=qt(I[5].polygons);let W;for(W=0;W<d.length;W+=1){const B=Er(I,d,W);g[W]?(g[W].p(B,H),st(g[W],1)):(g[W]=Ir(B),g[W].c(),st(g[W],1),g[W].m(r.parentNode,r))}for(Vt(),W=d.length;W<g.length;W+=1)x(W);Qt()}I[6]!==void 0&&!I[7]?C?(C.p(Gi(I),H),H[0]&192&&st(C,1)):(C=Pr(Gi(I)),C.c(),st(C,1),C.m(o.parentNode,o)):C&&(Vt(),ht(C,1,1,()=>{C=null}),Qt())},i(I){if(!s){for(let H=0;H<d.length;H+=1)st(g[H]);st(C),s=!0}},o(I){g=g.filter(Boolean);for(let H=0;H<g.length;H+=1)ht(g[H]);ht(C),s=!1},d(I){I&&(V(r),V(o)),ie(g,I),C&&C.d(I)}}}function zo(t){let r,o;return r=new Ei({props:{shape:t[0],transform:t[2],editor:t[16],svgEl:t[4],$$slots:{default:[jo,({grab:s})=>({28:s}),({grab:s})=>[s?268435456:0]]},$$scope:{ctx:t}}}),r.$on("change",t[20]),r.$on("grab",t[21]),r.$on("release",t[22]),{c(){Xt(r.$$.fragment)},m(s,d){ue(r,s,d),o=!0},p(s,d){const g={};d[0]&1&&(g.shape=s[0]),d[0]&4&&(g.transform=s[2]),d[0]&16&&(g.svgEl=s[4]),d[0]&268437482|d[1]&128&&(g.$$scope={dirty:d,ctx:s}),r.$set(g)},i(s){o||(st(r.$$.fragment,s),o=!0)},o(s){ht(r.$$.fragment,s),o=!1},d(s){se(r,s)}}}const Wo=250,Bo=1e3,ri=4.5;function Go(t,r,o){let s,d,g;const x=Xe();let{shape:C}=r,{computedStyle:I}=r,{transform:H}=r,{viewportScale:W=1}=r,{svgEl:B}=r,ne,we=!1,ge,de=[];const je=()=>o(7,we=!0),Se=()=>o(7,we=!1),Fe=Te=>{if(de.length>0||!d.some(Pt=>Pt.visible)){o(6,ne=void 0);return}const[Qe,qe]=H.elementToImage(Te.offsetX,Te.offsetY),nt=Pt=>Math.pow(Pt[0]-Qe,2)+Math.pow(Pt[1]-qe,2),At=li(s).reduce((Pt,$t)=>nt($t)<nt(Pt)?$t:Pt),wt=d.filter(Pt=>Pt.visible).reduce((Pt,$t)=>nt($t.point)<nt(Pt.point)?$t:Pt),St=Math.pow(Bo/W,2);nt(At)<St||nt(wt.point)<St?o(6,ne=d.indexOf(wt)):o(6,ne=void 0)},ve=()=>{document.activeElement!==B&&B.focus()},He=()=>{o(8,de=[]),ve()},Ge=Te=>{o(7,we=!0),Te.preventDefault(),Te.stopPropagation(),ge=performance.now()},tt=(Te,Qe,qe)=>nt=>{if(!ge||yn||performance.now()-ge>Wo)return;const At=St=>St.polygon===Te&&St.ring===Qe&&St.point===qe,wt=de.some(At);nt.metaKey||nt.ctrlKey||nt.shiftKey?wt?o(8,de=de.filter(St=>!At(St))):o(8,de=[...de,{polygon:Te,ring:Qe,point:qe}]):wt&&de.length>1?o(8,de=[{polygon:Te,ring:Qe,point:qe}]):wt?o(8,de=[]):o(8,de=[{polygon:Te,ring:Qe,point:qe}]),ve()},Ye=(Te,Qe,qe)=>{ve();const nt=Te.geometry.polygons;let At;if(Qe==="SHAPE")At=nt.map(wt=>{const St=wt.rings.map(($t,ln)=>({points:$t.points.map((Kt,bn)=>[Kt[0]+qe[0],Kt[1]+qe[1]])})),Pt=Ut(St[0].points);return{rings:St,bounds:Pt}});else{const[wt,St,Pt,$t]=Qe.split("-").map(ln=>parseInt(ln));At=nt.map((ln,Kt)=>{if(Kt===St){const bn=ln.rings.map((yt,an)=>an===Pt?{points:yt.points.map((zt,sn)=>sn===$t?[zt[0]+qe[0],zt[1]+qe[1]]:zt)}:yt),In=Ut(bn[0].points);return{rings:bn,bounds:In}}else return ln})}return{...Te,geometry:{polygons:At,bounds:On(At)}}},gt=Te=>async Qe=>{Qe.stopPropagation();const qe=d[Te],nt=s.polygons.map((wt,St)=>{if(St===qe.elementIdx){const Pt=wt.rings.map((ln,Kt)=>Kt===qe.ringIdx?{points:[...ln.points.slice(0,qe.pointIdx+1),qe.point,...ln.points.slice(qe.pointIdx+1)]}:ln),$t=Ut(Pt[0].points);return{rings:Pt,bounds:$t}}else return wt});x("change",{...C,geometry:{polygons:nt,bounds:On(nt)}}),await le();const At=[...document.querySelectorAll(".a9s-handle")][Te+1];if(At!=null&&At.firstChild){const wt=new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:Qe.clientX,clientY:Qe.clientY,pointerId:Qe.pointerId,pointerType:Qe.pointerType,isPrimary:Qe.isPrimary,buttons:Qe.buttons});At.firstChild.dispatchEvent(wt)}},ut=()=>{const Te=s.polygons.map((Qe,qe)=>{if(de.some(nt=>nt.polygon===qe)){const nt=Qe.rings.map((wt,St)=>{const Pt=de.filter($t=>$t.polygon===qe&&$t.ring===St);return Pt.length&&wt.points.length-Pt.length>=3?{points:wt.points.filter(($t,ln)=>!Pt.some(Kt=>Kt.point===ln))}:wt}),At=Ut(nt[0].points);return{rings:nt,bounds:At}}else return Qe});!Bi(s.polygons,Te)&&(x("change",{...C,geometry:{polygons:Te,bounds:On(Te)}}),o(8,de=[]))};Ue(()=>{if(yn)return;const Te=Qe=>{(Qe.key==="Delete"||Qe.key==="Backspace")&&(Qe.preventDefault(),ut())};return B.addEventListener("pointermove",Fe),B.addEventListener("keydown",Te),()=>{B.removeEventListener("pointermove",Fe),B.removeEventListener("keydown",Te)}});const Lt=`polygon-mask-${Math.random().toString(36).substring(2,12)}`,It=(Te,Qe,qe,{polygon:nt,ring:At,point:wt})=>nt===Te&&At===Qe&&wt===qe;function Ee(Te){ot.call(this,t,Te)}function Ie(Te){ot.call(this,t,Te)}function pe(Te){ot.call(this,t,Te)}return t.$$set=Te=>{"shape"in Te&&o(0,C=Te.shape),"computedStyle"in Te&&o(1,I=Te.computedStyle),"transform"in Te&&o(2,H=Te.transform),"viewportScale"in Te&&o(3,W=Te.viewportScale),"svgEl"in Te&&o(4,B=Te.svgEl)},t.$$.update=()=>{t.$$.dirty[0]&1&&o(5,s=C.geometry),t.$$.dirty[0]&40&&o(10,d=yn?[]:Uo(s,W)),t.$$.dirty[0]&40&&o(9,g=ni(s.bounds,ri/W))},[C,I,H,W,B,s,ne,we,de,g,d,je,Se,He,Ge,tt,Ye,gt,Lt,It,Ee,Ie,pe]}class Yo extends it{constructor(r){super(),Me(this,r,Go,zo,z,{shape:0,computedStyle:1,transform:2,viewportScale:3,svgEl:4},null,[-1,-1])}}const Dr=new Map([[at.RECTANGLE,wr],[at.POLYGON,br],[at.MULTIPOLYGON,Yo]]),Or=t=>Dr.get(t.type),Lr=(t,r)=>Dr.set(t,r);function Xo(t,r,o){let s;const d=Xe();let{annotation:g}=r,{editor:x}=r,{style:C}=r,{target:I}=r,{transform:H}=r,{viewportScale:W}=r,B;return Ue(()=>(o(6,B=new x({target:I,props:{shape:g.target.selector,computedStyle:s,transform:H,viewportScale:W,svgEl:I.closest("svg")}})),B.$on("change",ne=>{B.$$set({shape:ne.detail}),d("change",ne.detail)}),B.$on("grab",ne=>d("grab",ne.detail)),B.$on("release",ne=>d("release",ne.detail)),()=>{B.$destroy()})),t.$$set=ne=>{"annotation"in ne&&o(0,g=ne.annotation),"editor"in ne&&o(1,x=ne.editor),"style"in ne&&o(2,C=ne.style),"target"in ne&&o(3,I=ne.target),"transform"in ne&&o(4,H=ne.transform),"viewportScale"in ne&&o(5,W=ne.viewportScale)},t.$$.update=()=>{t.$$.dirty&5&&o(7,s=jn(g,C)),t.$$.dirty&65&&g&&(B==null||B.$set({shape:g.target.selector})),t.$$.dirty&80&&B&&B.$set({transform:H}),t.$$.dirty&96&&B&&B.$set({viewportScale:W}),t.$$.dirty&192&&B&&s&&B.$set({computedStyle:s})},[g,x,C,I,H,W,B,s]}class Nr extends it{constructor(r){super(),Me(this,r,Xo,null,z,{annotation:0,editor:1,style:2,target:3,transform:4,viewportScale:5})}}function Mo(t,r,o){const s=Xe();let{drawingMode:d}=r,{target:g}=r,{tool:x}=r,{transform:C}=r,{viewportScale:I}=r,H;return Ue(()=>{const W=g.closest("svg"),B=[],ne=(we,ge,de)=>{W==null||W.addEventListener(we,ge,de),B.push(()=>W==null?void 0:W.removeEventListener(we,ge,de))};return o(5,H=new x({target:g,props:{addEventListener:ne,drawingMode:d,transform:C,viewportScale:I}})),H.$on("create",we=>s("create",we.detail)),()=>{B.forEach(we=>we()),H.$destroy()}}),t.$$set=W=>{"drawingMode"in W&&o(0,d=W.drawingMode),"target"in W&&o(1,g=W.target),"tool"in W&&o(2,x=W.tool),"transform"in W&&o(3,C=W.transform),"viewportScale"in W&&o(4,I=W.viewportScale)},t.$$.update=()=>{t.$$.dirty&40&&H&&H.$set({transform:C}),t.$$.dirty&48&&H&&H.$set({viewportScale:I})},[d,g,x,C,I,H]}class Fr extends it{constructor(r){super(),Me(this,r,Mo,null,z,{drawingMode:0,target:1,tool:2,transform:3,viewportScale:4})}}function Hr(t){let r,o,s,d,g,x,C,I,H,W;return{c(){r=R("defs"),o=R("mask"),s=R("rect"),I=R("rect"),H=R("rect"),W=R("rect"),b(s,"class","rect-mask-bg svelte-1a76qe7"),b(s,"x",d=t[1]-t[5]),b(s,"y",g=t[2]-t[5]),b(s,"width",x=t[3]+2*t[5]),b(s,"height",C=t[4]+2*t[5]),b(I,"class","rect-mask-fg svelte-1a76qe7"),b(I,"x",t[1]),b(I,"y",t[2]),b(I,"width",t[3]),b(I,"height",t[4]),b(o,"id",t[6]),b(o,"class","a9s-rubberband-rectangle-mask svelte-1a76qe7"),b(H,"class","a9s-outer"),b(H,"mask",`url(#${t[6]})`),b(H,"x",t[1]),b(H,"y",t[2]),b(H,"width",t[3]),b(H,"height",t[4]),b(W,"class","a9s-inner"),b(W,"x",t[1]),b(W,"y",t[2]),b(W,"width",t[3]),b(W,"height",t[4])},m(B,ne){M(B,r,ne),te(r,o),te(o,s),te(o,I),M(B,H,ne),M(B,W,ne)},p(B,ne){ne&34&&d!==(d=B[1]-B[5])&&b(s,"x",d),ne&36&&g!==(g=B[2]-B[5])&&b(s,"y",g),ne&40&&x!==(x=B[3]+2*B[5])&&b(s,"width",x),ne&48&&C!==(C=B[4]+2*B[5])&&b(s,"height",C),ne&2&&b(I,"x",B[1]),ne&4&&b(I,"y",B[2]),ne&8&&b(I,"width",B[3]),ne&16&&b(I,"height",B[4]),ne&2&&b(H,"x",B[1]),ne&4&&b(H,"y",B[2]),ne&8&&b(H,"width",B[3]),ne&16&&b(H,"height",B[4]),ne&2&&b(W,"x",B[1]),ne&4&&b(W,"y",B[2]),ne&8&&b(W,"width",B[3]),ne&16&&b(W,"height",B[4])},d(B){B&&(V(r),V(H),V(W))}}}function qo(t){let r,o=t[0]&&Hr(t);return{c(){r=R("g"),o&&o.c(),b(r,"class","a9s-annotation a9s-rubberband")},m(s,d){M(s,r,d),o&&o.m(r,null)},p(s,[d]){s[0]?o?o.p(s,d):(o=Hr(s),o.c(),o.m(r,null)):o&&(o.d(1),o=null)},i:c,o:c,d(s){s&&V(r),o&&o.d()}}}function Qo(t,r,o){let s;const d=Xe();let{addEventListener:g}=r,{drawingMode:x}=r,{transform:C}=r,{viewportScale:I=1}=r,H,W,B,ne,we,ge,de;const je=Ge=>{const tt=Ge;H=performance.now(),x==="drag"&&(o(0,W=C.elementToImage(tt.offsetX,tt.offsetY)),B=W,o(1,ne=W[0]),o(2,we=W[1]),o(3,ge=1),o(4,de=1))},Se=Ge=>{const tt=Ge;W&&(B=C.elementToImage(tt.offsetX,tt.offsetY),o(1,ne=Math.min(B[0],W[0])),o(2,we=Math.min(B[1],W[1])),o(3,ge=Math.abs(B[0]-W[0])),o(4,de=Math.abs(B[1]-W[1])))},Fe=Ge=>{const tt=Ge,Ye=performance.now()-H;if(x==="click"){if(Ye>300)return;W?ve():(o(0,W=C.elementToImage(tt.offsetX,tt.offsetY)),B=W,o(1,ne=W[0]),o(2,we=W[1]),o(3,ge=1),o(4,de=1))}else W&&(Ye>300||ge*de>100?(tt.stopPropagation(),ve()):(o(0,W=void 0),B=void 0))},ve=()=>{if(ge*de>15){const Ge={type:at.RECTANGLE,geometry:{bounds:{minX:ne,minY:we,maxX:ne+ge,maxY:we+de},x:ne,y:we,w:ge,h:de}};d("create",Ge)}o(0,W=void 0),B=void 0};Ue(()=>{g("pointerdown",je),g("pointermove",Se),g("pointerup",Fe,!0)});const He=`rect-mask-${Math.random().toString(36).substring(2,12)}`;return t.$$set=Ge=>{"addEventListener"in Ge&&o(7,g=Ge.addEventListener),"drawingMode"in Ge&&o(8,x=Ge.drawingMode),"transform"in Ge&&o(9,C=Ge.transform),"viewportScale"in Ge&&o(10,I=Ge.viewportScale)},t.$$.update=()=>{t.$$.dirty&1024&&o(5,s=2/I)},[W,ne,we,ge,de,s,He,g,x,C,I]}class Rr extends it{constructor(r){super(),Me(this,r,Qo,qo,z,{addEventListener:7,drawingMode:8,transform:9,viewportScale:10})}}function Mi(t){const r=t.slice(),o=r[2].map(s=>s.join(",")).join(" ");return r[19]=o,r}function Vr(t){let r,o,s,d,g,x,C,I,H,W,B,ne,we,ge,de=t[1]&&Ur(t);return{c(){r=R("defs"),o=R("mask"),s=R("rect"),I=R("polygon"),W=R("polygon"),ne=R("polygon"),de&&de.c(),ge=Q(),b(s,"x",d=t[3].x),b(s,"y",g=t[3].y),b(s,"width",x=t[3].w),b(s,"height",C=t[3].h),b(s,"class","svelte-18wrg3t"),b(I,"points",H=t[19]),b(I,"class","svelte-18wrg3t"),b(o,"id",t[5]),b(o,"class","a9s-rubberband-polygon-mask svelte-18wrg3t"),b(W,"class","a9s-outer"),b(W,"mask",`url(#${t[5]})`),b(W,"points",B=t[19]),b(ne,"class","a9s-inner"),b(ne,"points",we=t[19])},m(je,Se){M(je,r,Se),te(r,o),te(o,s),te(o,I),M(je,W,Se),M(je,ne,Se),de&&de.m(je,Se),M(je,ge,Se)},p(je,Se){Se&8&&d!==(d=je[3].x)&&b(s,"x",d),Se&8&&g!==(g=je[3].y)&&b(s,"y",g),Se&8&&x!==(x=je[3].w)&&b(s,"width",x),Se&8&&C!==(C=je[3].h)&&b(s,"height",C),Se&4&&H!==(H=je[19])&&b(I,"points",H),Se&4&&B!==(B=je[19])&&b(W,"points",B),Se&4&&we!==(we=je[19])&&b(ne,"points",we),je[1]?de?de.p(je,Se):(de=Ur(je),de.c(),de.m(ge.parentNode,ge)):de&&(de.d(1),de=null)},d(je){je&&(V(r),V(W),V(ne),V(ge)),de&&de.d(je)}}}function Ur(t){let r,o,s;return{c(){r=R("circle"),b(r,"class","a9s-handle svelte-18wrg3t"),b(r,"cx",o=t[0][0][0]),b(r,"cy",s=t[0][0][1]),b(r,"r",t[4])},m(d,g){M(d,r,g)},p(d,g){g&1&&o!==(o=d[0][0][0])&&b(r,"cx",o),g&1&&s!==(s=d[0][0][1])&&b(r,"cy",s),g&16&&b(r,"r",d[4])},d(d){d&&V(r)}}}function Ko(t){let r,o=t[3]&&Vr(Mi(t));return{c(){r=R("g"),o&&o.c(),b(r,"class","a9s-annotation a9s-rubberband")},m(s,d){M(s,r,d),o&&o.m(r,null)},p(s,[d]){s[3]?o?o.p(Mi(s),d):(o=Vr(Mi(s)),o.c(),o.m(r,null)):o&&(o.d(1),o=null)},i:c,o:c,d(s){s&&V(r),o&&o.d()}}}const Zo=20,Jo=1500;function $o(t,r,o){let s,d,g;const x=Xe();let{addEventListener:C}=r,{drawingMode:I}=r,{transform:H}=r,{viewportScale:W=1}=r,B,ne=[],we,ge,de=!1;const je=tt=>{const Ye=tt,{timeStamp:gt,offsetX:ut,offsetY:Lt}=Ye;if(B={timeStamp:gt,offsetX:ut,offsetY:Lt},I==="drag"&&ne.length===0){const It=H.elementToImage(Ye.offsetX,Ye.offsetY);ne.push(It),o(10,we=It)}},Se=tt=>{const Ye=tt;if(ge&&clearTimeout(ge),ne.length>0){if(o(10,we=H.elementToImage(Ye.offsetX,Ye.offsetY)),ne.length>2){const gt=wn(we,ne[0])*W;o(1,de=gt<Zo)}Ye.pointerType==="touch"&&(ge=setTimeout(()=>{ve()},Jo))}},Fe=tt=>{const Ye=tt;if(ge&&clearTimeout(ge),I==="click"){const gt=Ye.timeStamp-B.timeStamp,ut=wn([B.offsetX,B.offsetY],[Ye.offsetX,Ye.offsetY]);if(gt>300||ut>15)return;if(de)He();else if(ne.length===0){const Lt=H.elementToImage(Ye.offsetX,Ye.offsetY);ne.push(Lt),o(10,we=Lt)}else ne.push(we)}else{if(ne.length===1&&wn(ne[0],we)<=4){o(0,ne=[]),o(10,we=void 0);return}Ye.stopImmediatePropagation(),de?He():ne.push(we)}},ve=()=>{if(!we)return;const tt=ne.slice(0,-1);if(tt.length<3)return;const Ye={type:at.POLYGON,geometry:{bounds:Ut(ne),points:tt}};un(Ye)>4&&(o(0,ne=[]),o(10,we=void 0),x("create",Ye))},He=()=>{const tt={type:at.POLYGON,geometry:{bounds:Ut(ne),points:[...ne]}};o(0,ne=[]),o(10,we=void 0),x("create",tt)};Ue(()=>{C("pointerdown",je,!0),C("pointermove",Se),C("pointerup",Fe,!0),C("dblclick",ve,!0)});const Ge=`polygon-mask-${Math.random().toString(36).substring(2,12)}`;return t.$$set=tt=>{"addEventListener"in tt&&o(6,C=tt.addEventListener),"drawingMode"in tt&&o(7,I=tt.drawingMode),"transform"in tt&&o(8,H=tt.transform),"viewportScale"in tt&&o(9,W=tt.viewportScale)},t.$$.update=()=>{t.$$.dirty&512&&o(4,s=4/W),t.$$.dirty&1027&&o(2,d=we?de?ne:[...ne,we]:[]),t.$$.dirty&516&&o(3,g=d.length>0?ni(Ut(d),2/W):void 0)},[ne,de,d,g,s,Ge,C,I,H,W,we]}class ea extends it{constructor(r){super(),Me(this,r,$o,Ko,z,{addEventListener:6,drawingMode:7,transform:8,viewportScale:9})}}const qi=new Map([["rectangle",{tool:Rr}],["polygon",{tool:ea}]]),Qi=()=>[...qi.keys()],Ki=t=>qi.get(t),jr=(t,r,o={})=>qi.set(t,{tool:r,opts:o});function ta(t){let r,o,s,d,g;return{c(){r=R("g"),o=R("ellipse"),d=R("ellipse"),b(o,"class","a9s-outer"),b(o,"style",s=t[1]?"display:none;":void 0),b(o,"cx",t[2]),b(o,"cy",t[3]),b(o,"rx",t[4]),b(o,"ry",t[5]),b(d,"class","a9s-inner"),b(d,"style",t[1]),b(d,"cx",t[2]),b(d,"cy",t[3]),b(d,"rx",t[4]),b(d,"ry",t[5]),b(r,"class","a9s-annotation"),b(r,"data-id",g=t[0].id)},m(x,C){M(x,r,C),te(r,o),te(r,d)},p(x,[C]){C&2&&s!==(s=x[1]?"display:none;":void 0)&&b(o,"style",s),C&2&&b(d,"style",x[1]),C&1&&g!==(g=x[0].id)&&b(r,"data-id",g)},i:c,o:c,d(x){x&&V(r)}}}function na(t,r,o){let s,{annotation:d}=r,{geom:g}=r,{style:x}=r;const{cx:C,cy:I,rx:H,ry:W}=g;return t.$$set=B=>{"annotation"in B&&o(0,d=B.annotation),"geom"in B&&o(6,g=B.geom),"style"in B&&o(7,x=B.style)},t.$$.update=()=>{t.$$.dirty&129&&o(1,s=jn(d,x))},[d,s,C,I,H,W,g,x]}class ia extends it{constructor(r){super(),Me(this,r,na,ta,z,{annotation:0,geom:6,style:7})}}function ra(t){let r,o,s,d,g;return{c(){r=R("g"),o=R("line"),d=R("line"),b(o,"class","a9s-outer"),b(o,"style",s=t[1]?"display:none;":void 0),b(o,"x1",t[2]),b(o,"y1",t[3]),b(o,"x2",t[4]),b(o,"y2",t[5]),b(d,"class","a9s-inner"),b(d,"style",t[1]),b(d,"x1",t[2]),b(d,"y1",t[3]),b(d,"x2",t[4]),b(d,"y2",t[5]),b(r,"class","a9s-annotation"),b(r,"data-id",g=t[0].id)},m(x,C){M(x,r,C),te(r,o),te(r,d)},p(x,[C]){C&2&&s!==(s=x[1]?"display:none;":void 0)&&b(o,"style",s),C&2&&b(d,"style",x[1]),C&1&&g!==(g=x[0].id)&&b(r,"data-id",g)},i:c,o:c,d(x){x&&V(r)}}}function oa(t,r,o){let s,{annotation:d}=r,{geom:g}=r,{style:x}=r;const{points:C}=g,[[I,H],[W,B]]=C;return t.$$set=ne=>{"annotation"in ne&&o(0,d=ne.annotation),"geom"in ne&&o(6,g=ne.geom),"style"in ne&&o(7,x=ne.style)},t.$$.update=()=>{t.$$.dirty&129&&o(1,s=jn(d,x))},[d,s,I,H,W,B,g,x]}class aa extends it{constructor(r){super(),Me(this,r,oa,ra,z,{annotation:0,geom:6,style:7})}}function zr(t,r,o){const s=t.slice();return s[5]=r[o],s}function Wr(t){let r,o,s;return{c(){r=R("path"),s=R("path"),b(r,"class","a9s-outer"),b(r,"style",o=t[1]?"display:none;":void 0),b(r,"fill-rule","evenodd"),b(r,"d",fn(t[5])),b(s,"class","a9s-inner"),b(s,"style",t[1]),b(s,"fill-rule","evenodd"),b(s,"d",fn(t[5]))},m(d,g){M(d,r,g),M(d,s,g)},p(d,g){g&2&&o!==(o=d[1]?"display:none;":void 0)&&b(r,"style",o),g&2&&b(s,"style",d[1])},d(d){d&&(V(r),V(s))}}}function sa(t){let r,o,s=qt(t[2]),d=[];for(let g=0;g<s.length;g+=1)d[g]=Wr(zr(t,s,g));return{c(){r=R("g");for(let g=0;g<d.length;g+=1)d[g].c();b(r,"class","a9s-annotation"),b(r,"data-id",o=t[0].id)},m(g,x){M(g,r,x);for(let C=0;C<d.length;C+=1)d[C]&&d[C].m(r,null)},p(g,[x]){if(x&6){s=qt(g[2]);let C;for(C=0;C<s.length;C+=1){const I=zr(g,s,C);d[C]?d[C].p(I,x):(d[C]=Wr(I),d[C].c(),d[C].m(r,null))}for(;C<d.length;C+=1)d[C].d(1);d.length=s.length}x&1&&o!==(o=g[0].id)&&b(r,"data-id",o)},i:c,o:c,d(g){g&&V(r),ie(d,g)}}}function la(t,r,o){let s,{annotation:d}=r,{geom:g}=r,{style:x}=r;const{polygons:C}=g;return t.$$set=I=>{"annotation"in I&&o(0,d=I.annotation),"geom"in I&&o(3,g=I.geom),"style"in I&&o(4,x=I.style)},t.$$.update=()=>{t.$$.dirty&17&&o(1,s=jn(d,x))},[d,s,C,g,x]}class ca extends it{constructor(r){super(),Me(this,r,la,sa,z,{annotation:0,geom:3,style:4})}}function ua(t){let r,o,s,d,g;return{c(){r=R("g"),o=R("polygon"),d=R("polygon"),b(o,"class","a9s-outer"),b(o,"style",s=t[1]?"display:none;":void 0),b(o,"points",t[2].map(da).join(" ")),b(d,"class","a9s-inner"),b(d,"style",t[1]),b(d,"points",t[2].map(fa).join(" ")),b(r,"class","a9s-annotation"),b(r,"data-id",g=t[0].id)},m(x,C){M(x,r,C),te(r,o),te(r,d)},p(x,[C]){C&2&&s!==(s=x[1]?"display:none;":void 0)&&b(o,"style",s),C&2&&b(d,"style",x[1]),C&1&&g!==(g=x[0].id)&&b(r,"data-id",g)},i:c,o:c,d(x){x&&V(r)}}}const da=t=>t.join(","),fa=t=>t.join(",");function ha(t,r,o){let s,{annotation:d}=r,{geom:g}=r,{style:x}=r;const{points:C}=g;return t.$$set=I=>{"annotation"in I&&o(0,d=I.annotation),"geom"in I&&o(3,g=I.geom),"style"in I&&o(4,x=I.style)},t.$$.update=()=>{t.$$.dirty&17&&o(1,s=jn(d,x))},[d,s,C,g,x]}class pa extends it{constructor(r){super(),Me(this,r,ha,ua,z,{annotation:0,geom:3,style:4})}}function ga(t){let r,o,s,d,g,x,C;return{c(){r=R("g"),o=R("path"),g=R("path"),b(o,"class",s=Z(`a9s-outer ${t[1]}`)+" svelte-1w0132l"),b(o,"style",d=t[3]?"display:none;":void 0),b(o,"d",t[2]),b(g,"class",x=Z(`a9s-inner ${t[1]}`)+" svelte-1w0132l"),b(g,"style",t[3]),b(g,"d",t[2]),b(r,"class","a9s-annotation"),b(r,"data-id",C=t[0].id)},m(I,H){M(I,r,H),te(r,o),te(r,g)},p(I,[H]){H&2&&s!==(s=Z(`a9s-outer ${I[1]}`)+" svelte-1w0132l")&&b(o,"class",s),H&8&&d!==(d=I[3]?"display:none;":void 0)&&b(o,"style",d),H&4&&b(o,"d",I[2]),H&2&&x!==(x=Z(`a9s-inner ${I[1]}`)+" svelte-1w0132l")&&b(g,"class",x),H&8&&b(g,"style",I[3]),H&4&&b(g,"d",I[2]),H&1&&C!==(C=I[0].id)&&b(r,"data-id",C)},i:c,o:c,d(I){I&&V(r)}}}function ma(t,r,o){let s,d,g,{annotation:x}=r,{geom:C}=r,{style:I}=r;return t.$$set=H=>{"annotation"in H&&o(0,x=H.annotation),"geom"in H&&o(4,C=H.geom),"style"in H&&o(5,I=H.style)},t.$$.update=()=>{t.$$.dirty&33&&o(3,s=jn(x,I)),t.$$.dirty&16&&o(2,d=Gn(C)),t.$$.dirty&16&&o(1,g=C.closed?"closed":"open")},[x,g,d,s,C,I]}class va extends it{constructor(r){super(),Me(this,r,ma,ga,z,{annotation:0,geom:4,style:5})}}function ya(t){let r,o,s,d,g;return{c(){r=R("g"),o=R("rect"),d=R("rect"),b(o,"class","a9s-outer"),b(o,"style",s=t[5]?"display:none;":void 0),b(o,"x",t[4]),b(o,"y",t[3]),b(o,"width",t[2]),b(o,"height",t[1]),b(d,"class","a9s-inner"),b(d,"style",t[5]),b(d,"x",t[4]),b(d,"y",t[3]),b(d,"width",t[2]),b(d,"height",t[1]),b(r,"class","a9s-annotation"),b(r,"data-id",g=t[0].id)},m(x,C){M(x,r,C),te(r,o),te(r,d)},p(x,[C]){C&32&&s!==(s=x[5]?"display:none;":void 0)&&b(o,"style",s),C&16&&b(o,"x",x[4]),C&8&&b(o,"y",x[3]),C&4&&b(o,"width",x[2]),C&2&&b(o,"height",x[1]),C&32&&b(d,"style",x[5]),C&16&&b(d,"x",x[4]),C&8&&b(d,"y",x[3]),C&4&&b(d,"width",x[2]),C&2&&b(d,"height",x[1]),C&1&&g!==(g=x[0].id)&&b(r,"data-id",g)},i:c,o:c,d(x){x&&V(r)}}}function ba(t,r,o){let s,d,g,x,C,{annotation:I}=r,{geom:H}=r,{style:W}=r;return t.$$set=B=>{"annotation"in B&&o(0,I=B.annotation),"geom"in B&&o(6,H=B.geom),"style"in B&&o(7,W=B.style)},t.$$.update=()=>{t.$$.dirty&129&&o(5,s=jn(I,W)),t.$$.dirty&64&&o(4,{x:d,y:g,w:x,h:C}=H,d,(o(3,g),o(6,H)),(o(2,x),o(6,H)),(o(1,C),o(6,H)))},[I,C,x,g,d,s,H,W]}class wa extends it{constructor(r){super(),Me(this,r,ba,ya,z,{annotation:0,geom:6,style:7})}}const _a={elementToImage:(t,r)=>[t,r]},Br=t=>({elementToImage:(r,o)=>{const s=t.getBoundingClientRect(),d=t.createSVGPoint();d.x=r+s.x,d.y=o+s.y;const{x:g,y:x}=d.matrixTransform(t.getScreenCTM().inverse());return[g,x]}}),Ea=250,Gr=(t,r)=>{const o=Xe();let s;return{onPointerDown:()=>s=performance.now(),onPointerUp:d=>{if(performance.now()-s<Ea){const{x:g,y:x}=Zi(d,t),C=yn?10:2,I=r.getAt(g,x,void 0,C);I?o("click",{originalEvent:d,annotation:I}):o("click",{originalEvent:d})}}}},Zi=(t,r)=>{const o=r.createSVGPoint(),s=r.getBoundingClientRect(),d=t.clientX-s.x,g=t.clientY-s.y,{left:x,top:C}=r.getBoundingClientRect();return o.x=d+x,o.y=g+C,o.matrixTransform(r.getScreenCTM().inverse())};function Yr(t,r,o){const s=t.slice();return s[39]=r[o],s}function Xr(t,r,o){const s=t.slice();return s[42]=r[o],s}function Ji(t){const r=t.slice(),o=r[42].target.selector;return r[45]=o,r}function Mr(t){let r=t[42],o,s,d=qr(t);return{c(){d.c(),o=Q()},m(g,x){d.m(g,x),M(g,o,x),s=!0},p(g,x){x[0]&131072&&z(r,r=g[42])?(Vt(),ht(d,1,1,c),Qt(),d=qr(g),d.c(),st(d,1),d.m(o.parentNode,o)):d.p(g,x)},i(g){s||(st(d),s=!0)},o(g){ht(d),s=!1},d(g){g&&V(o),d.d(g)}}}function xa(t){let r,o;return r=new aa({props:{annotation:t[42],geom:t[45].geometry,style:t[1]}}),{c(){Xt(r.$$.fragment)},m(s,d){ue(r,s,d),o=!0},p(s,d){const g={};d[0]&131072&&(g.annotation=s[42]),d[0]&131072&&(g.geom=s[45].geometry),d[0]&2&&(g.style=s[1]),r.$set(g)},i(s){o||(st(r.$$.fragment,s),o=!0)},o(s){ht(r.$$.fragment,s),o=!1},d(s){se(r,s)}}}function Ca(t){let r,o;return r=new va({props:{annotation:t[42],geom:t[45].geometry,style:t[1]}}),{c(){Xt(r.$$.fragment)},m(s,d){ue(r,s,d),o=!0},p(s,d){const g={};d[0]&131072&&(g.annotation=s[42]),d[0]&131072&&(g.geom=s[45].geometry),d[0]&2&&(g.style=s[1]),r.$set(g)},i(s){o||(st(r.$$.fragment,s),o=!0)},o(s){ht(r.$$.fragment,s),o=!1},d(s){se(r,s)}}}function Ta(t){let r,o;return r=new ca({props:{annotation:t[42],geom:t[45].geometry,style:t[1]}}),{c(){Xt(r.$$.fragment)},m(s,d){ue(r,s,d),o=!0},p(s,d){const g={};d[0]&131072&&(g.annotation=s[42]),d[0]&131072&&(g.geom=s[45].geometry),d[0]&2&&(g.style=s[1]),r.$set(g)},i(s){o||(st(r.$$.fragment,s),o=!0)},o(s){ht(r.$$.fragment,s),o=!1},d(s){se(r,s)}}}function Sa(t){let r,o;return r=new pa({props:{annotation:t[42],geom:t[45].geometry,style:t[1]}}),{c(){Xt(r.$$.fragment)},m(s,d){ue(r,s,d),o=!0},p(s,d){const g={};d[0]&131072&&(g.annotation=s[42]),d[0]&131072&&(g.geom=s[45].geometry),d[0]&2&&(g.style=s[1]),r.$set(g)},i(s){o||(st(r.$$.fragment,s),o=!0)},o(s){ht(r.$$.fragment,s),o=!1},d(s){se(r,s)}}}function Aa(t){let r,o;return r=new wa({props:{annotation:t[42],geom:t[45].geometry,style:t[1]}}),{c(){Xt(r.$$.fragment)},m(s,d){ue(r,s,d),o=!0},p(s,d){const g={};d[0]&131072&&(g.annotation=s[42]),d[0]&131072&&(g.geom=s[45].geometry),d[0]&2&&(g.style=s[1]),r.$set(g)},i(s){o||(st(r.$$.fragment,s),o=!0)},o(s){ht(r.$$.fragment,s),o=!1},d(s){se(r,s)}}}function ka(t){var r;let o,s;return o=new ia({props:{annotation:t[42],geom:(r=t[45])==null?void 0:r.geometry,style:t[1]}}),{c(){Xt(o.$$.fragment)},m(d,g){ue(o,d,g),s=!0},p(d,g){var x;const C={};g[0]&131072&&(C.annotation=d[42]),g[0]&131072&&(C.geom=(x=d[45])==null?void 0:x.geometry),g[0]&2&&(C.style=d[1]),o.$set(C)},i(d){s||(st(o.$$.fragment,d),s=!0)},o(d){ht(o.$$.fragment,d),s=!1},d(d){se(o,d)}}}function qr(t){let r,o,s,d;const g=[ka,Aa,Sa,Ta,Ca,xa],x=[];function C(I,H){var W,B,ne,we,ge,de;return((W=I[45])==null?void 0:W.type)===at.ELLIPSE?0:((B=I[45])==null?void 0:B.type)===at.RECTANGLE?1:((ne=I[45])==null?void 0:ne.type)===at.POLYGON?2:((we=I[45])==null?void 0:we.type)===at.MULTIPOLYGON?3:((ge=I[45])==null?void 0:ge.type)===at.POLYLINE?4:((de=I[45])==null?void 0:de.type)===at.LINE?5:-1}return~(r=C(t))&&(o=x[r]=g[r](t)),{c(){o&&o.c(),s=Q()},m(I,H){~r&&x[r].m(I,H),M(I,s,H),d=!0},p(I,H){let W=r;r=C(I),r===W?~r&&x[r].p(I,H):(o&&(Vt(),ht(x[W],1,1,()=>{x[W]=null}),Qt()),~r?(o=x[r],o?o.p(I,H):(o=x[r]=g[r](I),o.c()),st(o,1),o.m(s.parentNode,s)):o=null)},i(I){d||(st(o),d=!0)},o(I){ht(o),d=!1},d(I){I&&V(s),~r&&x[r].d(I)}}}function Qr(t){let r=Nn(t[42])&&!t[10](t[42]),o,s,d=r&&Mr(Ji(t));return{c(){d&&d.c(),o=Q()},m(g,x){d&&d.m(g,x),M(g,o,x),s=!0},p(g,x){x[0]&132096&&(r=Nn(g[42])&&!g[10](g[42])),r?d?(d.p(Ji(g),x),x[0]&132096&&st(d,1)):(d=Mr(Ji(g)),d.c(),st(d,1),d.m(o.parentNode,o)):d&&(Vt(),ht(d,1,1,()=>{d=null}),Qt())},i(g){s||(st(d),s=!0)},o(g){ht(d),s=!1},d(g){g&&V(o),d&&d.d(g)}}}function Kr(t){let r,o,s,d;const g=[Pa,Ia],x=[];function C(I,H){return I[6]?0:I[15]&&I[0]?1:-1}return~(r=C(t))&&(o=x[r]=g[r](t)),{c(){o&&o.c(),s=Q()},m(I,H){~r&&x[r].m(I,H),M(I,s,H),d=!0},p(I,H){let W=r;r=C(I),r===W?~r&&x[r].p(I,H):(o&&(Vt(),ht(x[W],1,1,()=>{x[W]=null}),Qt()),~r?(o=x[r],o?o.p(I,H):(o=x[r]=g[r](I),o.c()),st(o,1),o.m(s.parentNode,s)):o=null)},i(I){d||(st(o),d=!0)},o(I){ht(o),d=!1},d(I){I&&V(s),~r&&x[r].d(I)}}}function Ia(t){let r=`${t[2]}-${t[7]}`,o,s,d=Zr(t);return{c(){d.c(),o=Q()},m(g,x){d.m(g,x),M(g,o,x),s=!0},p(g,x){x[0]&132&&z(r,r=`${g[2]}-${g[7]}`)?(Vt(),ht(d,1,1,c),Qt(),d=Zr(g),d.c(),st(d,1),d.m(o.parentNode,o)):d.p(g,x)},i(g){s||(st(d),s=!0)},o(g){ht(d),s=!1},d(g){g&&V(o),d.d(g)}}}function Pa(t){let r,o,s=qt(t[6]),d=[];for(let x=0;x<s.length;x+=1)d[x]=$r(Yr(t,s,x));const g=x=>ht(d[x],1,1,()=>{d[x]=null});return{c(){for(let x=0;x<d.length;x+=1)d[x].c();r=Q()},m(x,C){for(let I=0;I<d.length;I+=1)d[I]&&d[I].m(x,C);M(x,r,C),o=!0},p(x,C){if(C[0]&8659266){s=qt(x[6]);let I;for(I=0;I<s.length;I+=1){const H=Yr(x,s,I);d[I]?(d[I].p(H,C),st(d[I],1)):(d[I]=$r(H),d[I].c(),st(d[I],1),d[I].m(r.parentNode,r))}for(Vt(),I=s.length;I<d.length;I+=1)g(I);Qt()}},i(x){if(!o){for(let C=0;C<s.length;C+=1)st(d[C]);o=!0}},o(x){d=d.filter(Boolean);for(let C=0;C<d.length;C+=1)ht(d[C]);o=!1},d(x){x&&V(r),ie(d,x)}}}function Zr(t){let r,o;return r=new Fr({props:{target:t[8],tool:t[15],drawingMode:t[14],transform:t[13],viewportScale:t[18]}}),r.$on("create",t[22]),{c(){Xt(r.$$.fragment)},m(s,d){ue(r,s,d),o=!0},p(s,d){const g={};d[0]&256&&(g.target=s[8]),d[0]&32768&&(g.tool=s[15]),d[0]&16384&&(g.drawingMode=s[14]),d[0]&8192&&(g.transform=s[13]),d[0]&262144&&(g.viewportScale=s[18]),r.$set(g)},i(s){o||(st(r.$$.fragment,s),o=!0)},o(s){ht(r.$$.fragment,s),o=!1},d(s){se(r,s)}}}function Jr(t){let r,o;return r=new Nr({props:{target:t[8],editor:t[39].editor,annotation:t[39].annotation,style:t[1],transform:t[13],viewportScale:t[18]}}),r.$on("change",function(){D(t[23](t[39].annotation))&&t[23](t[39].annotation).apply(this,arguments)}),{c(){Xt(r.$$.fragment)},m(s,d){ue(r,s,d),o=!0},p(s,d){t=s;const g={};d[0]&256&&(g.target=t[8]),d[0]&64&&(g.editor=t[39].editor),d[0]&64&&(g.annotation=t[39].annotation),d[0]&2&&(g.style=t[1]),d[0]&8192&&(g.transform=t[13]),d[0]&262144&&(g.viewportScale=t[18]),r.$set(g)},i(s){o||(st(r.$$.fragment,s),o=!0)},o(s){ht(r.$$.fragment,s),o=!1},d(s){se(r,s)}}}function $r(t){let r=t[39].annotation.id,o,s,d=Jr(t);return{c(){d.c(),o=Q()},m(g,x){d.m(g,x),M(g,o,x),s=!0},p(g,x){x[0]&64&&z(r,r=g[39].annotation.id)?(Vt(),ht(d,1,1,c),Qt(),d=Jr(g),d.c(),st(d,1),d.m(o.parentNode,o)):d.p(g,x)},i(g){s||(st(d),s=!0)},o(g){ht(d),s=!1},d(g){g&&V(o),d.d(g)}}}function Da(t){let r,o,s,d,g,x,C=qt(t[17].filter(t[34])),I=[];for(let B=0;B<C.length;B+=1)I[B]=Qr(Xr(t,C,B));const H=B=>ht(I[B],1,1,()=>{I[B]=null});let W=t[8]&&Kr(t);return{c(){r=R("svg"),o=R("g");for(let B=0;B<I.length;B+=1)I[B].c();s=R("g"),W&&W.c(),b(s,"class","drawing"),b(r,"role","application"),b(r,"tabindex",0),b(r,"class","a9s-annotationlayer"),ce(r,"drawing",t[15]),ce(r,"editing",t[5]),ce(r,"hidden",!t[3]),ce(r,"hover",t[16])},m(B,ne){M(B,r,ne),te(r,o);for(let we=0;we<I.length;we+=1)I[we]&&I[we].m(o,null);te(r,s),W&&W.m(s,null),t[35](s),t[36](r),d=!0,g||(x=[oe(r,"pointerup",function(){D(t[11])&&t[11].apply(this,arguments)}),oe(r,"pointerdown",function(){D(t[12])&&t[12].apply(this,arguments)}),oe(r,"pointermove",t[24])],g=!0)},p(B,ne){if(t=B,ne[0]&132098){C=qt(t[17].filter(t[34]));let we;for(we=0;we<C.length;we+=1){const ge=Xr(t,C,we);I[we]?(I[we].p(ge,ne),st(I[we],1)):(I[we]=Qr(ge),I[we].c(),st(I[we],1),I[we].m(o,null))}for(Vt(),we=C.length;we<I.length;we+=1)H(we);Qt()}t[8]?W?(W.p(t,ne),ne[0]&256&&st(W,1)):(W=Kr(t),W.c(),st(W,1),W.m(s,null)):W&&(Vt(),ht(W,1,1,()=>{W=null}),Qt()),(!d||ne[0]&32768)&&ce(r,"drawing",t[15]),(!d||ne[0]&32)&&ce(r,"editing",t[5]),(!d||ne[0]&8)&&ce(r,"hidden",!t[3]),(!d||ne[0]&65536)&&ce(r,"hover",t[16])},i(B){if(!d){for(let ne=0;ne<C.length;ne+=1)st(I[ne]);st(W),d=!0}},o(B){I=I.filter(Boolean);for(let ne=0;ne<I.length;ne+=1)ht(I[ne]);ht(W),d=!1},d(B){B&&V(r),ie(I,B),W&&W.d(),t[35](null),t[36](null),g=!1,A(x)}}}function Oa(t,r,o){let s,d,g,x,C,I,H,W,B,ne,we,ge,de=c,je=()=>(de(),de=E(Te,yt=>o(18,ge=yt)),Te);t.$$.on_destroy.push(()=>de());let{drawingEnabled:Se}=r,{image:Fe}=r,{preferredDrawingMode:ve}=r,{state:He}=r,{style:Ge=void 0}=r,{toolName:tt=Qi()[0]}=r,{user:Ye}=r,{visible:gt=!0}=r,ut=0;const Lt=()=>o(7,ut+=1),It=()=>tt,Ee=()=>Se;let Ie,pe,Te;Ue(()=>je(o(9,Te=lr(Fe,pe))));const{hover:Qe,selection:qe,store:nt}=He;L(t,Qe,yt=>o(16,B=yt)),L(t,qe,yt=>o(33,ne=yt)),L(t,nt,yt=>o(17,we=yt));let At,wt;const St=yt=>{At&&nt.unobserve(At);const an=yt.filter(({editable:zt})=>zt).map(({id:zt})=>zt);an.length>0?(o(5,wt=an.map(zt=>nt.getAnnotation(zt)).filter(zt=>zt&&Nn(zt))),At=zt=>{const{updated:sn}=zt.changes;o(5,wt=sn==null?void 0:sn.map(gn=>gn.newValue))},nt.observe(At,{annotations:an})):o(5,wt=void 0)},Pt=yt=>{const an=Rn(),zt={id:an,bodies:[],target:{annotation:an,selector:yt.detail,creator:Ye,created:new Date}};nt.addAnnotation(zt),qe.setSelected(zt.id)},$t=yt=>an=>{var zt;const{target:sn}=yt,gn=600*1e3,Wn=((zt=sn.creator)==null?void 0:zt.id)!==Ye.id||!sn.created||new Date().getTime()-sn.created.getTime()>gn;nt.updateTarget({...sn,selector:an.detail,created:Wn?sn.created:new Date,updated:Wn?new Date:void 0,updatedBy:Wn?Ye:void 0})},ln=yt=>{const{x:an,y:zt}=Zi(yt,pe),sn=nt.getAt(an,zt,void 0,2);sn?B!==sn.id&&Qe.set(sn.id):Qe.set(void 0)},Kt=yt=>Nn(yt);function bn(yt){ze[yt?"unshift":"push"](()=>{Ie=yt,o(8,Ie)})}function In(yt){ze[yt?"unshift":"push"](()=>{pe=yt,o(4,pe)})}return t.$$set=yt=>{"drawingEnabled"in yt&&o(0,Se=yt.drawingEnabled),"image"in yt&&o(25,Fe=yt.image),"preferredDrawingMode"in yt&&o(26,ve=yt.preferredDrawingMode),"state"in yt&&o(27,He=yt.state),"style"in yt&&o(1,Ge=yt.style),"toolName"in yt&&o(2,tt=yt.toolName),"user"in yt&&o(28,Ye=yt.user),"visible"in yt&&o(3,gt=yt.visible)},t.$$.update=()=>{t.$$.dirty[0]&4&&o(15,{tool:s,opts:d}=Ki(tt)||{tool:void 0,opts:void 0},s,(o(32,d),o(2,tt))),t.$$.dirty[0]&67108864|t.$$.dirty[1]&2&&o(14,g=(d==null?void 0:d.drawingMode)||ve),t.$$.dirty[0]&16&&o(13,x=Br(pe)),t.$$.dirty[0]&16&&o(12,{onPointerDown:C,onPointerUp:I}=Gr(pe,nt),C,(o(11,I),o(4,pe))),t.$$.dirty[1]&4&&St(ne.selected),t.$$.dirty[0]&32&&o(6,H=wt?wt.map(yt=>({annotation:yt,editor:Or(yt.target.selector)})).filter(yt=>yt.editor):void 0),t.$$.dirty[0]&64&&o(10,W=yt=>H&&H.some(an=>an.annotation.id===yt.id))},[Se,Ge,tt,gt,pe,wt,H,ut,Ie,Te,W,I,C,x,g,s,B,we,ge,Qe,qe,nt,Pt,$t,ln,Fe,ve,He,Ye,Lt,It,Ee,d,ne,Kt,bn,In]}class eo extends it{constructor(r){super(),Me(this,r,Oa,Da,z,{drawingEnabled:0,image:25,preferredDrawingMode:26,state:27,style:1,toolName:2,user:28,visible:3,cancelDrawing:29,getDrawingTool:30,isDrawingEnabled:31},null,[-1,-1])}get cancelDrawing(){return this.$$.ctx[29]}get getDrawingTool(){return this.$$.ctx[30]}get isDrawingEnabled(){return this.$$.ctx[31]}}function to(t,r,o=0,s=t.length-1,d=La){for(;s>o;){if(s-o>600){const I=s-o+1,H=r-o+1,W=Math.log(I),B=.5*Math.exp(2*W/3),ne=.5*Math.sqrt(W*B*(I-B)/I)*(H-I/2<0?-1:1),we=Math.max(o,Math.floor(r-H*B/I+ne)),ge=Math.min(s,Math.floor(r+(I-H)*B/I+ne));to(t,r,we,ge,d)}const g=t[r];let x=o,C=s;for(oi(t,o,r),d(t[s],g)>0&&oi(t,o,s);x<C;){for(oi(t,x,C),x++,C--;d(t[x],g)<0;)x++;for(;d(t[C],g)>0;)C--}d(t[o],g)===0?oi(t,o,C):(C++,oi(t,C,s)),C<=r&&(o=C+1),r<=C&&(s=C-1)}}function oi(t,r,o){const s=t[r];t[r]=t[o],t[o]=s}function La(t,r){return t<r?-1:t>r?1:0}class Na{constructor(r=9){this._maxEntries=Math.max(4,r),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(r){let o=this.data;const s=[];if(!Ci(r,o))return s;const d=this.toBBox,g=[];for(;o;){for(let x=0;x<o.children.length;x++){const C=o.children[x],I=o.leaf?d(C):C;Ci(r,I)&&(o.leaf?s.push(C):er(r,I)?this._all(C,s):g.push(C))}o=g.pop()}return s}collides(r){let o=this.data;if(!Ci(r,o))return!1;const s=[];for(;o;){for(let d=0;d<o.children.length;d++){const g=o.children[d],x=o.leaf?this.toBBox(g):g;if(Ci(r,x)){if(o.leaf||er(r,x))return!0;s.push(g)}}o=s.pop()}return!1}load(r){if(!(r&&r.length))return this;if(r.length<this._minEntries){for(let s=0;s<r.length;s++)this.insert(r[s]);return this}let o=this._build(r.slice(),0,r.length-1,0);if(!this.data.children.length)this.data=o;else if(this.data.height===o.height)this._splitRoot(this.data,o);else{if(this.data.height<o.height){const s=this.data;this.data=o,o=s}this._insert(o,this.data.height-o.height-1,!0)}return this}insert(r){return r&&this._insert(r,this.data.height-1),this}clear(){return this.data=Kn([]),this}remove(r,o){if(!r)return this;let s=this.data;const d=this.toBBox(r),g=[],x=[];let C,I,H;for(;s||g.length;){if(s||(s=g.pop(),I=g[g.length-1],C=x.pop(),H=!0),s.leaf){const W=Fa(r,s.children,o);if(W!==-1)return s.children.splice(W,1),g.push(s),this._condense(g),this}!H&&!s.leaf&&er(s,d)?(g.push(s),x.push(C),C=0,I=s,s=s.children[0]):I?(C++,s=I.children[C],H=!1):s=null}return this}toBBox(r){return r}compareMinX(r,o){return r.minX-o.minX}compareMinY(r,o){return r.minY-o.minY}toJSON(){return this.data}fromJSON(r){return this.data=r,this}_all(r,o){const s=[];for(;r;)r.leaf?o.push(...r.children):s.push(...r.children),r=s.pop();return o}_build(r,o,s,d){const g=s-o+1;let x=this._maxEntries,C;if(g<=x)return C=Kn(r.slice(o,s+1)),Qn(C,this.toBBox),C;d||(d=Math.ceil(Math.log(g)/Math.log(x)),x=Math.ceil(g/Math.pow(x,d-1))),C=Kn([]),C.leaf=!1,C.height=d;const I=Math.ceil(g/x),H=I*Math.ceil(Math.sqrt(x));no(r,o,s,H,this.compareMinX);for(let W=o;W<=s;W+=H){const B=Math.min(W+H-1,s);no(r,W,B,I,this.compareMinY);for(let ne=W;ne<=B;ne+=I){const we=Math.min(ne+I-1,B);C.children.push(this._build(r,ne,we,d-1))}}return Qn(C,this.toBBox),C}_chooseSubtree(r,o,s,d){for(;d.push(o),!(o.leaf||d.length-1===s);){let g=1/0,x=1/0,C;for(let I=0;I<o.children.length;I++){const H=o.children[I],W=$i(H),B=Va(r,H)-W;B<x?(x=B,g=W<g?W:g,C=H):B===x&&W<g&&(g=W,C=H)}o=C||o.children[0]}return o}_insert(r,o,s){const d=s?r:this.toBBox(r),g=[],x=this._chooseSubtree(d,this.data,o,g);for(x.children.push(r),si(x,d);o>=0&&g[o].children.length>this._maxEntries;)this._split(g,o),o--;this._adjustParentBBoxes(d,g,o)}_split(r,o){const s=r[o],d=s.children.length,g=this._minEntries;this._chooseSplitAxis(s,g,d);const x=this._chooseSplitIndex(s,g,d),C=Kn(s.children.splice(x,s.children.length-x));C.height=s.height,C.leaf=s.leaf,Qn(s,this.toBBox),Qn(C,this.toBBox),o?r[o-1].children.push(C):this._splitRoot(s,C)}_splitRoot(r,o){this.data=Kn([r,o]),this.data.height=r.height+1,this.data.leaf=!1,Qn(this.data,this.toBBox)}_chooseSplitIndex(r,o,s){let d,g=1/0,x=1/0;for(let C=o;C<=s-o;C++){const I=ai(r,0,C,this.toBBox),H=ai(r,C,s,this.toBBox),W=Ua(I,H),B=$i(I)+$i(H);W<g?(g=W,d=C,x=B<x?B:x):W===g&&B<x&&(x=B,d=C)}return d||s-o}_chooseSplitAxis(r,o,s){const d=r.leaf?this.compareMinX:Ha,g=r.leaf?this.compareMinY:Ra,x=this._allDistMargin(r,o,s,d),C=this._allDistMargin(r,o,s,g);x<C&&r.children.sort(d)}_allDistMargin(r,o,s,d){r.children.sort(d);const g=this.toBBox,x=ai(r,0,o,g),C=ai(r,s-o,s,g);let I=xi(x)+xi(C);for(let H=o;H<s-o;H++){const W=r.children[H];si(x,r.leaf?g(W):W),I+=xi(x)}for(let H=s-o-1;H>=o;H--){const W=r.children[H];si(C,r.leaf?g(W):W),I+=xi(C)}return I}_adjustParentBBoxes(r,o,s){for(let d=s;d>=0;d--)si(o[d],r)}_condense(r){for(let o=r.length-1,s;o>=0;o--)r[o].children.length===0?o>0?(s=r[o-1].children,s.splice(s.indexOf(r[o]),1)):this.clear():Qn(r[o],this.toBBox)}}function Fa(t,r,o){if(!o)return r.indexOf(t);for(let s=0;s<r.length;s++)if(o(t,r[s]))return s;return-1}function Qn(t,r){ai(t,0,t.children.length,r,t)}function ai(t,r,o,s,d){d||(d=Kn(null)),d.minX=1/0,d.minY=1/0,d.maxX=-1/0,d.maxY=-1/0;for(let g=r;g<o;g++){const x=t.children[g];si(d,t.leaf?s(x):x)}return d}function si(t,r){return t.minX=Math.min(t.minX,r.minX),t.minY=Math.min(t.minY,r.minY),t.maxX=Math.max(t.maxX,r.maxX),t.maxY=Math.max(t.maxY,r.maxY),t}function Ha(t,r){return t.minX-r.minX}function Ra(t,r){return t.minY-r.minY}function $i(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function xi(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Va(t,r){return(Math.max(r.maxX,t.maxX)-Math.min(r.minX,t.minX))*(Math.max(r.maxY,t.maxY)-Math.min(r.minY,t.minY))}function Ua(t,r){const o=Math.max(t.minX,r.minX),s=Math.max(t.minY,r.minY),d=Math.min(t.maxX,r.maxX),g=Math.min(t.maxY,r.maxY);return Math.max(0,d-o)*Math.max(0,g-s)}function er(t,r){return t.minX<=r.minX&&t.minY<=r.minY&&r.maxX<=t.maxX&&r.maxY<=t.maxY}function Ci(t,r){return r.minX<=t.maxX&&r.minY<=t.maxY&&r.maxX>=t.minX&&r.maxY>=t.minY}function Kn(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function no(t,r,o,s,d){const g=[r,o];for(;g.length;){if(o=g.pop(),r=g.pop(),o-r<=s)continue;const x=r+Math.ceil((o-r)/s/2)*s;to(t,x,r,o,d),g.push(r,x,x,o)}}const ja=()=>{const t=new Na,r=new Map,o=()=>[...r.values()],s=()=>{t.clear(),r.clear()},d=x=>{if(!Fn(x))return;const{minX:C,minY:I,maxX:H,maxY:W}=x.selector.geometry.bounds,B={minX:C,minY:I,maxX:H,maxY:W,target:x};t.insert(B),r.set(x.annotation,B)},g=x=>{if(!Fn(x))return;const C=r.get(x.annotation);C&&t.remove(C),r.delete(x.annotation)};return{all:o,clear:s,getAt:(x,C,I=0)=>{const H=t.search({minX:x-I,minY:C-I,maxX:x+I,maxY:C+I}).map(W=>W.target).filter(W=>W.selector.type===at.RECTANGLE||mn(W.selector,x,C,I));return H.length>0?(H.sort((W,B)=>un(W.selector)-un(B.selector)),H):[]},getIntersecting:(x,C,I,H)=>t.search({minX:x,minY:C,maxX:x+I,maxY:C+H}).map(W=>W.target),insert:d,remove:g,set:(x,C=!0)=>{C&&s();const I=x.reduce((H,W)=>{if(Fn(W)){const{minX:B,minY:ne,maxX:we,maxY:ge}=W.selector.geometry.bounds;return[...H,{minX:B,minY:ne,maxX:we,maxY:ge,target:W}]}else return H},[]);I.forEach(H=>r.set(H.target.annotation,H)),t.load(I)},size:()=>t.all().length,update:(x,C)=>{g(x),d(C)}}},io=t=>{const r=Ve(),o=ja(),s=P(r,t.userSelectAction,t.adapter),d=u(r),g=re();return r.observe(({changes:x})=>{o.set((x.created||[]).map(C=>C.target),!1),(x.deleted||[]).forEach(C=>o.remove(C.target)),(x.updated||[]).forEach(({oldValue:C,newValue:I})=>o.update(C.target,I.target))}),{store:{...r,getAt:(x,C,I,H)=>{const W=o.getAt(x,C,H);if(I)return W.map(B=>r.getAnnotation(B.annotation)).filter(Boolean).filter(I)[0];{const B=W[0];return B?r.getAnnotation(B.annotation):void 0}},getIntersecting:(x,C,I,H)=>o.getIntersecting(x,C,I,H).map(W=>r.getAnnotation(W.annotation)).filter(Boolean)},selection:s,hover:d,viewport:g}},ro=t=>{const r=io(t);return{...r,store:Je(r.store)}},oo=t=>{let r,o;if(t.nodeName==="CANVAS")r=t,o=r.getContext("2d",{willReadFrequently:!0});else{const d=t;r=document.createElement("canvas"),r.width=d.width,r.height=d.height,o=r.getContext("2d",{willReadFrequently:!0}),o.drawImage(d,0,0,d.width,d.height)}let s=0;for(let d=1;d<10;d++)for(let g=1;g<10;g++){const x=Math.round(g*r.width/10),C=Math.round(d*r.height/10),I=o.getImageData(x,C,1,1).data,H=(.299*I[0]+.587*I[1]+.114*I[2])/255;s+=H}return s/81},ao=t=>{const r=oo(t),o=r>.6?"dark":"light";return console.log(`[Annotorious] Image brightness: ${r.toFixed(1)}. Setting ${o} theme.`),o},tr=(t,r,o)=>r.setAttribute("data-theme",o==="auto"?ao(t):o),so=(t,r)=>({...t,drawingEnabled:t.drawingEnabled===void 0?r.drawingEnabled:t.drawingEnabled,drawingMode:t.drawingMode||r.drawingMode,userSelectAction:t.userSelectAction||r.userSelectAction,theme:t.theme||r.theme}),nr=typeof navigator>"u"?!1:navigator.userAgent.indexOf("Mac OS X")!==-1,lo=(t,r)=>{const o=r||document,s=x=>{const C=x;C.key==="z"&&C.ctrlKey?t.undo():C.key==="y"&&C.ctrlKey&&t.redo()},d=x=>{const C=x;C.key==="z"&&C.metaKey&&(C.shiftKey?t.redo():t.undo())},g=()=>{nr?o.removeEventListener("keydown",d):o.removeEventListener("keydown",s)};return nr?o.addEventListener("keydown",d):o.addEventListener("keydown",s),{destroy:g}},za=(t,r={})=>{if(!t)throw"Missing argument: image";const o=typeof t=="string"?document.getElementById(t):t,s=so(r,{drawingEnabled:!0,drawingMode:"drag",userSelectAction:y.EDIT,theme:"light"}),d=ro(s),{selection:g,store:x}=d,C=Ft(x,s.initialHistory),I=ke(d,C,s.adapter,s.autoSave),H=document.createElement("DIV");H.style.position="relative",H.style.display="inline-block",o.style.display="block",o.parentNode.insertBefore(H,o),H.appendChild(o);const W=lo(C);let B=Vi();tr(o,H,s.theme);const ne=new eo({target:H,props:{drawingEnabled:!!s.drawingEnabled,image:o,preferredDrawingMode:s.drawingMode,state:d,style:s.style,user:B}});ne.$on("click",Ee=>{const{originalEvent:Ie,annotation:pe}=Ee.detail;pe?g.userSelect(pe.id,Ie):g.isEmpty()||g.clear()});const we=Be(d,C,s.adapter),ge=()=>ne.cancelDrawing(),de=()=>{ne.$destroy(),H.parentNode.insertBefore(o,H),H.parentNode.removeChild(H),W.destroy(),C.destroy()},je=()=>ne.getDrawingTool(),Se=()=>B,Fe=()=>ne.isDrawingEnabled(),ve=(Ee,Ie,pe)=>jr(Ee,Ie,pe),He=(Ee,Ie)=>Lr(Ee,Ie),Ge=Ee=>{if(!Ki(Ee))throw`No drawing tool named ${Ee}`;ne.$set({toolName:Ee})},tt=Ee=>ne.$set({drawingEnabled:Ee}),Ye=Ee=>{console.warn("Filter not implemented yet")},gt=Ee=>ne.$set({style:Ee}),ut=Ee=>tr(o,H,Ee),Lt=Ee=>{B=Ee,ne.$set({user:Ee})},It=Ee=>ne.$set({visible:Ee});return{...we,cancelDrawing:ge,destroy:de,getDrawingTool:je,getUser:Se,isDrawingEnabled:Fe,listDrawingTools:Qi,on:I.on,off:I.off,registerDrawingTool:ve,registerShapeEditor:He,setDrawingEnabled:tt,setDrawingTool:Ge,setFilter:Ye,setStyle:gt,setTheme:ut,setUser:Lt,setVisible:It,element:H,state:d}};e.Editor=Ei,e.EditorMount=Nr,e.Handle=zn,e.IdentityTransform=_a,e.MidpointHandle=Ui,e.PolygonEditor=br,e.RectangleEditor=wr,e.RectangleUtil=ui,e.RubberbandRectangle=Rr,e.SVGAnnotationLayer=eo,e.ShapeType=at,e.ToolMount=Fr,e.UserSelectAction=y,e.W3CImageFormat=go,e.addEventListeners=Gr,e.approximateAsPolygon=Ln,e.boundsFromMultiPolygonElements=On,e.boundsFromPoints=Ut,e.chainStyles=Dt,e.computeArea=un,e.computePolygonArea=vn,e.computeSVGPath=Gn,e.computeStyle=rt,e.createBody=ct,e.createImageAnnotator=za,e.createImageAnnotatorState=io,e.createSVGTransform=Br,e.createSvelteImageAnnotatorState=ro,e.defaultColorProvider=po,e.detectTheme=ao,e.distance=wn,e.enableResponsive=lr,e.fillDefaults=so,e.getAllCorners=li,e.getEditor=Or,e.getMaskDimensions=ni,e.getSVGPoint=Zi,e.getTool=Ki,e.initKeyboardCommands=lo,e.intersects=mn,e.isImageAnnotation=Nn,e.isImageAnnotationTarget=Fn,e.isMac=nr,e.isPointInPolygon=dn,e.isTouch=yn,e.listDrawingTools=Qi,e.multipolygonElementToPath=fn,e.parseFragmentSelector=di,e.parseSVGSelector=yi,e.parseW3CImageAnnotation=ar,e.pointsToPath=Bn,e.registerEditor=Lr,e.registerShapeUtil=Jt,e.registerTool=jr,e.sampleBrightness=oo,e.serializeFragmentSelector=fi,e.serializeSVGSelector=Mn,e.serializeW3CImageAnnotation=sr,e.setTheme=tr,e.simplifyMultiPolygon=Di,e.simplifyPoints=tn,e.simplifyPolygon=_n,Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});var SceneMaker=SceneMaker||{};SceneMaker.Locales={en:{"i.ActionEvent":"Triggering event:","i.ActionEventPuzzleSolved":"Puzzle solved","i.ActionEventSlideRevealed":"Screen or view accessed","i.ActionEventSlideRevealedFirstTime":"Screen or view accessed for the first time","i.ActionParamsPuzzle":"Puzzle:","i.ActionParamsPuzzleSolution":"Puzzle solution:","i.ActionParamsScreen":"Screen:","i.ActionParamsScreenReplacement":"Replace with:","i.ActionParamsSlide":"Screen or view:","i.ActionParamsText":"Text:","i.ActionParamsURL":"URL:","i.ActionParamsView":"View","i.ActionType":"Action:","i.ActionTypeChangeBackground":"Change background of screen or view","i.ActionTypeChangeScreen":"Change screen","i.ActionTypeDisableHotzone":"Disable zone","i.ActionTypeEnableHotzone":"Enable zone","i.ActionTypeGoToScreen":"Go to screen","i.ActionTypeHideHotspot":"Hide hotspot","i.ActionTypeOpenLink":"Open link","i.ActionTypeOpenView":"Open view","i.ActionTypePlaySound":"Play sound","i.ActionTypeShowHotspot":"Show hotspot","i.ActionTypeShowText":"Show text","i.ActionTypeSolvePuzzle":"Solve escape room puzzle","i.ActionTypeStopSound":"Stop sound","i.ActionWarningChangeBackground":"If the new background image has different dimensions from the original, the position of the zones will vary.","i.AddCaption":"Caption","i.AddContent":"Add Content","i.AddHotspot":"Add hotspot","i.AddImageURL":"Add image URL","i.AddMultimediaURL":"Add video or audio URL (YouTube or HTML5)","i.AddScreen":"Add Screen","i.AddView":"Add View","i.AddWebURL":"Add web URL","i.AddZone":"Add zone","i.AreYouSure":"Are you sure?","i.AreYouSureContent":"Are you sure you want to delete this content?","i.AreYouSureDeleteHotspot":"Are you sure you want to delete this hotspot?","i.AreYouSureDeleteHotzone":"Are you sure you want to delete this zone?","i.AreYouSureDeleteScreen":"Are you sure you want to delete this screen?","i.AreYouSureDeleteView":"Are you sure you want to delete this view?","i.AspectRatio":"Aspect ratio","i.Background":"Background","i.cancel":"cancel","i.Continue":"Continue","i.CursorVisibility":"Cursor on hover:","i.CursorVisibilityDefault":"No change","i.CursorVisibilityPointer":"Pointer","i.Delete":"Delete","i.delete":"delete","i.Description":"Description","i.Done":"Done","i.Enabled":"Enabled:","i.Exit":"Exit","i.ExitConfirmation":"You are about to leave Scene Maker. Any changes not saved will be lost.","i.ExitConfirmationMenu":"The scene has been modified. Closing without saving will discard your changes. What would you like to do?","i.exitWSaving":"exit without saving","i.HotspotActions":"Actions to perform when the hotspot is clicked","i.HotspotID":"Hotspot ID:","i.HotzoneActions":"Actions to perform when the zone is clicked","i.HotzoneID":"Zone ID:","i.Image":"Image","i.ImageSource":"Source:","i.ImageSourceGallery":"Gallery","i.ImageSourceURL":"URL","i.ImageURL":"URL:","i.LockAspectRatio":"Maintain aspect ratio:","i.Multimedia":"Video & audio","i.NewAction":"Add action","i.no":"no","i.No":"No","i.NoSlidesOnSaveNotification":"Create at least one screen before saving.","i.Object":"Object","i.Ok":"Ok","i.OSettingsPreview":"Include preview param in the URL.","i.OSettingsUnload":"Unload the web page when hiding the view.","i.Position":"Position","i.PositionX":"X (px):","i.PositionY":"Y (px):","i.Preview":"Preview","i.Properties":"Properties","i.PuzzleOption":"Puzzle #{number}","i.Rotation":"Rotation angle (\xB0):","i.Save":"Save","i.saveAndExit":"save and exit","i.Saved":"Saved","i.Saving":"Saving","i.SceneActions":"Actions","i.SceneCaption":"Scene caption","i.SceneCaptionText":"Text","i.SceneCaptionMode":"Display mode:","i.SceneCaptionModeClosable":"Can be closed","i.SceneCaptionModeFixed":"Always visible","i.SceneCaptionModeMinimizable":"Can be minimized","i.Screen":"Screen","i.ScreenOption":"Screen #{number}","i.Settings":"Settings","i.Size":"Size","i.SizeHeight":"Height (px):","i.SizeWidth":"Width (px):","i.Text":"Text","i.Title":"Scene title","i.Unspecified":"Unspecified","i.Untitled":"Untitled","i.Url":"Url","i.url":"url","i.Video":"Video","i.View":"View","i.ViewOption":"View #{viewNumber} - Screen #{screenNumber}","i.Views":"Views","i.ViewsType":"Choose view type","i.ViewsTypeImage":"Image","i.ViewsTypeOther":"Other content","i.Visibility":"Visibility:","i.VisibilityHidden":"Hidden","i.VisibilityVisible":"Visible","i.WrongResource":"This resource is corrupted or incompatible with the current version of Scene Maker and cannot be loaded.","i.yes":"yes","i.Yes":"Yes","i.ZoneTooltip":"Click here to add content"},es:{"i.ActionEvent":"Evento desencadenante:","i.ActionEventPuzzleSolved":"Reto resuelto","i.ActionEventSlideRevealed":"Pantalla o vista accedida","i.ActionEventSlideRevealedFirstTime":"Pantalla o vista accedida por primera vez","i.ActionParamsPuzzle":"Reto:","i.ActionParamsPuzzleSolution":"Soluci\xF3n del reto:","i.ActionParamsScreen":"Pantalla:","i.ActionParamsScreenReplacement":"Reemplazar con:","i.ActionParamsSlide":"Pantalla o vista:","i.ActionParamsText":"Texto:","i.ActionParamsURL":"URL:","i.ActionParamsView":"Vista","i.ActionType":"Acci\xF3n:","i.ActionTypeChangeBackground":"Cambiar fondo de una pantalla o vista","i.ActionTypeChangeScreen":"Cambiar pantalla","i.ActionTypeDisableHotzone":"Deshabilitar zona","i.ActionTypeEnableHotzone":"Habilitar zona","i.ActionTypeGoToScreen":"Ir a la pantalla","i.ActionTypeHideHotspot":"Ocultar hotspot","i.ActionTypeOpenLink":"Abrir enlace","i.ActionTypeOpenView":"Abrir vista","i.ActionTypePlaySound":"Reproducir sonido","i.ActionTypeShowHotspot":"Mostrar hotspot","i.ActionTypeShowText":"Mostrar texto","i.ActionTypeSolvePuzzle":"Resolver reto de la escape room","i.ActionTypeStopSound":"Detener sonido","i.ActionWarningChangeBackground":"Si la nueva imagen de fondo tiene dimensiones diferentes a la original, la posici\xF3n de las zonas variar\xE1.","i.AddCaption":"R\xF3tulo","i.AddContent":"A\xF1adir contenido","i.AddHotspot":"A\xF1adir hotspot","i.AddImageURL":"A\xF1adir URL de una imagen","i.AddMultimediaURL":"A\xF1adir URL de video o audio (YouTube o HTML5)","i.AddScreen":"A\xF1adir pantalla","i.AddView":"A\xF1adir vista","i.AddWebURL":"A\xF1adir URL de una web","i.AddZone":"A\xF1adir zona","i.AreYouSure":"\xBFEst\xE1 seguro?","i.AreYouSureContent":"\xBFEst\xE1 seguro de que desea eliminar este contenido?","i.AreYouSureDeleteHotspot":"\xBFEst\xE1 seguro de que desea eliminar este hotspot?","i.AreYouSureDeleteHotzone":"\xBFEst\xE1 seguro de que desea eliminar esta zona?","i.AreYouSureDeleteScreen":"\xBFEst\xE1 seguro de que desea eliminar esta pantalla?","i.AreYouSureDeleteView":"\xBFEst\xE1 seguro de que desea eliminar esta vista?","i.AspectRatio":"Relaci\xF3n de aspecto","i.Background":"Fondo","i.cancel":"cancelar","i.Continue":"Continuar","i.CursorVisibility":"Cursor al pasar el rat\xF3n:","i.CursorVisibilityDefault":"No cambiar","i.CursorVisibilityPointer":"Puntero","i.Delete":"Borrar","i.delete":"borrar","i.Description":"Descripci\xF3n","i.Done":"Hecho","i.Enabled":"Habilitado:","i.Exit":"Salir","i.ExitConfirmation":"Est\xE1 a punto de salir de Scene Maker. Los cambios no guardados se perder\xE1n.","i.ExitConfirmationMenu":"El escenario ha sido modificado. Si cierra sin guardar, se perder\xE1n los cambios. \xBFQu\xE9 desea hacer?","i.exitWSaving":"salir sin guardar","i.HotspotActions":"Acciones al hacer clic en el hotspot","i.HotspotID":"ID del hotspot:","i.HotzoneActions":"Acciones al hacer clic en la zona","i.HotzoneID":"ID de la zona:","i.Image":"Imagen","i.ImageSource":"Fuente:","i.ImageSourceGallery":"Galer\xEDa","i.ImageSourceURL":"URL","i.ImageURL":"URL:","i.LockAspectRatio":"Mantener relaci\xF3n de aspecto:","i.Multimedia":"V\xEDdeo & audio","i.NewAction":"A\xF1adir acci\xF3n","i.no":"no","i.No":"No","i.NoSlidesOnSaveNotification":"Cree al menos una pantalla antes de guardar.","i.Object":"Objeto","i.Ok":"Aceptar","i.OSettingsPreview":"Incluir par\xE1metro de previsualizaci\xF3n en la URL.","i.OSettingsUnload":"Cerrar la p\xE1gina web al ocultar la vista.","i.Position":"Posici\xF3n","i.PositionX":"X (px):","i.PositionY":"Y (px):","i.Preview":"Vista previa","i.Properties":"Propiedades","i.PuzzleOption":"Reto #{number}","i.Rotation":"\xC1ngulo de rotaci\xF3n (\xB0):","i.Save":"Guardar","i.saveAndExit":"guardar y salir","i.Saved":"Guardado","i.Saving":"Guardando","i.SceneActions":"Acciones","i.SceneCaption":"R\xF3tulo de la escena","i.SceneCaptionText":"Texto","i.SceneCaptionMode":"Modo de visualizaci\xF3n:","i.SceneCaptionModeClosable":"Se puede cerrar","i.SceneCaptionModeFixed":"Siempre visible","i.SceneCaptionModeMinimizable":"Se puede minimizar","i.Screen":"Pantalla","i.ScreenOption":"Pantalla #{number}","i.Settings":"Configuraci\xF3n","i.Size":"Tama\xF1o","i.SizeHeight":"Alto (px):","i.SizeWidth":"Ancho (px):","i.Text":"Texto","i.Title":"T\xEDtulo del escenario","i.Unspecified":"No especificado","i.Untitled":"Sin t\xEDtulo","i.Url":"Url","i.url":"url","i.Video":"Video","i.View":"Vista","i.ViewOption":"Vista #{viewNumber} - Pantalla #{screenNumber}","i.Views":"Vistas","i.ViewsType":"Elige tipo de vista","i.ViewsTypeImage":"Imagen","i.ViewsTypeOther":"Otro contenido","i.Visibility":"Visibilidad:","i.VisibilityHidden":"Oculto","i.VisibilityVisible":"Visible","i.WrongResource":"Este recurso est\xE1 da\xF1ado o es incompatible con la versi\xF3n actual de Scene Maker y no se puede cargar.","i.yes":"s\xED","i.Yes":"S\xED","i.ZoneTooltip":"Haz clic aqu\xED para a\xF1adir contenido"}},SceneMaker.Constant=SceneMaker.Constant||{},SceneMaker.Constant.NONE="none",SceneMaker.Constant.UNKNOWN="Unknown",SceneMaker.Constant.SCREEN="screen",SceneMaker.Constant.VIEW="view",SceneMaker.Constant.VIEW_IMAGE="view_image",SceneMaker.Constant.VIEW_CONTENT="view_content",SceneMaker.Constant.TEXT="text",SceneMaker.Constant.IMAGE="image",SceneMaker.Constant.AUDIO="audio",SceneMaker.Constant.VIDEO="video",SceneMaker.Constant.OBJECT="object",SceneMaker.Constant.IE="Internet Explorer",SceneMaker.Constant.FIREFOX="Mozilla Firefox",SceneMaker.Constant.CHROME="Google Chrome",SceneMaker.Constant.SAFARI="Safari",SceneMaker.Constant.ANDROID_BROWSER="Android Browser",SceneMaker.Constant.MEDIA={},SceneMaker.Constant.MEDIA.IMAGE="image",SceneMaker.Constant.MEDIA.HTML5_VIDEO="HTML5_VIDEO",SceneMaker.Constant.MEDIA.YOUTUBE_VIDEO="YouTube",SceneMaker.Constant.MEDIA.HTML5_AUDIO="HTML5_AUDIO",SceneMaker.Constant.MEDIA.WEB="web",SceneMaker.Constant.MEDIA.REUSABLE_PUZZLE_INSTANCE="reusable_puzzle_instance",SceneMaker.Constant.MEDIA.PDF="pdf",SceneMaker.Constant.MEDIA.DOC="doc",SceneMaker.Constant.MEDIA.PPT="ppt",SceneMaker.Constant.MEDIA.JSON="json",SceneMaker.Constant.WRAPPER={},SceneMaker.Constant.WRAPPER.EMBED="EMBED",SceneMaker.Constant.WRAPPER.OBJECT="OBJECT",SceneMaker.Constant.WRAPPER.IFRAME="IFRAME",SceneMaker.Constant.WRAPPER.VIDEO="VIDEO",SceneMaker.Constant.WRAPPER.AUDIO="AUDIO",SceneMaker.Configuration=(function(e,n,w){var l,c=function(f){typeof f=="undefined"&&(f={}),l=f,e.ImagesPath=l.ImagesPath,e.StylesheetsPath=l.StylesheetsPath,e.PreviewPath=l.PreviewPath,e.UploadScenePath=l.UploadScenePath},m=function(){return typeof l=="undefined"?{}:l};return{init:c,getConfiguration:m}})(SceneMaker,jQuery),SceneMaker.User=(function(e,n,w){var l,c=function(O){var E={};typeof O=="object"&&(E=O.user),f(E)},m=function(){return Object.keys(l).length>0?l:w},f=function(O){typeof O=="object"?l=O:l={}},T=function(){return l&&typeof l.token=="string"&&l.id},A=function(){return l.name},D=function(){return l.id},z=function(){return l.token};return{init:c,getUser:m,setUser:f,isLogged:T,getName:A,getId:D,getToken:z}})(SceneMaker,jQuery),SceneMaker.I18n=(function(e,n,w){var l="en",c,m,f,T,A,D,z=function(N,Q){var oe=e.Configuration.getConfiguration();if(c=L(),f=O(),p(oe.defaultLanguage)&&(l=oe.defaultLanguage),p(N.lang))T=N.lang;else{var b=navigator.language||navigator.userLanguage;p(b)?T=b:typeof Q=="object"&&p(Q.language)?T=Q.language:T=l}D=e.Locales,typeof m=="object"?A=m:A=D},O=function(){for(var N=[],Q=L(),oe=0;oe<Q.length;oe++)for(var b=Object.keys(Q[oe]),Le=0;Le<b.length;Le++)N.indexOf(b[Le])==-1&&N.push(b[Le]);return N},E=function(){return f instanceof Array?f:O()},L=function(){var N=[],Q=e.Configuration.getConfiguration();return typeof e.Locales=="object"&&N.push(e.Locales),typeof Q=="object"&&typeof Q.locales=="object"&&(N.push(Q.locales),m=Q.locales),N},v=function(){return c instanceof Array?c:L()},p=function(N){return typeof N=="string"&&E().indexOf(N)!=-1},S=function(){n("[i18n-key]").each(function(N,Q){var oe=V(n(Q).attr("i18n-key"));if(typeof oe!="undefined")switch(Q.tagName){case"INPUT":k(Q,oe);break;case"TEXTAREA":G(Q,oe);break;case"DIV":F(Q,oe);break;case"LI":Z(Q,oe);break;case"IMG":te(Q,oe);break;default:M(Q,oe);break}}),n("[i18n-key-tooltip]").each(function(N,Q){var oe=V(n(Q).attr("i18n-key-tooltip"));typeof oe!="undefined"&&n(Q).attr("title",oe)}),n("[i18n-key-href]").each(function(N,Q){var oe=V(n(Q).attr("i18n-key-href"));typeof oe!="undefined"&&n(Q).attr("href",oe)})},k=function(N,Q){n(N).val()!==""&&n(N).val(Q),n(N).attr("placeholder")&&n(N).attr("placeholder",Q)},F=function(N,Q){n(N).attr("data-text")!=w&&n(N).attr("data-text",Q),n(N).attr("title")!=w&&n(N).attr("title",Q)},G=function(N,Q){n(N).attr("placeholder",Q)},Z=function(N,Q){n(N).attr("data-text")!=w?n(N).attr("data-text",Q):M(N,Q)},te=function(N,Q){var oe="src";typeof n(N).attr("srctoload")!="undefined"&&(oe="srctoload"),n(N).attr(oe,e.ImagesPath+Q)},M=function(N,Q){n(N).text(Q)},V=function(N,Q){var oe=ie(A,N,Q);if(typeof oe=="string"||(oe=ie(D,N,Q),typeof oe=="string"))return oe;var b=/^i\./g;return b.exec(N)!=null?w:N},ie=function(N,Q,oe){return typeof N[T]!="undefined"&&typeof N[T][Q]=="string"?R(N[T][Q],oe):T!=l&&typeof N[l]!="undefined"&&typeof N[l][Q]=="string"?R(N[l][Q],oe):w},R=function(N,Q){if(typeof Q!="object")return N;for(var oe in Q){var b="#{"+oe+"}";N.indexOf(b)!=-1&&(N=N.replaceAll(b,Q[oe]))}return N},Y=function(){return T};return{init:z,getAvailableLanguages:E,getAvailableLocales:v,getLanguage:Y,getTrans:V,translateUI:S}})(SceneMaker,jQuery),SceneMaker.Object=(function(e,n,w){var l=function(){e.Object.PDF.init(),e.Object.GoogleDOC.init()};function c(S,k,F){this.wrapper=S,this.source=k,this.type=F}var m=function(S){var k=null;if(typeof S=="string"){var F=new RegExp("^<video","g");F.exec(S)!==null&&(k="VIDEO");var G=new RegExp("^<audio","g");G.exec(S)!==null&&(k="AUDIO")}if(k===null||typeof k=="undefined"){var Z=n(S)[0];typeof Z!="undefined"&&(k=Z.tagName)}var te=f(S,k),M;switch(k){case"VIDEO":M=e.Constant.MEDIA.HTML5_VIDEO;break;case"AUDIO":M=e.Constant.MEDIA.HTML5_AUDIO;break;case"IFRAME":default:M=v(te)}return new c(k,te,M)},f=function(S,k){var F=null;switch(k){case null:F=S;break;case e.Constant.WRAPPER.EMBED:F=n(S).attr("src");break;case e.Constant.WRAPPER.OBJECT:typeof n(S).attr("src")!="undefined"?F=n(S).attr("src"):typeof n(S).attr("data")!="undefined"&&(F=n(S).attr("data"));break;case e.Constant.WRAPPER.IFRAME:F=n(S).attr("src");break;case e.Constant.WRAPPER.VIDEO:return e.Video.HTML5.getSources(S);case e.Constant.WRAPPER.AUDIO:return e.Audio.HTML5.getSources(S);default:e.Debugging.log("Unrecognized object wrapper: "+k);break}if(k==null||k==e.Constant.WRAPPER.IFRAME){var G=/(^https?:\/\/docs.google.com\/viewer\?url=)/g,Z=F.match(G);Z instanceof Array&&Z.length===1&&(F=F.replace(Z[0],"").replace("&embedded=true",""))}return F},T=/(http(s)?:\/\/)([aA-zZ0-9%=_&+?])+([./-][aA-zZ0-9%=_&+?]+)*[/]?/g,A=/(www[.])([aA-zZ0-9%=_&+?])+([./-][aA-zZ0-9%=_&+?]+)*[/]?/g,D=/(http(s)?:\/\/)?(((youtu.be\/)([aA-zZ0-9-]+))|((www.youtube.com\/((watch\?v=)|(embed\/)|(v\/)))([aA-z0-9-Z&=.])+))/g,z=/^https?:\/\/[^\/]+\/escapeRooms\/[A-Za-z0-9]+\/reusablePuzzleInstances\/[A-Za-z0-9]+\/render$/,O=["mp4","webm","ogg"],E=["jpg","jpeg","png","gif","bmp","svg"],L=["mp3","wav","ogg"],v=function(S){if(typeof S=="object"&&S!==null&&typeof S.length=="number"&&S.length>0&&(S=S[0]),typeof S!="string")return null;if(S.match(z)!==null)return e.Constant.MEDIA.REUSABLE_PUZZLE_INSTANCE;if(S.match(D)!==null)return e.Constant.MEDIA.YOUTUBE_VIDEO;S=S.split("?")[0];var k=p(S);return E.indexOf(k)!==-1?e.Constant.MEDIA.IMAGE:k==="pdf"?e.Constant.MEDIA.PDF:O.indexOf(k)!==-1?e.Constant.MEDIA.HTML5_VIDEO:L.indexOf(k)!==-1?e.Constant.MEDIA.HTML5_AUDIO:k==="json"?e.Constant.MEDIA.JSON:k==="doc"||k==="docx"?e.Constant.MEDIA.DOC:k==="ppt"||k==="pptx"||k==="odp"?e.Constant.MEDIA.PPT:S.match(T)!==null||S.match(A)!==null?e.Constant.MEDIA.WEB:k},p=function(S){return S.split(".").pop().split("&")[0].toLowerCase()};return{init:l,getExtensionFromSrc:p,getObjectInfo:m}})(SceneMaker,jQuery),SceneMaker.Object.PDF=(function(e,n,w){var l=!1,c=function(){l=e.Status.getDevice().features.pdfReader},m=function(T){return T=e.Utils.checkUrlProtocol(T),l?"<iframe src='"+T+"'></iframe>":e.Object.GoogleDOC.generateWrapper(T)},f=function(T,A){if(typeof A!="object"||typeof A.source!="string")return"";var D=T.style?T.style:"",z=m(A.source),O="objectelement";return A.extraClasses&&(O=O+" "+A.extraClasses),"<div id='"+T.id+"' class='"+O+"' objectStyle='"+D+`' objectWrapper="`+z+'"></div>'};return{init:c,generateWrapper:m,renderPDFFromJSON:f}})(SceneMaker,jQuery),SceneMaker.Object.GoogleDOC=(function(e,n,w){var l=function(){},c=function(m){return m=e.Utils.checkUrlProtocol(m),"<iframe src='https://docs.google.com/viewer?url="+m+"&embedded=true'></iframe>"};return{init:l,generateWrapper:c}})(SceneMaker,jQuery),SceneMaker.Renderer=(function(e,n,w){var l=function(){},c=function(p){var S=m(p);if(S){n("section.slides").append(n(S)),e.Marker.drawSlideWithMarkers(p);for(var k=p.views.length,F=0;F<k;F++){var G=p.views[F];e.Marker.drawSlideWithMarkers(G)}}},m=function(p){for(var S="",k=p.views.length,F=0;F<k;F++){var G=p.views[F];S+=f(G)}return n("<article type='"+p.type+"' id='"+p.id+"'>"+S+"</article>")},f=function(p){if(p.type===e.Constant.VIEW_CONTENT)return A(p);if(p.type===e.Constant.VIEW_IMAGE)return T(p)},T=function(p){var S="hide_in_screen",k="<div class='close_view' id='close"+p.id+"'></div>";return"<article class='"+S+"' type='"+e.Constant.VIEW_IMAGE+"' id='"+p.id+"'>"+k+"</article>"},A=function(p){for(var S="",k="hide_in_screen",F="<div class='close_view' id='close"+p.id+"'></div>",G=p.elements.length,Z=0;Z<G;Z++){var te=p.elements[Z];te.type===e.Constant.TEXT?S+=z(te):te.type===e.Constant.IMAGE?S+=O(te):te.type===e.Constant.VIDEO?S+=E(te):te.type===e.Constant.AUDIO?S+=L(te):te.type===e.Constant.OBJECT?(S+=v(te),k+=" object"):S+=D(te)}return"<article class='"+k+"' type='"+e.Constant.VIEW_CONTENT+"' id='"+p.id+"'>"+F+S+"</article>"},D=function(p){return"<div id='"+p.id+"' class='view_content_text'></div>"},z=function(p){return"<div id='"+p.id+"' class='view_content_text textArea'>"+p.body+"</div>"},O=function(p){var S=n("<div id='"+p.id+"' class='view_content_image_wrapper'></div>"),k=n("<img class='view_content_image' src='"+p.body+"' style='"+p.style+"' />");if(p.hyperlink){var F=n("<a href='"+p.hyperlink+"' target='blank_'></a>");n(F).append(k),n(S).append(F)}else n(S).append(k);return e.Utils.getOuterHTML(S)},E=function(p){var S="<div id='"+p.id+"' class='view_content_video_wrapper'>",k=e.Video.HTML5.renderVideoFromJSON(p,{id:e.Utils.getId(p.id+"_video"),extraClasses:["view_content_video"],timestamp:!0});return S=S+k+"</div>",S},L=function(p){var S="<div id='"+p.id+"' class='view_content_audio_wrapper'>",k=e.Audio.HTML5.renderAudioFromJSON(p,{id:e.Utils.getId(p.id+"_audio"),extraClasses:["view_content_audio"],timestamp:!0});return S=S+k+"</div>",S},v=function(p){var S=p.settings||{},k=S.unloadObject===!1?"unloadableObject":"",F=e.Object.getObjectInfo(p.body);switch(F.type){case e.Constant.MEDIA.YOUTUBE_VIDEO:return e.Video.Youtube.renderVideoFromJSON(p,{extraClasses:"objectelement youtubeelement "+k});case e.Constant.MEDIA.PDF:return e.Object.PDF.renderPDFFromJSON(p,{extraClasses:k,source:F.source});default:var G=n(p.body),Z=G.attr("src");typeof Z!="undefined"&&(Z=e.Utils.checkWebUrl(Z),(F.type===e.Constant.MEDIA.REUSABLE_PUZZLE_INSTANCE||S.addPreviewParamToObject===!0)&&(Z=e.Utils.addParamToUrl(Z,"escapp_preview",""+e.Status.isPreview())),G.attr("src",Z)),F.type===e.Constant.MEDIA.REUSABLE_PUZZLE_INSTANCE&&G.attr("reusablepuzzleinstance","true");var te=e.Utils.getOuterHTML(G),M=p.style?p.style:"";return"<div id='"+p.id+"' class='objectelement "+k+"' objectStyle='"+M+"' objectWrapper='"+te+"'></div>"}};return{init:l,renderScreen:c}})(SceneMaker,jQuery),SceneMaker.Scene=(function(e,n){var w=function(l,c){e.ViewerAdapter.applyAspectRatio(l.aspectRatio),e.Renderer.init();for(var m=l.screens,f=0;f<m.length;f++)e.Renderer.renderScreen(m[f]);typeof c=="function"&&c()};return{init:w}})(SceneMaker),SceneMaker.ObjectPlayer=(function(e,n,w){var l=function(f){n.each(f.children(".objectelement"),function(T,A){if(!n(A).hasClass("loadedObject")){if(n(A).addClass("loadedObject"),n(A).hasClass("youtubeelement")){e.Video.Youtube.loadYoutubeObject(A);return}var D=n(n(A).attr("objectWrapper"));n(A).html("<div style='"+n(A).attr("objectStyle")+"'>"+e.Utils.getOuterHTML(D)+"</div>")}})},c=function(f){n.each(n(f).children('.objectelement:not(".unloadableObject")'),function(T,A){n(A).removeClass("loadedObject"),n(A).html("")})},m=function(f){n(".current").hasClass("object")&&l(n(".current"))};return{loadObject:l,unloadObject:c,aftersetupSize:m}})(SceneMaker,jQuery),SceneMaker.Video=(function(e,n,w){var l=function(){e.Video.HTML5.init(),e.Video.Youtube.init()};return{init:l}})(SceneMaker,jQuery);var youtubePlayers={},YT=YT||{};YT.PlayerState=YT.PlayerState||{},YT.PlayerState.UNSTARTED=-1,YT.PlayerState.ENDED=0,YT.PlayerState.PLAYING=1,YT.PlayerState.PAUSED=2,YT.PlayerState.BUFFERING=3,YT.PlayerState.CUED=5;var _youTubeIframeApiReady=!1;function onYouTubeIframeAPIReady(){_youTubeIframeApiReady=!0}SceneMaker.Video.Youtube=(function(e,n,w){var l=!0,c=function(){m(),setTimeout(function(){l=!1},11e3)},m=function(){var v=document.createElement("script");v.src="https://www.youtube.com/iframe_api";var p=document.getElementsByTagName("script")[0];p.parentNode.insertBefore(v,p)},f=function(){return!!(window.YT&&_youTubeIframeApiReady===!0)},T=function(v,k){var S=v.body||v.source,k=k||{};return k.id=v.id?v.id:e.Utils.getId(),k.objectStyle=v.style,A(S,k)},A=function(v,p){var S=p&&p.id?p.id:e.Utils.getId(),k=e.Utils.getId(),F="",G="";p&&(p.extraClasses&&(F=F+" "+p.extraClasses),p.objectStyle?G="objectStyle='"+p.objectStyle+"' ":p.style&&(G="objectStyle='"+p.style+"' "));var Z="<div id='"+S+"' ytContainerId='"+k+"' class='"+F+"' "+G+" source='"+v+"'></div>";return Z},D=function(v,p){var S=1,k=z,F=O;if(p&&(typeof p.controls=="boolean"&&(S=p.controls===!0?1:0),typeof p.onReadyCallback=="function"&&(k=p.onReadyCallback),typeof p.onPlayerError=="function"&&(F=p.onPlayerError)),!f()){if(l)setTimeout(function(){D(v,p)},1e3);else{n(v).html("<img src='"+e.ImagesPath+"adverts/advert_content_unavailable.png'/>"),n(v).addClass("videoOfflineContainer");var G=n(v).find("img");n(G).load(function(V){n(G).css("margin-top",(n(v).height()-n(G).height())/2+"px")}),F()}return}var Z=E(n(v).attr("source"));if(Z===null){F();return}var te=n(v).attr("ytContainerId"),M=typeof n(v).attr("objectStyle")!="undefined"?"style='"+n(v).attr("objectStyle")+"' ":"";n(v).html("<div id='"+te+"' videotype='"+e.Constant.MEDIA.YOUTUBE_VIDEO+"' "+M+"'></div>"),youtubePlayers[te]=new YT.Player(te,{height:"100%",width:"100%",videoId:Z,playerVars:{autoplay:0,controls:S,enablejsapi:1,showinfo:0,wmode:"transparent",rel:0},events:{onReady:k,onError:F}}),n("#"+te).attr("wmode","transparent")},z=function(v){},O=function(v){},E=function(v){var p=null;if(!v)return p;var S=/https?:\/\/?youtu.be\/([aA-zZ0-9-]+)/g,k=/(https?:\/\/)?(www.youtube.com\/watch\?v=|embed\/)([aA-zZ0-9-]+)[&=.]*/g,F=/(https?:\/\/)?(www.youtube.com\/v\/)([aA-zZ0-9-]+)/g,G=/(https?:\/\/)?(www.youtube.com\/embed\/)([aA-zZ0-9-]+)/g;if(v.match(S)!=null){var Z=S.exec(v);return Z&&Z[1]&&(p=Z[1]),p}if(v.match(k)!=null){var Z=v.split("&")[0],Z=k.exec(v);return Z&&Z[3]&&(p=Z[3]),p}if(v.match(F)!=null){var Z=v.split("&")[0],Z=F.exec(v);return Z&&Z[3]&&(p=Z[3]),p}if(v.match(G)!=null){var Z=v.split("&")[0],Z=G.exec(v);return Z&&Z[3]&&(p=Z[3]),p}return p},L=function(v){return"https://www.youtube.com/embed/"+e.Video.Youtube.getYoutubeIdFromURL(e.Object.getObjectInfo(v).source)};return{init:c,renderVideoFromJSON:T,renderVideoFromSource:A,loadYoutubeObject:D,getYoutubeIdFromURL:E,getEmbedSource:L}})(SceneMaker,jQuery),SceneMaker.Video.HTML5=(function(e,n,w){var l=function(){},c=function(){var p=n("video, audio");n.each(p,function(S,k){var F=k.tagName==="VIDEO";F&&n(k).focus(function(G){this.blur()})})},m=function(p){var S=n(p).find("video, audio");n.each(S,function(k,F){n(F).attr("wasplayingonslideleave")=="true"?F.play():n(F).attr("wasplayingonslideleave")=="false"||typeof n(F).attr("wasplayingonslideleave")=="undefined"&&n(F).attr("autoplayonslideenter")=="true"&&F.play()})},f=function(p){var S=n(p).find("video, audio");n.each(S,function(k,F){var G=!F.paused;n(F).attr("wasplayingonslideleave",G),G&&F.pause()})},T=function(p,S){var k=S||{};return typeof k.id=="undefined"&&(k.id=typeof p!="undefined"&&p.id?p.id:e.Utils.getId()),typeof k.controls=="undefined"&&(k.controls=p.controls),k.style=p.style,k.autoplay=p.autoplay,k.loop=p.loop,A(L(p),k)},A=function(p,S){var k=n("<video></video>");if(n(k).attr("preload","metadata"),S&&S.extraAttrs)for(var F in S.extraAttrs)n(k).attr(F,S.extraAttrs[F]);if(S){if(S.id&&n(k).attr("id",S.id),typeof S.onVideoReady=="string")try{for(var G=S.onVideoReady.split("."),Z=window[G[0]],te=1;te<G.length;te++)Z=Z[G[te]];typeof Z=="function"&&n(k).attr("onloadeddata",S.onVideoReady+"(this)")}catch(ie){}if(S.extraClasses)for(var M=S.extraClasses.length,V=0;V<M;V++)n(k).addClass(S.extraClasses[V]);S.controls!==!1&&n(k).attr("controls","controls"),typeof S.autoplay!="undefined"&&n(k).attr("autoplayonslideenter",S.autoplay),typeof S.poster=="string"&&n(k).attr("poster",S.poster),S.loop===!0&&n(k).attr("loop","loop"),S.style&&n(k).attr("style",S.style)}return typeof n(k).attr("onloadeddata")=="undefined"&&n(k).attr("onloadeddata","SceneMaker.Video.HTML5.onVideoReady(this)"),k=e.Utils.getOuterHTML(k),k=k.split("</video>")[0],(!S||S.loadSources!==!1)&&(n.each(p,function(ie,R){if(typeof R.src=="string"){var Y=R.src;typeof S!="undefined"&&S.timestamp===!0&&(Y=e.Utils.addParamToUrl(Y,"timestamp",""+new Date().getTime()));var N=R.mimeType?"type='"+R.mimeType+"' ":"";k=k+"<source src='"+Y+"' "+N+">"}}),p.length>0&&(k=k+"<p>Your browser does not support HTML5 video.</p>")),k=k+"</video>",k},D=function(p,S,F){var F=F||{};n.each(p,function(G,Z){if(typeof Z.src=="string"){var te=Z.src;F.timestamp===!0&&(te=e.Utils.addParamToUrl(te,"timestamp",""+new Date().getTime()));var M=Z.mimeType?"type='"+Z.mimeType+"' ":"";n(S).append("<source src='"+te+"' "+M+">")}}),p.length>0&&n(S).append("<p>Your browser does not support HTML5 video.</p>")},z=function(p){typeof p!="undefined"&&(p.readyState==4||p.readyState==3)&&n(p).attr("loaded","true")},O=function(p){if(typeof p=="string"){for(var S=[],k=new RegExp(`src=('||")([a-z-.://0-9]+)`,"g"),F;F=k.exec(p);)F.length>2&&S.push(F[2]),k.lastIndex=F.index+1;return S.map(function(G){return{src:G,mimeType:E(G)}})}try{return n(p).find("source").map(function(){return{src:this.src,mimeType:E(this.src)}})}catch(G){return[]}return[]},E=function(p){var S=e.Object.getObjectInfo(p).source;return"video/"+S.split(".").pop().split("?")[0]},L=function(p){if(typeof p!="object")return[];if(typeof p.sources=="string")try{var S=JSON.parse(p.sources)}catch(k){return[]}else if(typeof p.sources=="object")var S=p.sources;return S},v=function(p){if(typeof p=="string"){var S=new RegExp(`poster=('||")([a-z.://0-9?=%]+)`,"g"),k=S.exec(p);return typeof k!="undefined"&&k!=null&&k.length>2?k[2]:w}return n(p).attr("poster")};return{init:l,setMultimediaEvents:c,playMultimedia:m,stopMultimedia:f,renderVideoFromJSON:T,renderVideoFromSources:A,addSourcesToVideoTag:D,getSources:O,getSourcesFromJSON:L,getPoster:v,onVideoReady:z}})(SceneMaker,jQuery),SceneMaker.Audio=(function(e,n,w){var l=function(){e.Audio.HTML5.init()};return{init:l}})(SceneMaker,jQuery),SceneMaker.Audio.HTML5=(function(e,n,w){var l,c=function(){var v=new Audio;l={player:v,url:w},v.addEventListener("ended",()=>{l.url=w})},m=function(v){typeof l=="undefined"||typeof l.player=="undefined"||typeof v=="string"&&l.url===v||(l.url=v,l.player.pause(),l.player.currentTime=0,l.player.src=v,l.player.play().then(()=>{}).catch(p=>{l.url=w}))},f=function(v){typeof l=="undefined"||typeof l.player=="undefined"||typeof v=="string"&&l.url===v&&(l.player.pause(),l.url=w)},T=function(v,p){var S=p||{};return typeof S.id=="undefined"&&(S.id=typeof v!="undefined"&&v.id?v.id:e.Utils.getId()),typeof S.controls=="undefined"&&(S.controls=v.controls),S.style=v.style,S.autoplay=v.autoplay,S.loop=v.loop,A(E(v),S)},A=function(v,p){var S=n("<audio></audio>");if(n(S).attr("preload","metadata"),n(S).addClass("veaudioelement"),p&&p.extraAttrs)for(var k in p.extraAttrs)n(S).attr(k,p.extraAttrs[k]);if(p){if(p.id&&n(S).attr("id",p.id),typeof p.onAudioReady=="string")try{for(var F=p.onAudioReady.split("."),G=window[F[0]],Z=1;Z<F.length;Z++)G=G[F[Z]];typeof G=="function"&&n(S).attr("onloadeddata",p.onAudioReady+"(this)")}catch(V){}if(p.extraClasses)for(var te=p.extraClasses.length,M=0;M<te;M++)n(S).addClass(p.extraClasses[M]);p.controls!==!1&&n(S).attr("controls","controls"),typeof p.autoplay!="undefined"&&n(S).attr("autoplayonslideenter",p.autoplay),p.loop===!0&&n(S).attr("loop","loop"),p.style&&n(S).attr("style",p.style)}return typeof n(S).attr("onloadeddata")=="undefined"&&n(S).attr("onloadeddata","SceneMaker.Audio.HTML5.onAudioReady(this)"),S=e.Utils.getOuterHTML(S),S=S.split("</audio>")[0],(!p||p.loadSources!==!1)&&(n.each(v,function(V,ie){if(typeof ie.src=="string"){var R=ie.src;typeof p!="undefined"&&p.timestamp===!0&&(R=e.Utils.addParamToUrl(R,"timestamp",""+new Date().getTime()));var Y=ie.mimeType?"type='"+ie.mimeType+"' ":"";S=S+"<source src='"+R+"' "+Y+">"}}),v.length>0&&(S=S+"<p>Your browser does not support HTML5 audio.</p>")),S=S+"</audio>",S},D=function(v,p,k){var k=k||{};n.each(v,function(F,G){if(typeof G.src=="string"){var Z=G.src;k.timestamp===!0&&(Z=e.Utils.addParamToUrl(Z,"timestamp",""+new Date().getTime()));var te=G.mimeType?"type='"+G.mimeType+"' ":"";n(p).append("<source src='"+Z+"' "+te+">")}}),v.length>0&&n(p).append("<p>Your browser does not support HTML5 audio.</p>")},z=function(v){typeof v!="undefined"&&(v.readyState==4||v.readyState==3)&&n(v).attr("loaded","true")},O=function(v){if(typeof v=="string"){var p=e.Video.HTML5.getSources(v);return p.map(function(S){return{src:S.src,mimeType:L(S.src)}})}try{return n(v).find("source").map(function(){return{src:this.src,mimeType:L(this.src)}})}catch(S){return[]}return[]},E=function(v){return e.Video.HTML5.getSourcesFromJSON(v)},L=function(v){var p=e.Object.getObjectInfo(v).source,S=p.split(".").pop().split("?")[0],k;switch(S){case"ogg":k="ogg";break;case"mp3":k="mpeg";break;case"wav":k="wav";break;default:k=S;break}return"audio/"+k};return{init:c,playAudio:m,stopAudio:f,renderAudioFromJSON:T,renderAudioFromSources:A,addSourcesToAudioTag:D,onAudioReady:z,getSources:O,getSourcesFromJSON:E,getAudioMimeType:L}})(SceneMaker,jQuery),SceneMaker.Events=(function(e,n,w){var l=!1,c=function(){m()},m=function(){if(!l){n("article").live("slideenter",e.Viewer.onSlideEnterViewer),n("article").live("slideleave",e.Viewer.onSlideLeaveViewer),n(document).on("click",".close_view",e.View.onCloseViewClicked),n(document).on("click",".captionHeaderWrapper img",e.Caption.onCaptionButtonClicked);var T=w;window.onresize=function(){typeof T=="undefined"?(T=!1,setTimeout(function(){T?(T=w,window.onresize()):(T=w,f())},600)):T=!0},n(window).on("orientationchange",function(){n(window).trigger("resize")}),window.onbeforeunload=function(){e.EventsNotifier.notifyEvent("EXIT")},l=!0}},f=function(){e.ViewerAdapter.updateInterface()};return{init:c,bindViewerEventListeners:m}})(SceneMaker,jQuery),SceneMaker.EventsNotifier=(function(e,n,w){var l,c=function(){l=new Array},m=function(A,D){A in l||(l[A]=[]),l[A].push(D)},f=function(A,D){A in l&&l[A].indexOf(D)!==-1&&l[A].splice(l[A].indexOf(D),1)},T=function(A,D,z){if(l){D=D||{},D.triggeredByUser=z!==!1;var O=l[A];if(O)for(var E=0;E<O.length;E++)O[E](D)}};return{init:c,notifyEvent:T,registerCallback:m,unRegisterCallback:f}})(SceneMaker,jQuery),SceneMaker.Viewer=(function(e,n,w){var l,c,m=function(){f(e.getOptions())},f=function(L){e.Editing=!1,n("body").addClass("SceneMakerViewerBody"),l=typeof L=="object"?L:{},e.Debugging.init(L),l.configuration&&e.Configuration&&e.Configuration.init(l.configuration);var v=L.scene;if(e.Utils.init(),e.I18n.init(l,v),e.Debugging.log(`

Scene Maker initiated with scene:
`),e.Debugging.log(JSON.stringify(v)),v=e.Utils.fixScene(v),v===null){e.Utils.showPNotValidDialog();return}c=v,e.Status.init(function(){T(L,v)})},T=function(L,v){e.Utils.Loader.loadLanguageCSS(),e.EventsNotifier.init(),e.Object.init(),e.Screen.init(),e.View.init(),e.Marker.init(),e.Actions.init(v),e.Caption.init(),e.Slides.init(),e.I18n.translateUI(),e.User.init(L),e.Events.init(),e.Video.init(),e.Audio.init(),e.FullScreen.init(),e.Scene.init(v,function(){A(L,v)})},A=function(L,v){e.Video.HTML5.setMultimediaEvents(),e.Screen.updateCurrentScreenFromHash(),e.Screen.updateScreens(),e.ViewerAdapter.init(L),e.Utils.Loader.preloadResources(v),e.Screen.getCurrentScreenNumber()>0&&e.Slides.triggerSlideEnterEvent(n(e.Screen.getCurrentScreen()).attr("id")),e.Status.isExternalDomain()||window.focus(),e.Escapp.init(L,v)},D=function(){return l},z=function(L){var v=L.target,p=e.Slides.isView(v),S=e.Slides.getCurrentSlide();L.stopPropagation(),p?(setTimeout(function(){var k=n(v);k.hasClass(e.Constant.OBJECT)&&n(S).attr("id")===n(e.Slides.getCurrentSlide()).attr("id")&&e.ObjectPlayer.loadObject(k)},400),e.Video.HTML5.playMultimedia(v)):e.Screen.onEnterScreen(v),e.Actions.checkActionsForSlideEnterEvent(v.id)},O=function(L){var v=L.target,p=e.Slides.isView(v);L.stopPropagation(),p?(n(v).hasClass(e.Constant.OBJECT)&&e.ObjectPlayer.unloadObject(n(v)),e.Video.HTML5.stopMultimedia(v)):e.Screen.onLeaveScreen(v)},E=function(){return c};return{init:m,getOptions:D,getCurrentScene:E,onSlideEnterViewer:z,onSlideLeaveViewer:O}})(SceneMaker,jQuery),SceneMaker.Debugging=(function(e,n,w){var l=!1,c,m=function(E){E&&typeof E.developping=="boolean"?(l=E.developping,l&&E.developmentSettings&&(c=E.developmentSettings)):(l=!1,c=null)},f=function(...E){window.console&&window.console.log&&l&&console.log(...E)},T=function(){l=!0},A=function(){l=!1},D=function(){return l},z=function(){return c?c.actionInit:"nothing"},O=function(){return c&&c.testing_scene?c.testing_scene:(f("Error: Please specify development settings"),null)};return{init:m,log:f,enableDevelopingMode:T,disableDevelopingMode:A,isDevelopping:D,getActionInit:z,getTestingScene:O}})(SceneMaker,jQuery),SceneMaker.Validator=(function(e,n,w){var l=function(){},c=function(m){if(!m||typeof m=="string"&&m.trim()==="")return!1;var f=e.Object.getObjectInfo(m);if(!f||!f.source||!f.type)return!1;if(typeof f.source=="string"){if(f.source.trim()==="")return!1}else if(typeof f.source=="object"){if(f.source.length<1)return!1}else return!1;return!0};return{init:l,validateObject:c}})(SceneMaker,jQuery),SceneMaker.Status=(function(e,n,w){var l,c,m,f,T,A,D,z=function(V){O(),E(),L(),v(),p(),e.Status.Device.init(function(ie){l=ie,typeof V=="function"&&V()})},O=function(){return c=window.location!=window.parent.location,c},E=function(){if(T=!1,O())try{for(var V=window.parent;V!=window.top;)if(typeof V.location.href=="undefined"){T=!0;break}else V=V.parent;typeof window.top.location.href=="undefined"&&(T=!0)}catch(ie){T=!0}return T},L=function(){if(m=w,f="undefined",c&&!T)try{switch(window.frameElement.tagName){case"OBJECT":case"IFRAME":default:f=window.frameElement.tagName,m=window.frameElement}}catch(V){}},v=function(){var V;try{V=document.location.protocol}catch(R){}if(typeof V=="string"){var ie=V.match(/[\w]+/);ie instanceof Array&&typeof ie[0]=="string"?V=ie[0]:V=w}typeof V=="string"?D=V:D="unknown"},p=function(){var V=e.Utils.getOptions();typeof V.preview=="boolean"?A=V.preview:A=!1},S=function(){return l},k=function(){return c},F=function(){return m},G=function(){return f},Z=function(){return T},te=function(){return typeof D=="undefined"&&v(),D},M=function(){return A};return{init:z,getDevice:S,isExternalDomain:Z,isEmbed:k,getContainer:F,getContainerType:G,getProtocol:te,isPreview:M}})(SceneMaker,jQuery),SceneMaker.Status.Device=(function(e,n,w){var l=function(O){e.Status.Device.Browser.init(),e.Status.Device.Features.init(),c(O)},c=function(O){var E={};E.browser=e.Status.Device.Browser.fillBrowser(),E.features={},m(E),f(E,function(){E.features=e.Status.Device.Features.fillFeatures(),typeof O=="function"&&O(E)})},m=function(O){O.iPhone=/iPhone/i.test(navigator.userAgent),O.iPad=/iPad/i.test(navigator.userAgent),O.iOS=O.iPhone||O.iPad,O.android=/android/i.test(navigator.userAgent)},f=function(O,E){O.iOS&&O.browser.name===e.Constant.SAFARI?z(E):O.android?O.browser.name===e.Constant.CHROME?D(E):O.browser.name===e.Constant.ANDROID_BROWSER&&A(E):typeof E=="function"&&E()},T=function(O,E){var L=n("head>meta[name='viewport']");L.length===0?n("head").prepend('<meta name="viewport" content="'+O+'"/>'):n(L).attr("content",O),setTimeout(function(){typeof E=="function"&&E()},1250)},A=function(O){T("user-scalable=yes",O)},D=function(O){T("width=device-width,height=device-height,user-scalable=yes",O)},z=function(O){T("user-scalable=yes",O)};return{init:l}})(SceneMaker,jQuery),SceneMaker.Status.Device.Browser=(function(e,n,w){var l="Microsoft Internet Explorer",c="Netscape",m=function(){},f=function(){var O={},E=A();if(E!==-1)return O.name=e.Constant.FIREFOX,O.version=E,O;if(E=D(),E!==-1)return O.name=e.Constant.CHROME,O.version=E,O;if(E=T(),E!==-1)return O.name=e.Constant.IE,O.version=E,O;if(E=z(),E!==-1){var L=/android/i.test(navigator.userAgent);return L?O.name=e.Constant.ANDROID_BROWSER:O.name=e.Constant.SAFARI,O.version=E,O}return O.name=e.Constant.UNKNOWN,O.version=-1,O},T=function(){var O=-1;if(navigator.appName===l){var E=navigator.userAgent,L=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");L.exec(E)!=null&&(O=parseFloat(RegExp.$1))}else if(navigator.appName===c){var E=navigator.userAgent,L=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");L.exec(E)!=null&&(O=parseFloat(RegExp.$1))}return O},A=function(){var O=-1;if(navigator.appName===c){var E=navigator.userAgent,L=new RegExp(".* Firefox/([0-9.]+)");L.exec(E)!=null&&(O=parseFloat(RegExp.$1))}return O},D=function(){var O=-1;if(navigator.appName===c){var E=navigator.userAgent,L=new RegExp(".* Chrome/([0-9.]+)");L.exec(E)!=null&&(O=parseFloat(RegExp.$1))}return O},z=function(){var O=-1;if(navigator.appName===c){var E=navigator.userAgent;if(E.indexOf("Safari")!==-1&&E.indexOf("Chrome")===-1&&E.indexOf("crmo")==-1){var O=-2,L=new RegExp(".* Version/([0-9.]+)");L.exec(E)!=null&&(O=parseFloat(RegExp.$1))}}return O};return{init:m,fillBrowser:f}})(SceneMaker,jQuery),SceneMaker.Status.Device.Features=(function(e,n,w){var l=function(){},c=function(){var f={};return f.fullscreen=e.FullScreen.isFullScreenSupported(),f.touchScreen="ontouchstart"in window,f.localStorage=m(),f.history=typeof history=="object"&&typeof history.back=="function"&&typeof history.go=="function",f.history&&typeof history.pushState=="function"?f.historypushState=!0:f.historypushState=!1,window.File&&window.FileReader&&window.FileList&&window.Blob?f.reader=!0:f.reader=!1,f.pdfReader=!1,typeof navigator.mimeTypes=="object"&&"application/pdf"in navigator.mimeTypes&&(f.pdfReader=!0),f},m=function(){var f=typeof Storage!="undefined";if(f)try{return localStorage.setItem("myKey","myKeyValue"),localStorage.getItem("myKey"),localStorage.removeItem("myKey"),!0}catch(T){return!1}else return!1};return{init:l,fillFeatures:c}})(SceneMaker,jQuery),SceneMaker.ViewerAdapter=(function(e,n,w){var l=!1,c,m,f,T,A,D,z,O,E,L=function(M){l||(l=!0,c=e.FullScreen.canFullScreen(),c=c&&!e.Status.isPreview(),n("#viewbar").show(),e.Status.isPreview()&&n("div#viewerpreview").show(),c?(e.FullScreen.enableFullScreen(),n("#page-fullscreen").show()):n("#page-fullscreen").hide(),S(),e.Text.init())},v=function(M){typeof M!="string"||["4:3","16:9"].indexOf(M)===-1||D!==M&&(D=M,n("body").attr("aspectRatio",M),M==="16:9"?(z=16/9,_referenceSlideWidth=1024,E=576):(z=4/3,_referenceSlideWidth=800,E=600))},p=function(){return D},S=function(){if(typeof z!="undefined"){var M=n(window).width(),V=n(window).height();M===m&&V===f||(m=M,f=V,k())}},k=function(){var M,V,ie=25,R=10,Y=F(f),N=f-Y,Q=m,oe=(Q-R)/(N-ie);if(oe>z){V=N-ie,M=V*z;var b=Q-M;if(b<R){var Le=R-b;M=M-Le}}else{M=Q-R,V=M/z;var ce=N-V;if(ce<ie){var J=ie-ce;V=V-J}}typeof A!="number"&&(A=E),typeof T!="number"&&(T=_referenceSlideWidth);var me=V/A;A=V,T=M,n("#viewbar").height(Y);var h=n(".slides > article"),Re=n(".slides > article > article"),Ue=n(".slides article");n(Ue).css("height",V),n(Ue).css("width",M);var Xe=V/2+Y/2,ot=M/2;n(h).css("margin-top","-"+Xe+"px"),n(Re).css("margin-top","-"+V/2+"px"),n(Ue).css("margin-left","-"+ot+"px");var Tt=3/100*M,ze=5/100*M;n(Ue).css("padding-left",ze),n(Ue).css("padding-right",ze),n(Ue).css("padding-top",Tt),n(Ue).css("padding-bottom",Tt);var et=23;me<=1?et=et*te(me,.7):et=et*te(me,.2),n("div.close_view").css("width",et+"px"),n("div.close_view").css("height",et+"px"),n("#page-fullscreen").width(n("#page-fullscreen").height()),Z(me),G(me),e.Text.aftersetupSize(me),e.ObjectPlayer.aftersetupSize(me),e.Screen.afterSetupSize(me)},F=function(M){var V=26,ie=40,R=M/E,Y=40*te(R,.7);return Math.min(Math.max(Y,V),ie)},G=function(M){var V=n("#fancybox-overlay");if(!(n(V).length<1||!n(V).is(":visible"))){var ie=n("#fancybox-wrap"),R=n("#fancybox-content"),Y=n("#"+n(R).attr("id")+" > div"),N=n(".current"),Q=n(N).cssNumber("padding-top"),oe=n(N).cssNumber("padding-left"),b=n(N).cssNumber("padding-right"),Le=n(N).offset(),ce=23;M<=1?ce=ce*te(M,.7):ce=ce*te(M,.2);var J=n("#fancybox-close");n(J).width(ce+"px"),n(J).height(ce+"px"),n(J).css("padding","10px"),n(J).css("padding-left","4px"),n(ie).css("margin-top","0px"),n(ie).css("margin-left","0px"),n(ie).width(n(N).width()+oe+b),n(ie).height(n(N).height()+2*Q),n(ie).css("top",Le.top+"px"),n(ie).css("left",Le.left+"px"),n(R).width("100%"),n(R).height("100%"),n(Y).width("100%"),n(Y).height("100%")}},Z=function(M){var V=n("div[data-tippy-root]:visible");V.length>0&&V.each(function(ie,R){n("[markertooltipid="+n(R).attr("id")+"]").each(function(Y,N){typeof N._tippy!="undefined"&&(N._tippy.hide(),N._tippy.show())})})},te=function(M,V){var ie=(M-1)*V;return 1+ie};return{init:L,getAspectRatio:p,applyAspectRatio:v,updateInterface:S}})(SceneMaker,jQuery),SceneMaker.Text=(function(e,n,w){var l=12,c=function(){m(n("article > div.textArea")),n("article > div.textArea > table").each(function(E,L){m(n(L).find("caption")),n(L).find("td").each(function(Z,te){m(te)});var v=n(L).attr("style");if(v){var p="",S=e.Utils.getWidthFromStyle(v);if(S){var k=S*100/800;p+="width:"+k+"%;"}var F=e.Utils.getHeightFromStyle(v);if(F){var G=F*100/600;p+="height:"+G+"%;"}p!==""&&n(L).attr("style",p)}})},m=function(E){T(n(E).find("font")),f(n(E).find("[style]"))},f=function(E){n(E).each(function(L,v){var p=n(v).attr("style");if(typeof p=="string"){var S=e.Utils.getFontSizeFromStyle(p);if(!(typeof S!="number"||isNaN(S))){var k=S/l+"rem",F=e.Utils.addFontSizeToStyle(p,k);n(v).attr("style",F)}}})},T=function(E){n(E).each(function(L,v){var p=n(v).attr("size");if(p){var S=parseInt(p);if(!isNaN(S)){n(v).hide();var k=O(S),F=k/l+"rem",G=n("<span style='font-size:"+F+"'></span>");n(G).html(n(v).html()),n(v).before(G),n(v).remove()}}})},A=function(E){E=E*D(E);var L=l,v=n("html");n(v).css("font-size",L*E+"px")},D=function(E){return E<.25?.5:z(E,.25,.3)?.55:z(E,.3,.35)?.65:z(E,.35,.4)?.7:z(E,.4,.5)?.8:z(E,.5,.6)?.85:z(E,.6,.75)?.9:z(E,.75,.95)?.95:(z(E,.95,1.5)||E>1.5,1)},z=function(E,L,v){return E>L&&E<=v},O=function(E){switch(E){case 7:return 48;case 6:return 32;case 5:return 24;case 4:return 18;case 3:return 16;case 2:return 14;case 1:return 12;default:break}};return{init:c,aftersetupSize:A}})(SceneMaker,jQuery),SceneMaker.Utils=(function(e,n){var w,l,c=function(){l||(l=new Array,w=[]),jQuery.fn.cssNumber=function(J){var me=parseInt(this.css(J),10);return isNaN(me)?0:me},jQuery.fn.reverse=[].reverse,String.prototype.replaceAll=function(J,me){var h=this;return h.replace(new RegExp(J.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),me)},Array.prototype.filter||(Array.prototype.filter=function(J){"use strict";if(this===void 0||this===null)throw new TypeError;var me=Object(this),h=me.length>>>0;if(typeof J!="function")throw new TypeError;for(var Re=[],Ue=arguments.length>=2?arguments[1]:void 0,Xe=0;Xe<h;Xe++)if(Xe in me){var ot=me[Xe];J.call(Ue,ot,Xe,me)&&Re.push(ot)}return Re}),Array.prototype.map||(Array.prototype.map=function(J){"use strict";if(this===void 0||this===null)throw new TypeError;var me=Object(this),h=me.length>>>0;if(typeof J!="function")throw new TypeError;for(var Re=new Array(h),Ue=arguments.length>=2?arguments[1]:void 0,Xe=0;Xe<h;Xe++)Xe in me&&(Re[Xe]=J.call(Ue,me[Xe],Xe,me));return Re}),Array.prototype.indexOf||(Array.prototype.indexOf=function(J){var me=this.length>>>0,h=Number(arguments[1])||0;for(h=h<0?Math.ceil(h):Math.floor(h),h<0&&(h+=me);h<me;h++)if(h in this&&this[h]===J)return h;return-1}),Object.keys||(Object.keys=(function(){"use strict";var J=Object.prototype.hasOwnProperty,me=!{toString:null}.propertyIsEnumerable("toString"),h=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],Re=h.length;return function(Ue){if(typeof Ue!="object"&&(typeof Ue!="function"||Ue===null))throw new TypeError("Object.keys called on non-object");var Xe=[],ot,Tt;for(ot in Ue)J.call(Ue,ot)&&Xe.push(ot);if(me)for(Tt=0;Tt<Re;Tt++)J.call(Ue,h[Tt])&&Xe.push(h[Tt]);return Xe}})()),typeof Array.prototype.forEach!="function"&&(Array.prototype.forEach=function(J){for(var me=0;me<this.length;me++)J.apply(this,[this[me],me,this])}),typeof String.prototype.trim!="function"&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),e.Utils.Loader.init()},m=function(){return e.Editing?e.Editor.getOptions():e.Viewer.getOptions()},f=function(J,me,h){if(me){var Re=J;J=J.replace(J[J.length-1],"")}else{typeof J!="string"&&(J="unicID"),typeof h!="string"&&(h=""),typeof l[J]=="undefined"&&(l[J]=0),l[J]=l[J]+1;var Re=J+h+l[J]}return $("#"+Re).length===0&&w.indexOf(Re)===-1?(w.push(Re),Re):f(J,!1,h)},T=function(J){w.indexOf(J)===-1&&w.push(J)},A=function(J,me){if(typeof J=="object"&&typeof me=="object"&&!(J instanceof Array)){let h=Object.keys(Object.assign({},J,me)),Re=h.length;for(let Ue=0;Ue<Re;Ue++)J[h[Ue]]=A(J[h[Ue]],me[h[Ue]]);return J}else return typeof me!="undefined"?me:J},D=function(J){return typeof J!="object"?null:J},z=function(J){return typeof $(J)[0].outerHTML=="undefined"?$(J).clone().wrap("<div></div>").parent().html():$(J)[0].outerHTML},O=function(J,me){if(typeof J!="string"||typeof me!="string")return J;var h=J.split("#");J=h[0];var Re=J.split("?");if(Re.length===2){J=Re[0];for(var Ue=Re[1],Xe=[],Re=Ue.split("&"),ot=Re.length,Tt=0;Tt<ot;Tt++){var ze=Re[Tt].split("=");ze[0]!=me&&Xe.push({key:ze[0],value:ze[1]})}for(var et=Xe.length,Pe=0;Pe<et;Pe++){var We=Xe[Pe];Pe===0?J=J+"?":J=J+"&",J=J+We.key+"="+We.value}}return h.length>1&&(J=J+"#"+h[1]),J},E=function(J,me,h){if(typeof J!="string"||typeof me!="string"||typeof h!="string")return J;J=O(J,me);var Re=J.split("#");J=Re[0];var Ue=me+"="+h;return J.indexOf("?")>-1?J+="&"+Ue:J+="?"+Ue,Re.length>1&&(J=J+"#"+Re[1]),J},L=function(J){var me={};if(typeof J!="string")return me;var h=J.split("?");if(h.length<=1)return me;for(var Re=h[1].split("#")[0].split("&"),Ue=0;Ue<Re.length;Ue++){var Xe=Re[Ue].split("=");Xe.length===2&&(me[Xe[0]]=Xe[1])}return me},v=function(){try{var J=window.location;if(typeof J=="undefined")return;var me=Math.max(1,Math.min(e.Screen.getScreensQuantity(),parseInt(J.hash.split("?")[0].split("#").pop())));return isNaN(me)?n:me}catch(h){return n}},p=function(J){return J.split("#")[0]},S=function(J){try{if(typeof J=="string"&&J.indexOf("url")===0&&J.length>3){var me=J[4];return me=='"'||me=="'"?J.substring(5,J.length-2):J.substring(4,J.length-1)}}catch(h){}return J},k=function(J,me){return G(J,me)[0]},F=function(J,me){return G(J,me)[1]},G=function(J,me){var h=[],Re=null,Ue=null;return $.each(J.split(";"),function(Xe,ot){var Tt=/width:\s?([0-9]+(\.[0-9]+)?)%/g,ze=/width:\s?([0-9]+(\.?[0-9]+)?)px/g,et=/height:\s?([0-9]+(\.[0-9]+)?)%/g,Pe=/height:\s?([0-9]+(\.?[0-9]+)?)px/g;if(ot.indexOf("width")!==-1){if(ot.match(ze)){var We=ze.exec(ot);We[1]&&(Re=We[1])}else if(ot.match(Tt)){var We=Tt.exec(ot);if(We[1]){var xt=We[1];me&&(Re=$(me).width()*xt/100)}}}else if(ot.indexOf("height")!==-1){if(ot.match(Pe)){var We=Pe.exec(ot);We[1]&&(Ue=We[1])}else if(ot.match(et)){var We=et.exec(ot);if(We[1]){var xt=We[1];me&&(Ue=$(me).height()*xt/100)}}}}),h.push(Re),h.push(Ue),h},Z=function(J){if(J){var me=null;return $.each(J.split(";"),function(h,Re){var Ue=/font-size\s*:\s*((\d*\.)?\d+)px/i;if(Re.match(Ue)!=null){var Xe=Ue.exec(Re);if(Xe!==null&&Xe[1]!==null)return me=parseFloat(Xe[1]),!1}}),me}},te=function(J,me){if(typeof J!="string")return null;var h="";return $.each(J.split(";"),function(Re,Ue){Ue.indexOf("font-size")===-1&&Ue!==""&&(h=h+Ue+"; ")}),me&&(h=h+"font-size:"+me+";"),h},M=function(){var J={};J.width=650,J.height=220,J.text=e.I18n.getTrans("i.WrongResource");var me={};me.text=e.I18n.getTrans("i.Ok"),me.callback=function(){$.fancybox.close()},J.buttons=[me],e.Utils.showDialog(J)},V=function(J){ie();var me=$("#notification_template");if($(me).length!==0&&!(!J||!J.text)){var h="90%",Re,Ue=!1,Xe;e.Editing&&(Xe=e.ImagesPath+"thumbs/content_fail.png"),J.width&&(h=J.width),J.showCloseButton&&(Ue=J.showCloseButton),J.notificationIconSrc&&(Xe=J.notificationIconSrc),Xe||(J.textWrapperClass="forceCenter"),typeof h=="string"&&h.indexOf("%")!=0&&(h=h.split("%")[0].trim(),h=h*$(window).width()/100);var ot=$(me).parent();$(me).width(h);var Tt=$(me).find(".notification_row1"),ze=$(me).find(".notification_row2"),et=$(Tt).find(".notificationIcon");if(Xe&&($(et).attr("src",Xe),$(et).css("display","inline")),J.notificationIconClass&&$(et).addClass(J.notificationIconClass),J.textWrapperClass&&$(Tt).addClass(J.textWrapperClass),J.buttonsWrapperClass&&$(ze).addClass(J.buttonsWrapperClass),$(Tt).find(".notification_text").html(J.text),J.buttons){var Pe=J.buttons.length;$(J.buttons).reverse().each(function(Oe,ft){var Ct=Pe-Oe,Rt=$('<a href="#" buttonNumber="'+Ct+'" class="button notification_button">'+ft.text+"</a>");ft.extraclass&&$(Rt).addClass(ft.extraclass),$(ze).append(Rt)})}if(J.middlerow){var We=document.createElement("div");$(We).addClass("notification_middlerow"),$(We).append(J.middlerow),J.middlerowExtraClass&&$(We).addClass(J.middlerowExtraClass),$(ze).before(We)}e.Utils.addTempShown(ot);var xt=$(Tt).outerHeight(!0)+$(ze).outerHeight(!0);if(J.middlerow){var We=$(me).find(".notification_middlerow");xt=xt+$(We).outerHeight(!0)}e.Utils.removeTempShown(ot);var Et=$(me).clone();$(Et).attr("id","notification_template_cloned"),$(ot).append(Et);var le=$("#notification_template_cloned");if(J.buttons){ze=$(le).find(".notification_row2"),$(ze).html("");var Pe=J.buttons.length;$(J.buttons).reverse().each(function(ft,Ct){var Rt=Pe-ft,Wt=$('<a href="#" buttonNumber="'+Rt+'" class="button notification_button">'+Ct.text+"</a>");Ct.extraclass&&$(Wt).addClass(Ct.extraclass),$(ze).append(Wt),$(ze).find(".button[buttonNumber='"+Rt+"']").click(function(nn){nn.preventDefault(),Ct.callback()})})}$("a#link_to_notification_template").fancybox({autoDimensions:!1,autoScale:!0,scrolling:"no",width:h,height:xt,padding:0,hideOnOverlayClick:!0,hideOnContentClick:!1,showCloseButton:Ue,onStart:function(Oe){},onComplete:function(Oe){},onClosed:function(Oe){ie(),J&&typeof J.onClosedCallback=="function"&&J.onClosedCallback()}}),$("a#link_to_notification_template").trigger("click")}},ie=function(){var J=$("#notification_template_wrapper");$(J).html("");var me=document.createElement("div");$(me).attr("id","notification_template");var h=document.createElement("div");$(h).addClass("notification_row1");var Re=document.createElement("img");$(Re).addClass("notificationIcon"),$(Re).attr("style","display:none");var Ue=document.createElement("span");$(Ue).addClass("notification_text"),$(h).append(Re),$(h).append(Ue),$(me).append(h);var Xe=document.createElement("div");$(Xe).addClass("notification_row2"),$(me).append(Xe),$(J).append(me)},R=function(J){return Y(e.VERSION)>Y(J)},Y=function(J){var me=0,h=[100,10,1];try{for(var Re=J.split("."),Ue=0;Ue<Re.length;Ue++)me+=parseFloat(Re[Ue])*h[Ue]}catch(Xe){return 0}return me},N={},Q=function(J){$(J).each(function(me,h){var Re=$(h).attr("id");typeof Re=="undefined"&&(Re=e.Utils.getId("TmpShownId"),$(h).attr("id",Re));var Ue=typeof N[Re]!="undefined"?N[Re]:0;N[Re]=Ue+1,Ue==0&&$(h).addClass("temp_shown")})},oe=function(J){$(J).each(function(me,h){var Re=$(h).attr("id");typeof Re=="undefined"&&(Re=e.Utils.getId("TmpShownId"),$(h).attr("id",Re));var Ue=typeof N[Re]!="undefined"?N[Re]:0,Xe=Math.max(0,Ue-1);N[Re]=Xe,Xe==0&&setTimeout(function(){N[Re]===0&&$(h).removeClass("temp_shown")},1)})},b=function(J){if(typeof J=="string"){var me=J.match(/^https?:\/\//);if(me instanceof Array&&me.length===1){var h=me[0].replace("://",""),Re=e.Status.getProtocol();if(h!=Re)switch(Re){case"https":J="https"+J.replace(h,"");break;case"http":break;default:break}}}return J},Le=function(J){return typeof J!="string"||(J=b(J)),J},ce=function(J){if(typeof J!="string")return J;J=b(J);var me=e.Utils.getOptions();if(typeof me!="undefined"&&typeof me.escapp!="undefined"&&typeof me.escapp.endpoint=="string")try{var h=new URL(me.escapp.endpoint).hostname,Re=new URL(J).hostname;if(h===Re)return e.Utils.addParamToUrl(J,"escapp_preview",""+e.Status.isPreview())}catch(Ue){}return J};return{init:c,getOptions:m,getId:f,registerId:T,deepMerge:A,fixScene:D,getOuterHTML:z,getSrcFromCSS:S,addFontSizeToStyle:te,getFontSizeFromStyle:Z,getWidthFromStyle:k,getHeightFromStyle:F,getPixelDimensionsFromStyle:G,addParamToUrl:E,removeParamFromUrl:O,getParamsFromUrl:L,removeHashFromUrlString:p,getScreenNumberFromHash:v,showDialog:V,showPNotValidDialog:M,isObseleteVersion:R,addTempShown:Q,removeTempShown:oe,checkUrlProtocol:b,checkWebUrl:Le,checkReusablePuzzleInstanceUrl:ce}})(SceneMaker),SceneMaker.Utils.Loader=(function(e,n){var w=function(){},l=function(k){if(k.screens&&Array.isArray(k.screens))for(let Z=0;Z<k.screens.length;Z++){var F=k.screens[Z];if(F.hotspots&&Array.isArray(F.hotspots))for(let te=0;te<F.hotspots.length;te++){var G=F.hotspots[te];if(G.actions&&Array.isArray(G.actions))for(let M=0;M<G.actions.length;M++)c(G.actions[M])}}},c=function(k){if(k.actionType&&k.actionParams&&typeof k.actionParams=="object")switch(k.actionType){case"changeBackground":typeof k.actionParams.url=="string"&&m([k.actionParams.url]);break;case"playSound":typeof k.actionParams.url=="string"&&f([k.actionParams.url]);break;default:break}},m=function(k){for(let F=0;F<k.length;F++){const G=new Image;G.src=k[F]}},f=function(k){for(let F=0;F<k.length;F++){const G=new Audio;G.src=k[F],G.preload="auto"}},T=function(k,F){if(!(typeof k!="string"||typeof F!="function")){var G=document.getElementsByTagName("head")[0];if(G){var Z=document.createElement("script");Z.setAttribute("src",k),Z.setAttribute("type","text/javascript");var te=!1,M=function(){te||typeof F=="function"&&(te=!0,F())},V=function(){(this.readyState=="complete"||this.readyState=="loaded")&&M()};Z.onreadystatechange=V,Z.onload=M,G.appendChild(Z)}}},A=function(k,F){var G=k;G.indexOf("http")!=0&&(G=e.StylesheetsPath+G,e.Status.getProtocol()==="file"&&G.indexOf("/")==0&&(G=G.replace("/","")));var Z=document.getElementsByTagName("head")[0],te=document.createElement("link");if(te.type="text/css",te.rel="stylesheet",te.href=G,typeof F=="function"){var M=!1,V=function(){M||(M=!0,F())};te.onload=V,te.onerror=V;var ie=function(){(this.readyState=="complete"||this.readyState=="loaded")&&V()};te.onreadystatechange=ie}if(Z.appendChild(te),typeof F=="function"){var R=document.createElement("img");R.onerror=function(){V()},R.src=G}},D=function(){var k=["es","fr","hu","nl","de"],F=e.I18n.getLanguage();k.indexOf(F)!=-1&&A("language/"+F+".css")},z,O=function(){v()||(z=Date.now(),$("#fancyLoad").trigger("click"))},E=function(k){var F=Date.now()-z;if(F<1250)setTimeout(function(){E(k)},Math.max(0,Math.min(1250-F,1250)));else{var G=!1,Z=0;v()&&($.fancybox.close(),G=!0,Z=800),typeof k=="function"&&setTimeout(function(){k(G)},Z)}},L=function(){$("#fancybox-outer").css("background","rgba(255,255,255,0.9)"),$("#fancybox-wrap").css("margin-top","20px"),$("#fancybox-wrap").css("margin-left","20px")},v=function(){return $("#loading_fancy").is(":visible")},p=function(k,F){var G=document.createElement("img");$(G).addClass("loading_fancy_img"),$(G).attr("src",e.ImagesPath+"lightbox-ico-loading.gif"),F&&F.style&&$(G).addClass(F.style);var Z=document.createElement("div");$(Z).addClass("loading_fancy"),$(Z).append(G),$(k).html(""),$(k).append(Z),$(k).addClass("loadingtmpShown")},S=function(k){$(k).find(".loading_fancy_img").parent().remove(),$(k).removeClass("loadingtmpShown")};return{init:w,preloadResources:l,loadScript:T,loadCSS:A,loadLanguageCSS:D,prepareFancyboxForFullLoading:L,startLoading:O,stopLoading:E,startLoadingInContainer:p,stopLoadingInContainer:S}})(SceneMaker),SceneMaker.Slides=(function(e,n,w){var l=function(){},c=function(){var v=e.View.getCurrentView();return typeof v=="undefined"||v===null?e.Screen.getCurrentScreen():v},m=function(){var v=e.View.getCurrentViewNumber();return typeof v!="undefined"?v:e.Screen.getCurrentScreenNumber()},f=function(v){var p=n(v),S=p.attr("id");return p.find("img.slide_background#"+S+"_background")},T=function(v){var p=f(v);return p.length>0?p.attr("src"):w},A=function(v,p){var S=n(v);if(S.attr("type")!==e.Constant.VIEW_CONTENT){var k=f(S);k.attr("src",p)}},D=function(v){return v&&v.tagName==="ARTICLE"||typeof v=="object"&&v.length===1&&v[0].tagName==="ARTICLE"?n(v).attr("type"):typeof v=="object"&&typeof v.type=="string"?v.type:null},z=function(v){var p;return typeof v=="string"?p=v:p=n(v).attr("type"),p===e.Constant.SCREEN},O=function(v){var p;return typeof v=="string"?p=v:p=n(v).attr("type"),p===e.Constant.VIEW_IMAGE||p===e.Constant.VIEW_CONTENT},E=function(v){var p=n("#"+v)[0];if(typeof p!="undefined"){if(document.createEvent){var S=document.createEvent("Event");S.initEvent("slideenter",!0,!0),p.dispatchEvent(S)}else if(document.createEventObject){var S=document.createEventObject();p.fireEvent("onslideenter",S)}}},L=function(v){var p=n("#"+v)[0];if(typeof p!="undefined"){if(document.createEvent){var S=document.createEvent("Event");S.initEvent("slideleave",!0,!0),p.dispatchEvent(S)}else if(document.createEventObject){var S=document.createEventObject();p.fireEvent("onslideleave",S)}}};return{init:l,getCurrentSlide:c,getCurrentSlideNumber:m,getSlideBackgroundImg:f,getSlideBackground:T,changeSlideBackground:A,getSlideType:D,isScreen:z,isView:O,triggerSlideEnterEvent:E,triggerSlideLeaveEvent:L}})(SceneMaker,jQuery),SceneMaker.Screen=(function(e,n,w){var l,c,m=function(){},f=function(){return l},T=function(N){l=N,n.each(l,function(Q,oe){n(oe).attr("slidenumber",Q+1)})},A=function(){var N=n("section.slides > article");T(N),N.removeClass("current"),n(L(c+1)).addClass("current")},D=function(){return l[c]},z=function(){return c+1},O=function(N){E(N-1)},E=function(N){c=N},L=function(N){var Q=N-1;return Q<0||Q>=l.length?null:l[Q]},v=function(){var N=e.Utils.getScreenNumberFromHash();O(N||1)},p=function(){return n("section.slides > article").length},S=function(N){var Q=n(N).children("article.show_in_screen");if(Q.length===1){var oe=Q[0],b=n(oe).attr("id");e.Slides.triggerSlideEnterEvent(b)}},k=function(N){var Q=n(N).children("article.show_in_screen");if(Q.length===1){var oe=Q[0],b=n(oe).attr("id");e.Slides.triggerSlideLeaveEvent(b)}},F=function(N){Z(1)},G=function(){Z(-1)},Z=function(N){var Q=c+N+1;Q=Math.min(Math.max(1,Q),l.length),te(Q)},te=function(N,Q){Q!==!0&&N===z()||N>l.length||N<=0||(!e.Editing&&n.fancybox&&n.fancybox.close(),M(N))},M=function(N){var Q=N-1;Q<l.length&&Q>=0&&(Y(c+1),E(Q),A(),R(c+1))},V=function(){te(l.length)},ie=function(N,Q){},R=function(N){var Q=e.Screen.getScreenWithNumber(N);Q&&e.Slides.triggerSlideEnterEvent(Q.id)},Y=function(N){var Q=e.Screen.getScreenWithNumber(N);Q&&e.Slides.triggerSlideLeaveEvent(Q.id)};return{init:m,getScreens:f,setScreens:T,updateScreens:A,getCurrentScreen:D,getCurrentScreenNumber:z,setCurrentScreenNumber:O,getScreenWithNumber:L,updateCurrentScreenFromHash:v,getScreensQuantity:p,onEnterScreen:S,onLeaveScreen:k,forwardOneScreen:F,backwardOneScreen:G,goToScreenWithNumber:te,goToLastScreen:V,afterSetupSize:ie,triggerScreenEnterEvent:R,triggerScreenLeaveEvent:Y}})(SceneMaker,jQuery),SceneMaker.View=(function(e,n,w){var l=null,c=function(){},m=function(){return e.Editing?e.Editor.View.getCurrentView():l===null?null:n("#"+l)},f=function(){var O=m();if(typeof O=="undefined"||O===null)return w;var E=n(O).attr("slidenumber");if(typeof E=="string")try{return parseInt(E)}catch(L){return w}},T=function(O,E){return n(O).children("article[slidenumber='"+E+"']")},A=function(O){var E=O.target.id.substring(5);z(E)},D=function(O){var E=m();if(typeof E!="undefined"&&E!==null){var L=n(E).attr("id");if(O===L)return;z(L)}l=O,n("#"+O).removeClass("hide_in_screen"),n("#"+O).addClass("show_in_screen"),e.Slides.triggerSlideEnterEvent(O)},z=function(O){l=null,n("#"+O).removeClass("show_in_screen"),n("#"+O).addClass("hide_in_screen"),e.Slides.triggerSlideLeaveEvent(O)};return{init:c,getCurrentView:m,getCurrentViewNumber:f,getViewWithNumber:T,onCloseViewClicked:A,openView:D,closeView:z}})(SceneMaker,jQuery),SceneMaker.Marker=(function(e,n,w){var l,c,m,f,T=function(){l={},c={},m={},f=e.ImagesPath+"hotspotgallery/hotspot.png"},A=function(){return f},D=function(F){var G=n("#"+F.id);if(typeof F.background=="string"){var Z=F.id+"_background",te=n("<img>",{id:Z,class:"slide_background",src:F.background});G.append(te)}if(Array.isArray(F.hotzones)&&F.hotzones.length>0)for(j in F.hotzones)O(G,F.hotzones[j]);if(Array.isArray(F.hotspots)&&F.hotspots.length>0)for(i in F.hotspots)z(G,F.hotspots[i]);typeof F.caption!="undefined"&&e.Caption.drawCaption(G,F.caption)},z=function(F,G){if(!(!G||!G.id)){var Z=10;if(G.x&&G.y&&!(!G.width||G.width<=0)&&!(!G.height||G.height<=0)){typeof G.image!="string"&&(G.image=f);var te=parseFloat(G.rotationAngle);(typeof te!="number"||isNaN(te)||te<0||te>360)&&(te=0);var M="",V=G.visibility!=="hidden";V===!1&&(M+=" hotspot_hidden");var ie=G.cursorVisibility==="pointer";ie===!0&&(M+=" hotspot_cursor_pointer");var R=e.Slides.getSlideBackgroundImg(F),Y=n("<img>",{src:G.image,class:"hotspot"+M,id:G.id,rotationAngle:te,css:{position:"absolute",left:G.x+"%",top:G.y+"%",width:G.width+"%",height:G.height+"%",transform:"rotate("+te+"deg)"}}).appendTo(R.parent());if(Array.isArray(G.actions)&&G.actions.length>0){Y.addClass("hotspot_with_actions"),c[G.id]=G,Y.on("click",function(){S(G.id)});for(i in G.actions)e.Actions.addActionToHotspot(Y,G.actions[i])}}}},O=function(F,G){if(!(!G||!G.id)&&Array.isArray(G.points)){var Z=F.attr("id"),te=G.id,M=L(Z),V=v(te,G.points);M.addAnnotation(V),E(V.id,function(ie){if(G.cursorVisibility==="pointer"&&n(ie).attr("hotzone_cursor_visibility",G.cursorVisibility),G.enabled===!1?n(ie).attr("hotzone_enabled","false"):n(ie).attr("hotzone_enabled","true"),Array.isArray(G.actions)&&G.actions.length>0){m[te]=G;for(i in G.actions)e.Actions.addActionToHotzone(ie,G.actions[i])}})}},E=function(F,G){var Z,te=Date.now();function M(){var V=p(F);return V.length>0?(clearInterval(Z),G(V),!0):(Date.now()-te>=1e3&&clearInterval(Z),!1)}setTimeout(function(){M()||(Z=setInterval(M,200))},0)},L=function(F){if(typeof l[F]=="undefined"&&(l[F]={}),typeof l[F].annotator!="undefined")return l[F].annotator;var G=e.Slides.getSlideBackgroundImg(n("#"+F)),Z=Annotorious.createImageAnnotator(G.attr("id"),{drawingEnabled:!1,userSelectAction:"SELECT",style:{fill:"#dddddd00",fillOpacity:0,stroke:"#00000000",strokeWidth:1}});return Z.on("selectionChanged",function(te){Array.isArray(te)&&te.length===1&&k(te[0].id)}),l[F].annotator=Z,Z},v=function(F,G){var Z=G.map(([N])=>N),te=G.map(([,N])=>N),M=Math.min(...Z),V=Math.max(...Z),ie=Math.min(...te),R=Math.max(...te),Y={id:F,target:{selector:{type:"POLYGON",geometry:{bounds:{minX:M,minY:ie,maxX:V,maxY:R},points:G}}}};return Y},p=function(F){return n("g.[data-id='"+F+"']")},S=function(F){e.Actions.performActions(c[F].actions,F)},k=function(F){var G=p(F);n(G).attr("hotzone_enabled")!=="false"&&e.Actions.performActions(m[F].actions,m[F].idAlias)};return{init:T,getDefaultHotspotImg:A,getHotzoneDOM:p,drawSlideWithMarkers:D,createAnnotationFromPointsArray:v}})(SceneMaker,jQuery),SceneMaker.FullScreen=(function(e,n,w){var l,c,m,f=function(){T(),A()},T=function(){try{var M=e.Status.getContainer();if(typeof M!="undefined"){if(typeof n(M).attr("allowfullscreen")=="undefined")n(M).attr("allowfullscreen","true"),n(M).attr("webkitAllowFullScreen","true"),n(M).attr("mozallowfullscreen","true");else if(n(M).attr("allowfullscreen")==="false"){n(M).removeAttr("allowfullscreen"),n(M).removeAttr("webkitAllowFullScreen"),n(M).removeAttr("mozallowfullscreen");return}var V=te();e.Status.getContainerType()==="OBJECT"&&(n(M).addClass("ScreenMakerFS"),n(V).addClass("ScreenMakerFS"),n(window.parent.document).find("head").append("<style>.ScreenMakerFS:full-screen, :full-screen > object.ScreenMakerFS {width: 100% !important;height: 100% !important;}</style>"),n(window.parent.document).find("head").append("<style>.ScreenMakerFS:-webkit-full-screen, :-webkit-full-screen > object.ScreenMakerFS {width: 100% !important;height: 100% !important;}</style>"),n(window.parent.document).find("head").append("<style>.ScreenMakerFS:-moz-full-screen, :-moz-full-screen > object.ScreenMakerFS {width: 100% !important;height: 100% !important;}</style>"))}}catch(ie){}},A=function(){k()?n("#page-fullscreen").removeClass("fsoff").addClass("fson"):n("#page-fullscreen").removeClass("fson").addClass("fsoff")},D=function(){var M=document.createElement("div");return!!(M&&(M.requestFullScreen||M.mozRequestFullScreen||M.webkitRequestFullScreen||M.msRequestFullscreen))},z=function(){return!e.Editing&&O()},O=function(){return e.Status.getDevice().features.fullscreen&&E(Z())},E=function(M){return M.fullscreenEnabled||M.mozFullScreenEnabled||M.webkitFullscreenEnabled||M.msFullscreenEnabled},L=function(){n(document).on("click","#page-fullscreen",v),n(Z()).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(M){c=l,l=G(Z()),m=new Date,A()})},v=function(){var M=Z(),V=te();k()?S(M):p(M,V)},p=function(M,V){V.requestFullscreen?V.requestFullscreen():V.mozRequestFullScreen?V.mozRequestFullScreen():V.webkitRequestFullscreen?(V.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT),setTimeout(function(){M.webkitCurrentFullScreenElement||V.webkitRequestFullScreen()},250)):V.msRequestFullscreen&&V.msRequestFullscreen()},S=function(M){M.exitFullscreen?M.exitFullscreen():M.cancelFullScreen?M.cancelFullScreen():M.mozCancelFullScreen?M.mozCancelFullScreen():M.webkitExitFullscreen?M.webkitExitFullscreen():M.webkitCancelFullScreen?M.webkitCancelFullScreen():M.msExitFullscreen&&M.msExitFullscreen()},k=function(){return e.Status.getContainerType()==="OBJECT"?F():n(G(Z())).is("html")},F=function(){var M=G(Z());return typeof M!="undefined"&&M!==null},G=function(M){return M.fullscreenElement||M.mozFullScreenElement||M.webkitFullscreenElement||M.msFullscreenElement},Z=function(){return e.Status.getContainerType()=="OBJECT"?window.parent.document:document},te=function(){return e.Status.getContainerType()==="OBJECT"?e.Status.getContainer().parentElement:document.documentElement};return{init:f,isFullScreenSupported:D,canFullScreen:z,enableFullScreen:L,isFullScreen:k}})(SceneMaker,jQuery),SceneMaker.Editor=(function(e,n,w){var l,c,m=!1,f,T,A,D,z=e.Constant.NONE,O=function(){E(e.getOptions())},E=function(Pe){n("#waiting_overlay").show(),n("body").addClass("SceneMakerBody"),e.Editing=!0,e.Debugging.init(Pe);var We;Pe?(We=Pe.scene,l=Pe,Pe.configuration&&e.Configuration&&e.Configuration.init(Pe.configuration)):l={},We&&(m=!0),e.Utils.init(),e.I18n.init(l,We),e.Status.init(function(){L(Pe,We)})},L=function(Pe,We){if(e.Utils.Loader.loadLanguageCSS(),e.I18n.translateUI(),e.Object.init(),e.Editor.Dummies.init(),e.EventsNotifier.init(),e.Screen.init(),e.Editor.Screen.init(),e.View.init(),e.Editor.View.init(),e.Marker.init(),e.Editor.Marker.init(),e.Editor.Actions.init(),e.Editor.Caption.init(),e.Renderer.init(),e.Slides.init(),e.User.init(Pe),e.Video.init(),e.Audio.init(),e.Editor.Settings.init(),m){var We=e.Utils.fixScene(We);if(We===null){n("#waiting_overlay").hide(),e.Utils.showPNotValidDialog();return}c=We,e.Editor.Settings.loadSceneSettings(We),e.Editor.Renderer.init(We),te(),v(Pe,We)}else e.Editor.Settings.loadSceneSettings(),v(Pe,We)},v=function(Pe,We){if(m){var xt=e.Utils.getScreenNumberFromHash();xt?e.Screen.setCurrentScreenNumber(xt):e.Screen.setCurrentScreenNumber(1)}if(e.Screen.updateScreens(),e.Editor.Thumbnails.drawScreenThumbnails(function(){e.Editor.Thumbnails.selectThumbnail(e.Screen.getCurrentScreenNumber()),e.Editor.Thumbnails.moveThumbnailsToScreenWithNumber(e.Screen.getCurrentScreenNumber())}),m&&n(".object_wrapper").hide(),e.Editor.Text.init(),e.Editor.Image.init(),e.Editor.Video.init(),e.Editor.Audio.init(),e.Editor.Object.init(),e.Editor.Thumbnails.init(),e.Editor.Preview.init(),e.Editor.Tools.init(),e.Editor.Clipboard.init(),e.Editor.Events.init(),e.Editor.Utils.Loader.unloadAllObjects(),e.Screen.getCurrentScreenNumber()>0&&e.Slides.triggerSlideEnterEvent(n(e.Screen.getCurrentScreen()).attr("id")),!m){var Et=e.Editor.Dummies.getDummy(e.Constant.SCREEN,{slideNumber:1});e.Editor.Screen.addScreen(Et),e.Screen.goToScreenWithNumber(1)}m||e.Editor.Settings.displaySettings(),window.focus(),n("#waiting_overlay").hide()},p=function(Pe){var We=e.Screen.getCurrentScreen();if(e.Slides.isScreen(We)){var xt=n(Pe.currentTarget).attr("type"),Et=e.Editor.Dummies.getDummy(xt,{screenId:n(We).attr("id"),slideNumber:n(We).find("article").length+1});e.Editor.View.addView(We,Et),n.fancybox.close()}},S=function(Pe){n(this).removeClass("editable"),h(n(this));var We=n("#menuselect").clone();n(We).removeAttr("id"),n(We).find("a").css("display","none").addClass("thumb_shown"),e.Editor.Tools.hideZoneToolTip(n(this).find(".zone_tooltip")),n(this).append(We),e.Editor.Events.addZoneThumbsEvents(this)},k=function(){h(n(this).parent());var Pe={};Pe.width=375,Pe.height=135;var We=me().attr("type");We==="audio"&&(We="video"),Pe.notificationIconSrc=e.ImagesPath+"thumbs/"+We+".png",Pe.text=e.I18n.getTrans("i.AreYouSureContent");var xt={};xt.text=e.I18n.getTrans("i.no"),xt.callback=function(){n.fancybox.close()};var Et={};Et.text=e.I18n.getTrans("i.delete"),Et.callback=function(){var le=me();le.html(""),le.removeAttr("type"),le.addClass("editable"),e.Editor.Tools.addTooltipToZone(le),G(null),e.Editor.Slides.updateThumbnail(e.Slides.getCurrentSlide()),n.fancybox.close()},Pe.buttons=[xt,Et],e.Utils.showDialog(Pe)},F=function(Pe){G(n(this)),Pe.stopPropagation(),Pe.preventDefault()},G=function(Pe){h(Pe),te(),Z(Pe),e.Editor.Tools.loadToolsForZone(Pe)},Z=function(Pe){n(Pe).removeClass("zoneUnselected"),n(Pe).addClass("zoneSelected")},te=function(Pe){Pe?(n(Pe).removeClass("zoneSelected"),n(Pe).addClass("zoneUnselected")):(n(".zoneSelected").addClass("zoneUnselected"),n(".zoneSelected").removeClass("zoneSelected"))},M=function(Pe){var We=n(Pe.target),xt=n(We).parent();if(!n(We).hasClass("noSelectableElement")){if(n("#fancybox-content").is(":visible")||n(We).is("polygon")||n(xt).hasClass("selectable")||n(xt).hasClass("preventNoselectable")||jQuery.contains(n("#toolbar_wrapper")[0],Pe.target)||Pe.target.id==="toolbar_wrapper")return;var Et=!1;if(n(".cke_dialog").each(function(le,Oe){if(Oe&&jQuery.contains(Oe,Pe.target))return Et=!0,!1}),Et)return}V()},V=function(){e.Editor.Tools.cleanZoneTool(me()),h(null),te()},ie=function(Pe){Pe.append("<div class='delete_content'></div>")},R=function(Pe){var We=n(Pe.target);Pe.stopPropagation(),e.Slides.isScreen(We)?e.Editor.Screen.onEnterScreen(We):(e.Editor.Utils.Loader.loadObjectsInEditorSlide(We),setTimeout(function(){n(We).find(".object_wrapper").show()},500)),e.Editor.Thumbnails.selectThumbnail(e.Screen.getCurrentScreenNumber()),V(),e.Editor.Tools.loadToolsForSlide(We)},Y=function(Pe){var We=n(Pe.target);Pe.stopPropagation(),e.Slides.isScreen(We)?e.Editor.Screen.onLeaveScreen(We):(e.Editor.Utils.Loader.unloadObjectsInEditorSlide(We),n(".object_wrapper").hide())},N=function(){var Pe={},We=e.Utils.getOptions();return Pe=e.Editor.Settings.getSettings(),We&&typeof We.erId=="number"&&(Pe.erId=We.erId),Pe.screens=[],e.Editor.Utils.Loader.loadAllObjects(),n(".object_wrapper").show(),n("section.slides > article").each(function(xt,Et){var le={};e.Slides.isScreen(Et)&&(e.Utils.addTempShown(Et),le=e.Editor.Marker.saveSlideWithMarkers(Et),le.views=[],n(Et).find("article").each(function(Oe,ft){var Ct=Q(ft,Pe,!0);le.views.push(Ct)}),e.Utils.removeTempShown(Et),Pe.screens.push(le))}),e.Editor.Utils.Loader.unloadAllObjects(),e.Editor.Utils.Loader.loadObjectsInEditorSlide(e.Screen.getCurrentScreen()),e.Debugging.log(`

Scene Maker save the following scene:
`),e.Debugging.log(JSON.stringify(Pe)),Pe},Q=function(Pe,We){switch(n(Pe).attr("type")){case e.Constant.VIEW_IMAGE:return oe(Pe,We);case e.Constant.VIEW_CONTENT:return b(Pe,We)}},oe=function(Pe){e.Utils.addTempShown(Pe);var We=e.Editor.Marker.saveSlideWithMarkers(Pe);return e.Utils.removeTempShown(Pe),We},b=function(Pe,We){return slide={},slide.id=n(Pe).attr("id"),slide.type=n(Pe).attr("type"),slide.elements=[],e.Utils.addTempShown(Pe),n(Pe).find("div.view_content_zone").each(function(xt,Et){var le={};le.id=n(Et).attr("id"),le.type=n(Et).attr("type");var Oe=n(Et).attr("elSettings");if(typeof Oe=="string")try{le.settings=JSON.parse(Oe)}catch(st){}if(le.type==e.Constant.TEXT){var ft=e.Editor.Text.getCKEditorFromZone(Et);ft!==null?le.body=ft.getData():le.body=""}else if(le.type==e.Constant.IMAGE)le.body=n(Et).find("img").attr("src"),le.style=e.Editor.Utils.getStylesInPercentages(n(Et),n(Et).find("img")),n(Et).attr("hyperlink")&&(le.hyperlink=n(Et).attr("hyperlink"));else if(le.type==e.Constant.VIDEO){var Ct=n(Et).find("video"),Rt=n(Ct).attr("poster");typeof Rt=="string"&&(le.poster=Rt),le.style=e.Editor.Utils.getStylesForFitContent();var Wt="";n(Ct).find("source").each(function(st,ht){st!==0&&(Wt=Wt+",");var qt=e.Utils.removeParamFromUrl(n(ht).attr("src"),"timestamp"),Xt=typeof n(ht).attr("type")!="undefined"?', "type": "'+n(ht).attr("type")+'"':"";Wt=Wt+'{"src":"'+qt+'"'+Xt+"}"}),Wt="["+Wt+"]",le.sources=Wt}else if(le.type==e.Constant.AUDIO){var nn=n(Et).find("audio");le.style=e.Editor.Utils.getStylesForFitContent();var Wt="";n(nn).find("source").each(function(ht,qt){ht!==0&&(Wt=Wt+",");var Xt=e.Utils.removeParamFromUrl(n(qt).attr("src"),"timestamp"),ue=typeof n(qt).attr("type")!="undefined"?', "type": "'+n(qt).attr("type")+'"':"";Wt=Wt+'{"src":"'+Xt+'"'+ue+"}"}),Wt="["+Wt+"]",le.sources=Wt}else if(le.type===e.Constant.OBJECT){var rn=n(Et).find(".object_wrapper")[0],Zt=n(rn).children()[0],Vt=n(Zt).clone();Vt.removeAttr("style");var Qt=e.Utils.removeParamFromUrl(Vt.attr("src"),"escapp_preview");Vt.attr("src",Qt),le.body=e.Utils.getOuterHTML(Vt),le.style=e.Editor.Utils.getStylesForFitContent(),le.subtype=e.Object.getObjectInfo(Vt).type}else le.type;slide.elements.push(le)}),e.Utils.removeTempShown(Pe),slide},Le=function(Pe,We,xt,Et){if(e.Debugging.isDevelopping()){f=JSON.stringify(Pe),setTimeout(function(){xt()},5e3);return}var le=typeof f=="undefined"&&!m,Oe;le?Oe="POST":Oe="PUT";var ft={};typeof e.User.getToken()!="undefined"&&(ft.authenticity_token=e.User.getToken());var Ct=JSON.stringify(Pe);ft["scene[json]"]=Ct,n.ajax({type:Oe,url:e.UploadScenePath,data:ft,success:function(Rt){f=Ct,le&&typeof Rt!="undefined"&&Rt.uploadPath&&(e.UploadScenePath=e.Utils.checkUrlProtocol(Rt.uploadPath),e.Status.getDevice().features.historypushState&&window.top.history.replaceState("","",e.UploadScenePath)),typeof xt=="function"&&xt(Rt)},error:function(Rt,Wt){typeof Et=="function"&&Et()}})},ce=function(){return l},J=function(){var Pe=me();if(typeof Pe!="undefined"&&Pe!==null)return"ZONE";var We=e.Editor.Marker.getCurrentHotspot();if(typeof We!="undefined"&&We!==null)return"HOTSPOT";var xt=e.Editor.Marker.getCurrentHotzoneId();return typeof xt!="undefined"&&xt!==null?"HOTZONE":"NONE"},me=function(){return T||null},h=function(Pe){n(Pe).attr("id")!=n(T).attr("id")&&(A=T,T=Pe)},Re=function(){return A||null},Ue=function(){return D},Xe=function(Pe){D=Pe},ot=function(Pe){return Pe&&n(Pe).find(".delete_content").length===0},Tt=function(){return z},ze=function(Pe){z=Pe},et=function(){try{var Pe;if(typeof f!="undefined")Pe=f;else if(typeof c!="undefined")Pe=JSON.stringify(c);else return!0;var We=e.Editor.saveScene();return Pe!==JSON.stringify(We)}catch(xt){return!0}};return{init:O,getOptions:ce,getCurrentElementType:J,getCurrentArea:me,setCurrentArea:h,selectContentZone:G,getLastArea:Re,cleanArea:V,getCurrentContainer:Ue,setCurrentContainer:Xe,getContentAddMode:Tt,setContentAddMode:ze,isZoneEmpty:ot,saveScene:N,sendScene:Le,onSlideEnterEditor:R,onSlideLeaveEditor:Y,onViewThumbClicked:p,onEditableClicked:S,onSelectableClicked:F,onNoSelectableClicked:M,onDeleteItemClicked:k,addDeleteButton:ie,hasSceneChanged:et}})(SceneMaker,jQuery),SceneMaker.Editor.Slides=(function(e,n,w){var l=function(){var O=e.Slides.getCurrentSlide();e.Slides.isView(O)?e.Editor.View.removeView(O):e.Editor.Screen.removeScreen(O)},c=function(O){var E=e.Editor.Thumbnails.getThumbnailForSlide(O),L=e.Editor.Thumbnails.getThumbnailURLForSlide(O);n(E).error(function(v){m(O,E,e.Editor.Thumbnails.getDefaultThumbnailURLForSlide(O))}),m(O,E,L)},m=function(O,E,L){e.Slides.isScreen(O)&&n("#screen_selected > img").attr("src",L),n(E).attr("src",L)},f=function(){return!(n(".wysiwygInstance").is(":focus")||n("#fancybox-content").is(":visible")||n("input").is(":focus")||e.Editor&&e.Editor.getCurrentArea()!==null)},T=function(O,E){var L=n(O);if(L.attr("type")!==e.Constant.VIEW_CONTENT){var v=e.Slides.getSlideBackgroundImg(L);if(v.length===0){var p=L.attr("id")+"_background";v=n("<img>",{id:p,class:"slide_background"}),L.append(v)}v.attr("src",E),n(O).find("div.change_bg_button").hide(),e.Editor.Slides.updateThumbnail(O),e.Editor.Tools.loadToolsForSlide(O)}n.fancybox.close()},A=function(O){var E={};return n(O).find("div[type='text']").each(function(L,v){var p=n(v).attr("id"),S=e.Editor.Text.getCKEditorFromZone(v);p&&S!==null&&(E[p]=S.getData())}),E},D=function(O,E,L){L!==!0&&(L=!1);var v=n(O).find("article[type='"+e.Constant.VIEW_CONTENT+"']");e.Utils.addTempShown(O),e.Utils.addTempShown(v),n(O).find("div[type='text']").each(function(p,S){var k;if(L?k=n(S).attr("copyid"):k=n(S).attr("id"),k&&E[k]){var F=E[k];e.Editor.Text.launchTextEditor({},n(S),F)}}),e.Utils.removeTempShown(v),e.Utils.removeTempShown(O)},z=function(O){n(O).find("div[type='text'],div.wysiwygTextArea").each(function(E,L){n(L).html("")})};return{removeCurrentSlide:l,updateThumbnail:c,isSlideFocused:f,setSlideBackground:T,copyTextAreasOfSlide:A,loadTextAreasOfSlide:D,cleanTextAreasOfSlide:z}})(SceneMaker,jQuery),SceneMaker.Editor.Dummies=(function(e,n){var w=function(){},l=function(E,L){switch(E){case e.Constant.SCREEN:return typeof L.screenId=="undefined"&&(L.screenId=e.Utils.getId("article")),c(L);case e.Constant.VIEW_IMAGE:return typeof L.viewId=="undefined"&&(L.viewId=e.Utils.getId(L.screenId+"_article")),m(L);case e.Constant.VIEW_CONTENT:return typeof L.viewId=="undefined"&&(L.viewId=e.Utils.getId(L.screenId+"_article")),f(L)}},c=function(E){var L="<article id='article_id_to_change' type='"+e.Constant.SCREEN+"' slidenumber='slidenumber_to_change'><div class='change_bg_button'></div></article>";return O(L,E.slideNumber,E.screenId)},m=function(E){var L="<article id='article_id_to_change' type='"+e.Constant.VIEW_IMAGE+"' slidenumber='slidenumber_to_change'><div class='change_bg_button'></div></article>";return O(L,E.slideNumber,E.viewId)},f=function(E){var L="<article id='article_id_to_change' type='"+e.Constant.VIEW_CONTENT+"' slidenumber='slidenumber_to_change'><div id='div_id_to_change' class='view_content_zone editable selectable'></div></article>";return O(L,E.slideNumber,E.viewId,E.zoneIds)},T=function(E,L){switch(E.type){case e.Constant.SCREEN:return A(E,L);case e.Constant.VIEW_IMAGE:return D(E,L);case e.Constant.VIEW_CONTENT:return z(E,L)}},A=function(E,L){return L.screenId=E.id,c(L)},D=function(E,L){return L.viewId=E.id,m(L)},z=function(E,L){L.viewId=E.id;var v=[];for(el in E.elements)v.push(E.elements[el].id);L.zoneIds=v;var p=f(L);return p=p.replace(/editable /g,""),p},O=function(E,L,v,p){var S=E,k=0;if(typeof v!="undefined")e.Utils.registerId(v);else return;for(S.indexOf("article_id_to_change")!=-1&&(S=S.replace("article_id_to_change",v)),S.indexOf("slidenumber_to_change")!=-1&&(S=S.replace("slidenumber_to_change",L));S.indexOf("div_id_to_change")!=-1;){if(p){var F=p[k];k++,e.Utils.registerId(F)}else var F=e.Utils.getId(v+"_zone");S=S.replace("div_id_to_change",F)}return S};return{init:w,getDummy:l,getScaffoldForSlide:T}})(SceneMaker),SceneMaker.Editor.Renderer=(function(e,n,w){var l,c=function(E){l=!1,m(E)},m=function(E){l=!0;for(var L=E.screens,v=0;v<L.length;v++)f(L[v]);l=!1},f=function(E){var L={};L.slideNumber=e.Screen.getScreensQuantity()+1,L.screenId=E.id.toString();var v=e.Editor.Dummies.getScaffoldForSlide(E,L);if(v){e.Editor.Screen.appendScreen(v),e.Screen.updateScreens(),e.Screen.goToLastScreen();var p=n(v).attr("id"),S=n("#"+p),k=E.views;if(k)for(var F=k.length,G=0;G<F;G++){var Z=k[G];T(Z,{screenDOM:S,slideNumber:G+1})}e.Editor.Marker.drawSlideWithMakers(E,S)}},T=function(E,L){E.type===e.Constant.VIEW_CONTENT?z(E,L):E.type===e.Constant.VIEW_IMAGE&&D(E,L)},A=function(E,L){var v=e.Editor.Dummies.getScaffoldForSlide(E,{slideNumber:L.slideNumber});e.Editor.View.appendView(L.screenDOM,v)},D=function(E,L){A(E,L);var v=n("#"+E.id);e.Editor.Marker.drawSlideWithMakers(E,v)},z=function(E,L){A(E,L);var v=n("#"+E.id);e.Utils.addTempShown(v);for(var p=E.elements.length,S=0;S<p;S++){var k=E.elements[S],F=k.id,G=n("div#"+F);if(G.length!==0){if(k.settings){var Z=JSON.stringify(k.settings);n(G).attr("elSettings",Z)}if(k.type===e.Constant.TEXT)e.Editor.Text.launchTextEditor({},G,k.body);else if(k.type===e.Constant.IMAGE)e.Editor.Image.drawImage(k.body,G,k.style,k.hyperlink,k.options);else if(k.type===e.Constant.VIDEO){var te=[];typeof k.poster=="string"&&(te.poster=k.poster),te.autoplay=k.autoplay,e.Editor.Video.HTML5.drawVideo(e.Video.HTML5.getSourcesFromJSON(k),te,G,k.style)}else if(k.type===e.Constant.AUDIO){var te=[];te.autoplay=k.autoplay,e.Editor.Audio.HTML5.drawAudio(e.Audio.HTML5.getSourcesFromJSON(k),te,G,k.style)}else k.type===e.Constant.OBJECT&&e.Editor.Object.drawObject(k.body,{area:G,style:k.style});var M=!0;e.Editor.isZoneEmpty(G)&&(M=!1,n(G).addClass("editable")),e.Editor.Tools.addTooltipToZone(G,M)}}e.Utils.removeTempShown(v)},O=function(){return l};return{init:c,isRendering:O}})(SceneMaker,jQuery),SceneMaker.Editor.Carousel=(function(e,n,w){var l=function(p,S){if(p){var k=1,F=5,G=null,Z="",te="",M=null,V=790,ie=!1,R=!0,Y=!1,N=null;S&&(S.rows&&(k=S.rows),S.rowItems&&(F=S.rowItems),S.scrollItems&&(G=S.scrollItems),S.styleClass&&(Z=S.styleClass),S.titleClass&&(te=S.titleClass),S.callback&&(M=S.callback),S.width&&(V=S.width),S.startAtLastElement&&(ie=S.startAtLastElement),typeof S.pagination=="boolean"&&(R=S.pagination),typeof S.sortable=="boolean"&&(Y=S.sortable),S.afterCreateCarruselFunction&&(N=S.afterCreateCarruselFunction));var Q=k>1,oe="";if(Z&&(oe="_"+Z),G||(G=F),Q)var b="multiple_row"+oe;else var b="single_row"+oe;var Le=n("#"+p);Le.attr("class","image_carousel image_carousel_"+b),Le.removeAttr("id");var ce=document.createElement("div");n(ce).html(n(Le).html()),n(Le).html(""),ce.setAttribute("id",p);var J=document.createElement("div");J.setAttribute("class","clearfix");var me=document.createElement("a"),h=document.createElement("a");if(me.setAttribute("class","prev"),h.setAttribute("class","next"),n(me).addClass("prev_"+b),n(h).addClass("next_"+b),me.setAttribute("href","#"),h.setAttribute("href","#"),me.setAttribute("id","carousel_prev"+p),h.setAttribute("id","carousel_next"+p),n(me).html("<span>prev</span>"),n(h).html("<span>next</span>"),n(Le).append(J),n(Le).append(me),n(Le).append(h),R){var Re=document.createElement("div");Re.setAttribute("class","pagination pagination_"+b),Re.setAttribute("id","carousel_pag"+p),n(Le).append(Re)}if(n(ce).children().addClass("carousel_element_"+b),n(ce).children().each(function(Xe,ot){n(ot).children().addClass("carousel_element_"+b)}),M&&typeof M=="function"&&n(ce).children().click(function(Xe){M(Xe)}),Q)c(p,Le,ce,k,F,G,b,V,N);else{if(n(Le).prepend(ce),ie)var Ue=n(ce).children().length-F+1;else var Ue=0;T(p,p,k,[],F,G,V,Ue,function(){R&&z(p),Y&&n("#"+p).sortable(),typeof N=="function"&&N()})}}},c=function(p,S,k,F,G,Z,te,M,V){var ie=[],R=0,Y;for(Y=0;Y<F;Y++)window[k.id+"_row"+Y]=document.createElement("div"),window[k.id+"_row"+Y].setAttribute("id",k.id+"_row"+Y),window[k.id+"_row"+Y].setAttribute("class","carousel_wrapper_"+te),Y!=0&&ie.push(k.id+"_row"+Y);for(n(k).children().each(function(Q,oe){n(window[k.id+"_row"+Q%F]).append(oe)}),Y=F-1;Y>=0;Y--)if(n(S).prepend(window[k.id+"_row"+Y]),Y==0){var N=k.id+"_row"+Y;T(N,p,F,ie,G,Z,M,null,function(){R++,m(R,F,V)})}else f(k.id+"_row"+Y,G,Z,M,function(){R++,m(R,F,V)})},m=function(p,S,k){p===S&&typeof k=="function"&&k()},f=function(p,S,k,F,G){n("#"+p).carouFredSel({auto:!1,circular:!1,infinite:!1,width:F,scroll:{items:k,fx:"scroll",duration:1e3,timeoutDuration:2e3},items:{visible:{min:S,max:S}},onCreate:G})},T=function(p,S,k,F,G,Z,te,M,V){if(M||(M=0),n("#"+p).carouFredSel({circular:!1,infinite:!1,auto:!1,width:te,scroll:{items:Z,duration:1e3,timeoutDuration:2e3},items:{visible:{min:G,max:G},start:M},prev:{button:"#carousel_prev"+S},next:{button:"#carousel_next"+S},pagination:"#carousel_pag"+S,onCreate:V}),F){var ie="";n(F).each(function(R,Y){R!=0&&(ie=ie+", "),ie=ie+"#"+Y}),n("#"+p).trigger("configuration",["synchronise",ie])}n("#"+p).attr("rows",k)},A=function(p){n("#"+p).html("");var S=p+"_row0";if(n("#"+S).attr("rows")){var k=n("#"+S).attr("rows"),F;for(F=0;F<k;F++)D(p+"_row"+F);n("#"+S).attr("id",p)}else D(p)},D=function(p){var S=n("#"+p).parent().parent();n(S).hasClass("image_carousel")&&(n(S).removeClass(),n(S).html(""),n(S).attr("id",p))},z=function(p){var S=n("#"+p).parent().parent();n(S).hasClass("image_carousel")&&n(S).find(".pagination").attr("style","")},O=function(p,S){n(S).is("IMG")&&(S=n(S).parent()),n("#"+p).trigger("slideTo",S)},E=function(p,S){n("#"+p).trigger("next",S)},L=function(p,S){n("#"+p).trigger("prev",S)},v=function(p,S,k){n("#"+p).trigger("insertItem",[S,k])};return{createCarousel:l,cleanCarousel:A,goToElement:O,advanceCarousel:E,backCarousel:L,insertElement:v}})(SceneMaker,jQuery),SceneMaker.Editor.Scrollbar=(function(e,n,w){var l=function(f,T){if(f){var A=null,D=!1;T&&(T.callback&&(A=T.callback),T.horizontalScroll&&(D=T.horizontalScroll));var z=n("#"+f);n(z).mCustomScrollbar({scrollInertia:0,autoDraggerLength:!0,horizontalScroll:D}),n(z).find(".mCSB_container").css("margin-right","5px"),setTimeout(function(){n(z).mCustomScrollbar("update"),setTimeout(function(){T&&T.scrollTop===!0||n(z).mCustomScrollbar("scrollTo","bottom"),typeof A=="function"&&A()},150)},100)}},c=function(f){var T=n("#"+f);n(T).html(""),n(T).removeClass()},m=function(f,T){var A=n(T).attr("id"),D=typeof A=="string";if(!D){var z=e.Utils.getId("tmp");n(T).attr("id",z),A=z}n("#"+f).mCustomScrollbar("scrollTo","#"+A),D||n(T).removeAttr("id",z)};return{createScrollbar:l,cleanScrollbar:c,goToElement:m}})(SceneMaker,jQuery),SceneMaker.Editor.Video=(function(e,n,w){var l=null,c=e.Constant.NONE,m="tab_video_from_url_content",f=function(){e.Editor.Video.HTML5.init();var L=n("#"+m).find("input");n("#tab_video_from_url_content .previewButton").click(function(v){e.Validator.validateObject(n(L).val())?(l=e.Editor.Utils.autocompleteUrls(n(L).val()),e.Editor.Object.drawPreview("tab_video_from_url_content",l)):l=null})},T=function(L){n("#tab_video_from_url_content").find("input").val(""),e.Editor.Object.resetPreview("tab_video_from_url_content")},A=function(L){L&&(l=L,D())},D=function(){switch(c){case e.Constant.EVIDEO:e.Editor.EVideo.onVideoSelected(l);break;default:e.Editor.Object.drawPreviewObject(l)}c=e.Constant.NONE},z=function(){return c},O=function(L){switch(e.Editor.Utils.hideNonDefaultTabs(),L){case e.Constant.NONE:break;case e.Constant.EVIDEO:n("#tab_audio_soundcloud").hide();break}c=L},E=function(){var L="tab_video_from_url";return e.Configuration.getConfiguration().Youtube&&(L="tab_video_youtube"),L};return{init:f,onLoadTab:T,addVideo:A,addContent:D,getAddContentMode:z,setAddContentMode:O,getDefaultTab:E}})(SceneMaker,jQuery),SceneMaker.Editor.Audio=(function(e,n,w){var l=function(){e.Editor.Audio.HTML5.init()};return{init:l}})(SceneMaker,jQuery),SceneMaker.Editor.Audio.HTML5=(function(e,n,w){var l=function(){},c=function(D){var z=e.Audio.HTML5.getSources(D);if(z.length>0){var O={};O.timestamp=!0,f(z,O)}},m=function(D){var z={};z.timestamp=!0,f([{src:D}],z)},f=function(D,z,O,E){var L;O?L=O:L=e.Editor.getCurrentArea(),L.attr("type","audio");var v=!1;z&&z.autoplay&&(v=z.autoplay);var p=document.createElement("audio");p.setAttribute("class","view_content_audio"),p.setAttribute("controls","controls"),p.setAttribute("preload","metadata"),p.setAttribute("autoplayonslideenter",v),E&&p.setAttribute("style",E),n(L).html(""),n(L).append(p),e.Audio.HTML5.addSourcesToAudioTag(D,p,{timestamp:!0}),e.Editor.addDeleteButton(n(L)),e.Editor.Tools.loadToolsForZone(L)},T=function(D,z){var O=e.Audio.HTML5.getSources(D);if(O.length>0){var z=z||{};return e.Audio.HTML5.renderAudioFromSources(O,z)}},A=function(D,z){return e.Audio.HTML5.renderAudioFromSources([{src:D}],z)};return{init:l,drawAudioWithWrapper:c,drawAudioWithUrl:m,drawAudio:f,renderAudioFromWrapper:T,renderAudioWithURL:A}})(SceneMaker,jQuery),SceneMaker.Editor.Video.HTML5=(function(e,n,w){var l=function(){},c=function(D){var z=e.Video.HTML5.getSources(D);if(z.length>0){var O={},E=e.Video.HTML5.getPoster(D);typeof E=="string"&&(O.poster=E),O.timestamp=!0,f(z,O)}},m=function(D){var z={};z.timestamp=!0,f([{src:D}],z)},f=function(D,z,O,E){var L;O?L=O:L=e.Editor.getCurrentArea(),L.attr("type","video");var v,p=!1;z&&(z.poster&&(v=z.poster),z.autoplay&&(p=z.autoplay));var S=document.createElement("video");S.setAttribute("class","view_content_video"),S.setAttribute("controls","controls"),S.setAttribute("preload","metadata"),typeof v=="string"&&S.setAttribute("poster",v),S.setAttribute("autoplayonslideenter",p),E&&S.setAttribute("style",E),n(L).html(""),n(L).append(S),e.Video.HTML5.addSourcesToVideoTag(D,S,{timestamp:!0}),e.Editor.addDeleteButton(n(L)),e.Editor.Tools.loadToolsForZone(L)},T=function(D,z){var O=e.Video.HTML5.getSources(D);if(O.length>0){var z=z||{},E=e.Video.HTML5.getPoster(D);return typeof E=="string"&&(z.poster=E),e.Video.HTML5.renderVideoFromSources(O,z)}},A=function(D,z){return e.Video.HTML5.renderVideoFromSources([{src:D}],z)};return{init:l,drawVideoWithUrl:m,drawVideo:f,drawVideoWithWrapper:c,renderVideoFromWrapper:T,renderVideoWithURL:A}})(SceneMaker,jQuery),SceneMaker.Editor.Video.Youtube=(function(e,n,w){var l=function(T){var A=e.Video.Youtube.getYoutubeIdFromURL(T);return A!=null?c(A):"Youtube Video ID can't be founded."},c=function(T){var A="https://www.youtube.com/embed/"+T;A=e.Utils.addParamToUrl(A,"wmode","opaque");var D=typeof e.Editor.getCurrentArea()!="undefined"&&e.Editor.getCurrentArea()!=null?e.Editor.getCurrentArea():e.Editor.getCurrentContainer(),z=e.Editor.Utils.dimentionsToDraw(n(D).width(),n(D).height(),325,243),O="<iframe src='"+A+"' frameborder='0' style='width:"+z.width+"px; height:"+z.height+"px;'></iframe>";return O},m=function(T){var A=e.Video.Youtube.getYoutubeIdFromURL(T);return A!=null?f(A):"<p class='objectPreview'>Youtube Video ID can't be founded.</p>"},f=function(T){var A="https://www.youtube.com/embed/"+T;A=e.Utils.addParamToUrl(A,"wmode","opaque");var D='<iframe class="objectPreview" src="'+A+'" frameborder="0"></iframe>';return D};return{generateWrapperForYoutubeVideoUrl:l,generatePreviewWrapperForYoutubeVideoUrl:m}})(SceneMaker,jQuery),SceneMaker.Editor.Image=(function(e,n,w){var l=null,c=e.Constant.NONE,m="tab_pic_from_url_content",f="picture_url",T=function(){n("#"+m+" .previewButton").click(function(v){e.Validator.validateObject(n("#"+f).val())&&(l=e.Editor.Utils.autocompleteUrls(n("#"+f).val()),e.Editor.Object.drawPreview(m,l,{contentAddMode:c}))})},A=function(v){v=="url"&&D()},D=function(){if(c===e.Constant.SCREEN){var v=n(e.Slides.getCurrentSlide()),p=e.Slides.getSlideBackground(v);if(typeof p=="string"){n("#"+f).val(p),n("#"+m+" .previewButton").trigger("click"),n("#"+m+" .previewimgbox button").hide();return}}l=null,e.Editor.Object.resetPreview(m),n("#"+f).val("")},z=function(){switch(c){case e.Constant.SCREEN:e.Editor.Slides.setSlideBackground(e.Slides.getCurrentSlide(),l);break;default:e.Editor.Object.drawPreviewObject(l,{forceType:e.Constant.MEDIA.IMAGE})}c=e.Constant.NONE},O=function(v,p,S,k,F){var G,Z=!1;if(p?(G=p,Z=!0):G=e.Editor.getCurrentArea(),!(typeof G=="undefined"||G===null)){var te;if(S)te=e.Editor.Utils.setStyleInPixels(S,G);else{var M=n(G).width();te="width:"+M+"px;"}var V=e.Utils.getId(),ie="draggable"+V;if(G.attr("type","image"),k&&G.attr("hyperlink",k),G.html("<img class='view_content_image' id='"+ie+"' draggable='true' title='Click to drag' src='"+v+"' style='"+te+"'/>"),!S){var R=n("#"+ie);n(R).load(function(){e.Utils.addTempShown([n(G).parent(),n(G),n(R)]);var Y=e.Editor.Utils.dimentionsToDraw(n(G).width(),n(G).height(),n(R).width(),n(R).height());e.Utils.removeTempShown([n(G).parent(),n(G),n(R)]),n(R).width(Y.width),Y.height>0&&n(R).height(Y.height)})}e.Editor.addDeleteButton(G),n("#"+ie).draggable({cursor:"move",stop:function(){n(this).parent().click()}}),Z===!1&&e.Editor.Slides.updateThumbnail(e.Slides.getCurrentSlide())}},E=function(){return c},L=function(v){e.Editor.Utils.hideNonDefaultTabs(),c=v};return{init:T,onLoadTab:A,drawImage:O,addContent:z,getAddContentMode:E,setAddContentMode:L}})(SceneMaker,jQuery),SceneMaker.Editor.Object=(function(e,n,w){var l=null,c="tab_object_from_url_content",m="object_web_input",f,T=function(){e.Editor.Object.Web.init(),e.Editor.Object.GoogleDOC.init(),e.Editor.Object.PDF.init(),n("#"+c+" .previewButton").click(function(V){e.Validator.validateObject(n("#"+m).val())&&(l=e.Editor.Utils.autocompleteUrls(n("#"+m).val()),D(c,l))}),f=n('<a href="#objectSettings_fancybox" style="display:none"></a>'),n(f).fancybox({autoDimensions:!1,height:400,width:400,scrolling:"no",showCloseButton:!1,padding:0,onStart:function(V){te()},onComplete:function(V){},onClosed:function(V){}})},A=function(){l=null,O(c),n("#"+m).val("")},D=function(V,ie,R){n("#"+V+" .previewimgbox").css("background-image","none"),n("#"+V+" .previewimgbox img.imagePreview").remove(),n("#"+V+" .previewimgbox .objectPreview").remove();var Y=n(p(ie));n("#"+V+" .previewimgbox").append(Y),z(ie,Y),n("#"+V+" .previewimgbox button").show()},z=function(V,ie){var R=e.Object.getObjectInfo(V);if(R.wrapper===e.Constant.WRAPPER.VIDEO||R.wrapper===null&&R.type===e.Constant.MEDIA.HTML5_VIDEO){var Y=typeof R.source=="object"?R.source:[{src:R.source}];e.Video.HTML5.addSourcesToVideoTag(Y,ie,{timestamp:!0})}else if(R.wrapper===e.Constant.WRAPPER.AUDIO||R.wrapper===null&&R.type===e.Constant.MEDIA.HTML5_AUDIO){var Y=typeof R.source=="object"?R.source:[{src:R.source}];e.Audio.HTML5.addSourcesToAudioTag(Y,ie,{timestamp:!0})}},O=function(V){n("#"+V+" .previewimgbox button").hide(),n("#"+V+" .previewimgbox img.imagePreview").remove(),n("#"+V+" .previewimgbox .objectPreview").remove(),n("#"+V+" .previewimgbox").css("background-image","")},E=function(){L(l)},L=function(V,ie){V&&(k(V,ie),n.fancybox.close())},v=function(V,b){var R=n("#"+V).parent(),Y=n("#"+V).width()/n("#"+V).height(),N=Math.round(b/Y),Q=Math.round(b);n(R).width(Q),n(R).height(N);var oe=N,b=Q;n("#"+V).width(b),n("#"+V).height(oe)},p=function(V,ie){var R=e.Object.getObjectInfo(V),Y=R.type;if(ie&&typeof ie.forceType=="string"&&(Y=ie.forceType),Y===e.Constant.MEDIA.REUSABLE_PUZZLE_INSTANCE)return e.Editor.Object.Web.generatePreviewWrapperForReusablePuzzleInstance(R.source);switch(R.wrapper){case null:switch(Y){case e.Constant.MEDIA.IMAGE:return"<img class='imagePreview' src='"+V+"'></img>";case e.Constant.MEDIA.PDF:return e.Editor.Object.PDF.generatePreviewWrapper(V);case e.Constant.MEDIA.DOC:case e.Constant.MEDIA.PPT:return e.Editor.Object.GoogleDOC.generatePreviewWrapper(V);case e.Constant.MEDIA.YOUTUBE_VIDEO:return e.Editor.Video.Youtube.generatePreviewWrapperForYoutubeVideoUrl(V);case e.Constant.MEDIA.HTML5_VIDEO:return e.Editor.Video.HTML5.renderVideoWithURL(V,{loadSources:!1,extraClasses:["objectPreview"]});case e.Constant.MEDIA.HTML5_AUDIO:return e.Editor.Audio.HTML5.renderAudioWithURL(V,{loadSources:!1,extraClasses:["objectPreview"]});case e.Constant.MEDIA.WEB:return e.Editor.Object.Web.generatePreviewWrapperForWeb(V);default:e.Debugging.log("Unrecognized object source type")}break;case e.Constant.WRAPPER.EMBED:return S(V);case e.Constant.WRAPPER.OBJECT:return S(V);case e.Constant.WRAPPER.IFRAME:return S(V);case e.Constant.WRAPPER.VIDEO:return e.Editor.Video.HTML5.renderVideoFromWrapper(V,{loadSources:!1,extraClasses:["objectPreview"]});case e.Constant.WRAPPER.AUDIO:return e.Editor.Audio.HTML5.renderAudioFromWrapper(V,{loadSources:!1,extraClasses:["objectPreview"]});default:e.Debugging.log("Unrecognized object wrapper: "+R.wrapper);break}},S=function(V){var ie=n(V);return n(ie).addClass("objectPreview"),n(ie).attr("wmode","opaque"),n(ie).removeAttr("width"),n(ie).removeAttr("height"),typeof n(ie).attr("src")!="undefined"&&n(ie).attr("src",e.Utils.checkWebUrl(n(ie).attr("src"))),typeof n(ie).attr("scrolling")!="undefined"&&n(ie).attr("scrolling","auto"),ie},k=function(V,ie){if(e.Validator.validateObject(V)){ie=typeof ie=="undefined"?{}:ie;var R=e.Object.getObjectInfo(V),Y=e.Editor.getCurrentArea(),N="";if(ie&&(ie.area&&(Y=ie.area),ie.style&&(N=ie.style),ie.forceType&&(R.type=ie.forceType)),R.type===e.Constant.MEDIA.REUSABLE_PUZZLE_INSTANCE&&ie.wrapperGenerated!==!0)return ie.wrapperGenerated=!0,k(e.Editor.Object.Web.generateWrapperForReusablePuzzleInstance(R.source),ie);switch(R.wrapper){case null:switch(R.type){case e.Constant.MEDIA.IMAGE:e.Editor.Image.drawImage(V);break;case e.Constant.MEDIA.PDF:return ie.wrapperGenerated=!0,k(e.Editor.Object.PDF.generateWrapper(R.source),ie);case e.Constant.MEDIA.DOC:case e.Constant.MEDIA.PPT:return k(e.Editor.Object.GoogleDOC.generateWrapper(V),ie);case e.Constant.MEDIA.YOUTUBE_VIDEO:return k(e.Editor.Video.Youtube.generateWrapperForYoutubeVideoUrl(V),ie);case e.Constant.MEDIA.HTML5_VIDEO:e.Editor.Video.HTML5.drawVideoWithUrl(V);break;case e.Constant.MEDIA.HTML5_AUDIO:e.Editor.Audio.HTML5.drawAudioWithUrl(V);break;case e.Constant.MEDIA.WEB:return k(e.Editor.Object.Web.generateWrapperForWeb(V),ie);default:e.Debugging.log("Unrecognized object source type: "+R.type);break}break;case e.Constant.WRAPPER.EMBED:case e.Constant.WRAPPER.OBJECT:case e.Constant.WRAPPER.IFRAME:if([e.Constant.MEDIA.PDF].indexOf(R.type)!=-1&&!ie.wrapperGenerated)return k(R.source,ie);F(V,Y,N);break;case e.Constant.WRAPPER.VIDEO:e.Editor.Video.HTML5.drawVideoWithWrapper(V);break;case e.Constant.WRAPPER.AUDIO:e.Editor.Audio.HTML5.drawAudioWithWrapper(V);break;default:e.Debugging.log("Unrecognized object wrapper: "+R.wrapper);break}e.Editor.Tools.loadToolsForZone(Y)}},F=function(V,ie,R){ie.attr("type","object");var Y=document.createElement("div");R&&Y.setAttribute("style",R),n(Y).addClass("object_wrapper");var N=n(V);n(N).css("pointer-events","none"),n(N).attr("class","view_content_object"),n(N).attr("wmode","opaque"),typeof n(N).attr("scrolling")!="undefined"&&n(N).attr("scrolling","auto"),n(ie).html(""),n(ie).append(Y),e.Editor.addDeleteButton(n(ie)),n(Y).append(N),G(N,ie),e.Editor.Tools.loadToolbarForObject(V)},G=function(V,ie){var R=ie.width(),Y=ie.height(),N=V.width(),Q=V.height(),oe=Q/N;N>R&&(V.width(R),V.height(N*oe),N=R,Q=V.height()),Q>Y&&(V.height(Y),V.width(Q/oe),N=V.width(),Q=Y);var b=V.parent();n(b).hasClass("object_wrapper")&&(n(b).height(V.height()),n(b).width(V.width()))},Z=function(){n(f).trigger("click")},te=function(){var V=n("#objectSettings_fancybox"),ie=n(e.Editor.getCurrentArea()),R=ie.find("div.object_wrapper").children().first(),Y=R.attr("reusablepuzzleinstance")==="true";V.find("input[type='hidden'][name='elId']").val(ie.attr("id"));var N={},Q=Y===!1,oe=Y;try{N=JSON.parse(ie.attr("elSettings"))}catch(ce){}typeof N.unloadObject!="undefined"&&(Q=N.unloadObject),typeof N.addPreviewParamToObject!="undefined"&&(oe=N.addPreviewParamToObject);var b=V.find("input[type='checkbox'][name='unloadObject']");b.prop("checked",Q);var Le=V.find("input[type='checkbox'][name='addPreviewParamToObject']");Le.prop("checked",oe),Le.attr("defaultvalue",Y),e.Editor.Utils.enableElementSettingsField(b,!0),e.Editor.Utils.enableElementSettingsField(Le,Y===!1)},M=function(){var V=n("#objectSettings_fancybox"),ie=V.find("input[type='hidden'][name='elId']").val(),R=n("#"+ie),Y=R.find("div.object_wrapper").children().first(),N={};try{N=JSON.parse(n(area).attr("elsettings"))}catch(b){}N.unloadObject=V.find("input[type='checkbox'][name='unloadObject']").is(":checked"),N.addPreviewParamToObject=V.find("input[type='checkbox'][name='addPreviewParamToObject']").is(":checked");var Q=JSON.stringify(N);R.attr("elSettings",Q);var oe=Y.attr("src");N.addPreviewParamToObject?oe=e.Utils.addParamToUrl(oe,"escapp_preview",""+e.Status.isPreview()):oe=e.Utils.removeParamFromUrl(oe,"escapp_preview"),Y.attr("src",oe),n.fancybox.close()};return{init:T,onLoadTab:A,drawObject:k,renderObjectPreview:p,resizeObject:v,drawPreview:D,resetPreview:O,drawPreviewElement:E,drawPreviewObject:L,showObjectSettings:Z,onObjectSettingsDone:M}})(SceneMaker,jQuery),SceneMaker.Editor.Object.Web=(function(e,n,w){var l=function(){},c=function(A){return A=e.Utils.checkWebUrl(A),"<iframe src='"+A+"' wmode='opaque'></iframe>"},m=function(A){return A=e.Utils.checkReusablePuzzleInstanceUrl(A),"<iframe src='"+A+"' reusablepuzzleinstance='true' wmode='opaque'></iframe>"},f=function(A){return A=e.Utils.checkWebUrl(A),"<iframe class='objectPreview' src='"+A+"' wmode='opaque'></iframe>"},T=function(A){return A=e.Utils.checkReusablePuzzleInstanceUrl(A),f(A)};return{init:l,generatePreviewWrapperForWeb:f,generateWrapperForReusablePuzzleInstance:m,generateWrapperForWeb:c,generatePreviewWrapperForReusablePuzzleInstance:T}})(SceneMaker,jQuery),SceneMaker.Editor.Object.PDF=(function(e,n,w){var l=function(){},c=function(f){return e.Object.PDF.generateWrapper(f)},m=function(f){var T=e.Object.PDF.generateWrapper(f),A=n(T);return n(A).addClass("objectPreview"),e.Utils.getOuterHTML(A)};return{init:l,generateWrapper:c,generatePreviewWrapper:m}})(SceneMaker,jQuery),SceneMaker.Editor.Object.GoogleDOC=(function(e,n,w){var l=function(){},c=function(f){return e.Object.GoogleDOC.generateWrapper(f)},m=function(f){var T=e.Object.GoogleDOC.generateWrapper(f),A=n(T);return n(A).addClass("objectPreview"),e.Utils.getOuterHTML(A)};return{init:l,generatePreviewWrapper:m,generateWrapper:c}})(SceneMaker,jQuery),SceneMaker.Editor.Text=(function(e,n,w){var l=!1,c={},m=function(){l||(n(document).on("click",".textthumb",f),CKEDITOR.on("dialogDefinition",function(v){var p=v.data.name,S=v.data.definition;switch(p){case"link":S.getContents("info").remove("linkType");var k=S.getContents("info").get("protocol").items;k.splice(3,1),k.splice(2,1),S.removeContents("advanced");var F=S.getContents("target"),M=F.get("linkTargetType");M.default="_blank",M.items.splice(6,1),M.items.splice(4,1),M.items.splice(1,1),M.items.splice(0,1);break;case"table":S.removeContents("advanced");var G=S.getContents("info"),Z=G.get("cmbAlign");Z.items.splice(0,1),Z.default="center",G.remove("selHeaders");break;case"image":S.removeContents("advanced");var te=S.getContents("Link"),M=te.get("cmbTarget");M.default="_blank",M.items.splice(4,1),M.items.splice(2,1),M.items.splice(0,1);break;case"MediaEmbedDialog":break}}),l=!0)},f=function(v,p,S,k){m();var F;p?F=p:F=n(this).parents(".selectable"),F.attr("type","text");var G=n("article").has(F),Z=n("article > article").has(F);typeof n(F).attr("id")=="undefined"&&n(F).attr("id",e.Utils.getId("TmpShownId"));var te=k&&k.disableTmpShown;te||e.Utils.addTempShown(F);var M=n(F).height(),V=n(F).width();te||e.Utils.removeTempShown(F);var ie=e.Utils.getId(),R=n("<div id='"+ie+"' class='wysiwygTextArea'></div>");n(R).attr("style","width: 100%; height: 100%"),n(F).append(R);var Y={};Y.toolbar="Full",Y.toolbar_Full=[{name:"first",items:["Bold","Italic","Underline","-","Subscript","Superscript","Font","FontSize","TextColor","BGColor"]},"/",{name:"lists",items:["NumberedList","BulletedList","Table"]},{name:"alignment",items:["JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"link",items:["Link"]},{name:"Objects",items:["Image","MediaEmbed"]},{name:"symbols",items:["SpecialChar"]}],Y.sharedSpaces={top:"toolbar_text"},Y.toolbarCanCollapse=!1,Y.resize_enabled=!1,Y.removePlugins="elementspath",Y.extraPlugins="tableresize,autogrow,specialchar,mediaembed",k&&k.autogrow&&(Y.autoGrow_minHeight=34,Y.autoGrow_maxHeight=800),Y.specialChars=[],Y.specialChars=Y.specialChars.concat([["&alpha;","Alpha"]],[["&beta;","Beta"]],[["&gamma;","Gamma"]],[["&delta;","Delta"]],[["&epsilon;","Epsilon"]],[["&zeta;","Zeta"]],[["&eta;","Eta"]],[["&theta;","Theta"]],[["&iota;","Iota"]],[["&kappa;","Kappa"]],[["&lambda;","Lambda"]],[["&mu;","Mu"]],[["&nu;","Nu"]],[["&xi;","Xi"]],[["&omicron;","Omicron"]],[["&pi;","Pi"]],[["&rho;","Rho"]],[["&sigma;","Sigma"]],[["&tau;","Tau"]],[["&upsilon;","Upsilon"]],[["&phi;","Phi"]],[["&chi;","Chi"]],[["&psi;","Psi"]],[["&omega;","Omega"]],[["&divide;",""]],[["&radic;",""]],[["&bull;",""]],[["&middot;",""]],[["&plusmn;",""]],[["&frac14;",""]],[["&frac12;",""]],[["&frac34;",""]],[["&permil;",""]],[["&weierp;",""]],[["&image;",""]],[["&real;",""]],[["&forall;",""]],[["&part;",""]],[["&exist;",""]],[["&empty;",""]],[["&nabla;",""]],[["&isin;",""]],[["&notin;",""]],[["&ni;",""]],[["&prod;",""]],[["&sum;",""]],[["&minus;",""]],[["&lowast;",""]],[["&prop;",""]],[["&infin;",""]],[["&ang;",""]],[["&and;",""]],[["&or;",""]],[["&cap;",""]],[["&cup;",""]],[["&int;",""]],[["&cong;",""]],[["&asymp;",""]],[["&ne;",""]],[["&equiv;",""]],[["&le;",""]],[["&ge;",""]],[["&sub;",""]],[["&sup;",""]],[["&nsub;",""]],[["&sube;",""]],[["&supe;",""]],[["&oplus;",""]],[["&otimes;",""]],[["&perp;",""]],[["&lang;",""]],[["&rang;",""]],[["&lceil;",""]],[["&rceil;",""]],[["&lfloor;",""]],[["&rfloor;",""]],[["&fnof;",""]],[["&lsquo;",""]],[["&rsquo;",""]],[["&ldquo;",""]],[["&rdquo;",""]],[["&larr;",""]],[["&uarr;",""]],[["&darr;",""]],[["&rarr;",""]],[["&harr;",""]],[["&crarr;",""]],[["&lArr;",""]],[["&uArr;",""]],[["&dArr;",""]],[["&rArr;",""]],[["&hArr;",""]],[["&euro;","Euro"]],[["&cent;","Cent"]],[["&pound;","Pound"]],[["&yen;",""]],[["&curren;",""]],[["&brvbar;",""]],[["&sect;",""]],[["&copy;",""]],[["&reg;",""]],[["&ordf;",""]],[["&ordm;",""]],[["&deg;",""]],[["&laquo;",""]],[["&raquo;",""]],[["&not;",""]],[["&para;",""]],[["&loz;",""]],[["&spades;",""]],[["&clubs;",""]],[["&hearts;",""]],[["&diams;",""]],[["&dagger;",""]]),Y.width="100%",Y.height=M,Y.fontSize_defaultLabel="12";var N=CKEDITOR.basePath.substr(0,CKEDITOR.basePath.indexOf("editor/"));Y.skin="sceneMaker,"+N+"editor/skins/sceneMaker/";var Q=typeof S!="string"||k&&k.forceNew;if(Q){var oe=36,b="center",Le="color:#000",ce=Le;k&&(typeof k.fontSize=="number"&&(oe=k.fontSize),k.placeholder===!0&&(Le="color:#ccc")),S="<p style='text-align:"+b+";'><span autoColor='true' style='"+Le+"'><span style='font-size:"+oe+"px;'>&shy</span></span></p>",initial_text_blank="<p style='text-align:"+b+";'><span autoColor='true' style='"+ce+"'><span style='font-size:"+oe+"px;'>&shy</span></span></p>"}var J=CKEDITOR.appendTo(ie,Y),me=V,h=M;Q||(te||e.Utils.addTempShown([G,Z,F]),setTimeout(function(){c[J.name]!==!0?(c[J.name]=!1,te||e.Utils.removeTempShown([G,Z,F])):c[J.name]=w},6e3)),J.on("instanceReady",function(){S&&J.setData(S,function(){L(J),Q&&J.focus(),k&&typeof k.callback=="function"&&k.callback()}),Q||(typeof c[J.name]=="undefined"?(c[J.name]=!0,te||e.Utils.removeTempShown([G,Z,F])):c[J.name]=w),k&&typeof k.onKeyup=="function"&&k.placeholder!=!0&&J.document.on("keyup",function(Re){k.onKeyup(F,J,Re)}),!S&&k&&typeof k.callback=="function"&&k.callback()}),J.on("resize",function(Re){}),J.on("focus",function(Re){if(k&&k.placeholder===!0){var Ue=n(S).text().replace(/\s+/g,""),Xe=n(Re.editor.getData()).text().replace(/\s+/g,"");Ue==Xe&&setTimeout(function(){Re.editor.setData(initial_text_blank,function(){k&&typeof k.onKeyup=="function"&&J.document.on("keyup",function(Tt){k.onKeyup(F,J,Tt)})}),Re.editor.focus()},20)}var ot=A(Re.editor.container.$);e.Editor.selectContentZone(ot)}),J.getPlainText=E,e.Editor.addDeleteButton(F)},T=function(v){if(!v||typeof CKEDITOR=="undefined"||typeof CKEDITOR.instances=="undefined")return null;var p=null;return jQuery.each(CKEDITOR.instances,function(S,k){var F=A(k.container.$);if(n(F).attr("id")===n(v).attr("id")){p=k;return}}),p},A=function(v){return n("div[type='text']").has(v)},D=function(v){var p=T(v);return p?z(p):null},z=function(v){var p=n(document.getElementById("cke_contents_"+v.name)).find("iframe")[0];return n(p).contents()[0]},O=function(v){if(!v||typeof CKEDITOR=="undefined"||typeof CKEDITOR.instances=="undefined")return null;n(v).hasClass(".cke_skin_sceneMaker")||(v=n(v).find(".cke_skin_sceneMaker"),v.length>0&&(v=v[0]));var p=null;return jQuery.each(CKEDITOR.instances,function(S,k){if(v===k.container.$){p=k;return}}),p},E=function(){var v="",p=0;return n(this.getSnapshot()).each(function(S,k){k.tagName!="SCRIPT"&&(p!=0&&(v=v+`
`),v=v+n(k).text(),p+=1)}),v},L=function(v){if(CKEDITOR.env.webkit){var p=n(document.getElementById("cke_contents_"+v.name)).find("iframe")[0];p.style.display="none",p.style.display="block"}};return{init:m,launchTextEditor:f,getCKEditorFromZone:T,getCKEditorIframeContentFromZone:D,getCKEditorFromTextArea:O}})(SceneMaker,jQuery),SceneMaker.Editor.Thumbnails=(function(e,n,w){var l="screens_list",c="views_list",m,f,T=w,A=w,D=function(){},z=function(b){m=b,e.Editor.Scrollbar.cleanScrollbar(l),n("#"+l).hide();var Le=[],ce=[],J=0;n(".slides > article").each(function(h,Re){var Ue=Z(Re),Xe=V(Re);Ue&&(J+=1,Le.push(n("<img id='screenThumbnail"+J+"' class='image_slidethumbnail' slideNumber='"+J+"' action='goToScreenWithNumber' src='"+Ue+"' defaultsrc='"+Xe+"'/>")),ce.push(J))});var me={};me.titleArray=ce,me.callback=E,me.onImageErrorCallback=O,e.Editor.Utils.Loader.loadImagesOnContainer(Le,l,me)},O=function(b){var Le=e.Screen.getScreenWithNumber(n(b).attr("slidenumber")),ce=V(Le),J=e.Editor.Thumbnails.getThumbnailForSlide(Le);n(J).attr("src",ce),e.Screen.getCurrentScreen()===Le&&n("#screen_selected > img").attr("src",thumbnailURL)},E=function(){n("#"+l).find("img.image_slidethumbnail").each(function(Le,ce){var J=n(ce).parent();n(J).addClass("wrapper_slidethumbnail"),n(J).addClass("preventNoselectable"),n(J).append("<div class='delete_slide delete_screen'></div>");var me=n(J).find("p");n(me).addClass("ptext_barbutton"),n(ce).click(function(h){v(h)})}),n(".barbutton").css("background-color","transparent");var b=new Array;b.callback=L,n("#"+l).show(),e.Editor.Scrollbar.createScrollbar(l,b)},L=function(){n("#"+l).sortable({items:'div.wrapper_slidethumbnail:has(img[action="goToScreenWithNumber"])',change:function(b,Le){},start:function(b,Le){},stop:function(b,Le){var ce=Le.item,J=n(Le.item).find("img.image_slidethumbnail[slidenumber]");if(!isNaN(n(J).attr("slidenumber"))){var me=parseInt(n(J).attr("slidenumber")),h;n("#screens_list").find("img.image_slidethumbnail[slidenumber]").each(function(Re,Ue){var Xe=parseInt(n(Ue).attr("slidenumber")),ot=Re+1;Xe===me&&Xe!=ot&&(h=ot)}),e.Editor.Screen.moveScreenTo(me,h)}}}),typeof m=="function"&&(m(),m=w)},v=function(b){switch(n(b.target).attr("action")){case"goToScreenWithNumber":e.Screen.goToScreenWithNumber(n(b.target).attr("slideNumber"));break;default:return}},p=function(b){n("#screens_list img.image_slidethumbnail").removeClass("selectedScreenThumbnail"),n("#screens_list img.image_slidethumbnail[slideNumber="+b+"]").addClass("selectedScreenThumbnail"),n("#screens_list div.wrapper_slidethumbnail").removeClass("selectedThumbnailBackground"),n("#screens_list img.image_slidethumbnail[slideNumber="+b+"]").parent("div.wrapper_slidethumbnail").addClass("selectedThumbnailBackground");var Le=T===w||b>T;T=b;var ce=e.Screen.getScreenWithNumber(b);oe(ce)||S(Le?Math.max(b-5,1):b)},S=function(b){var Le=n("img.image_slidethumbnail[slideNumber="+b+"]");e.Editor.Scrollbar.goToElement(l,Le)},k=function(b){var Le=n("#views_list img.image_slidethumbnail[slideNumber="+b+"]").parent();e.Editor.Scrollbar.goToElement(c,Le)},F=function(b){if(e.Slides.isView(b))return G(b);var Le=n(b).attr("slidenumber");return n("#screens_list img.image_slidethumbnail[slideNumber="+Le+"]")},G=function(b){var Le=n(b).attr("slidenumber");return n("#views_list img.image_slidethumbnail[slideNumber="+Le+"]")},Z=function(b){return n(b).attr("type")===e.Constant.VIEW_CONTENT?te(b):M(b)},te=function(b){var Le=n(b).children("div.view_content_zone");if(Le.length===1&&!e.Editor.isZoneEmpty(Le)&&Le.attr("type")=="image"){var ce=Le.find("img");if(n(ce).length===1&&typeof n(ce).attr("src")=="string")return n(ce).attr("src")}return V(b)},M=function(b){var Le=e.Slides.getSlideBackground(b);return typeof Le!="undefined"?Le:V(b)},V=function(b){return n(b).attr("type")===e.Constant.VIEW_CONTENT?e.ImagesPath+"slidesthumbs/view_content_template.png":e.ImagesPath+"slidesthumbs/screen_template.png"},ie=function(b,Le){f=Le,e.Editor.Scrollbar.cleanScrollbar(c),n("#"+c).hide();var ce=[],J=0;n(b).each(function(h,Re){if(!e.Slides.isView(Re))return e.Debugging.log("Invalid view type"),!0;var Ue=Z(Re),Xe=V(Re);J+=1,ce.push(n("<img id='viewThumbnail"+J+"' class='image_slidethumbnail' slideNumber='"+J+"' src='"+Ue+"' defaultsrc='"+Xe+"'/>"))});var me={};me.callback=R,e.Editor.Utils.Loader.loadImagesOnContainer(ce,c,me)},R=function(){n("#"+c).find("img.image_slidethumbnail").each(function(Le,ce){var J=n(ce).parent();n(J).addClass("wrapper_slidethumbnail"),n(J).append("<div class='delete_slide delete_view'></div>"),n(J).find("p").addClass("ptext_barbutton"),n(ce).click(function(me){N(me)})});var b=new Array;b.horizontalScroll=!0,b.callback=Y,n("#"+c).show(),e.Editor.Scrollbar.createScrollbar(c,b)},Y=function(){typeof f=="function"&&(f(),f=w)},N=function(b){var Le=n(b.target).attr("slideNumber");e.Editor.View.openViewWithNumber(Le)},Q=function(b){if(n("#views_list img.image_slidethumbnail").removeClass("selectedViewThumbnail"),b!==null){n("#views_list img.image_slidethumbnail[slideNumber="+b+"]").addClass("selectedViewThumbnail");var Le=A===w||b>A;A=b;var ce=e.View.getViewWithNumber(e.Screen.getCurrentScreen(),b);oe(ce)||k(Le?Math.max(b-7,1):b)}},oe=function(b){var Le=F(b),ce=n(Le).offset();if(typeof ce=="undefined"||ce===null)return!0;if(e.Slides.isView(b)){var J=ce.left;return J>466&&J<1119}else{var me=ce.top;return me>132&&me<667}};return{init:D,drawScreenThumbnails:z,drawViewThumbnails:ie,selectThumbnail:p,selectViewThumbnail:Q,moveThumbnailsToScreenWithNumber:S,moveThumbnailsToViewWithNumber:k,getThumbnailURLForSlide:Z,getDefaultThumbnailURLForSlide:V,getThumbnailForSlide:F,isThumbnailVisible:oe}})(SceneMaker,jQuery),SceneMaker.Editor.Settings=(function(e,n,w){var l,c=function(){},m=function(v){typeof v!="undefined"?(l=JSON.parse(JSON.stringify(v)),delete l.screens):l={},l.SMVersion=e.VERSION,(typeof l.aspectRatio!="string"||["4:3","16:9"].indexOf(l.aspectRatio)===-1)&&(l.aspectRatio="4:3"),e.ViewerAdapter.applyAspectRatio(l.aspectRatio)},f=function(){var v=JSON.parse(JSON.stringify(l));return(typeof v.title!="string"||v.title.trim()==="")&&(v.title=e.I18n.getTrans("i.Untitled")),v.avatar=T(),v},T=function(){for(var v=n("section.slides > article"),p=0;p<v.length;p++){var S=v[p];if(e.Slides.isScreen(S)){var k=e.Slides.getSlideBackground(S);if(typeof k!="undefined")return k}}return e.ImagesPath+"logos/scene_maker_escapp_thumbnail.png"},A=function(){n("a#edit_scene_details").fancybox({autoDimensions:!1,autoScale:!0,scrolling:"no",width:1e3,height:700,padding:0,hideOnOverlayClick:!1,hideOnContentClick:!1,showCloseButton:!0,onStart:function(){D()},onComplete:function(v){}}),n("a#edit_scene_details").trigger("click")},D=function(){typeof l.title=="string"?n("#scene_details_input_title").val(l.title):n("#scene_details_input_title").val("");var v=e.ViewerAdapter.getAspectRatio();typeof v!="undefined"&&n("#scene_details_select_aspectRatio").val(v),e.Editor.Actions.loadActions(n("#sceneActions"),l,"SCENE"),z()},z=function(){var v=O();v?(n("#save_scene_details").removeClass("buttonDisabledOnSettings"),n("#save_scene_details").removeAttr("disabled"),n("#save_scene_details").removeAttr("title")):(n("#save_scene_details").addClass("buttonDisabledOnSettings"),n("#save_scene_details").attr("disabled","true"))},O=function(){return!0},E=function(v){v.preventDefault(),!n(v.target).hasClass("buttonDisabledOnSettings")&&(l=L(),e.ViewerAdapter.applyAspectRatio(l.aspectRatio),n.fancybox.close())},L=function(){var v={};v.SMVersion=e.VERSION;var p=n("#scene_details_input_title").val();typeof p=="string"&&(v.title=p);var S=n("#scene_details_select_aspectRatio").val();typeof S=="string"&&["4:3","16:9"].indexOf(S)!==-1?v.aspectRatio=S:v.aspectRatio="4:3";var k=e.Editor.Actions.getActionsJSON(n("#sceneActions"));return k.length>0&&(v.actions=k),v};return{init:c,loadSceneSettings:m,getSettings:f,displaySettings:A,onSaveSceneSettingsButtonClicked:E}})(SceneMaker,jQuery),SceneMaker.Editor.Tools=(function(e,n,w){var l=!1,c=1.05,m=function(){f(),l||(n.each(n("#toolbar_wrapper a.tool_action, div.tool_action"),function(ze,et){n(et).on("click",function(Pe){return typeof e.Editor.Tools[n(et).attr("action")]=="function"&&(n(et).find(".toolbar_scene_wrapper").hasClass("toolbar_scene_wrapper_disabled")||e.Editor.Tools[n(et).attr("action")](this)),!1})}),l=!0),e.Editor.Tools.Menu.init()},f=function(){var ze=e.Screen.getCurrentScreen();typeof ze!="undefined"&&D(ze)},T=function(){n("#toolbar_wrapper").show()},A=function(){n("#toolbar_wrapper").hide()},D=function(ze){z();var et=n(ze).attr("type");switch(n(".toolbar_scene_wrapper_slideTools:not(.toolbar_"+et+")").hide(),n("#toolbar_slide .toolbar_btn.tool_action:not(.toolbar_"+et+")").hide(),et){case e.Constant.VIEW_CONTENT:n("#toolbar_slide").removeClass("toolbar_slide_screen").addClass("toolbar_slide_view_content");break;case e.Constant.VIEW_IMAGE:case e.Constant.SCREEN:n("#toolbar_slide").removeClass("toolbar_slide_view_content").addClass("toolbar_slide_screen"),n("div.tool_action[action='changeBackground']").show(),typeof e.Slides.getSlideBackground(ze)!="undefined"?(n("div.tool_action[action='addHotspot']").show(),n("div.tool_action[action='addHotzone']").show(),n("div.tool_action[action='addCaption']").show()):(n("div.tool_action[action='addHotspot']").hide(),n("div.tool_action[action='addHotzone']").hide(),n("div.tool_action[action='addCaption']").hide());break;default:return}},z=function(){n(".toolbar_scene_wrapper_slideTools").removeClass("toolbar_scene_wrapper_disabled"),n(".menuselect_hide").hide(),n(".delete_content").hide(),oe()},O,E="enabled",L=function(ze){switch(ze){case"enabled":v();break;case"loading":p();break;case"disabled":S();break;default:return}},v=function(){E!=="enabled"&&(E="enabled",k(),n("#toolbar_save").find(".toolbar_scene_wrapper").removeClass("toolbar_scene_wrapper_loading"),n("#toolbar_save").find(".toolbar_scene_wrapper").removeClass("toolbar_scene_wrapper_disabled"),n("#toolbar_save").find("p.toolbar_scene_title").html(e.I18n.getTrans("i.Save")),n(".menu_option.menu_action[action='onSaveButtonClicked']").parent().removeClass("menu_item_disabled"),n(".menu_option.menu_action[action='onSaveButtonClicked']").find("span").html(e.I18n.getTrans("i.Save")))},p=function(){E!=="loading"&&(E="loading",n("#toolbar_save").find(".toolbar_scene_wrapper").addClass("toolbar_scene_wrapper_disabled"),n("#toolbar_save").find(".toolbar_scene_wrapper").addClass("toolbar_scene_wrapper_loading"),n("#toolbar_save").find("p.toolbar_scene_title").html(e.I18n.getTrans("i.Saving")),n(".menu_option.menu_action[action='onSaveButtonClicked']").parent().addClass("menu_item_disabled"),n(".menu_option.menu_action[action='onSaveButtonClicked']").find("span").html(e.I18n.getTrans("i.Saving")))},S=function(){E!=="disabled"&&(E="disabled",n("#toolbar_save").find(".toolbar_scene_wrapper").removeClass("toolbar_scene_wrapper_loading"),n("#toolbar_save").find(".toolbar_scene_wrapper").addClass("toolbar_scene_wrapper_disabled"),n("#toolbar_save").find("p.toolbar_scene_title").html(e.I18n.getTrans("i.Saved")),k(),O=setTimeout(function(){L("enabled")},5e3),n(".menu_option.menu_action[action='onSaveButtonClicked']").parent().addClass("menu_item_disabled"),n(".menu_option.menu_action[action='onSaveButtonClicked']").find("span").html(e.I18n.getTrans("i.Saved")))},k=function(){typeof O!="undefined"&&clearTimeout(O)},F=function(ze){R(e.Editor.getLastArea());var et=n(ze).attr("type");switch(et){case"text":N(et);break;case"image":N(et);break;case"video":N(et);break;case"object":var Pe=n(ze).find(".object_wrapper").children()[0];Q(Pe);break;case w:n(ze).find(".menuselect_hide").show(),ie(n(ze).find(".zone_tooltip"));return;default:break}n(ze).find(".delete_content").show()},G=function(ze){for(var et=n(ze).find("div.view_content_zone"),Pe=0;Pe<et.length;Pe++)Z(et[Pe])},Z=function(ze,et){var Pe="",We="true";et===!0&&(Pe="style='display:none'",We="false");var xt="<span class='zone_tooltip' visible='"+We+"' "+Pe+" >"+e.I18n.getTrans("i.ZoneTooltip")+"</span>";n(ze).append(xt),xt=n(ze).find(".zone_tooltip"),et===!0?ie(xt):te(xt)},te=function(ze){var et=n("div").has(ze);n(ze).show(),n(ze).attr("visible","true"),n(et).attr("tooltip","true"),n(ze).css("margin-top")==="0px"&&M(ze)},M=function(ze){var et=n("div").has(ze),Pe=n("article").has(et);e.Utils.addTempShown([Pe,et,ze]);var We=n(et).height(),xt=n(ze).height(),Et=(We-xt)/2;e.Utils.removeTempShown([Pe,et,ze]),n(ze).css("margin-top",Et+"px")},V=function(ze){n("span.zone_tooltip").each(function(et,Pe){M(Pe)}),typeof ze=="function"&&ze(!0)},ie=function(ze){var et=n("div").has(ze);n(ze).hide(),n(ze).attr("visible","false"),n(et).attr("tooltip","false")},R=function(ze){oe();var et=n(ze).find(".zone_tooltip");e.Editor.isZoneEmpty(ze)?(n(ze).find(".menuselect_hide").remove(),n(ze).removeClass("zoneUnselected").removeClass("zoneSelected").addClass("editable"),te(et)):(n(ze).find(".menuselect_hide").hide(),n(ze).find(".delete_content").hide(),ie(et))},Y=function(ze){N(ze)},N=function(ze){oe(ze);var et="toolbar_"+ze;n("#toolbar_element").children().hide(),n("#toolbar_element").find("."+et).css("display","inline-block"),document.getElementById("toolbar_settings_wrapper").style.top="-4px"},Q=function(ze){var et=e.Object.getObjectInfo(ze);switch(et.type){case e.Constant.MEDIA.WEB:N(e.Constant.MEDIA.WEB);break;default:N("object");break}},oe=function(ze){ze!=="hotspot"&&e.Editor.Marker.setCurrentHotspot(w),ze!=="hotzone"&&e.Editor.Marker.setCurrentHotzoneId(w),n("#toolbar_element").children().hide()},b=function(){e.Editor.Tools.Menu.exit()},Le=function(){oe(),e.Editor.Settings.displaySettings()},ce=function(){oe(),e.Editor.Tools.Menu.onSaveButtonClicked()},J=function(){oe(),e.Editor.Preview.preview()},me=function(){n("#hidden_button_to_change_slide_background").trigger("click")},h=function(){e.Editor.Slides.removeCurrentSlide()},Re=function(){e.Editor.Marker.addHotspot()},Ue=function(){e.Editor.Marker.addHotzone()},Xe=function(){oe(),e.Editor.Caption.addCaption()},ot=function(){e.Editor.Marker.deleteCurrentHotmarker()},Tt=function(ze){switch(e.Editor.getCurrentElementType()){case"HOTSPOT":e.Editor.Marker.showHotspotSettings();break;case"HOTZONE":e.Editor.Marker.showHotzoneSettings();break;case"ZONE":switch(n(e.Editor.getCurrentArea()).attr("type")){case e.Constant.OBJECT:e.Editor.Object.showObjectSettings();break;default:break}break}};return{init:m,loadToolsForSlide:D,loadToolsForElement:Y,loadToolsForZone:F,loadToolbarForObject:Q,cleanZoneTool:R,cleanToolbar:f,enableToolbar:T,disableToolbar:A,save:ce,displaySettings:Le,preview:J,deleteSlide:h,changeBackground:me,addHotspot:Re,addHotzone:Ue,addCaption:Xe,deleteHotmarker:ot,addTooltipsToSlide:G,addTooltipToZone:Z,showZoneToolTip:te,hideZoneToolTip:ie,setAllTooltipMargins:V,changeSaveButtonStatus:L,showElementSettings:Tt,exit:b}})(SceneMaker,jQuery),SceneMaker.Editor.Tools.Menu=(function(e,n,w){var l=!1,c=!1,m=function(){if(!l){c=!0,n.each(n("#menu a.menu_action"),function(Z,te){n(te).on("click",function(M){return M.preventDefault(),n(te).parent().hasClass("menu_item_disabled")||typeof e.Editor.Tools.Menu[n(te).attr("action")]=="function"&&(e.Editor.Tools.Menu[n(te).attr("action")](this),k()),!1})}),n("a.menu_option_main, a.menu_option:not('.menu_action')").on("click",function(Z){return Z.preventDefault(),!1});var F=e.Utils.getOptions();typeof F.exitURL!="string"?(n(".menu_option.menu_action[action='exit']").parent().hide(),n("#toolbar_exit_btn").hide()):e.exitPath=F.exitURL,l=!0}n("#menu").show();var G=!1;n("a:.menu_option_main").on("click",function(){n("#menu li > ul.menu_option_main").css("display")==="none"?(n("#menu li > ul.menu_option_main").css("display","block"),n("ul:.menu_option_main li").hover(function(Z){n(this).children("ul").css("display","block").on("mouseenter",function(){G=!0,n(this).mouseleave(function(te){G=!1})})},function(){G||n("ul:.menu_option_main li > ul").css("display","none")})):n("#menu li > ul.menu_option_main").css("display","none")}),n(document).click(function(){n("#menu li > ul.menu_option_main").hide()})},f=function(F){n(F).removeClass("menu_item_disabled").addClass("menu_item_enabled")},T=function(F){n(F).removeClass("menu_item_enabled").addClass("menu_item_disabled")},A=function(){n("#menu").hide(),n("#menu").attr("id","menuDisabled")},D=function(){n("#menuDisabled").show(),n("#menuDisabled").attr("id","menu")},z=function(){if(e.Screen.getScreens().length===0){var F={};F.width=600,F.height=150,F.text=e.I18n.getTrans("i.NoSlidesOnSaveNotification");var G={};G.text=e.I18n.getTrans("i.Ok"),G.callback=function(){n.fancybox.close()},F.buttons=[G],e.Utils.showDialog(F);return}e.Editor.Tools.changeSaveButtonStatus("loading");var Z=e.Editor.saveScene();e.Editor.sendScene(Z,"save",function(){e.Editor.Tools.changeSaveButtonStatus("disabled")},function(){e.Editor.Tools.changeSaveButtonStatus("enabled")})},O=function(){e.Editor.Preview.preview()},E=function(){if(e.Editor.hasSceneChanged()){var F={};F.width=600,F.height=200,F.notificationIconSrc=e.ImagesPath+"icons/save_document.png",F.text=e.I18n.getTrans("i.ExitConfirmationMenu"),F.buttons=[];var G={};G.text=e.I18n.getTrans("i.cancel"),G.callback=function(){n.fancybox.close()},F.buttons.push(G);var Z={};Z.text=e.I18n.getTrans("i.exitWSaving"),Z.callback=function(){L(),n.fancybox.close()},F.buttons.push(Z);var te={};te.text=e.I18n.getTrans("i.saveAndExit"),te.callback=function(){n("#waiting_overlay").show(),e.Editor.Tools.changeSaveButtonStatus("loading");var M=e.Editor.saveScene();e.Editor.sendScene(M,"save",function(){e.Editor.Tools.changeSaveButtonStatus("disabled"),L()},function(){e.Editor.Tools.changeSaveButtonStatus("enabled"),n("#waiting_overlay").hide()}),n.fancybox.close()},F.buttons.push(te),e.Utils.showDialog(F)}else L()},L=function(){e.Editor.Events.allowExitWithoutConfirmation(),window.top.location.href=e.exitPath},v=function(){return n("#addScreenButton").trigger("click"),!1},p=function(){return n("#addViewButton").trigger("click"),!1},S=function(){e.Editor.Settings.displaySettings()},k=function(){c&&(n("#menu ul.menu_option_main").addClass("temp_hidden"),setTimeout(function(){n("#menu ul.menu_option_main").removeClass("temp_hidden")},500))};return{init:m,disableMenu:A,enableMenu:D,addScreen:v,addView:p,displaySettings:S,onSaveButtonClicked:z,preview:O,exit:E}})(SceneMaker,jQuery),SceneMaker.Editor.Utils=(function(e,n,w){var l=function(L,v,p,S){var k={width:p,height:S},F=L/v,G=p/S;return F>G?(k.width=G*v,k.height=v,k):(k.width=L,k.height=L/G,k)},c=function(L,v){var p="";n.each(L.split(";"),function(k,F){F.indexOf("width")===-1&&F.indexOf("height")===-1&&(p=p+F+"; ")});var S=e.Utils.getPixelDimensionsFromStyle(L,v);return S&&S[0]&&(p=p+"width: "+S[0]+"px; ",S[1]&&(p=p+"height: "+S[1]+"px; ")),p},m=function(L,v){var p=v.width()*100/L.width(),S=v.height()*100/L.height(),k=v.position().top*100/L.height(),F=v.position().left*100/L.width();return"position: relative; width:"+p+"%; height:"+S+"%; top:"+k+"%; left:"+F+"%;"},f=function(){return"position: relative; width:100%; height:100%; top:0%; left:0%;"},T=function(L){var v=/(^http(s)?:\/\/)/g,p=/(^#)/g,S=e.Object.getObjectInfo(L);return S.wrapper===null&&L.match(v)===null&&L.match(p)===null?"http://"+L:L},A,D=function(L){switch(n(".fancy_tab_content").hide(),n("#"+L+"_content").show(),n(".fancy_tab").removeClass("fancy_selected"),n("#"+L).addClass("fancy_selected"),n("#"+L+"_help").show(),L){case"tab_pic_from_url":e.Editor.Image.onLoadTab("url");break;case"tab_video_from_url":e.Editor.Video.onLoadTab();break;case"tab_object_from_url":e.Editor.Object.onLoadTab("url");break;default:break}return!1},z=function(){n("div.fancy_tabs a.fancy_tab:not(.disabled)").show()},O=function(L){var v={};v.width=650,v.height=190,v.text=L;var p={};p.text=e.I18n.getTrans("i.Ok"),p.callback=function(){n.fancybox.close()},v.buttons=[p],e.Utils.showDialog(v)},E=function(L,v){if(L instanceof Array){for(var p=0;p<L.length;p++)E(L[p],v);return}if(v)n(L).parent().removeClass("disableSettingsField"),n(L).removeAttr("disabled");else{if(n(L).is("input")){if(n(L).attr("type")==="checkbox"){var S=n(L).attr("defaultvalue")==="true";n(L).prop("checked",S)}}else if(n(L).is("select")){var k=n(L).find("option[selected='selected']").val();n(L).val(k)}n(L).parent().addClass("disableSettingsField"),n(L).attr("disabled","disabled")}};return{dimentionsToDraw:l,setStyleInPixels:c,getStylesInPercentages:m,getStylesForFitContent:f,autocompleteUrls:T,loadTab:D,hideNonDefaultTabs:z,showErrorDialog:O,enableElementSettingsField:E}})(SceneMaker,jQuery),SceneMaker.Editor.Utils.Loader=(function(e,n,w){var l=function(E){T(n(E).find(".object_wrapper"))},c=function(E){A(n(E).find(".object_wrapper"))},m=function(){T(n(".object_wrapper"))},f=function(){A(n(".object_wrapper"))},T=function(E){n.each(E,function(L,v){var p=n(v).attr("htmlContent");typeof p!="undefined"&&(n(v).html(p),n(v).removeAttr("htmlContent"))})},A=function(E){n.each(E,function(L,v){var p=n(v).html();typeof p!="undefined"&&p!==""&&(n(v).attr("htmlContent",n(v).html()),n(v).html(""))})},D=function(E,L,v){var p=E,S=E.length,k=0;n.each(E,function(F,G){n(G).load(function(Z){k=k+1,k===S&&z(p,L,v)}),n(G).error(function(Z){k=k+1,v.filterUnloadedImages===!0&&p.splice(p.indexOf(G),1),k===S&&z(p,L,v)})})},z=function(E,L,v){n.each(E,function(p,S){O(S,E,L,v)}),typeof v.callback=="function"&&v.callback(v)},O=function(E,L,v,p){var S=p.titleArray;S&&S[L.indexOf(E)]?n("#"+v).append("<div><p>"+S[L.indexOf(E)]+"</p>"+e.Utils.getOuterHTML(E)+"</div>"):n("#"+v).append("<div>"+e.Utils.getOuterHTML(E)+"</div>")};return{loadObjectsInEditorSlide:l,unloadObjectsInEditorSlide:c,loadAllObjects:m,unloadAllObjects:f,loadImagesOnContainer:D}})(SceneMaker,jQuery),SceneMaker.Editor.Screen=(function(e,n,w){var l=function(){},c=function(Y){var Y=n(Y);e.Screen.getCurrentScreen()?n(e.Screen.getCurrentScreen()).after(Y):m(Y);var N=e.Screen.getCurrentScreenNumber();e.Screen.setCurrentScreenNumber(N+1),e.Screen.triggerScreenLeaveEvent(N),e.Screen.updateScreens(),e.Screen.triggerScreenEnterEvent(e.Screen.getCurrentScreenNumber()),e.Editor.Thumbnails.drawScreenThumbnails(function(){e.Editor.Thumbnails.selectThumbnail(e.Screen.getCurrentScreenNumber()),e.Editor.Thumbnails.moveThumbnailsToScreenWithNumber(e.Screen.getCurrentScreenNumber())})},m=function(R){n(".slides").append(R)},f=function(){var R=e.Editor.Dummies.getDummy(e.Constant.SCREEN,{slideNumber:e.Screen.getScreensQuantity()+1});return c(R),n.fancybox.close(),!1},T=function(R){return n(R).children("article").length},A=function(R){e.Editor.Slides.updateThumbnail(R),n("#bottomside").show(),O(R);var Y=n(R).attr("id"),N=n("#"+Y+" > article");e.Editor.Thumbnails.drawViewThumbnails(N,function(){})},D=function(R){E(R);var Y=e.Editor.View.getCurrentView();Y&&e.Editor.View.closeView(Y),n("#bottomside").hide(),n("#screen_selected > img").attr("src","")},z=function(){var R=e.Screen.getCurrentScreen();O(R)},O=function(R){n("#screen_selected_img").addClass("selectedScreenThumbnailInViews");var Y=e.Editor.View.getCurrentView();Y&&e.Editor.View.closeView(Y),e.Editor.Tools.loadToolsForSlide(R)},E=function(R){n("#screen_selected_img").removeClass("selectedScreenThumbnailInViews"),e.Editor.Marker.cancelAnnotationSelectedForSlide(n(R).attr("id"))},L=function(R){var Y=n(R.target).prev("img").attr("slidenumber"),N=n("article[type='screen'][slidenumber='"+Y+"']")[0];v(N)},v=function(R){var Y={};Y.width=375,Y.height=130,Y.notificationIconSrc=e.Editor.Thumbnails.getThumbnailURLForSlide(R),Y.notificationIconClass="notificationIconDeleteSlide",Y.text=e.I18n.getTrans("i.AreYouSureDeleteScreen");var N={};N.text=e.I18n.getTrans("i.no"),N.callback=function(){n.fancybox.close()};var Q={};Q.text=e.I18n.getTrans("i.delete"),Q.callback=function(){p(R),n.fancybox.close()},Y.buttons=[N,Q],e.Utils.showDialog(Y)},p=function(R){if(R!==null){e.Screen.getCurrentScreen()===R&&D(R);var Y=n(R).attr("slidenumber"),N=e.Screen.getCurrentScreenNumber();n(R).remove(),Y<=N&&(N-1>0?e.Screen.setCurrentScreenNumber(N-1):e.Screen.getScreensQuantity()>1&&e.Screen.setCurrentScreenNumber(1)),e.Screen.updateScreens(),e.Editor.Thumbnails.drawScreenThumbnails(function(){if(typeof e.Screen.getCurrentScreen()!="undefined"){var Q=e.Screen.getCurrentScreenNumber();e.Editor.Thumbnails.selectThumbnail(Q),e.Editor.Thumbnails.moveThumbnailsToScreenWithNumber(Q),e.Screen.triggerScreenEnterEvent(Q)}})}},S=function(R,Y){var N=e.Screen.getScreenWithNumber(R),Q=e.Screen.getScreenWithNumber(Y);if(!(typeof N=="undefined"||typeof Q=="undefined")&&!(typeof N.length!==w&&(N=n(N)[0],typeof N=="undefined"))&&!(typeof Q.length!==w&&(Q=n(Q)[0],typeof Q=="undefined"))&&!(N.tagName!="ARTICLE"||Q.tagName!="ARTICLE"||N==Q)){var oe=null;if(Y>R)oe="after";else if(Y<R)oe="before";else return;var b=!1,Le=e.Screen.getCurrentScreen(),ce=parseInt(n(Le).attr("slidenumber"));Le===N&&(b=!0);var J=e.Editor.Slides.copyTextAreasOfSlide(N);if(n(N).remove(),oe=="after")n(Q).after(N);else if(oe=="before")n(Q).before(N);else return;e.Utils.addTempShown(N),e.Editor.Marker.refreshDraggables(N),e.Editor.Slides.cleanTextAreasOfSlide(N),e.Editor.Slides.loadTextAreasOfSlide(N,J),e.Utils.removeTempShown(N),e.Screen.setScreens(n("section.slides > article")),n("#screens_list").find("div.wrapper_slidethumbnail:has(img[slidenumber])").each(function(h,Re){var Ue=h+1,Xe=n(Re).find("p.ptext_barbutton");n(Xe).html(Ue);var ot=n(Re).find("img.image_slidethumbnail");n(ot).attr("slidenumber",Ue)});var me;b?me=Y:R>ce&&Y<=ce?me=ce+1:R<ce&&Y>=ce&&(me=ce-1),typeof me=="number"&&e.Screen.setCurrentScreenNumber(me),e.Screen.updateScreens()}},k=function(R,Y){if(typeof R!="undefined"){var N=n(R).attr("id");e.Editor.Slides.cleanTextAreasOfSlide(R),R=F(R);var Q=n(R).attr("id"),oe=e.Screen.getCurrentScreen();oe?n(oe).after(R):n("section#slides_panel").append(R);var b=n("#"+Q);e.Editor.Marker.refreshDraggables(b),e.Editor.Marker.copyMarkers(N,Q),Y.textAreas&&e.Editor.Slides.loadTextAreasOfSlide(b,Y.textAreas,!0),e.Screen.updateScreens(),e.Editor.Thumbnails.drawScreenThumbnails(function(){oe?(e.Screen.goToScreenWithNumber(e.Screen.getCurrentScreenNumber()+1),e.Editor.Thumbnails.moveThumbnailsToScreenWithNumber(e.Screen.getCurrentScreenNumber())):(e.Screen.goToScreenWithNumber(1),e.Editor.Thumbnails.moveThumbnailsToScreenWithNumber(1))}),n(b).find("[copyid]").removeAttr("copyid")}},F=function(R){var Y=n(R),N=Y.attr("id"),Q=e.Utils.getId("article");Y.attr("id",Q);var oe=Y.find("img.slide_background#"+N+"_background");n(oe).attr("id",Q+"_background");var b=Y.children("article");return b.each(function(Le,ce){G(ce,Q)}),R},G=function(R,Y){var N=n(R);switch(N.attr("type")){case e.Constant.VIEW_IMAGE:return Z(N,Y);case e.Constant.VIEW_CONTENT:return te(N,Y)}},Z=function(R,Y){var N=R.attr("id"),Q=e.Utils.getId(Y+"_article");R.attr("id",Q);var oe=R.find("img.slide_background#"+N+"_background");n(oe).attr("id",Q+"_background")},te=function(R,Y){var N=e.Utils.getId(Y+"_article");R.attr("id",N),R.children("div[id].view_content_zone").each(function(Q,oe){oe=M(oe,N)})},M=function(R,Y){n(R).attr("copyid",n(R).attr("id"));var N=e.Utils.getId(Y+"_zone");return n(R).attr("id",N),n(R).find("[id]").each(function(Q,oe){oe=V(oe,N)}),R},V=function(R,Y){var N=ie(R),Q=e.Utils.getId(Y+"_"+N);return n(R).attr("id",Q),R},ie=function(R){var Y=n(n(R).attr("id").split("_")).last()[0];return Y.length>1?Y.substring(0,Y.length-1):Y};return{init:l,addScreen:c,appendScreen:m,onClickAddScreenButton:f,onEnterScreen:A,onLeaveScreen:D,openScreen:O,closeScreen:E,onDeleteScreenClicked:L,removeScreen:v,onClickOpenScreen:z,getViewsQuantity:T,moveScreenTo:S,copyScreen:k}})(SceneMaker,jQuery),SceneMaker.Editor.View=(function(e,n,w){var l,c=function(){},m=function(){return l},f=function(V){l=V},T=function(V,R){var R=n(R).css("display","none")[0];A(V,R),e.Editor.Tools.addTooltipsToSlide(R),e.Editor.View.openView(R),e.Editor.Thumbnails.drawViewThumbnails(n(V).find("article"),function(){e.Editor.Thumbnails.selectViewThumbnail(n(R).attr("slidenumber"))})},A=function(V,ie){n(V).append(ie)},D=function(){return n("#addViewFancybox").trigger("click"),e.Editor.Utils.loadTab("tab_views"),!1},z=function(V){var ie=e.Screen.getCurrentScreen(),R=n(V.target).prev("img").attr("slidenumber"),Y=n(ie).find("article[slidenumber='"+R+"']")[0];O(Y)},O=function(V){var ie={};ie.width=375,ie.height=130,ie.notificationIconSrc=e.Editor.Thumbnails.getThumbnailURLForSlide(V),ie.notificationIconClass="notificationIconDeleteSlide",ie.text=e.I18n.getTrans("i.AreYouSureDeleteView");var R={};R.text=e.I18n.getTrans("i.no"),R.callback=function(){n.fancybox.close()};var Y={};Y.text=e.I18n.getTrans("i.delete"),Y.callback=function(){E(V),n.fancybox.close()},ie.buttons=[R,Y],e.Utils.showDialog(ie)},E=function(V){if(typeof V=="object"){var ie=n(V).parent(),R=e.View.getCurrentView(),Y=R===V;e.View.getCurrentView()===V&&F(V),n(V).remove();var N=n(ie).find("article");n(N).each(function(Q,oe){n(oe).attr("slidenumber",Q+1)}),e.Editor.Thumbnails.drawViewThumbnails(N,function(){Y===!1&&e.Editor.Thumbnails.selectViewThumbnail(n(R).attr("slidenumber"))}),Y&&e.Editor.Screen.openScreen(ie)}},L=function(V){var ie=e.Screen.getCurrentScreen(),R=n(ie).find("article"),Y=R[V-1];v(Y)},v=function(V){var ie=m();if(ie)F(ie);else{var R=n(V).parent();e.Editor.Screen.closeScreen(R)}f(V),p(V),e.Editor.Thumbnails.selectViewThumbnail(n(V).attr("slidenumber")),e.Slides.triggerSlideEnterEvent(n(V).attr("id"))},p=function(V){n(V).css("display","block")},S=function(V){n(V).css("display","none")},k=function(V){var ie=e.Screen.getCurrentScreen(),R=n(ie).find("article"),Y=R[V-1];F(Y)},F=function(V){var ie=n(V).attr("id");f(null),e.Editor.Thumbnails.selectViewThumbnail(null),S(V),e.Editor.Marker.cancelAnnotationSelectedForSlide(ie),e.Slides.triggerSlideLeaveEvent(ie)},G=function(V){te(1)},Z=function(){te(-1)},te=function(V){var ie=e.View.getCurrentViewNumber();typeof ie=="undefined"&&(ie=0);var R=e.Editor.Screen.getViewsQuantity(e.Screen.getCurrentScreen()),Y=ie+V,N=Math.min(Math.max(0,Y),R);Y===N&&M(Y)},M=function(V){V===0?e.Editor.Screen.onClickOpenScreen():e.Editor.View.openViewWithNumber(V)};return{init:c,addView:T,appendView:A,onClickAddViewButton:D,onDeleteViewClicked:z,removeView:O,getCurrentView:m,openViewWithNumber:L,openView:v,closeViewWithNumber:k,closeView:F,forwardOneView:G,backwardOneView:Z}})(SceneMaker,jQuery),SceneMaker.Editor.Marker=(function(e,n,w){var l,c,m,f,T="NONE",A,D,z=function(){l={},f={},A=n('<a href="#hotspotSettings_fancybox" style="display:none"></a>'),n(A).fancybox({autoDimensions:!1,height:690,width:920,scrolling:"no",showCloseButton:!1,padding:0,onStart:function(ue){me()},onComplete:function(ue){},onClosed:function(ue){}}),D=n('<a href="#hotzoneSettings_fancybox" style="display:none"></a>'),n(D).fancybox({autoDimensions:!1,height:690,width:920,scrolling:"no",showCloseButton:!1,padding:0,onStart:function(ue){Ct()},onComplete:function(ue){},onClosed:function(ue){}})},O=function(ue){var se={hotspots:{},hotzones:{},caption:{}};return se},E=function(ue,se){ue&&(typeof ue.background=="string"&&e.Editor.Slides.setSlideBackground(se,ue.background),v(ue.id,ue.hotzones),L(ue.id,ue.hotspots),e.Editor.Caption.loadCaption(ue.id,ue.caption))},L=function(ue,se){Array.isArray(se)&&se.forEach(function(Ne,Me){e.Utils.registerId(Ne.id);var it,vt;n("body").attr("aspectRatio")==="16:9"?(it=1024,vt=576):(it=800,vt=600),Ne.x=Ne.x*it/100,Ne.y=Ne.y*vt/100,Ne.width=Ne.width*it/100,Ne.height=Ne.height*vt/100,M(ue,Ne),Array.isArray(Ne.actions)&&Ne.actions.length>0&&(l[ue].hotspots[Ne.id].actions=Ne.actions)})},v=function(ue,se){Array.isArray(se)&&n(se).each(function(Ne,Me){p(ue,Me)})},p=function(ue,se){if(Array.isArray(se.points)){var Ne;typeof se.id=="string"?Ne=se.id:Ne=e.Utils.getId("annotation-");var Me;typeof se.idAlias=="string"?Me=se.idAlias:Me=e.Utils.getId("zone-"),f[Ne]=Me,e.Utils.registerId(Me);var it=e.Marker.createAnnotationFromPointsArray(Ne,se.points),vt=Et(ue);vt.addAnnotation(it),l[ue].hotzones[Ne]={},l[ue].hotzones[Ne].cursorVisibility=se.cursorVisibility,l[ue].hotzones[Ne].enabled=se.enabled,Array.isArray(se.actions)&&se.actions.length>0&&(l[ue].hotzones[Ne].actions=se.actions)}},S=function(){T==="HOTSPOT"?G("HOTSPOT"):F("HOTSPOT")},k=function(){T==="HOTZONE"?G("HOTZONE"):F("HOTZONE")},F=function(ue){switch(T=ue,ue){case"HOTSPOT":G("HOTZONE"),n("#slides_panel").addClass("hotspot_active");break;case"HOTZONE":G("HOTSPOT"),n("#slides_panel").addClass("hotzone_active"),We();break;case"NONE":G("HOTSPOT"),G("HOTZONE");break}},G=function(ue){switch(T===ue&&(T="NONE"),ue){case"HOTSPOT":n("#slides_panel").removeClass("hotspot_active"),Zt(w);break;case"HOTZONE":n("#slides_panel").removeClass("hotzone_active"),m=w,xt();break;default:break}},Z=function(ue){var se=n(ue.target);if(T!=="NONE")if(se.closest('article[type="'+e.Constant.SCREEN+'"]').length===0)F("NONE");else switch(T){case"HOTSPOT":te(ue);break;case"HOTZONE":break;default:break}else se.hasClass("hotspot")&&ce(se)},te=function(ue){ue.preventDefault(),ue.stopPropagation();var se=e.Slides.getCurrentSlide(),Ne=n(se).attr("id"),Me=e.Utils.getId("hotspot-"),it=42,vt=se.getBoundingClientRect(),at=ue.clientX-vt.left-it/2,_t=ue.clientY-vt.top-it/2;M(Ne,{id:Me,x:at,y:_t}),F("NONE")},M=function(ue,se){typeof se.image!="string"&&(se.image=e.Marker.getDefaultHotspotImg()),typeof se.lockAspectRatio!="boolean"&&(se.lockAspectRatio=!0),typeof se.visibility!="string"&&(se.visibility="visible"),typeof se.cursorVisibility!="string"&&(se.cursorVisibility="pointer"),typeof se.width!="number"&&(se.width=42),typeof se.height!="number"&&(se.height=42);var Ne=parseFloat(se.rotationAngle);(typeof Ne!="number"||isNaN(Ne)||Ne<0||Ne>360)&&(Ne=0);var Me=n("#"+ue),it=e.Slides.getSlideBackgroundImg(Me),vt=n("<img>",{src:se.image,class:"hotspot",id:se.id,rotationAngle:Ne,css:{position:"absolute",left:se.x,top:se.y,width:se.width+"px",height:se.height+"px",transform:"rotate("+Ne+"deg)"}}).appendTo(it.parent());ie(vt),typeof l[ue]=="undefined"&&(l[ue]=O()),l[ue].hotspots[se.id]={},l[ue].hotspots[se.id].lockAspectRatio=se.lockAspectRatio,l[ue].hotspots[se.id].visibility=se.visibility,l[ue].hotspots[se.id].cursorVisibility=se.cursorVisibility,V(vt)},V=function(ue){ue.draggable({start:function(se,Ne){ce(ue)},stop:function(se,Ne){ie(ue)}})},ie=function(ue,se=15){const Ne=ue.parent();Y(Ne,ue,se)&&N(Ne,ue)},R=function(ue,se,Ne=0){const Me=ue.innerWidth(),it=ue.innerHeight(),vt=se.outerWidth(),at=se.outerHeight(),_t=se.position();return _t.left>=-Ne&&_t.top>=-Ne&&_t.left+vt<=Me+Ne&&_t.top+at<=it+Ne},Y=function(ue,se,Ne=0){const Me=ue.innerWidth(),it=ue.innerHeight(),vt=se.outerWidth(),at=se.outerHeight(),_t=se.position();return _t.left+vt<=+Ne||_t.top+at<=+Ne||_t.left>=Me-Ne||_t.top>=it-Ne},N=function(ue,se,Ne=0){const Me=ue.innerWidth(),it=ue.innerHeight(),vt=se.outerWidth(),at=se.outerHeight();let{left:_t,top:kt}=se.position();_t=Math.max(Ne,Math.min(_t,Me-vt-Ne)),kt=Math.max(Ne,Math.min(kt,it-at-Ne)),se.stop(!0).animate({left:_t,top:kt},1e3)},Q=function(ue){n(ue).find("img.hotspot").each(function(){var se=n(this);V(se)})},oe=function(ue,se){b(ue,se),n("#"+se).children("article").each(function(Ne,Me){var it=n(Me).attr("id"),vt=ue+it.slice(se.length);b(vt,it)})},b=function(ue,se){if(typeof l[se]=="undefined"&&(l[se]=O()),typeof l[ue]!="undefined"){l[se]=JSON.parse(JSON.stringify(l[ue]));var Ne=n("#"+se);if(typeof l[se].annotator!="undefined"){delete l[se].annotator,l[se].hotzones={};var Me=e.Slides.getSlideBackgroundImg(Ne);Me.parent("div[data-theme]").remove(),Me.prependTo(Ne)}var it={};Ne.children("img.hotspot").each(function(vn,dn){var Bn=n(dn).attr("id"),tn=e.Utils.getId("hotspot-");n(dn).attr("id",tn),it[Bn]=tn});for(var vt in it){var at=it[vt],_t=Object.assign({},l[se].hotspots[vt]);typeof _t!="undefined"&&Object.keys(_t).length>0&&(l[se].hotspots[at]=_t),delete l[se].hotspots[vt]}for(var kt=Xt(n("#"+ue)),Nt=kt.hotzones,Gt={},Bt=0;Bt<Nt.length;Bt++){var Jt=Nt[Bt].id;Nt[Bt].id=e.Utils.getId("annotation-"),Gt[Jt]=Nt[Bt].id,delete Nt[Bt].idAlias}for(var un in l[se].hotspots){var mn=l[se].hotspots[un];l[se].hotspots[un].actions=Le(mn.actions,un,ue,se,it,Gt)}for(var Ut=0;Ut<Nt.length;Ut++)Nt[Ut].actions=Le(Nt[Ut].actions,Nt[Ut].id,ue,se,it,Gt);Array.isArray(Nt)&&Nt.length>0&&v(se,Nt)}},Le=function(ue,se,Ne,Me,it,vt){if(Array.isArray(ue))for(var at=ue.length,_t=0;_t<at;_t++){var kt=ue[_t];switch(kt.actionType){case"openView":if(kt.actionParams&&typeof kt.actionParams.view=="string"){var Nt=kt.actionParams.view,Gt;if(Nt.startsWith(Ne))Gt=Me+Nt.slice(Ne.length);else if(Nt.split("_")[0]===Ne.split("_")[0]){var Bt=Me.split("_")[0];Gt=Bt+Nt.slice(Bt.length)}typeof Gt=="string"&&(ue[_t].actionParams.view=Gt)}break;case"showHotspot":case"hideHotspot":if(kt.actionParams&&typeof kt.actionParams.hotspotId=="string"){var Jt=kt.actionParams.hotspotId,un=Object.keys(it).includes(Jt);un&&(kt.actionParams.hotspotId=it[Jt])}break;case"enableHotzone":case"disableHotzone":if(kt.actionParams&&typeof kt.actionParams.hotzoneId=="string"){var mn=kt.actionParams.hotzoneId,Ut=Object.keys(vt).includes(mn);Ut&&(kt.actionParams.hotzoneId=vt[mn])}break}}return ue},ce=function(ue){Zt(ue),e.Editor.Tools.loadToolsForElement("hotspot")},J=function(){n(A).trigger("click")},me=function(){var ue=n(e.Slides.getCurrentSlide()).attr("id"),se=n(c),Ne=se.attr("id"),Me=l[ue].hotspots[Ne];n("#hotspotIdInput").val(Ne),h(function(){n("#hotspotImageGallery img").removeClass("selected");var Gt=se.attr("src"),Bt=n("#hotspotImageGallery").find("img[src='"+Gt+"']")[0];typeof Bt=="undefined"?(n("#hotspotImageURL").val(Gt),n("#hotspotImageSource").val("url").trigger("change")):(n(Bt).addClass("selected"),n("#hotspotImageSource").val("gallery").trigger("change"),e.Editor.Carousel.goToElement("hotspotImageGallery",Bt))});var it=parseFloat(se.css("left")),vt=parseFloat(se.css("top"));n("#hotspotPositionX").val(it),n("#hotspotPositionY").val(vt),typeof l[ue].hotspots[Ne].lockAspectRatio=="boolean"&&n("#hotspotLockAspectRatio").prop("checked",l[ue].hotspots[Ne].lockAspectRatio);var at=se.width(),_t=se.height(),kt=Math.round(at/_t*100)/100;n("#hotspotSizeWidth").val(at),n("#hotspotSizeHeight").val(_t),n("#hotspotAspectRatio").val(kt);var Nt=se.attr("rotationAngle");!isNaN(Nt)&&Nt>=0&&Nt<=360?n("#hotspotRotation").val(Nt):n("#hotspotRotation").val(0),typeof l[ue].hotspots[Ne].visibility=="string"?n("#hotspotVisibility").val(l[ue].hotspots[Ne].visibility):n("#hotspotVisibility").val("visible"),typeof l[ue].hotspots[Ne].cursorVisibility=="string"?n("#hotspotCursorVisibility").val(l[ue].hotspots[Ne].cursorVisibility):n("#hotspotCursorVisibility").val("pointer"),e.Editor.Actions.loadActions(n("#hotspotActions"),Me,"HOTSPOT")},h=function(ue){Ue();var se=[{src:e.ImagesPath+"hotspotgallery/hotspot.png"},{src:e.ImagesPath+"hotspotgallery/arrow.png"},{src:e.ImagesPath+"hotspotgallery/magnifying_glass.png"},{src:e.ImagesPath+"hotspotgallery/eye.png"},{src:e.ImagesPath+"hotspotgallery/hand.png"},{src:e.ImagesPath+"hotspotgallery/hand2.png"},{src:e.ImagesPath+"hotspotgallery/wheel.png"},{src:e.ImagesPath+"hotspotgallery/info.png"},{src:e.ImagesPath+"hotspotgallery/dialogue.png"},{src:e.ImagesPath+"hotspotgallery/dialogue2.png",aspectRatio:1.164},{src:e.ImagesPath+"hotspotgallery/pin.png",aspectRatio:.774},{src:e.ImagesPath+"hotspotgallery/close.png"},{src:e.ImagesPath+"hotspotgallery/key.png",aspectRatio:.779},{src:e.ImagesPath+"hotspotgallery/painting.png",aspectRatio:.891},{src:e.ImagesPath+"hotspotgallery/keypad_standard.png"},{src:e.ImagesPath+"hotspotgallery/keypad_retro.png"},{src:e.ImagesPath+"hotspotgallery/keypad_futuristic.png"},{src:e.ImagesPath+"hotspotgallery/decoderdisk_standard.png"},{src:e.ImagesPath+"hotspotgallery/decoderdisk_basic.png"},{src:e.ImagesPath+"hotspotgallery/decoderdisk_retro.png"},{src:e.ImagesPath+"hotspotgallery/decoderdisk_futuristic.png"},{src:e.ImagesPath+"hotspotgallery/safebox_standard.png"},{src:e.ImagesPath+"hotspotgallery/safebox_retro.png"},{src:e.ImagesPath+"hotspotgallery/safebox_futuristic.png",aspectRatio:1.286},{src:e.ImagesPath+"hotspotgallery/signal_generator.png"},{src:e.ImagesPath+"hotspotgallery/switch_standard_off.png",aspectRatio:.767},{src:e.ImagesPath+"hotspotgallery/switch_standard_on.png",aspectRatio:.767},{src:e.ImagesPath+"hotspotgallery/switch_retro_off.png",aspectRatio:.743},{src:e.ImagesPath+"hotspotgallery/switch_retro_on.png",aspectRatio:.743},{src:e.ImagesPath+"hotspotgallery/switch_futuristic_off.png",aspectRatio:.762},{src:e.ImagesPath+"hotspotgallery/switch_futuristic_on.png",aspectRatio:.762},{src:e.ImagesPath+"hotspotgallery/switches_container_standard.png",aspectRatio:1.779},{src:e.ImagesPath+"hotspotgallery/switches_container_retro.png",aspectRatio:1.779},{src:e.ImagesPath+"hotspotgallery/switches_container_futuristic.png",aspectRatio:16/9},{src:e.ImagesPath+"hotspotgallery/wires_container_standard.png",aspectRatio:1.687},{src:e.ImagesPath+"hotspotgallery/wires_container_retro.png",aspectRatio:1.93},{src:e.ImagesPath+"hotspotgallery/wires_container_futuristic.png",aspectRatio:1.875},{src:e.ImagesPath+"hotspotgallery/chessboard_standard.png"},{src:e.ImagesPath+"hotspotgallery/chessboard_realistic.png"},{src:e.ImagesPath+"hotspotgallery/chessboard_futuristic.png"},{src:e.ImagesPath+"hotspotgallery/chessbox_standard.png",aspectRatio:.564},{src:e.ImagesPath+"hotspotgallery/chessbox_realistic.png",aspectRatio:.564}],Ne=[];n.each(se,function(it,vt){var at=n("<img src='"+vt.src+"'/>");typeof vt.aspectRatio=="number"&&at.attr("aspectratio",vt.aspectRatio),Ne.push(at)});var Me={};Me.callback=Re,Me.afterDrawCarouselCallback=ue,e.Editor.Utils.Loader.loadImagesOnContainer(Ne,"hotspotImageGallery",Me)},Re=function(ue){var se=n("#hotspotImageGallery"),Ne=se.parent();se.show(),e.Utils.addTempShown([Ne,se]);var Me=new Array;Me.rows=1,Me.rowItems=9,Me.scrollItems=9,Me.afterCreateCarruselFunction=function(){setTimeout(function(){e.Utils.removeTempShown([Ne,se]),typeof ue.afterDrawCarouselCallback=="function"&&ue.afterDrawCarouselCallback()},100)},e.Editor.Carousel.createCarousel("hotspotImageGallery",Me)},Ue=function(){e.Editor.Carousel.cleanCarousel("hotspotImageGallery"),n("#hotspotImageGallery").hide()},Xe=function(ue){var se=ue.target.value;if(se==="gallery"){var Ne=n("#hotspotImageGallery").parent().parent();n(Ne).show(),n("#hotspotImageURLWrapper").hide(),n("#hotspotImageURL").val(""),ot()}else if(se==="url"){var Ne=n("#hotspotImageGallery").parent().parent();n(Ne).hide(),n("#hotspotImageURLWrapper").show(),ot()}},ot=function(){var ue=n("#hotspotImageURLPreviewWrapper"),se=n("#hotspotImageURL").val();typeof se=="string"&&se.trim()!==""?ue.html("<img src='"+se+"'>").show():ue.html("").hide()},Tt=function(ue){var se=n(ue.target);n("#hotspotImageGallery").find("img").removeClass("selected"),se.addClass("selected");var Ne=parseFloat(se.attr("aspectratio"));isNaN(parseFloat(Ne))&&(Ne=1);var Me=n("#hotspotSizeWidth").val()/n("#hotspotSizeHeight").val();if(Ne!==Me&&Ne>0){var it=Math.round(n("#hotspotSizeWidth").val()/Ne);n("#hotspotSizeHeight").val(it),n("#hotspotAspectRatio").val(Ne)}},ze=function(ue){var se=n("#hotspotLockAspectRatio").prop("checked");if(se){var Ne=parseFloat(n("#hotspotAspectRatio").val()),Me=Math.round(n("#hotspotSizeWidth").val()/Ne);n("#hotspotSizeHeight").val(Me)}},et=function(ue){var se=n("#hotspotLockAspectRatio").prop("checked");if(se){var Ne=parseFloat(n("#hotspotAspectRatio").val()),Me=Math.round(n("#hotspotSizeHeight").val()*Ne);n("#hotspotSizeWidth").val(Me)}},Pe=function(ue){var se=n(e.Slides.getCurrentSlide()).attr("id"),Ne=n(c),Me=Ne.attr("id"),it={},vt;switch(n("#hotspotImageSource").val()){case"gallery":var at=n("#hotspotImageGallery img.selected");at.length&&(vt=at.attr("src"));break;case"url":vt=n("#hotspotImageURL").val();break;default:break}typeof vt!="string"&&(vt=e.Marker.getDefaultHotspotImg()),Ne.attr("src",vt);var _t=parseFloat(n("#hotspotPositionX").val()),kt=parseFloat(n("#hotspotPositionY").val());typeof _t=="number"&&!Number.isNaN(_t)&&_t>=0&&Ne.css("left",_t+"px"),typeof kt=="number"&&!Number.isNaN(kt)&&kt>=0&&Ne.css("top",kt+"px"),it.lockAspectRatio=n("#hotspotLockAspectRatio").prop("checked");var Nt=n("#hotspotSizeWidth").val(),Gt=n("#hotspotSizeHeight").val();Nt>0&&Ne.width(Nt),Gt>0&&Ne.height(Gt);var Bt=parseFloat(n("#hotspotRotation").val());!isNaN(Bt)&&Bt>=0&&Bt<=360&&(Ne.attr("rotationAngle",Bt),Ne.css("transform","rotate("+Bt+"deg)")),it.visibility=n("#hotspotVisibility").val(),it.cursorVisibility=n("#hotspotCursorVisibility").val(),ie(Ne);var Jt=e.Editor.Actions.getActionsJSON(n("#hotspotActions"));Jt.length>0&&(it.actions=Jt),l[se].hotspots[Me]=it,n.fancybox.close()},We=function(){var ue=n(e.Slides.getCurrentSlide()),se=ue.attr("id");if(typeof l[se]=="undefined"||typeof l[se].annotator=="undefined"){var Ne=ue.children("img.slide_background");if(Ne.length===0){G("HOTZONE");return}Et(se)}ue.find("div > svg.a9s-annotationlayer").css("pointer-events","auto"),l[se].annotator.setDrawingEnabled(!0),l[se].annotator.setUserSelectAction("NONE"),l[se].annotator.off("selectionChanged",le)},xt=function(){var ue=n(e.Slides.getCurrentSlide()),se=ue.attr("id");ue.find("div > svg.a9s-annotationlayer").css("pointer-events","none"),typeof l[se]!="undefined"&&typeof l[se].annotator!="undefined"&&(l[se].annotator.setDrawingEnabled(!1),l[se].annotator.setUserSelectAction("EDIT"),l[se].annotator.on("selectionChanged",le))},Et=function(ue){if(typeof l[ue]=="undefined"&&(l[ue]=O()),typeof l[ue].annotator!="undefined")return l[ue].annotator;var se=n("#"+ue),Ne=e.Slides.getSlideBackgroundImg(se),Me=Annotorious.createImageAnnotator(Ne.attr("id"),{drawingEnabled:!1,drawingMode:"click",userSelectAction:"EDIT",style:{fill:"#dddddd",fillOpacity:.25,stroke:"#000000",strokeWidth:1}});Me.setDrawingTool("polygon"),Me.on("createAnnotation",vt=>{f[vt.id]=e.Utils.getId("zone-"),l[ue].hotzones[vt.id]={},l[ue].hotzones[vt.id].cursorVisibility="default",l[ue].hotzones[vt.id].enabled=!0,G("HOTZONE")}),Me.on("selectionChanged",le);var it=n(se.find("div > svg.a9s-annotationlayer").parent());return se.children("img.hotspot").each(function(vt,at){it.append(at)}),l[ue].annotator=Me,Me},le=function(ue){Array.isArray(ue)&&ue.length===1&&Oe(ue[0].id)},Oe=function(ue){T==="HOTSPOT"&&G("HOTSPOT"),m=ue,e.Editor.Tools.loadToolsForElement("hotzone")},ft=function(){n(D).trigger("click")},Ct=function(){var ue=n(e.Slides.getCurrentSlide()).attr("id"),se=m,Ne=l[ue].hotzones[se];n("#hotzoneIdInput").val(f[se]),typeof l[ue].hotzones[se].cursorVisibility=="string"?n("#hotzoneCursorVisibility").val(l[ue].hotzones[se].cursorVisibility):n("#hotzoneCursorVisibility").val("default"),l[ue].hotzones[se].enabled===!1?n("#hotzoneEnabled").val("false"):n("#hotzoneEnabled").val("true"),e.Editor.Actions.loadActions(n("#hotzoneActions"),Ne,"HOTZONE")},Rt=function(ue){var se=n(e.Slides.getCurrentSlide()).attr("id"),Ne=m,Me={};Me.enabled=n("#hotzoneEnabled").val()!=="false",Me.cursorVisibility=n("#hotzoneCursorVisibility").val();var it=e.Editor.Actions.getActionsJSON(n("#hotzoneActions"));it.length>0&&(Me.actions=it),l[se].hotzones[Ne]=Me,n.fancybox.close()},Wt=function(){return l},nn=function(ue){l=ue},rn=function(){return c},Zt=function(ue){c=ue,n("img.hotspot").removeClass("hotspot_selected"),typeof ue!="undefined"&&n(ue).addClass("hotspot_selected")},Vt=function(){return m},Qt=function(ue){m=ue,typeof ue=="undefined"&&ht(n(e.Slides.getCurrentSlide()).attr("id"))},st=function(ue){return f[ue]},ht=function(ue){typeof l[ue]!="undefined"&&typeof l[ue].annotator!="undefined"&&l[ue].annotator.cancelSelected()},qt=function(){var ue;if(typeof c!="undefined")ue=!0;else if(typeof m=="undefined")return;var se={};se.width=375,se.height=130,ue?(se.text=e.I18n.getTrans("i.AreYouSureDeleteHotspot"),se.notificationIconSrc=n(c).attr("src"),se.notificationIconClass="notificationIconDeleteHotspot"):(se.text=e.I18n.getTrans("i.AreYouSureDeleteHotzone"),se.notificationIconSrc=e.ImagesPath+"thumbs/hotzone.png");var Ne={};Ne.text=e.I18n.getTrans("i.no"),Ne.callback=function(){n.fancybox.close()};var Me={};Me.text=e.I18n.getTrans("i.delete"),Me.callback=function(){var it=n(e.Slides.getCurrentSlide()).attr("id");if(ue){var vt=n(c),at=vt.attr("id");vt.remove(),delete l[it].hotspots[at],Zt(w)}else{var _t=l[it].annotator;typeof _t!="undefined"&&_t.removeAnnotation(m),delete l[it].hotzones[m],m=w}e.Editor.Tools.cleanToolbar(),n.fancybox.close()},se.buttons=[Ne,Me],e.Utils.showDialog(se)},Xt=function(ue){var se={};se.id=n(ue).attr("id"),se.type=n(ue).attr("type");var Ne=e.Slides.getSlideBackground(ue);if(typeof Ne=="string"&&(se.background=Ne),typeof l[se.id]!="undefined"){var Me=Object.keys(l[se.id].hotspots);Me.length>0&&(se.hotspots=[],Me.forEach(at=>{var _t=n("img.hotspot[id='"+at+"']"),kt=parseFloat(_t.css("left")),Nt=parseFloat(_t.css("top")),Gt=l[se.id].hotspots[at],Bt,Jt;n("body").attr("aspectRatio")==="16:9"?(Bt=1024,Jt=576):(Bt=800,Jt=600);var un=(kt*100/Bt).toFixed(4),mn=(Nt*100/Jt).toFixed(4),Ut=(_t.width()*100/Bt).toFixed(4),vn=(_t.height()*100/Jt).toFixed(4),dn={id:at,x:un,y:mn,image:_t.attr("src"),width:Ut,height:vn,lockAspectRatio:Gt.lockAspectRatio,rotationAngle:_t.attr("rotationAngle"),visibility:Gt.visibility,cursorVisibility:Gt.cursorVisibility};Array.isArray(Gt.actions)&&Gt.actions.length>0&&(dn.actions=Gt.actions),se.hotspots.push(dn)}));var it=l[se.id].annotator;if(typeof it!="undefined"){var vt=it.getAnnotations();vt.length>0&&(se.hotzones=[],vt.forEach(at=>{var _t=at.id,kt=l[se.id].hotzones[_t],Nt=at.target.selector.geometry.points,Gt={id:_t,idAlias:f[_t],points:Nt,cursorVisibility:kt.cursorVisibility,enabled:kt.enabled};Array.isArray(kt.actions)&&kt.actions.length>0&&(Gt.actions=kt.actions),se.hotzones.push(Gt)}))}se=e.Editor.Caption.saveCaption(se)}return se};return{init:z,drawSlideWithMakers:E,refreshDraggables:Q,copyMarkers:oe,addHotspot:S,addHotzone:k,onClick:Z,getSlideData:Wt,setSlideData:nn,getDefaultSlideConfig:O,getCurrentHotspot:rn,setCurrentHotspot:Zt,showHotspotSettings:J,getCurrentHotzoneId:Vt,setCurrentHotzoneId:Qt,getAliasForHotzone:st,showHotzoneSettings:ft,cancelAnnotationSelectedForSlide:ht,deleteCurrentHotmarker:qt,onHotspotImageSourceChange:Xe,onClickHotspotImageGallery:Tt,checkHotspotImageURLPreview:ot,onInputHotspotSizeWidth:ze,onInputHotspotSizeHeight:et,onHotspotSettingsDone:Pe,onHotzoneSettingsDone:Rt,saveSlideWithMarkers:Xt}})(SceneMaker,jQuery),SceneMaker.Editor.Actions=(function(e,n,w){var l=function(){var L=[],v=e.Editor.getOptions().nPuzzles;if(typeof v=="number"&&v>0)for(var p=0;p<v;p++){var S=p+1;L.push({value:S,text:e.I18n.getTrans("i.PuzzleOption",{number:S})})}n("div.actionWrapperTemplate div.actionParamsPuzzle select, div.actionWrapperTemplate div.actionEventParamsPuzzle select").each(function(){var k=n(this);k.empty(),k.append(n("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),n.each(L,function(F,G){k.append(n("<option>",{value:G.value,text:G.text}))})})},c=function(L){var v=n("div.actionWrapperTemplate"),p=[];n('article[type="'+e.Constant.SCREEN+'"]').each(function(){var R=n(this);p.push({value:R.attr("id"),text:e.I18n.getTrans("i.ScreenOption",{number:R.attr("slidenumber")})})}),v.find("div.actionParamsScreen select").each(function(){var R=n(this);R.empty(),R.append(n("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),n.each(p,function(Y,N){R.append(n("<option>",{value:N.value,text:N.text}))})}),v.find("div.actionParamsScreenReplacement select").each(function(){var R=n(this);R.empty(),R.append(n("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),n.each(p,function(Y,N){R.append(n("<option>",{value:N.value,text:N.text}))})});var S=[],k=[],F=[],G=n(e.Screen.getCurrentScreen()),Z=G.attr("id");n("article[type='screen'] > article").each(function(){var R=n(this),Y=n(this).parent(),N={value:R.attr("id"),text:e.I18n.getTrans("i.ViewOption",{screenNumber:Y.attr("slidenumber"),viewNumber:R.attr("slidenumber")})};S.push(N),Y.attr("id")===Z&&k.push(N),R.attr("type")===e.Constant.VIEW_IMAGE&&F.push(N)});var te;L==="SCENE"?te=S:te=k,v.find("div.actionParamsView select").each(function(){var R=n(this);R.empty(),R.append(n("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),n.each(te,function(Y,N){R.append(n("<option>",{value:N.value,text:N.text}))})}),v.find("div.actionEventParamsSlide select").each(function(){var R=n(this);R.empty(),R.append(n("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),n.each(p,function(Y,N){R.append(n("<option>",{value:N.value,text:N.text}))}),n.each(S,function(Y,N){R.append(n("<option>",{value:N.value,text:N.text}))})}),v.find("div.actionParamsSlide select").each(function(){var R=n(this);R.empty(),R.append(n("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),n.each(p,function(Y,N){R.append(n("<option>",{value:N.value,text:N.text}))}),n.each(F,function(Y,N){R.append(n("<option>",{value:N.value,text:N.text}))})});var M=[];n("img.hotspot").each(function(){var R=n(this);M.push({value:R.attr("id"),text:R.attr("id")})}),v.find("div.actionParamsHotspotId select").each(function(){var R=n(this);R.empty(),R.append(n("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),n.each(M,function(Y,N){R.append(n("<option>",{value:N.value,text:N.text}))})});var V=[],ie=e.Editor.Marker.getSlideData();Object.keys(ie).forEach((R,Y)=>{Object.keys(ie[R].hotzones).forEach((N,Q)=>{V.push({value:N,text:e.Editor.Marker.getAliasForHotzone(N)})})}),v.find("div.actionParamsHotzoneId select").each(function(){var R=n(this);R.empty(),R.append(n("<option>",{value:"none",text:e.I18n.getTrans("i.Unspecified")})),n.each(V,function(Y,N){R.append(n("<option>",{value:N.value,text:N.text}))})})},m=function(L,v,p){if(n(L).find("div.actionWrapper:not(.actionWrapperTemplate)").remove(),c(p),n(L).addClass("actions_container"),typeof p=="string"&&n(L).addClass("actions_container_"+p),Array.isArray(v.actions)&&v.actions.length>0)for(var S=0;S<v.actions.length;S++){var k=v.actions[S];if(typeof k.actionType=="string"&&k.actionType!=="none"){var F=f(L);if(typeof k.event!="undefined"&&typeof k.event.eventType=="string"&&k.event.eventType!=="none"&&(F.find("select.actionEvent").val(k.event.eventType).trigger("change"),typeof k.event.eventParams!="undefined")){if(typeof k.event.eventParams.puzzleId=="string"){var G=F.find("div.actionEventParamsPuzzle select");G.val(k.event.eventParams.puzzleId)}if(typeof k.event.eventParams.slide=="string"){var Z=F.find("div.actionEventParamsSlide select");Z.val(k.event.eventParams.slide)}}if(F.find("select.actionType").val(k.actionType).trigger("change"),typeof k.actionParams!="undefined"){if(typeof k.actionParams.screen=="string"){var te=F.find("div.actionParamsScreen select");te.val(k.actionParams.screen)}if(typeof k.actionParams.screenReplacement=="string"){var M=F.find("div.actionParamsScreenReplacement select");M.val(k.actionParams.screenReplacement)}if(typeof k.actionParams.view=="string"){var V=F.find("div.actionParamsView select");V.val(k.actionParams.view)}if(typeof k.actionParams.slide=="string"){var ie=F.find("div.actionParamsSlide select");ie.val(k.actionParams.slide)}if(typeof k.actionParams.text=="string"){var R=F.find("div.actionParamsText textarea");R.val(k.actionParams.text)}if(typeof k.actionParams.url=="string"){var Y=F.find("div.actionParamsURL input");Y.val(k.actionParams.url)}if(typeof k.actionParams.hotspotId=="string"){var N=F.find("div.actionParamsHotspotId select");N.val(k.actionParams.hotspotId)}if(typeof k.actionParams.hotzoneId=="string"){var Q=F.find("div.actionParamsHotzoneId select");Q.val(k.actionParams.hotzoneId)}if(typeof k.actionParams.puzzleId=="string"){var oe=F.find("div.actionParamsPuzzle select");oe.val(k.actionParams.puzzleId),z(k.actionParams.puzzleId,F)}}}}},f=function(L){var v=n("div.actionWrapperTemplate").clone().removeClass("actionWrapperTemplate").show(),p=n(L);if(p.hasClass("actions_container_SCENE")){var S=["none","goToScreen","openView","showHotspot","hideHotspot","enableHotzone","disableHotzone","changeBackground","changeScreen","playSound","stopSound"];v.find("select.actionType option").each(function(){var k=n(this).val();S.includes(k)||n(this).remove()})}else v.find("div.setting_scene").remove();return n(L).append(v),v},T=function(L){var v=L.target.value,p=n(L.target).closest("div.actionWrapper"),S=p.find("div.actionEventParamsSlide"),k=S.find("select"),F=p.find("div.actionEventParamsPuzzle"),G=F.find("select");v==="puzzleSolved"?(G.prop("selectedIndex",0),F.show()):F.hide(),v==="slideRevealedFirstTime"||v==="slideRevealed"?(k.prop("selectedIndex",0),S.show()):S.hide()},A=function(L){var v=L.target.value,p=n(L.target).closest("div.actionWrapper"),S=p.find("div.actionParamsScreen"),k=S.find("select"),F=p.find("div.actionParamsScreenReplacement"),G=F.find("select"),Z=p.find("div.actionParamsView"),te=Z.find("select"),M=p.find("div.actionParamsSlide"),V=M.find("select"),ie=p.find("div.actionParamsText"),R=ie.find("textarea"),Y=p.find("div.actionParamsURL"),N=Y.find("input"),Q=p.find("div.actionParamsHotspotId"),oe=Q.find("select"),b=p.find("div.actionParamsHotzoneId"),Le=b.find("select"),ce=p.find("div.actionParamsPuzzle"),J=ce.find("select"),me=p.find("div.actionParamsPuzzleSolution"),h=p.find("div.ActionWarningChangeBackground");v==="goToScreen"||v==="changeScreen"?(k.prop("selectedIndex",0),S.show()):S.hide(),v==="changeScreen"?(G.prop("selectedIndex",0),F.show()):F.hide(),v==="openView"?(te.prop("selectedIndex",0),Z.show()):Z.hide(),v==="changeBackground"?(V.prop("selectedIndex",0),M.show(),h.show()):(M.hide(),h.hide()),v==="showText"?(R.val(""),ie.show()):ie.hide(),v==="openLink"||v==="changeBackground"||v==="playSound"||v==="stopSound"?(N.val(""),Y.show()):Y.hide(),v==="showHotspot"||v==="hideHotspot"?(oe.prop("selectedIndex",0),Q.show()):Q.hide(),v==="enableHotzone"||v==="disableHotzone"?(Le.prop("selectedIndex",0),b.show()):b.hide(),v==="solvePuzzle"?(J.prop("selectedIndex",0),ce.show()):ce.hide(),me.hide()},D=function(L){var v=L.target.value,p=n(L.target).closest("div.actionWrapper");z(v,p)},z=function(L,v){var p=v.find("div.actionParamsPuzzleSolution"),S=p.find("input");if(L!=="none"){var k=v.parent(),F="";k.hasClass("actions_container_HOTSPOT")?F=n("#hotspotIdInput").val():k.hasClass("actions_container_HOTZONE")&&(F=n("#hotzoneIdInput").val()),S.val(F),p.show()}else S.val(),p.hide()},O=function(L){n(L.target).closest(".actionWrapper").remove()},E=function(L){var v=[],p=n(L).hasClass("actions_container_SCENE");return n(L).find("div.actionWrapper").each(function(S,k){var F=n(this),G=F.find("select.actionType").val();if(G!=="none"){var Z={actionType:G,actionParams:{}},te=F.find("div.actionParamsScreen select");te.is(":visible")&&(Z.actionParams.screen=te.val());var M=F.find("div.actionParamsScreenReplacement select");M.is(":visible")&&(Z.actionParams.screenReplacement=M.val());var V=F.find("div.actionParamsView select");V.is(":visible")&&(Z.actionParams.view=V.val());var ie=F.find("div.actionParamsSlide select");ie.is(":visible")&&(Z.actionParams.slide=ie.val());var R=F.find("div.actionParamsText textarea");R.is(":visible")&&(Z.actionParams.text=R.val());var Y=F.find("div.actionParamsURL input");Y.is(":visible")&&(Z.actionParams.url=e.Editor.Utils.autocompleteUrls(Y.val()));var N=F.find("div.actionParamsHotspotId select");N.is(":visible")&&(Z.actionParams.hotspotId=N.val());var Q=F.find("div.actionParamsHotzoneId select");Q.is(":visible")&&(Z.actionParams.hotzoneId=Q.val());var oe=F.find("div.actionParamsPuzzle select");oe.is(":visible")&&(Z.actionParams.puzzleId=oe.val()),Object.keys(Z.actionParams).length===0&&delete Z.actionParams;var b=F.find("select.actionEvent").val();if(b!=="none"){Z.event={eventType:b,eventParams:{}};var Le=F.find("div.actionEventParamsPuzzle select");Le.is(":visible")&&(Z.event.eventParams.puzzleId=Le.val());var ce=F.find("div.actionEventParamsSlide select");ce.is(":visible")&&(Z.event.eventParams.slide=ce.val())}if(p&&typeof Z.event=="undefined")return;v.push(Z)}}),v};return{init:l,loadActions:m,onActionEventChange:T,onActionTypeChange:A,addNewAction:f,onPuzzleChange:D,onDeleteAction:O,getActionsJSON:E}})(SceneMaker,jQuery),SceneMaker.Editor.Caption=(function(e,n,w){var l,c=function(){l=n('<a href="#caption_fancybox" style="display:none"></a>'),n(l).fancybox({autoDimensions:!1,height:690,width:920,scrolling:"no",showCloseButton:!1,padding:0,onStart:function(O){m()},onComplete:function(O){},onClosed:function(O){}})},m=function(){var O=n(e.Slides.getCurrentSlide()).attr("id"),E=e.Editor.Marker.getSlideData(),L={};typeof E[O]!="undefined"&&typeof E[O].caption!="undefined"&&(L=E[O].caption),typeof L.text=="string"?n("#captionText").val(L.text):n("#captionText").val(""),typeof L.mode=="string"?n("#captionMode").val(L.mode):n("#captionMode").val("minimizable")},f=function(){n(l).trigger("click")},T=function(O){var E=n(e.Slides.getCurrentSlide()).attr("id"),L={};L.text=n("#captionText").val(),L.mode=n("#captionMode").val();var v=e.Editor.Marker.getSlideData();typeof v[E]=="undefined"&&(v[E]=e.Editor.Marker.getDefaultSlideConfig()),v[E].caption=L,e.Editor.Marker.setSlideData(v),n.fancybox.close()},A=function(O,E){if(z(E)!==!1){var L=e.Editor.Marker.getSlideData();typeof L[O]=="undefined"&&(L[O]=e.Editor.Marker.getDefaultSlideConfig()),L[O].caption=E,e.Editor.Marker.setSlideData(L)}},D=function(O){var E=e.Editor.Marker.getSlideData();return typeof E[O.id]!="undefined"&&z(E[O.id].caption)&&(O.caption=E[O.id].caption),O},z=function(O){return!(typeof O!="object"||typeof O.text!="string")};return{init:c,addCaption:f,onCaptionDone:T,loadCaption:A,saveCaption:D}})(SceneMaker,jQuery),SceneMaker.Editor.Preview=(function(e,n,w){var l=function(){},c=function(){var A=1;typeof e.PreviewPath!="undefined"&&n("#preview_action").attr("href",e.PreviewPath+"#"+A),window.SCENE_MAKER_OPTIONS_PREVIEW=JSON.parse(JSON.stringify(e.Utils.getOptions())),window.SCENE_MAKER_OPTIONS_PREVIEW.preview=!0,window.SCENE_MAKER_OPTIONS_PREVIEW.scene=e.Editor.saveScene(),m(),n("#preview_action").trigger("click")},m=function(){n("#preview_action").fancybox({width:f().width,height:f().height,padding:0,autoScale:!1,transitionIn:"none",transitionOut:"none",type:"iframe",onStart:function(){e.Editor.Utils.Loader.unloadObjectsInEditorSlide(e.Screen.getCurrentScreen())},onClosed:function(){e.Editor.Utils.Loader.loadObjectsInEditorSlide(e.Screen.getCurrentScreen())},onComplete:function(){}})},f=function(){var A={};return n("body").attr("aspectRatio")==="16:9"?(A.width=1e3,A.height=670):(A.width=910,A.height=680),A},T=function(){return scenePreview};return{init:l,preview:c,getPreview:T}})(SceneMaker,jQuery),SceneMaker.Editor.Clipboard=(function(e,n,w){var l,c,m="SceneMakerClipboard",f=function(){l=[null,null,null]},T=function(D){if(!(!D||!e.Slides.isScreen(D))){l[0]=e.Utils.getOuterHTML(n(D).clone()[0]);var z={};z.textAreas=e.Editor.Slides.copyTextAreasOfSlide(D),l[1]=z,e.Status.getDevice().features.localStorage&&localStorage.setItem(m,JSON.stringify(l))}},A=function(){if(c){var D=new Date().getTime()-c;if(D<500)return}if(c=new Date().getTime(),e.Status.getDevice().features.localStorage){var z=localStorage.getItem(m);if(z!==null)var O=JSON.parse(z)}if(O||(O=l),O[0])O[0]=n(O[0])[0];else return;var E=n(O[0]).clone()[0],L={};O[1]&&O[1].textAreas&&(L.textAreas=O[1].textAreas),e.Editor.Screen.copyScreen(E,L)};return{init:f,copy:T,paste:A}})(SceneMaker,jQuery),SceneMaker.Editor.Events=(function(e,n,w){var l=!1,c,m=!1,f=function(){T()},T=function(){l||(n(document).on("click","#addScreenButton",e.Editor.Screen.onClickAddScreenButton),n(document).on("click","#addViewButton",e.Editor.View.onClickAddViewButton),n(document).on("click","#screen_selected_img",e.Editor.Screen.onClickOpenScreen),n(document).on("click","#save_scene_details",e.Editor.Settings.onSaveSceneSettingsButtonClicked),n(document).on("click","div.viewthumb",e.Editor.onViewThumbClicked),n(document).on("click",".editable",e.Editor.onEditableClicked),n(document).on("click",".selectable",e.Editor.onSelectableClicked),n(document).on("click",':not(".selectable"):not(".preventNoselectable")',e.Editor.onNoSelectableClicked),n(document).on("click",".delete_screen",e.Editor.Screen.onDeleteScreenClicked),n(document).on("click",".delete_view",e.Editor.View.onDeleteViewClicked),n(document).on("click",".delete_content",e.Editor.onDeleteItemClicked),n(document).on("click",".change_bg_button",e.Editor.Tools.changeBackground),n(document).on("click","#tab_pic_from_url_content button.button_addContent",e.Editor.Image.addContent),n(document).on("click","#tab_object_from_url_content button.button_addContent",e.Editor.Object.drawPreviewElement),n(document).on("click","#tab_video_from_url_content button.button_addContent",e.Editor.Video.addContent),n(document).on("change","#hotspotImageSource",e.Editor.Marker.onHotspotImageSourceChange),n(document).on("click","#hotspotImageGallery img",e.Editor.Marker.onClickHotspotImageGallery),n(document).on("blur","#hotspotImageURL",e.Editor.Marker.checkHotspotImageURLPreview),n(document).on("input","#hotspotSizeWidth",e.Editor.Marker.onInputHotspotSizeWidth),n(document).on("input","#hotspotSizeHeight",e.Editor.Marker.onInputHotspotSizeHeight),n(document).on("click","#hotspotSettingsDone",e.Editor.Marker.onHotspotSettingsDone),n(document).on("click","#hotzoneSettingsDone",e.Editor.Marker.onHotzoneSettingsDone),n(document).on("click","div.actions_container button.add_action",function(){e.Editor.Actions.addNewAction(n(this).closest("div.actions_container"))}),n(document).on("change","select.actionEvent",e.Editor.Actions.onActionEventChange),n(document).on("change","select.actionType",e.Editor.Actions.onActionTypeChange),n(document).on("click","div.delete_action",e.Editor.Actions.onDeleteAction),n(document).on("change","div.actionParamsPuzzle select",e.Editor.Actions.onPuzzleChange),n(document).on("click","#objectSettingsDone",e.Editor.Object.onObjectSettingsDone),n(document).on("click","#captionDone",e.Editor.Caption.onCaptionDone),n(document).on("click",D),n(document).bind("keydown",z),n(document).bind("keyup",O),n("article").live("slideenter",e.Editor.onSlideEnterEditor),n("article").live("slideleave",e.Editor.onSlideLeaveEditor),n(document).on("click","#waiting_overlay",function(v){v.stopPropagation(),v.preventDefault()}),n(window).on("orientationchange",function(){n(window).trigger("resize")}),n("a#addViewFancybox").fancybox({autoDimensions:!1,scrolling:"no",width:800,height:740,padding:0,onStart:function(v){e.Editor.setContentAddMode(e.Constant.VIEW);var p=n(v).attr("zone");e.Editor.setCurrentArea(n("#"+p)),e.Editor.Utils.loadTab("tab_views")},onClosed:function(v){e.Editor.setContentAddMode(e.Constant.NONE)}}),n("#fancyLoad").fancybox({type:"inline",autoDimensions:!1,scrolling:"no",autoScale:!0,width:"100%",height:"100%",padding:0,margin:0,overlayOpacity:0,overlayColor:"#fff",showCloseButton:!1,onComplete:function(v){e.Utils.Loader.prepareFancyboxForFullLoading()},onClosed:function(v){}}),n("#hidden_button_to_change_slide_background").fancybox({autoDimensions:!1,width:800,scrolling:"no",height:600,padding:0,onStart:function(v){e.Editor.Image.setAddContentMode(e.Constant.SCREEN),e.Editor.Utils.loadTab("tab_pic_from_url")},onClosed:function(v){e.Editor.Image.setAddContentMode(e.Constant.NONE)}}),window.onbeforeunload=E,c=!0,l=!0)},A=function(v){n(v).find("a.addpicture").fancybox({autoDimensions:!1,width:800,scrolling:"no",height:600,padding:0,onStart:function(p){var S=n(p).attr("zone");e.Editor.setCurrentArea(n("#"+S)),e.Editor.Image.setAddContentMode(e.Constant.NONE),e.Editor.Utils.loadTab("tab_pic_from_url")}}),n(v).find("a.addobject").fancybox({autoDimensions:!1,width:800,height:600,scrolling:"no",padding:0,onStart:function(p){var S=n(p).attr("zone");e.Editor.setCurrentArea(n("#"+S)),e.Editor.Utils.loadTab("tab_object_from_url")},onClosed:function(p){e.Editor.Object.resetPreview("tab_object_from_url_content")}}),n(v).find("a.addvideo").fancybox({autoDimensions:!1,width:800,scrolling:"no",height:600,padding:0,onStart:function(p){var S=n(p).attr("zone");e.Editor.setCurrentArea(n("#"+S)),e.Editor.Utils.loadTab(e.Editor.Video.getDefaultTab())},onClosed:function(p){e.Editor.Object.resetPreview("tab_video_from_url_content")}})},D=function(v){e.Editor.Marker.onClick(v)},z=function(v){switch(v.keyCode){case 39:e.Editor.Slides.isSlideFocused()&&(e.Slides.isScreen(e.Screen.getCurrentScreen())&&e.Editor.View.forwardOneView(),v.preventDefault());break;case 40:e.Editor.Slides.isSlideFocused()&&(e.Screen.forwardOneScreen(),v.preventDefault());break;case 37:e.Editor.Slides.isSlideFocused()&&(e.Slides.isScreen(e.Screen.getCurrentScreen())&&e.Editor.View.backwardOneView(),v.preventDefault());break;case 38:e.Editor.Slides.isSlideFocused()&&(e.Screen.backwardOneScreen(),v.preventDefault());break;case 17:m=!0;break;case 67:e.Editor.Slides.isSlideFocused()&&m&&e.Screen.getCurrentScreenNumber()&&e.Editor.Clipboard.copy(e.Screen.getCurrentScreen());break;case 86:e.Editor.Slides.isSlideFocused()&&m&&e.Editor.Clipboard.paste();break;case 46:e.Editor.Slides.isSlideFocused()&&e.Editor.Slides.removeCurrentSlide();break}},O=function(v){switch(v.keyCode){case 17:m=!1;break}},E=function(){if(c&&e.Editor.hasSceneChanged()){var v=e.I18n.getTrans("i.ExitConfirmation");return v}},L=function(){c=!1};return{init:f,bindEditorEventListeners:T,addZoneThumbsEvents:A,allowExitWithoutConfirmation:L}})(SceneMaker,jQuery);
